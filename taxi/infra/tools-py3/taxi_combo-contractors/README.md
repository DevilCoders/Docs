# combo-contractors tools
## Cкрипт редактирования правил матчинга заказов
#### Добавление нового или обновление существующего правила
Пример
```
order_match_rules.py upsert -n regular_combo -e "cb1_dist-b2b1_dist>x_dist && cb1_time-b2b1_time" -p x_dist=500 -p x_time=100
```
добавляет правило с именем ```regular_combo``` и выражением ```cb1_dist-b2b1_dist>x_dist && cb1_time-b2b1_time```. Для правила задаются значения по умолчанию для параметров ```x_dist``` и ```x_time```. 
Значения по умолчанию необходимо задавать для всех используемых в выражении параметров, кроме тех, значения которых вычисляются в момент матчинга заказов:
- ```cb1_dist``` - расстояние по роутеру до конца текущего заказа в метрах
- ```cb1_time``` - время по роутеру до конца текущего заказа в секундах
- ```ca2_dist``` - расстояние от водителя до точки А второго заказа в метрах
- ```ca2_time``` - время по роутеру от водителя до точки А второго заказа в секундах
- ```b2b1_dist``` - расстояние по роутеру от точки Б второго заказа до точки Б первого в метрах
- ```b2b1_time``` - время по роутеру от точки Б второго заказа до точки Б первого в секундах
- ```a2b2_dist``` - расстояние по роутеру поездки по второму заказу в метрах
- ```a2b2_time``` - время по роутеру поездки по второму заказу в секундах
- ```a1c_dist``` - пройденное водителем расстояние по первому заказу в метрах 
- ```a1c_time``` - пройденное водителем время по первому заказу в секундах

Если правило с таким именем уже существовало, старая информация полностью затирается. 
Для правила допускается задавать только логическое выражение.

[Примеры выражений](https://wiki.yandex-team.ru/taxi/backend/userver/libraries/math-expr/#primeryvyrazhenijj "Примеры выражений")

#### Просмотр правил
Для вывода списка всех существующих правил:
```
order_match_rules.py list
```

#### Удаление правила
Для удаления правила с именем ```regular_combo```:
```
order_match_rules.py  delete -n regular_combo
```
