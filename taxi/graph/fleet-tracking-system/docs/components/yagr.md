# Yagr - yet another georeceiver

Ягр выступает как входная точка для пользовательских позиций и разделяет потоки
внутри системы.

Сейчас он делает чуть больше, вот то что остается снаружи - т.е. в сервисе,
который стоит перед Yagr, вне нашей системы.
1. Получить тип транспорта по сервису Такси
2. Сходить за хедерами по питания Таксиметра и добавить их во все ответы

Вот то что Ягр будет делать после введения в строй нашей системы:
1. Получить позицию
2. Отправить ее в каналы согласно спецификации

Под вопросом куда лучше внести
1. (под вопросом) определить регион по сервису Такси. Кажется что все наши
   потребители используют одну систему регионов, а наружу мы пока не выходим.
   Можно сделать так, что пока регион берется автоматом, а потом если мы добавим
   поле 'region', то если оно установленно пользователем - то используем его,
   иначе по старому, ходим в сервис Такси.
2. Подправить timestamp позиции согласно настройкам. Тут сейчас такая ситуация:
   1. Ягр подправляет timestamp у позиции прежде чем отправить ее в один канал.
      Он это делает согласно настройкам определенного конфига. Можно перенести
      это в конфиги пайплайна и считывать оттуда. 
   2. Ягр отбрасывает позиции из слишком далекого прошлого или будущего. Опять
      таки он это делает по такси-конфигу.
      Но он это делает только при отправке в канал А. А при отправке в канал Б
      он позиции не отбрасывает. Таковы требования заказчкиво.
      Кажется что это лучше внести в конфигурацию
      Ягра и оставить внутри, потому что снаружи такое не сделать.


## Конфигурация

Конфигурация для приемника описывается вот такой схемой

{% cut "Схема приемника" %}

{% code '../yaml/config_internal/yagr.yaml' lang=yaml %}

{% endcut %}

TODO: examples
