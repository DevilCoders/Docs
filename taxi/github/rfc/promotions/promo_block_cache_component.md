## Бизнесовая задача

Promotions используется для управление промо контентом, содержимое которого не зависит от места использования.
Однако есть определенный набор экранов, контент которых зависит от контекста ендпойнта:

- Пример №1: https://github.yandex-team.ru/taxi/rfc/pull/435 (Промоблоки в routestats)
  - текущее решение в protocol:
    - не настраиваются
    - не универсальны
  - описанное в rfc новое решение подразумевает поход из ручки во внешние источники, эти источники должны уметь формировать промоблоки
    - например потенциальный промоблок драйва должен вернуть цену в тайтле, и сформировать диплинк, позволяющий перейти на тариф драйва
- Пример №2: шорткаты
  - присутствуют источники шорткатов, которые должны так или иначе регулировать содержимое шортката
    - шорткат рефералки (формирование диплинка, тайтл)
    - шорткат драйва (цена, image_tag машинки, адрес)
    
Необходимость в самостоятельном изменении полей промоутирующего блока приводит к написанию велосипедов в каждом месте генерации объекта, 
связанных с конфигурацией полей + приводит к отсутствию средств визуализации в админке 

## Предложение архитектуры в рамках rfc

![promo_block_cache](https://jing.yandex-team.ru/files/ihelos/promo_block_cache.png "promo_block_cache")

## Флоу использования

![promo_block_cache_flow](https://jing.yandex-team.ru/files/ihelos/promo_block_flow.png "promo_block_cache_flow")

Краткие детали реализации:
- Реализуем все типы промок через заведение нового типа промо-объекта в promotions;
- Реализуем кэш-компоненту, которая из существующей ручки /internal/list (#TODO: или новой, допроработать) сервиса promotions,
по консьюмеру (например drive-promo-block-handler) и типу промоблока (например routestats-selector-promoblock) получает шаблон промоблока;
- Компонента "под капотом" проверяет попадание пользователя в эксперимент для промоблока;
- Компонента компилирует шаблон, используя передаваемый хендлером пейлоад/контекст.

Данный флоу позволит централизовать логику управления промообъектами в promotions.

### Продуктовые ограничения

#### Этап 1

Реализация MVP, позволяющего применить компоненту в потенциальном месте использования и использовать наложить на него свой payload;

Ограничения первой реализации:
- отсутствие проверок на наличие полей в payload;
- флоу введения новых промоблоков, которые не поддерживаются на старых клиентах;
- promotions использует свои изображения (нет image_tag);
- не решается вопрос создания новых промок;
