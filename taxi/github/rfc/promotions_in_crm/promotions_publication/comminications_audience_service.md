## Сервис для работы с аудиторией клиенских коммуникаций communications-audience

### Задача, которую решает сервис

С аудиторией коммуникации нужно уметь:
- публиковать коммуникацию на всю аудиторию;
- снимать публикацию с части аудитории;
- снимать публикацию со всей аудитории;
- публиковать коммуникацию, доступную в разное время;
- проверять попадание пользователя в аудиторию.

Предлагается аудиторию связать с меткой коммуникации. 
Новый сервис будет размечать аудиторию и хранить её.

Про новое хранилище для аудитории подробнее [здесь](audience_storage.md)

Предварительное название сервиса `communications-audience`

Сервис должен предоставлять следующие ручки:

1. Ручка для разметки аудитории.

`/communications-audience/v1/publish` 

Подробности и api [здесь](promotions_handler_for_crm.md)

2. Вернуть статус разметки. 

`/communications-audience/v1/publication-status`

размечается/размечено/удаляется/не найдено/ошибка разметки.

Потребуется для отчётности по кампаниям. В запросе - метка аудитории, ответ - статус разметки.

Другой вариант: статус по идентификатору пользователя. Здесь нужно более детальное обсуждение, 
api проработаем позже.

3. Снять разметку с аудитории.

`/communications-audience/v1/unpublish`

В запросе - метка аудитории и идентификаторы пользователей 
или метка без идентификаторов, если снимаем со всей аудитории. Возвращет 200 OK, если снятие с разметки успешно началось.

4. Вернуть поддержанные контекстные фильтры.

`/communications-audience/v1/available-filters`

Подробности и api [здесь](crm_communication_audience.md)

5. Проверить попадание пользователя в аудиторию кампании

`/4.0/communications-audience/v1/get_campaigns`

Подробности и api [здесь](user_campaigns_handler_for_inapp.md)
