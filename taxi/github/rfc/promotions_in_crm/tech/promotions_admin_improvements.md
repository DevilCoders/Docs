## Задача

Сейчас в админке коммуникаций есть ряд известных проблем:
- нельзя завести некоторые объекты без заголовка (пример: баннер заливается картинкой, заголовок не нужен. 
Приходится вписывать в поле заголовка `.` в цвет баннера);
- не работает публикация по времени (были жалобы на то, что публикуется по эксперименту, а не заданному времени);
- не работает тестовая публикация (были жалобы, что не работает совсем);
- персонализация YQL работает не для всех сценариев;
- не хватает логирования идентификаторов объектов для dwh;
- не хватает логирования ошибок для разбора проблем со сбором сложных объектов (витрин);
- админка недостаточно интуитивная, отсутствуют подсказки. Пример: решённый дьюти-тикет https://st.yandex-team.ru/TAXIDUTY-26707, 
отзывы менеджеров, загружающих в админку коммуникации;
- в случае проблем менеджерам непонятно, к кому обращаться и как решить её самостоятельно (ответственная команда и документация);
- коммуникаций стало много, сложно найти нужную.

Предлагается, пока в админке коммуникаций идёт активная разработка, по очереди починить эти проблемы.
Так как эти задачи не зависят от CRM, их можно делать параллельно с проектом доработки админки коммуникаций для CRM.

## План работ

Задачи перечислены от наиболее к наименее важной, в этом порядке и будем делать.
Также разбиваю на бэкенд/скорее, фронтенд/не разработка.

#### Бэкенд

1. Логирование идентификаторов для DWH.

https://st.yandex-team.ru/TAXIBACKEND-38657

2. Починить публикацию по времени.

Надо протестировать её и попробовать найти ошибку. На что были жалобы: коммуникация снимается с публикации не по указанному времени, 
а по времени завершения эксперимента. Надо изучить, как сейчас связано время публикации и время в эксперименте. 

https://st.yandex-team.ru/TAXIBACKEND-38695

3. Починить тестовую публикацию.

Надо протестировать её и попробовать найти ошибку. Тестовая публикация должна быть доступна более одного раза 
(проверить, чтобы была такая возможность при публикации по эксперименту).

4. Проверить публикацию по YQL и доработать её для тех типов коммуникаций, где она не используется, но нужна.

https://st.yandex-team.ru/TAXIBACKEND-38610

5. Логирование ошибок.

https://st.yandex-team.ru/TAXIBACKEND-38085


#### Скорее, фронтенд/потребуется фронтенд

1. Сделать возможным публиковать все объекты, которые загружаются картинкой, без заголовка.

Здесь надо изучить публикуемые объекты, посмотреть, какие нельзя сохранить без заголовка. 
Дальше попробовать убрать обязательность заголовка и посмотреть в районе `inapp-communications`, 
что там отсутствие заголовка не приводит к ошибкам. 

Сюда же: починить то, что уже можно публиковать без заголовка: https://st.yandex-team.ru/TAXIBACKEND-38870

2. Ограничивать публикации по приоритетам.

Пример (для объектов на карте): не должно быть возможности создать коммуникацию с высоким приоритетом, 
если уже есть с приоритетом 1 (здесь уточнить продуктовые требования).

3. Добавить возможность загружать разные картинки для разных локалей. 
Пример, где это может быть нужно: баннер для Uber, где шрифт не из 
стандартных шрифтов коммуникаций, поэтому текст написан на картинке.

4. Подсказки.

Можно добавить ко всем сложным текстовым полям в админке подсказки, 
что туда надо вписать, и какие ограничения на значение существуют.

5. Сортировать коммуникации.

Проработано [здесь](../../promotions/adminka.md)

https://st.yandex-team.ru/TAXIBACKEND-38502

#### Не разработка

1. К кому обращаться по проблемам.

Обновить отвественную команду в админке и описание в чате проблем с админкой коммуникаций. Проверить, что легко находится ссылка на чат.
Документацию дополнить и тоже сделать легко находимой, сейчас она лежит здесь: 
https://wiki.yandex-team.ru/taxi/backend/client-product/projects/klientskie-kommunikacii-v-taksi/
