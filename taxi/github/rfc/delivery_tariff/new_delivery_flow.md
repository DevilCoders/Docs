## Задача

Предлагается доработать флоу тарифа "Доставка" таким образом, чтобы новое флоу объединяло в себе тарифы "Доставка" и "Курьер".

## Дизайн

[Дизайн тарифа "Доставка" в Figma](https://www.figma.com/file/TZMNVE3YzGBElriZQNKlOZcr/Тариф-«Доставка»)

## Необходимые изменения
1. На экране тарифа должен измениться текст кнопки ("Далее" вместо "Заказать")
2. На экране выбора, кто заберёт, по тапу на номер квартиры должен появляться баббл "До двери - платно" только для тарифа "Доставка".
3. На экране "кто отдаст и заберёт" должна показываться плашка "От двери до двери" только для тарифа "Доставка".

## Решение
### Изменение текста кнопки
Существующие клиенты получают текст кнопки из ручки routestats. 
Новый текст не должен сломать существующую логику старых клиентов, поэтому предлагается ответ в routestats не менять. 
Можно добавить ещё одно поле в эксперимент `route_additional_information_step`, оно будет одинаковым для тарифов "Курьер" и "Доставка" и содержать танкерный ключ. 
Если ключ задан в эксперименте - клиенты будут показывать этот текст на кнопке, если не задан - брать из ответа routestats. 
Эксперимент нужно поменять только для клиентов, начиная с определённой версии.
Как это сделать, описано на вики: https://wiki.yandex-team.ru/taxi/backend/architecture/experiments3/Manual/#spisokdostupnyxoperacijj (операции сравнения).

```
{
  ...
  "enabled": true,
  "tariffs": [
    "express",
    "courier"
  ],
  ...
  // новый текст кнопки
  "tariff_screen_continue_button_text": "$tanker.order_additional_steps.express.tariff_screen_continue_button_text"
}
```

### Показ баббла и плашки для "Доставки"
Второй и третий пункты необходимых изменений можно закрыть одним решением.

Насколько я сейчас вижу, баббл и плашка связаны, скорее, с требованием `door_to_door`,  чем с тарифом.
Поэтому хочется и изменения привязать к этому требованию.

Я вижу несколько вариантов:
1. Не возвращать требование `door_to_door` на клиент для тарифа "Курьер".
Изначально казалось простым решением: есть требование - клиенты покажут баббл и плашку, нет требования - нет.
Оказалось, что у этого варианта есть ограничения. Сейчас требование для тарифа "Курьер" есть, и считается, что оно включено по дефолту.
На клиенте уже есть завязанная на это логика.
2. Добавить в требования флажок `is_hidden` и заполнять на бэкенде для тарифа "Курьер".
Это не сломает существующую логику на клиентах, использующую требование `door_to_door`, плашку и баббл можно показывать или не показывать по его значению.
```
supported_requirements:
        description: требования к заказу, регулируемые на стороне сервера
        items:
            additionalProperties: false
            properties:
                ...
                // новый флажок
                is_hidden:
                    description: требование не должно показываться на клиенте
                    type: boolean
                ...
```
3. Использовать эксперимент `route_additional_information_step` и в нём поле `turn_on_requirement_notification`.
Это поле отвечает за текст баббла. Можно разбить эксперимент для разных тарифов и добавить рядом с текстом флажок включения баббла.
Но тогда для плашки придётся добавлять отдельный флажок, возможно, в этот же эксперимент.

```
{
  ...
  "enabled": true,
  "tariffs": [
    "express",
    "courier"
  ],
  ...
  ,
  "turn_on_requirement_notification": {
    "description": "$tanker.order_additional_steps.express.turn_on_requirement_notification"
    // для баббла
    "enabled": [
    {
      "tariff": "express",
      "value": true
    },
    {
      "tariff": "courier",
      "value": false
    }
  ]
  },
  // для плашки
  "show_requirement_slider": [
    {
      "tariff": "express",
      "value": true
    },
    {
      "tariff": "courier",
      "value": false
    }
  ]
}
```

Решено делать вариант 3 с экспериментом, потому что он выглядит простым и позволит быстро запустить новое флоу. 
Потом вернуться к варианту 2, потому что размещать бизнес-логику на бэкенде всё же предпочтительнее, чем в эксперименте.