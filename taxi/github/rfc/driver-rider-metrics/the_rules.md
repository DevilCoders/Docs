## Цель документа
Определить общие правила и подходы, которым надо следовать при разработке сервисов *-Metrics-*, любых изменений в другие сервисы, проводимых в рамках разаработки указанных выше сервисов, а также любых других сервисов, которые будут разарабатываться текущей командой https://staff.yandex-team.ru/departments/yandex_rkub_taxi_marketing_6154_dep79096_dep25335_dep10217/.

## Порядок применения и изменения документа
1. Все указанные здесь процессы и правила нужно соблюдать. Если с чем-то не согласен - выносить на обсуждение, а не игнорировать. Так мы получим постоянное улучшение процесса, как нас учат умные документы вроде ISO 9000.
1. По результатам договоренностей по процессам в части пересмотра процессов или добавления новых процессов - обновлять данную страницу. 
1. Указанное на данной странице в общем случае имеет большее значение относительно устных договоренностей.
1. Частные исключения возможны в случаях рациональной обоснованности, если с этим согласны остальные члены команды.
1. Если некий частный случай возник больше 2 раз - занести его в данный документ. 

## Цености)
* Мы любим людей и уважаем друг друга. Давайте не забывать об этом.

## Общие принципы
1. Думай головой. Ни одно правило не существует просто так само по себе, у каждого правила есть конкретный смысл. Применять правила бездумно не стоит.
1. Явное лучше неявного. Как в общении, так и в разработке.
2. Мы стремимся решать проблемы простыми способами, не забывая при этом о масштабируемости, поддерживаемости и надёжности решений.
3. Качество в большинстве случаев важнее скорости.

## Порядок работы с задачами
1. Необходимо перемещать тикеты между статусами с целью отражать реальное состояние дел. Не забывай двигать тикеты, из Open -> Processing -> Pull Request -> ...

## Порядок разработки

### О задачах
1. Изменения вносим только по задачам. Исключение - однострочник, который что-то чинит или улучшает в явном виде и не требует отдельных тестов.
2. Каждая задача должна быть оценена с точки зрения необходимости, критичности бизнесом и товарищами. Это значит, что если ты нашел что-то, что ты уверен надо срочно исправить, и это не относится напрямую к задаче, над которой ты сейчас работаешь - то следует создать задачу, описать, и позвать руководителя оценить, насколько срочно ее нужно поправить. Даже если тебе точно кажется, что если ее не поправить немедленно, то все развалится.

### О коде
1. Те же правила, что и в общих принципах выше.
1. Следуем кодстайлам такси: ((c++ https://wiki.yandex-team.ru/taxi/backend/codestyle-and-checklist/)), ((python https://wiki.yandex-team.ru/taxi/backend/codestyle/)) и ((python https://wiki.yandex-team.ru/taxi/backend/client-product/code-guidelines/))
2. Необходимо делать функции, решающие как можно меньше задач: 1 - отлично, 2 - нормально, 3 - плохо. Согласно single responsibility principle и здравому смыслу. Также функции должны быть небольшими, так проще.
3. Чистая функция почти всегда лучше функции с побочными эффектами. Мы стремимся писать чистые функции.

### О ПРах
1. Не делаем большие ПРы. ПР большой, если в нём больше одного логического изменения. Также ПР можно счесть большим, если в нём больше 600 (400 для питона) строк изменений, это на усмотрение ревьюера. Если ПР большой, разбиваем его на несколько. Это возможно почти всегда.
5. Код должен быть покрыт тестами. Тесты должны покрывать как общую часть решения, так и краевые случаи.
5. Зовем коллег на ревью явным призывом в чатик. По умолчанию, при исправлении ошибок со стороны автора ПРа, при добавлении комментариев к ПРу со стороны ревьюера, уведомляем в личку/чатик противоположную сторону. В команде также может быть принято следить за уведомлениями арканума в почту и не уведомлять в личку.
7. Зовем на ревью, только когда все проверки, кроме schemas, позеленели и проверили в тестинге. Исключение - есть сомнения по выбранному пути или это часть большого ПР.
8. Если ты хочешь тоже ревьюить ПР, но тебя не позвали - предупреди об этом автора, чтобы он дождался всех замечаний ото всех, и исправил их одним заходом.
15. Если ревьювер делает замечание в ПР, то он его описывает так, чтобы любой чукча понял его смысл. И предлагает альтернативу, если не нравится подход. Варианты типа: не так, переделай, тут говно, надо по-другому, это не кошерно, ошибка! и т.д. без пояснений считаем, что можно игнорировать
10. Если по одному моменту у двух коллег возникло разное мнение в ПР - им следует согласовать свое видение вербально и написать в ПР достигнутое мнение.
11. Если по одному моменту в ПР больше трех комментариев - призываем коллег для общественного обсуждения.
13. При исправлении замечаний к ПРу, автор ПРа ставит resolved на замечания, о которых он уверен, что исправил. На оставшиеся замечания resolved ставит автор замечаний.
14. Если в ПР несколько однотипных вещей, к которым есть вопросы у ревьювера, то автор должен исправить все случаи, а ревьювер указать замечание только для одного случая. Т.е. если ревьювер хочет, чтобы не использовалась strcpy, то он пишет это только для первого случая, а автор исправляет все вхождения. По умолчанию считаем, что замечания относится ко всех вхождениям, если явно не указано иное.
128. Все ответы на комментарии по ПР, как автор и как ревьювер, отвечающий на ответы, делаем не на первой странице, а на 3ей вкладке Изменненые файлы, после чего нажимаем запостить ревью. Так все участники/подписчики получат только одно агрегированное письмо со всеми комментами, а не по письму на каждый коммент.

### Об остальном
1. Все вопросы стараемся обсуждать в общем чатике, чтобы не пересказывать потом другим коллегам то же самое, и все были в курсе.
9. При создании/доработке ручек сначала меняем/придумываем схему и согласовываем ее в тикете, затем - разрабатываем. Окаем сначала с руководителем, потом с одним из текущих окарей api. На свой страх и риск можно разрабатывать параллельно с ожиданием ока.
15. Если ты думал над проблемой больше получаса и не нашел решения - можешь смело справшивать товарищей, не держи в себе.

## Порядок планирования и работы со StarTrek
1. Наша доска https://st.yandex-team.ru/agile/board/6741
2. Когда создаем задачу - ставим ей компонент. Обязательно (driver-metrics, dms, rider-metrics, etc.)
5. Большие задачи создаем как Эпик.
6. Допустимо только два уровня иерархии - Эпик и Подэпик, никаих вложенных задач! Если нужно еще как-то поделить, то используй компоненты, версии и теги.
