#### Название сервиса
hiring-data-markup

#### Задачи сервиса
##### Какую продуктовую проблему решает сервис?
Управление прохождением данными экспериментов в зависимости от флоу. Флоу - некоторый набор обработок, через которые должен пройти тикет. Например, новый тикет должен провериться на факт вхождения в эксперимент по продаже лидов таксопаркам, чтобы не попасть в обработку КЦ. В дальнейшем тот же тикет может снова проходить эксперименты, но в рамках другого флоу. 

##### Почему нельзя решить эту задачу без разработки нового сервиса существующими решениями?
В репозитории infranaim есть часть необходимой логики, которую можно было бы доработать, но он deprecated.

##### Как именно сервис будет решать поставленные перед ним задачи?
Сервис принимает данные и последовательно обогащает их полями из экспериментов, соответствующих флоу. Настройки вызова экспериментов и взаимодействия с историей их прохождения (например, когда мы не хотим, чтобы один и тот же номер при каждом его появлении попадал в продажу лидов) находятся в конфигах админки такси.

##### Разрабатывается один сервис или система?
- [x] Один
- [ ] Система

#### Взаимодействие
##### Сервис внутренний или внешний?
- [x] Внутренний
- [ ] Внешний

##### С кем взаимодействует сервис?
- personal
- experiments3
- hiring-authproxy
- stq-agent

##### Использование Passenger Authorizer
https://wiki.yandex-team.ru/taxi/backend/architecture/passenger-authorizer/
- [ ] Да

##### Использование Driver-authorizer
https://wiki.yandex-team.ru/taxi/backend/architecture/driver-authorizer/
- [ ] Да

##### Залогиненность
Залогиненность означает возможность запуска сервиса в доменах yandex.ru|yandex-team.ru, возможность залогинить пользователя, возможность проверить или выставить cookie
- [ ] Да

##### Использование Blackbox
https://doc.yandex-team.ru/blackbox/concepts/about.xml
- [ ] Да

##### Использование MDS
https://wiki.yandex-team.ru/mds/s3-api/
- [ ] Да

##### Какие базы использует?
- [x] PostgreSQL
- [ ] Mongo
- [ ] Redis
- [ ] Other

##### Какие периодические процессы?
1. Удаление устаревших данных;
2. В дальнейшем добавится stq-таска для прохождения данных по флоу экспериментов.

#### Хранение и обработка данных
##### Планируется обработка персональных данных
Удостоверения личности, данные банковских карт, финансовая информация, ФИО + номер телефона, персональные прогнозы (как у Крипты) и т.д. 
- [x] Да

##### Какие данные и по какой схеме сервис будет хранить в базе?
На входе данные будут обмениваться на pd_id, всё дальнейшее взаимодейстие происходит только с pd_id.

##### Какой объем данных будет храниться и какой объем будет изменяться в единицу времени?
- До 1 Гб
- До 5 Мб/секунду

##### Какие операции над данными заложены?
- SELECT - поиск по истории
- INSERT - добавление в историю
- DELETE - удаление устаревших данных кроном

##### Есть ли какой-то стейт в памяти, как он обновляется и валидируется?
Нет

#### Отказоустойчивость и масштабируемость
##### Какая нагрузка ожидается?
Около 100 rps в пике, около 10 rps в штатном режиме.

##### Какие фолбеки предусмотрены на сам этот сервис?
Никаких

##### Какие фолбеки предусмотрены внутри этого сервиса на взаимодействие с другими сервисами?
Никаких

##### Какие возможности масштабируемости закладываются?
Возможность сложить задачу в очередь, а не ждать ответа от ручки.

##### Какие точки отказа есть в сервисе?
Все интеграции - точки отказа, так как являются ключевыми.

#### Метрики
##### Укажите ключевые продуктовые метрики сервиса, за которыми планируете следить
- Количество обработанных данных/заявок

##### Укажите технические метрики
- Среднее время обработки заявки
- RPS
- очередь stq

#### Планы роста
##### Какая функциональность ожидается в сервисе в будущем?
Возможность сложить данные в очередь, а не ждать ответа от ручки.

##### Какое изменение нагрузки планируется?
в пределах 250 rps

##### Активно ли будет изменяться сервис?
- [ ] Да

#### Общая информация
##### Менеджер
@ikolbey

##### Релиз (предполагаемая дата)
05.06.2020

##### Язык, на котором пишется сервис
- [ ] C++
- [x] Python3
- [ ] Other

##### Ссылка на тикет, в рамках которого идет разработка
[NAIMBACKEND-361](https://st.yandex-team.ru/NAIMBACKEND-361)

##### Дополнительные согласования


##### Комментарий
Описание: https://wiki.yandex-team.ru/taxi/backend/hiring/services/hiring-data-markup/
