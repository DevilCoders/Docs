## Бизнесовая задача

Старый сервис фидбеков. В отдельном файле в виде исключения, так как много текста

## Архитектура

### API

Новая ручка `GET /2.0/retrieve`:

```json
{
  "order_due": "2020-03-25T14:42:00+0000",
  "order_id": "20b5fa4f71ed1c19b9245d0a8898b300"
}
```
Responce
```json
{
  "feedback": {
    "choices": {
      "rating_reason": [
        "comfort_ride",
        "idealdriver",
        "mood"
      ]
    },
    "rating": 5
  },
}
```

Текущая ручка `POST /1.0/retrieve`:

```json
{
  "from_archive": false,
  "order_due": "2020-03-25T14:42:00+0000",
  "order_id": "20b5fa4f71ed1c19b9245d0a8898b300"
}
```

```json
{
  "app_comment": false,
  "call_me": false,
  "choices": [
    {
      "type": "rating_reason",
      "value": "comfort_ride"
    },
    {
      "type": "rating_reason",
      "value": "idealdriver"
    },
    {
      "type": "rating_reason",
      "value": "mood"
    }
  ],
  "is_after_complete": false,
  "rating": 5
}
```


### 2.0/retrieve
Достает текущий фидбек из своей базы. Немного меняется апи относительно 1.0:
 - из запроса убираем from_archive. Его непонятно как получать в api-proxy и можно обойтись без него. Флаг означает, что если прок уже не в монге, то мы сообщаем об этом сервису и тот в таком случаеи при условии, что не найдет фидбек в своей базе, пойдет за ним в YT. Проще сделать какие-то настроечные конфиги на основе разницы order_due с now для принятия решения, идти ли в YT. 
 - упрощаем ответ, чтобы его можно было сразу добавлять в ответ taxiontheway

#### Fallback
Ничего, не показываем выбранный фидбек.

### Технические детали и ограничения
1. Обсудил с @bznk насчет того, как лучше организовать и получил ответ, что чем меньше запросов, тем лучше.
Поэтому в api-proxy мы ждем от order-core/order-info ответа, проверяем статус и если он не (Pending, Assigned, Driving, Waiting), то только тогда идем за фидбеком. Также от order-info нам нужен due.
2. Кстати, сейчас 1.0/retrieve имеет bad rps 404 в 750 и оk rps в 75. Надо будет заодно это починить.