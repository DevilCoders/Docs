## Опросник для ревью комитетом

> Этот опросник нужен для [архитектурного ревью комитетом](https://forms.yandex-team.ru/surveys/25357/). Его можно будет скопировать.

#### Название сервиса

eats-chatterbox-meta

#### Какую продуктовую проблему решает сервис?

- Когда пользователь пишет в чат поддержки, ML может дать ему автоотписку, в том числе на основе тех данных, которые он получит из этого сервиса.
- Оператору на чатах нужно показать информацию о заказе.

#### Почему нельзя решить эту задачу без разработки нового сервиса существующими решениями?

ML для обращений в чатах - новая функциональность, для которой нет эндпоинтов на получение данных

#### Как именно сервис будет решать поставленные перед ним задачи?

Сервис по запросу будет собирать данные о заказе, жалобах по нему, пользователях из разных эндпоинтов монолита eda-core (с заделом на то, что из монолита эти эндпоинты в будущем переедут в отдельные сервисы), и отдавать агрегированный ответ. По сути это будет сервис-агрегатор данных без хранилищ.

#### Разрабатывается один сервис или система?

Один сервис

#### Сервис внутренний или внешний?

На сервис не будет клиентского трафика. В сервис будет приходить Chatterbox по HTTP

#### С кем взаимодействует сервис?

- Монолит Еды (HTTP):
    - Получение информации о заказе
    - Получение информации о проблемах заказа
    - Получение информации о компенсациях заказа
    - Получение информации об итере
    - Получение информации о сумме заказов итера
    - Получение информации о последнем созданном промокоде для итера
    - Получение информации о последнем созданном промокоде по телефону итера
    - Получение информации о последней компенсации итера

#### Какие базы использует?

Не использует базы данных

#### Какие периодические процессы?

Нет

#### Какая нагрузка ожидается?

До 10 RPS

#### Какие фолбеки предусмотрены на сам этот сервис?

Если сервис откажет, то:
- ML не сможет принять решение об автоотписке и все обращения от пользователя будут обрабатываться вручную операторами
- Операторы в КЦ не увидят некоторую информацию о заказе в тикете чаттербокса (но смогут увидеть в админке Еды)

#### Какие фолбеки предусмотрены внутри этого сервиса на взаимодействие с другими сервисами?

- Если какая-то ручка монолита (в будущем - сервис) откажет, то все данные, которые должны получиться от неё, будут переданы в ML как null. ML сможет принять решение на основе остаточных данных от других сервисов для части запросов к саппорту.

#### Какие возможности масштабируемости закладываются?

Наращивание количества инстансов сервиса при увеличении нагрузки.

#### Какие точки отказа есть в сервисе?

- Потеря сетевой связности с монолитом Еды (пока его хранилища с ручками получения инфы этим сервисом не разнесены в другие сервисы)

#### Укажите ключевые продуктовые метрики сервиса, за которыми планируете следить

- Алертинг на сгенерированные значения `unknown` для enum типов заказов/доставки/оплаты/etc. - признак того, что про ML в чатах забыли, когда разрабатывали новые продукты в Еде.

#### Укажите технические метрики

- Коды ответов API

#### Какая функциональность ожидается в сервисе в будущем?

Возможно, будет добавляться агрегация новых данных, которые нужны для ML.

#### Какое изменение нагрузки планируется?

Пропорционально росту количества заказов в Еде.

#### Активно ли будет изменяться сервис?

Скорее всего нет.

#### Менеджер

[Анна Цыганкова](https://staff.yandex-team.ru/annabarabanna)

#### Релиз

05.10.2020

#### Язык, на котором пишется сервис

C++

#### Ссылка на тикет, в рамках которого идет разработка

https://st.yandex-team.ru/EDADEV-33245

#### Wiki

https://wiki.yandex-team.ru/eda/team/backend/team-eaters/docs/chatterbox-order-meta/
