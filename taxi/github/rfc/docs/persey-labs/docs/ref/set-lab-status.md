# Обновить статус заявки

Ниже перечислены события, при возникновении которых необходимо [обновить статус заявки](#update). 

|Событие | Новый статус заявки     |
| ------------- |--------------|
|  Лаборатория зарегистрировала заявку в своей ЛИС | `registered` |
|  Лаборатория получила биоматериал | `delivered` |
|  Тест выполнен, пациенту сообщен результат | `completed` |
|  Не удалось выполнить тест | `error` |

Эти статусы фиксируются лабораторией; мобильное приложение «Помощь рядом» на них не влияет. Например, если медработник отменил заявку через приложение (не удалось
 связаться с пациентом) — статус заявки все равно останется `registered`. Его необходимо изменить через API — выставить значение `error`.

Статусы заявок, которые медработник отмечает в приложении, необходимы для работы самого приложения. Например, чтобы скрывать отмененные заявки.

## Формат запроса {#update}

Чтобы обновить статус заявки, отправьте запрос:

```http
PUT https://labs-api.yandex.ru/lab/v1/orders/status?id=<идентификатор заявки>

<тело запроса>
```

### Параметры запроса

| Query-параметр | Описание      |
| ------------- |--------------|
|  id  * | **Number**<br/> Идентификатор заявки, полученный от Яндекса. |

*Обязательный параметр.

### Тело запроса
```json
{    
    "status": <'registered' | 'delivered' | 'completed' | 'error'>,
    "internal_id": <номер заявки в ЛИС>,
    "reason": <поясняющий комментарий>
}
```

| Параметр | Описание      |
| ------------- |--------------|
|  status  *  | **Enum(String)**<br/> Новый статус заявки. Допустимые значения: `registered`, `delivered`, `completed`, `error`. <br/>Обратите внимание — если задается статус `registered`, в теле запроса также необходимо передать поле `internal_id`.|
|  internal_id  | **String**<br/> Внутренний номер заявки (который используется в ЛИС).<br/>Указывается, если `status=registered`.|
|  reason    | **String**<br/> Поясняющий комментарий к ошибке.<br/>Опциональное поле. Указывается, если `status=error`.|

*Обязательный параметр.

### HTTP-заголовки

Для доступа к API необходимо передать заголовки:

```http
X-External-Service: <логин лаборатории>
X-External-Api-Key: <API-ключ>
Origin: https://labs-api.yandex.ru
```
Подробнее см. в разделе [Доступ к API](../concepts/authorization.md).

## Формат ответа

В случае успеха сервер возвращает 200 OK.

## Пример
```curl
curl -X PUT 'https://labs-api.yandex.ru/lab/v1/orders/status?id=400123456' \
 -H 'X-External-Service: msk_lab' \
 -H 'X-External-API-Key: Njrgku45vmklf34gffgft44saafvvvqqnrfmgl9h' \
 -H 'Origin: https://labs-api.yandex.ru' \
 -d '{
     "status": "error",
     "reason": "Отсутствует биоматериал"
 }'
```