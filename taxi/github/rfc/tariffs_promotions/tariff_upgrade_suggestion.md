## Задача
Реализовать возможность показывать на клиенте промо блоки с нотификацией о том, 
что можно "поехать чуть дороже, но на более премиальном тарифе" 

## Продуктовые требования

Нужно иметь возможность:
- включать промки по эксперименту 
- настраивать для каких тарифов показывать промку и на какие тарифы она ведет (deeplink внутри промки)
- настраивать процентное отношение между ценами, при котором показываем промку

Требования к самой промо-плашке:
- должна быть возможность кастомизации текста 
- и возможность изменения переходов (deeplink на разные другие тарифы) в зависимости от цен на тарифы

## Промки
Промки - сущности из сервиса promotions, которые могут отображаться на клиенте(бывают разных видов)

Клиент после получения ответа routestats делает запрос в `/4.0/inapp-communications/promos-on-summary`
([проработка promos-on-summary](https://github.yandex-team.ru/taxi/rfc/pull/473))  
`promos-on-summary` внутри себя опрашивает различные источники с промками (сейчас это пока только драйв), 
отправляет их в blender, где промки сортируются по релевантности 

В сервисе promotions есть возможность создавать только статические промки.  
Так же в данный момент происходит создание [кэш компоненты promo_block_cache_component, которая возвращает шаблоны промок](https://github.yandex-team.ru/taxi/rfc/blob/master/promotions/promo_block_cache_component.md)

## Что планируется сделать

Для построения промоблоков "тариф чуть дороже" необходимо иметь информацию о цене.
Чтобы решить эту задачу планируется создать сервис, который будет скрывать за собой базу order_offers.
Это позволит решить нашу проблему, а в дальнейшем можно будет 
перевести все прямые обращения в базу order_offers на походы в этот сервис.
Чтобы наши запросы в сервис базы order_offers не аффектили основной флоу заказа 
планируется поставить rate limiter на ручку, которая производит чтение из базы
Так же планируется, что запросы будут идти только в реплику, без перезапроса в мастер, 
если не нашли offer в реплике (в таком случае промоблок построен не будет).  
(На первом этапе планируется сделать только ручку на чтение)

Также нужно будет создать новый источник промок, который будет опрашиваться из сервиса inapp.  
Источником будет ручка в новом сервисе, т.к. по логике это другие, уже не статические промки (утверждение и rfc нового сервиса будут позже) 

Флоу работы:
- клиент передает в `/4.0/inapp-communications/promos-on-summary` offer_id
- при запросе в наш источник `promos-on-summary` передает offer_id
- по offer_id из нового сервиса с базой offers будут получены цены по тарифам, которые сформировал routestats
- отрабатывает логика "показывать ли промку тарифа чуть дороже" в зависимости от цен
- делается запрос в `promo_block_cache_component`
- шаблоны промок, полученные из компоненты, заполняются инфрмацией 
- в `promos-on-summary` отдаются готовые промки 


## Тайминги:
Планируется, что наша ручка будет дергаться почти каждый раз, когда дергается routestats.

Общий тайминг будет состоять из:
- запрос в сервис за которым будет спрятана база offers
- запрос в `promo_block_cache_component` (т.к. это кэш - ожидается, что будет отрабатывать быстро)
- выполнение самой логики "чуть дороже"(сравнение цен)
- передача запроса\ответа по сети
