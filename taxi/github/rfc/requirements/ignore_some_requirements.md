# Игнорирование неподдерживаемых пожеланий

### Задача
https://st.yandex-team.ru/ITAXI-13108

## Что хочется
Не показывать красные баблы некоторых пожеланий в UI. 

В будущем можем использовать этот механизм для скрытия и доступных пожеланий для конкретных тарифов, если возникнет такая потребность. Для скрытия доступных баблов не в конкретных тарифах, а вообще есть другой механизм:
https://github.yandex-team.ru/taxi/rfc/blob/master/requirements/unsupported_order_popup.md
> Если bubble_available не указан, значит при доступности требования его не отображать

## Сценарий 1
Пользователь выбрал опцию "Перевозка домашнего животного" и перешел в вертикаль доставки. У него показывается красный бабл "Без питомца", но кнопка заказа активна и он может сделать заказ.

# Предложение
Не показывать в этом случае бабл "Без питомца" и игнорировать это пожелание при формировании текста на кнопке ("Заказать без n пожеланий") и попапа. Для этого нужно иметь возможность задать какие пожелания в каких тарифах мы игнорируем (blacklist) или наоборот задать только те пожелания, которые мы не игнорируем для данного тарифа (whitelist).

```
"ignored_requirements": {
	"whitelist": {
		"courier": ["door_to_door"], // Список всех пожеланий, которые мы НЕ игнорируем для данной категории
		"drive": []
	},
	"blacklist": {
		"express": ["ski"] // Список всех пожеланий, которые мы игнорируем для данной категории
	}
}
```
## Важно
В whitelist и blacklist мы не регулируем, какие баблы мы показываем, а какие нет. Мы указываем, на какие пожелания мы в принципе обращаем внимание, а какие игнорируем. После применения whitelist и blacklist у нас остаются какой-то список пожеланий и с ними мы работаем по обычной схеме. Для исключения неоднозначностей, если для одного тарифа задан и whitelist, и blacklist, то сначала применяется whitelist, потом blacklist.

Если у какого-то пожелания есть несколько опций, то если пожелание находится в blacklist/whitelist - это означает, что это применимо ко всем опциям этого пожелания.

Пустой whitelist список означает, что для тарифа игнорируются все пожелания.

## Сценарий 2
Пользователь выбрал какие-то пожелания и перешел в тариф драйва или шатла. Все пожелания показываются в красных баблах, но кнопка заказа доступна.

# Предложение
Не показывать вообще контрол баблов в такой ситуации. Для этого нужно иметь возможность задать, для каких тарифов скрывать контрол баблов.

Для простых тарифов, у которых есть tariff class, будем задавать список tariff_class, для которых хочется только скрывать баблы. 

```
// Классы тарифов, для которых нужно скрывать контрол баблов
"hide_bubbles_control_for_tariff_class": ["econom"]
```
Для полного игнорирования каких-то пожеланий в тариф классах (скрытия баблов, попапов, формирования текста на кнопке) можно воспользоваться ignored_requirements, описанным выше. Для отключения только попапов есть поле "disable_order_popup" в файле unsupported_order_popup.md



Для сложных тарифов задаем отдельный список фильтрации по order_flow. Тут указываются те order_flow, для которых не будут учитываться пожелания в баблах, попапе и тексте кнопки.
```
// Order flow, для которых не нужно учитывать никакие пожелания
"disable_requirements_for_order_flow": ["drive", "shuttle"]
```
