### Шорткат шаттла в органике

## Куда переходим?
  
  Переходим на саммари с выбранным тарифом шаттла.

## Куда кладем шорткат?

  Шорткат в persuggest кладем в отдельный сценарий.

## Как настраиваем отображение на клиентах?

  TODO договориться с блендером о настройках, удовлетворяющих наши пожелания. Пожелания такие:
  всегда показывать шорткат шаттла, если он пришел с бэка persuggest.

## Как показываем тот же шаттл на саммари, который показали в шорткате?

  По аналогии с шорткатом Драйва будем складывать в summary_context информацию, по которой можно
  восстановить то же самое предложение о бронировании.

## Какая работа необходима на бэке?

  1) В ручке /4.0/persuggest/v2/shortcuts идем в ручку матчинга шаттлов сервиса shuttle-control.
     По данным из её ответа собираем шорткат шаттла в отдельном сценарии.

  2) Учим блендер отображать шорткат.

  3) В плагине routestats для шаттла используем summary_context, прокинутый клиентами из
     шортката, чтобы либо передать в ручку матчинга, либо в другую какую-то более
     легковесную ручку. В случае более легковесной достаточно, чтобы она проверяла возможность
     забронировать шаттл и возвращала всё то же самое, что и ручка матчинга
     (eta, время пешком и т.д.)

Пример summary_context из запроса ручки /v1/routestats
```json
{
  "summary_context": {
    "by_classes": [
      {
        "class": "shuttle",
        "payload": {
          "offer_id": "shuttle_offer_id"
        }
      }
    ]
  }
}
```

Перекладываем payload в поле previous_match запроса ручки матчинга
```json
{
  "previous_match": {
    "offer_id": "shuttle_offer_id"
  }
}
```

  4) Либо учимся в ручке матчинга принимать данные из summary_context, либо делаем лёгкую ручку
     для проверки возможности букинга и возвращения всей необходимой для summary информации


## Какая работа необходима на клиенте?

  Предварительно кажется, что подхватывается автоматом


## Что еще нужно?

  Дизайн, иконки, ключи переводов


## Что если на саммари ручка матчинга (или другая ручка) ничего не вернула или сломалась?

  Здесь есть отличие от драйва в том, что мы изначально хотели прятать тариф шаттла, если ни
  один шаттл не сматчился. Получается конфликт: с одной стороны мы хотим спрятать тариф, если
  для пользователя шаттл не нашёлся, а с другой мы хотим НЕ бросать пользователя в пустоту, если
  что-то пошло не так. Можно фоллбэчиться на матчинг других шаттлов, если шаттл из шортката
  по какой-то причине не может быть возвращен на саммари. При этом как-то оповещать
  пользователя.

  Если матчинг других шаттлов тоже ничего не нашел, или произошла ошибка, то опять же не хочется
  кидать пользователя в пустоту. Возможно, в этом случае всё таки стоит вернуть тариф шаттла с
  объяснением в service_levels.tariff_unavailable.
