## Оверлеи от источника

### Продуктовая задача
Сейчас мы умеем добавлять оверлеи к шорткатам Еды и Лавки ([link](https://github.yandex-team.ru/taxi/rfc/blob/master/superapp/shortcuts/shorcuts_customization.md)). Происходит это в сервисе `shortcuts`. Мы хотим научиться получать оверлеи от источника шорткатов.

### Что нужно сделать
Медиашорткаты проходят через следующие сервисы: `promotions` -> `inapp-communications` -> `blender` -> `shortcuts`. Потенциально для решения задачи нужно внести изменения в API каждого из них. Есть 2 варианта:
- [1] - придерживаться по возможности текущего API, передавать информацию об оверлеях в `scenario_params`
- [2] - во всех сервисах добавить поле `overlays` и передавать информацию в нем

Рассмотрим изменения в сервисах подробнее:
- **promotions:**  
    нужно сделать возможным добавление оверлеев в интерфейсе админки (изменения в `POST /admin/promotions/create/`, `GET /admin/promotions/` и `PUT /admin/promotions/{promotion_id}/`), а также изменить API ручки `/internal/promotions/list`, чтобы она возвращала эти оверлеи.
- **inapp-communications:**   
    сервис ходит в `promotions` через кеш-компонент. Необходимо изменить API и начать получать из `promotions` оверлеи, а также возвращать их в ручке  `/4.0/inapp-communications/shortcuts`.
- **blender:**  
    - [1] изменений не потребуется:  
        ручка `/blender/v1/shortcuts-grid` принимает и отдает шорткаты вместе в поле `scenario_params`, схема которого не ограничена (additionalProperties: true). Иконки для шорткатов Такси передаются именно здесь.
    - [2] добавляется поле 'overlays':  
        ручка `/blender/v1/shortcuts-grid` принимает и отдает шорткаты в поле `overlays`. 
- **shortcuts:**  
    нужно будет добавить кастомизацию медиашорткатов на основании 'оверлейных' полей в теле запроса. В качестве примера посмотреть на шорткаты Такси, там от `persuggest`'а приходят poi-иконки.
- **api-proxy:**  
    на данный момент я не вижу, что требуются какие-либо существенные изменения. 
  
#### Аргументы в пользу [1]:
- меньше изменений в API
- возможность добавлять оверлеи ограниченному набору сценариев

#### Аргументы в пользу [2]:
- оверлеи - скорее свойство шортката, а не сценария
- оверлеи разных сценариев могут отличаться по структуре. в случае единого интерфейса с ними будет проще работать

В результате обсуждения был выбран вариант [2]  

### Этапы разработки:
Все изменения можно делать независимо, однако самым безопасным способом будет последовательное изменение каждого из сервисов.
- promotions: 3d 
- inapp-communications: 1-2d
- blender: 0.5-1d
- shortcuts: 1-2d