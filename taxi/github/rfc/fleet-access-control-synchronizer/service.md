### Название сервиса

`fleet-access-control-synchronizer`

### Какую продуктовую проблему решает сервис?

Сервис решает проблему интеграции различных продуктов, закрытых пользовательской авторизацией, в диспетчерскую посредством синхронизации различных сущностей (парков, ролей, пользователей) и их прав доступа.

### Почему нельзя решить эту задачу без разработки нового сервиса существующими решениями?

Требования к надежноси сервиса `dispatcher-access-control`, отвечающий за права доступа пользователей в диспетчерскую, выше, чем к надежности синхронизации, поэтому хочется отделить их друг от друга. 

### Как именно сервис будет решать поставленные перед ним задачи?

Синхронизация парка будет включаться/выключаться ручками `/v1/sync/call_center/park/on` и `/v1/sync/call_center/park/off` соответственно.

Сервис будет использовать СУБД PostgreSQL. Будет создана таблица с данными о синхронизируемых парках:

```
CREATE TABLE fleet-access-control-synchronizer.call_center_synchronization_parks (
    park_id TEXT PRIMARY KEY,
    cc_project_id TEXT NOT NULL,
    cc_lead_id TEXT NOT NULL,
    cc_operator_id TEXT NOT NULL,
    last_synchronized_user_id TEXT,
    last_synchronized_at timestamptz,
    is_active_synchronization BOOLEAN NOT NULL
)
```
Периодически из базы `fleet_users` будут выгружаться пользователи, созданные или отредактированные после последней синхронизации, и данные о них будут отправляться в колл-центр.

### Разрабатывается один сервис или система?

Один сервис.

### Сервис внутренний или внешний?

Внутренний.

### С кем взаимодействует сервис?

`fleet-parks`

`fleet-users`

`dispatcher-access-control`

*Сервисы колл-центра для синхронизации.*

### Какие базы использует?

Новая база postgres `fleet-access-control-synchronizer`

База пользователей `fleet-users` *Нужно указывать, если это через другой сервис происходит?*

### Какие периодические процессы?

На старте планируется процесс синхронизации дисповых пользователей с пользователями колл-центра.

### Планируется обработка персональных данных

Нет

### Какие данные и по какой схеме сервис будет хранить в базе?
```
CREATE TABLE fleet-access-control-synchronizer.call_center_synchronization_parks (
    park_id TEXT PRIMARY KEY,
    cc_project_id TEXT NOT NULL,
    cc_lead_id TEXT NOT NULL,
    cc_operator_id TEXT NOT NULL,
    last_synchronized_user_id TEXT,
    last_synchronized_at timestamptz,
    is_active_synchronization BOOLEAN NOT NULL
)
```

### Какой объем данных будет храниться и какой объем будет изменяться в единицу времени?

1 ГБ, 100 кб/мин

### Какие операции над данными заложены?

CRU

### Есть ли какой-то стейт в памяти, как он обновляется и валидируется?

Нет

### Какая нагрузка ожидается?

0.01 RPS на ручки и таска с периодом 30-120с
### Какие фолбеки предусмотрены на сам этот сервис?

Сервис - точка отказа синхонизации данных с другими системами.

### Какие фолбеки предусмотрены внутри этого сервиса на взаимодействие с другими сервисами?

При недоступности других сервисов синхронизация происходить не будет.

### Какие возможности масштабируемости закладываются?

Сервис можно будет использовать для интеграции в диспетчерскую многих других продуктов при возникновении такой необходимости.

### Какие точки отказа есть в сервисе?

база `fleet-access-control-synchronizer`

### Укажите ключевые продуктовые метрики сервиса, за которыми планируете следить

Количество таксопарков, использующих колл-центр в диспетчерской.

### Укажите технические метрики

Длительность задержки при синхронизации

### Какая функциональность ожидается в сервисе в будущем?

Сервис можно будет использовать для интеграции в диспетчерскую многих других продуктов при возникновении такой необходимости.

### Какое изменение нагрузки планируется?

Прямо пропорционально количеству парков с включенным КЦ.
