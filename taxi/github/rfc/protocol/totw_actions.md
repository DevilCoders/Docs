# Dynamic actions

В рамках переработки экрана мультизаказа такси, хочется добавить мехазм управления карточкой заказа.

## Текущее решение

На данный момент на клиентах такси, захардкожен набор кнопок для каждого состояния заказа.

Имеется решение для отключением некоторых из них, например:
- Кнопка отмены заказа может быть отключена в зависимости от флага `cancel_disabled` в ответе totw.
- Кнопку "Уже выхожу", можно нажать 1 раз, и после этого она больше не показывается.

## Продуктовые требования

1. Возможность менять набор действий в зависимости от статуса заказа

## Предлагаемое решение

Для тестирования и проверки гипотез, предлагается завести клиентский эксперимент `superorders_dynamic_widgets` который будет отдаваться в `taxiontheway` (просьба аналитиков).

### Значение

```
{
    "properties": {  # optional
        "actions": {  # дефолтные свойства экшенов, но как будто они нам сейчас не нужны
            "properties": {
                "cancel": {
                    # properties (idk)
               }
            }
        }
    }
    "statuses": {
        "transporting": {
            "priority": ["actions", "feedback", "tips"],
            "actions": {
                "priority": [["cancel", "help"]],
                "properties": { # optional
                    "cancel": {  # переопределенные свойства экшенов
                        ...
                    }   
                }
            }
        }
    }
}
```

### Описание

В эксперименте будут описаны все статусы заказа.
Каждый статус содержит массив виджетов которые должны использоваться для формирования карточки поездки. Виджеты передаются в отсортированом порядке, и определяют порядок отрисовки их на карточке.

Фолбек: При отсуствии описания какого либо статуса, нужно использовать захардкоженное поведение (хорошо бы его тоже задокументировать).

#### Виджеты

Считается, что шапка виджета не может быть изменена.
Виджет в себе содержит тип. Который определяет его функциональность.

Виджеты могут иметь следующие типы:
`actions`, `feedback`(?), `tips`(?)

##### Action widget

Данный виджет содержит в себе кроме типа, массив объектов, определяющих какого типа экшены и в каком порядке должны следовать.

`action_type` может принимать следующие значения: "driver" | "call" | "chat" | "walk" | "help" | "cancel" | "share" | "options"

Для добавления нового `action_type` - необоходима доработка клиентов. Универсальных действий - не будет.

### На клиентах

Поддержать старое поведение (кнопка "Уже выхожу" и "Отменить" и возможно другие) для передаваемых с бэка кнопок.
