## Список изменений в документации к API

### [Начало работы](https://yandex.ru/dev/taxi/doc/business-api/concepts/quickstart.html)
- ссылку "Укажите информацию о кост-центрах" заменить на новый раздел про Центры затрат

### [Запросы к сервису](https://yandex.ru/dev/taxi/doc/business-api/concepts/request-central.html)
- добавить строку с запросом `POST /1.0/client/{client_id}/cost_centers`
- добавить строку с запросом `GET /1.0/client/{client_id}/cost_centers`
- в строке с запросом `PUT /1.0/client/{client_id}/cost_centers` указать,
  что она принимает только устаревший формат, недоступный для новых клиентов
  (в будущем возможно будет поддержана загрузка и новых ЦЗ через XLS, но это не точно)

### [Детальная информация о клиенте](https://yandex.ru/dev/taxi/doc/business-api/concepts/client-info.html)
- в строке с параметром `cost_centers_file_name` указать, что он является устаревшим
  и добавить ссылку на новый раздел про Центры затрат

### [Создание кост-центров клиента](https://yandex.ru/dev/taxi/doc/business-api/concepts/cost-center-create.html)
- перенести текущее содержимое на страницу с названием `Создание кост-центров клиента в старом формате`
- добавить объяснение, для чего и как используются новые ЦЗ (идеально со скринами из приложения)
- ВАЖНО! на данном этапе удаление кост-центров не поддерживается; их можно переименовать,
  можно поменять их настройки (при этом в реестрах будут уже новые названия полей для старых заказов)
#### Синтаксис запроса
`POST https://business.taxi.yandex.ru/api/1.0/client/{идентификатор клиента}/cost_centers`
#### Заголовки запроса
`Authorization` - аналогично другим запросам. 
#### Описание полей запроса
- `name` (строка): название набора настроек центра затрат
- `default` (boolean): является ли набор настроек основным
  (на одном аккаунте может быть только один основной набор настроек)
- `field_settings` (список объектов): список настроек для каждого поля центров затрат
- `field_settings.[N].title` (строка): человекопонятное название поля (прорастёт в приложение)
- `field_settings.[N].required` (boolean): обязательно ли заполнять это поле при заказе
- `field_settings.[N].hidden` (boolean, необязательное поле):
  не показывать и не использовать это поле при заказе
- `field_settings.[N].services` (список строк): идентификаторы сервисов, в которых
  можно использовать это поле при заказе (на данный момент поддерживается только `taxi`)  
- `field_settings.[N].format` (объект): аналогично полю `cost_centers.format`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
- `field_settings.[N].values` (объект): аналогично полю `cost_centers.values`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
#### Описание полей ответа
- `id` (строка): id набора настроек центра затрат
- `client_id` (строка): id клиента
- `name` (строка): название набора настроек центра затрат
- `default` (boolean): является ли набор настроек основным
- `field_settings` (список объектов): список настроек для каждого поля центров затрат
- `field_settings.[N].id` (строка): id поля
- `field_settings.[N].title` (строка): человекопонятное название поля (прорастёт в приложение)
- `field_settings.[N].required` (boolean): обязательно ли заполнять это поле при заказе
- `field_settings.[N].hidden` (boolean): не показывать и не использовать это поле при заказе
- `field_settings.[N].services` (список строк): идентификаторы сервисов, в которых
  можно использовать это поле при заказе (на данный момент поддерживается только `taxi`)  
- `field_settings.[N].format` (объект): аналогично полю `cost_centers.format`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
- `field_settings.[N].values` (объект): аналогично полю `cost_centers.values`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
#### Пример запроса
```
POST https://business.taxi.yandex.ru/api/1.0/client/a2...d09/cost_centers

Authorization: <OAuth-токен>

{
    "name": "Основной центр затрат",
    "default": true,
    "field_settings": [
         {
           "title": "Центр затрат",
           "required": true,
           "services": ["taxi"],
           "format": "select",
           "values": ["командировка", "в центральный офис"]
         },
         {
           "title": "Цель поездки",
           "services": ["taxi"],
           "required": true,
           "format": "mixed",
           "values": ["цель 1", "цель 2", "особая цель"]
         },
         {
           "title": "Номер дела",
           "hidden": true,
           "services": ["taxi"],
           "required": true,
           "format": "text",
           "values": []
         }
    ]
}
```
#### Пример ответа
```
{
    "id": "1234567890abcdef1234567890abcdef",
    "name": "Основной центр затрат",
    "default": true,
    "field_settings": [
         {
           "id": "0123456789abcdef0123456789abcde0",
           "hidden": false,
           "title": "Центр затрат",
           "required": true,
           "services": ["taxi"],
           "format": "select",
           "values": ["командировка", "в центральный офис"]
         },
         {
           "id": "0123456789abcdef0123456789abcde1",
           "hidden": false,
           "title": "Цель поездки",
           "services": ["taxi"],
           "required": true,
           "format": "mixed",
           "values": ["цель 1", "цель 2", "особая цель"]
         },
         {
           "id": "0123456789abcdef0123456789abcde2",
           "hidden": true,
           "title": "Номер дела",
           "services": ["taxi"],
           "required": true,
           "format": "text",
           "values": []
         }
    ]
}
```
#### Возможные коды ответа
- 200 — запрос выполнен успешно
- 400 — в запросе был передан неизвестный параметр или параметр с недопустимым значением
- 401 — был передан неверный OAuth-токен
- 403 — у клиента не хватает прав на выполнение данного запроса

### Список настроек кост-центров (новая страница):
#### Синтаксис запроса
`GET https://business.taxi.yandex.ru/api/1.0/client/{идентификатор клиента}/cost_centers`
#### Заголовки запроса
`Authorization` - аналогично другим запросам. 
#### Описание полей ответа
- `items` (массив): список наборов настроек центров затрат
- `id` (строка): id набора настроек центра затрат
- `client_id` (строка): id клиента
- `name` (строка): название набора настроек центра затрат
- `default` (boolean): является ли набор настроек основным
- `field_settings` (список объектов): список настроек для каждого поля центров затрат
- `field_settings.[N].id` (строка): id поля
- `field_settings.[N].title` (строка): человекопонятное название поля
- `field_settings.[N].required` (boolean): обязательно ли заполнять это поле при заказе
- `field_settings.[N].hidden` (boolean): не показывать и не использовать это поле при заказе
- `field_settings.[N].services` (список строк): идентификаторы сервисов, в которых
  можно использовать это поле при заказе (на данный момент поддерживается только `taxi`)  
- `field_settings.[N].format` (объект): аналогично полю `cost_centers.format`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
- `field_settings.[N].values` (объект): аналогично полю `cost_centers.values`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
#### Пример запроса
```
GET https://business.taxi.yandex.ru/api/1.0/client/a2...d09/cost_centers

Authorization: <OAuth-токен>
```
#### Пример ответа
```
{
    "items": [
        {
            "id": "1234567890abcdef1234567890abcdef",
            "name": "Основной центр затрат",
            "default": true,
            "field_settings": [
                 {
                   "id": "0123456789abcdef0123456789abcde0",
                   "hidden": false,
                   "title": "Центр затрат",
                   "required": true,
                   "services": ["taxi"],
                   "format": "select",
                   "values": ["командировка", "в центральный офис"]
                 },
                 {
                   "id": "0123456789abcdef0123456789abcde1",
                   "hidden": false,
                   "title": "Цель поездки",
                   "services": ["taxi"],
                   "required": true,
                   "format": "mixed",
                   "values": ["цель 1", "цель 2", "особая цель"]
                 },
                 {
                   "id": "0123456789abcdef0123456789abcde2",
                   "hidden": true,
                   "title": "Номер дела",
                   "services": ["taxi"],
                   "required": true,
                   "format": "text",
                   "values": []
                 }
            ]
        }
    ]
}
```
#### Возможные коды ответа
- 200 — запрос выполнен успешно
- 401 — был передан неверный OAuth-токен
- 403 — у клиента не хватает прав на выполнение данного запроса

### Редактирование настроек кост-центров (новая страница)

(аналогично странице "Создание кост-центров клиента", разница в том, что
для редактирования передаётся id редактируемого набора настроек ЦЗ)
#### Синтаксис запроса
`POST https://business.taxi.yandex.ru/api/1.0/client/{идентификатор клиента}/cost_centers`
#### Заголовки запроса
`Authorization` - аналогично другим запросам. 
#### Описание полей запроса
- `id` (строка): id набора настроек центра затрат
- `name` (строка): название набора настроек центра затрат
- `default` (boolean): является ли набор настроек основным
  (на одном аккаунте может быть только один основной набор настроек)
- `field_settings` (список объектов): список настроек для каждого поля центров затрат
- `field_settings.[N].id` (строка, необязательное поле): id поля
  (для существующих полей берётся из запроса списка настроек центров затрат,
  для новых полей можно не указывать, будет сгенерирован автоматически)
- `field_settings.[N].title` (строка): человекопонятное название поля (прорастёт в приложение)
- `field_settings.[N].required` (boolean): обязательно ли заполнять это поле при заказе
- `field_settings.[N].hidden` (boolean, необязательное поле):
  не показывать и не использовать это поле при заказе
- `field_settings.[N].services` (список строк): идентификаторы сервисов, в которых
  можно использовать это поле при заказе (на данный момент поддерживается только `taxi`)  
- `field_settings.[N].format` (объект): аналогично полю `cost_centers.format`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
- `field_settings.[N].values` (объект): аналогично полю `cost_centers.values`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
#### Описание полей ответа
- `id` (строка): id набора настроек центра затрат
- `client_id` (строка): id клиента
- `name` (строка): название набора настроек центра затрат
- `default` (boolean): является ли набор настроек основным
- `field_settings` (список объектов): список настроек для каждого поля центров затрат
- `field_settings.[N].id` (строка): id поля
- `field_settings.[N].title` (строка): человекопонятное название поля
- `field_settings.[N].required` (boolean): обязательно ли заполнять это поле при заказе
- `field_settings.[N].hidden` (boolean): не показывать и не использовать это поле при заказе
- `field_settings.[N].services` (список строк): идентификаторы сервисов, в которых
  можно использовать это поле при заказе (на данный момент поддерживается только `taxi`)  
- `field_settings.[N].format` (объект): аналогично полю `cost_centers.format`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
- `field_settings.[N].values` (объект): аналогично полю `cost_centers.values`
  при создании пользователя (см. на странице
  https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
#### Пример запроса
```
POST https://business.taxi.yandex.ru/api/1.0/client/a2...d09/cost_centers

Authorization: <OAuth-токен>

{
    "id": "1234567890abcdef1234567890abcdef",
    "name": "Основной центр затрат",
    "default": true,
    "field_settings": [
         {
           "id": "0123456789abcdef0123456789abcde0",
           "hidden": false,
           "title": "Центр затрат",
           "required": true,
           "services": ["taxi"],
           "format": "select",
           "values": ["командировка", "в центральный офис"]
         },
         {
           "id": "0123456789abcdef0123456789abcde1",
           "hidden": false,
           "title": "Цель поездки",
           "services": ["taxi"],
           "required": true,
           "format": "mixed",
           "values": ["цель 1", "цель 2", "особая цель"]
         },
         {
           "id": "0123456789abcdef0123456789abcde2",
           "hidden": true,
           "title": "Номер дела",
           "services": ["taxi"],
           "required": true,
           "format": "text",
           "values": []
         }
    ]
}
```
#### Пример ответа
```
{
    "id": "1234567890abcdef1234567890abcdef",
    "name": "Основной центр затрат",
    "default": true,
    "field_settings": [
         {
           "id": "0123456789abcdef0123456789abcde0",
           "hidden": false,
           "title": "Центр затрат",
           "required": true,
           "services": ["taxi"],
           "format": "select",
           "values": ["командировка", "в центральный офис"]
         },
         {
           "id": "0123456789abcdef0123456789abcde1",
           "hidden": false,
           "title": "Цель поездки",
           "services": ["taxi"],
           "required": true,
           "format": "mixed",
           "values": ["цель 1", "цель 2", "особая цель"]
         },
         {
           "id": "0123456789abcdef0123456789abcde2",
           "hidden": true,
           "title": "Номер дела",
           "services": ["taxi"],
           "required": true,
           "format": "text",
           "values": []
         }
    ]
}
```
#### Возможные коды ответа
- 200 — запрос выполнен успешно
- 400 — в запросе был передан неизвестный параметр или параметр с недопустимым значением
- 401 — был передан неверный OAuth-токен
- 403 — у клиента не хватает прав на выполнение данного запроса
- 404 — не существует набора настроек с указанным id


### [Список заказов](https://yandex.ru/dev/taxi/doc/business-api/concepts/order-list.html)
В таблице "Описание полей ответа" добавить строчки:
- `cost_centers` (массив объектов): новые поля центров затрат
- `cost_centers.[N].id` (строка): id поля ЦЗ
- `cost_centers.[N].title` (строка): название поля ЦЗ
- `cost_centers.[N].value` (строка): значение поля ЦЗ, присланное при создании заказа
  либо изменённое после создания заказа (через приложение или кабинет)

В разделе "Пример ответа" рядом с полем `cost_center` добавить поле:
```
    "cost_centers": [
        {
            "id": "cost_center",
            "title": "Центр затрат",
            "value": "командировка"
        },
        {
            "id": "0123456789abcdef0123456789abcde1",
            "name": "Цель поездки",
            "value": "особая цель"
        }
    ],
```

### [Создание черновика нового заказа](https://yandex.ru/dev/taxi/doc/business-api/concepts/order-create.html)
В таблице раздела "Синтаксис запроса" добавить строчки:
- `cost_center_values` (массив объектов): новые поля центров затрат
- `cost_center_values.[N].id` (строка): id поля ЦЗ
- `cost_center_values.[N].title` (строка): название поля ЦЗ
- `cost_center_values.[N].value` (строка): значение поля ЦЗ для данного заказа

В разделе "Пример запроса" (вкладка "Создание заказа на вызов такси")
  рядом с полем `cost_center` добавить поле:
```
    "cost_center_values": [
        {
            "id": "cost_center",
            "title": "Центр затрат",
            "value": "командировка"
        },
        {
            "id": "0123456789abcdef0123456789abcde1",
            "name": "Цель поездки",
            "value": "особая цель"
        }
    ],
```

В разделе "Возможные коды ответа" добавить следующие коды:
- `406 EMPTY_CORP_PAYMENTMETHODS` - отсутствуют активные способы корп.оплаты
  для указанного пользователя
- `406 GENERAL` - ошибка при проверке возможности сделать заказ, точная причина
  указана в теле ответа в поле `message`
- `406 GENERAL` с причиной `Cannot create order` - временная техническая ошибка

### [Изменить данные черновика заказа](https://yandex.ru/dev/taxi/doc/business-api/concepts/order-change.html)
(Изменения почти аналогичны изменениям на странице про создание черновика).

В таблице раздела "Синтаксис запроса" добавить строчки:
- `cost_center_values` (массив объектов): новые поля центров затрат
- `cost_center_values.[N].id` (строка): id поля ЦЗ
- `cost_center_values.[N].title` (строка): название поля ЦЗ
- `cost_center_values.[N].value` (строка): новое значение поля ЦЗ для данного заказа

В разделе "Пример запроса" рядом с полем `cost_center` добавить поле:
```
    "cost_center_values": [
        {
            "id": "cost_center",
            "title": "Центр затрат",
            "value": "командировка"
        },
        {
            "id": "0123456789abcdef0123456789abcde1",
            "name": "Цель поездки",
            "value": "особая цель"
        }
    ],
```

В разделе "Возможные коды ответа" добавить следующие коды:
- `406 GENERAL` - ошибка при проверке изменений центров затрат, точная причина
  указана в теле ответа в поле `message`

### [Детальная информация о заказе](https://yandex.ru/dev/taxi/doc/business-api/concepts/order-info.html)
(Изменения аналогичны изменениям на странице про список заказов).

В таблице "Описание полей ответа" добавить строчки:
- `cost_centers` (массив объектов): новые поля центров затрат
- `cost_centers.[N].id` (строка): id поля ЦЗ
- `cost_centers.[N].title` (строка): название поля ЦЗ
- `cost_centers.[N].value` (строка): значение поля ЦЗ, присланное при создании заказа
  либо изменённое после создания заказа (через приложение или кабинет)

В разделе "Пример ответа" рядом с полем `cost_center` добавить поле:
```
    "cost_centers": [
        {
            "id": "cost_center",
            "title": "Центр затрат",
            "value": "командировка"
        },
        {
            "id": "0123456789abcdef0123456789abcde1",
            "name": "Цель поездки",
            "value": "особая цель"
        }
    ],
```

### [Список пользователей клиента](https://yandex.ru/dev/taxi/doc/business-api/concepts/user-list.html)
В таблице "Описание полей ответа":
- в строке про поле `cost_center` заменить ссылку на страницу про старый формат центров затрат 
- добавить строчку с полем `cost_centers_id` (строка, необязательное поле):
  id набора настроек центров затрат (при наличии у клиента новых центров затрат)
  (и ссылка на документацию про запрос "Список настроек кост-центров")

В разделе "Пример ответа" рядом с полем `cost_center` добавить поле:
```
    "cost_centers_id": "123...fef", 
```

### [Создание нового пользователя](https://yandex.ru/dev/taxi/doc/business-api/concepts/user-create.html)
В таблице полей в разделе "Синтаксис запроса":
- в строке про поле `cost_center` заменить ссылку на страницу про старый формат центров затрат 
- в строке про поле `cost_centers` добавить примечание, что это устаревшее поле
  и что при наличии новых центров затрат у клиента присылать его уже не нужно
- добавить строчку с полем `cost_centers_id` (строка, необязательное поле):
  id набора настроек центров затрат (при наличии у клиента новых центров затрат)
  (и ссылка на документацию про запрос "Список настроек кост-центров");
  если это поле не прислать, то пользователю будет назначен основной центр затрат
  (при наличии у клиента новых центров затрат)

В разделе "Примеры запросов" рядом с полем `cost_center` добавить поле:
```
    "cost_centers_id": "123...fef", 
```

### [Детальная информация о пользователе](https://yandex.ru/dev/taxi/doc/business-api/concepts/user-info.html)
(Изменения аналогичны изменениям на странице про список пользователей).

В таблице "Описание полей ответа":
- в строке про поле `cost_center` заменить ссылку на страницу про старый формат центров затрат 
- добавить строчку с полем `cost_centers_id` (строка, необязательное поле):
  id набора настроек центров затрат (при наличии у клиента новых центров затрат)
  (и ссылка на документацию про запрос "Список настроек кост-центров")

В разделе "Пример ответа" рядом с полем `cost_center` добавить поле:
```
    "cost_centers_id": "123...fef", 
```

### [Обновление данных пользователя](https://yandex.ru/dev/taxi/doc/business-api/concepts/user-update.html)
(Изменения аналогичны изменениям на странице про создание пользователя).

В таблице полей в разделе "Синтаксис запроса":
- в строке про поле `cost_center` заменить ссылку на страницу про старый формат центров затрат 
- в строке про поле `cost_centers` добавить примечание, что это устаревшее поле
  и что при наличии новых центров затрат у клиента присылать его уже не нужно
- добавить строчку с полем `cost_centers_id` (строка, необязательное поле):
  id набора настроек центров затрат (при наличии у клиента новых центров затрат)
  (и ссылка на документацию про запрос "Список настроек кост-центров");
  если это поле не прислать, то пользователю будет назначен основной центр затрат
  (при наличии у клиента новых центров затрат)

В разделе "Примеры запросов" рядом с полем `cost_center` добавить поле:
```
    "cost_centers_id": "123...fef", 
```
