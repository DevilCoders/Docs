# antifake_cancels_rules.json
Конфиг для настройки блокировок за водительские/все отмены в зонах/странах. Логика следующая:
1) Есть 2 возможных воздействия: 'block_cash' (блокируем заказы за наличные, явно пишем про это в сообщении, в безналичных заказах включаем прехолд) и 'block_all' (блокирукм все заказы, кроме корпоративных).
2) Есть 4 "уровня тревоги", каждому из которых соответствует определенное количество водительских/всех отмен у пользователя. В соответствии с количеством отмен у пользователя за сутки ему присваивается уровень подозрительности от 0 до 4.
3) Есть дополнительные факторы, увеличивающие "подозрительность" заказа - платформа (например, веб), новичковость пользователя и т.п. Наличие такого фактора добавляет 1 к общей подозрительности пользователя.
4) В соответствии с "подозрительностью" и настройками для геозоны/страны/дефолтными (в порядке приоритета) на пользователе может сработать одно из воздействий из п.1.

Формат записи:
```json
{
    "key": "Строка", // Страна (на английском, в соответствии с геоиерархией), геозона или _total_
    "block_cash": X, // Число от 0 до 4, соответствует необходимому конфигу из caution_levels
    "block_all": X, // Число от 0 до 4, соответствует необходимому конфигу из caution_levels
    "issue": "ISSUE-1234", // Тикет, в котором обосновывается установка такого значения
    "ttl": "yyyy-mm-dd", // Дата, после которой настройки необходимо проверить / откатить
    "login": "some-login" // Автор изменения
}
```

Часть строк может отсутствовать, особенно для старых записей.

# blacklisted_id.json

Конфиг для блокировки различных ID пользователей. Доступные ID:
* user_agent
* user_device_id
* user_metrica_device_id
* user_personal_phone_id
* user_uid

Формат записи:

```json
{
    "added": "yyyy-mm-dd", // Дата добавления в блеклист
    "block_all": false, // Если true, блокируем все заказы, несмотря на способ оплаты, приложение и пр.
    "block_callcenter": false, // Если true, блокируем все заказы через КЦ
    "block_orders_as_extra_user": false, // Если true, блокируем все заказы для другого с этим ID в extra_user_id
    "block_orders_to_extra_user": false, // Если true, блокируем все заказы для другого от этого ID
    "block_web": false, // Если true, блокируем все заказы с веба
    "comment": "Тестовая запись со всеми ключами", // Краткое описание причины добавления в блеклист
    "issue": "TAXISECTEAM-7956", // Тикет с обоснованием
    "key": "00000000000000000000000000000000", // Идентификатор
    "ttl": "yyyy-mm-dd", // Дата, после которой ID можно убрать из блеклиста (2999-12-31, если блокировка перманентная)
    "login": "some-login" // Логин автора изменения
}
```

Если какая-то из блокировок не требуется, можно опустить строчку.

# cashrunners_fp.json

Конфиги для снятия ошибочно наложенных санкций за кешраны. Доступные ID:
* device_id
* user_phone_pd_id

Формат записи:
```json
{
    "00000000000000000000000000000000": { // Ключ
        "added": "yyyy-mm-dd", // Дата добавления в вайтлист
        "comment": "Тестовая запись со всеми ключами", // Краткое описание причины добавления в вайтлист
        "issue": "TAXISECTEAM-7956", // Тикет с обоснованием
        "ttl": "yyyy-mm-dd", // Дата, после которой ID можно убрать из блеклиста (2999-12-31, если нахождение в вайтлисте перманентное)
    }
}
```

# taxi_order_params.json

Конфиги, в которых задаются признаки для различных параметров заказов (на момент последнего обновления раздела - способ оплаты и приложение).
В конфигах указываются различные свойства для указанных признаков заказа.

Формат записи (приложение):
```json
{
    "added": "yyyy-mm-dd", // Дата первого появления в продакшн заказах или добавления в конфиг
    "comment": "Короткое описание", // Описание приложения (например, "Турбоапп Yango")
    "is_callcenter": false, // Является ли приложение признаком заказа через коллцентр
    "is_corp": false, // Является ли приложение признаком заказа через корпоративный кабинет / api
    "is_technical": true, // Является ли приложение "техническим" (например, тестирование нового функционала), необходимо ли его игнорировать в блокирующих санкциях
    "is_web": true, // Является ли приложение "вебом" (в широком смысле - для таких приложений характерно отсутствие большого количества идентификаторов, таких как девайс и корректный ip-адрес)
    "key": "приложение" // Идентификатор (например, web_turboapp_taxi)
}
```

Формат записи (способ оплаты):
```json
{
    "added": "yyyy-mm-dd", // Дата первого появления в продакшн заказах или добавления в конфиг
    "comment": "Короткое описание", // Описание приложения (например, "Оплата через Систему быстрых платежей")
    "key": "способ оплаты", // Идентификатор (например, sbp)
    "is_cash": false, // Является ли способ оплаты наличным (у нас нет информации о транзакциях)
    "is_card": false, // Является ли способ оплаты безналичным (у нас есть информация о транзакциях, которые идут между водителем и пассажиром)
    "is_corp": true // Является ли способ оплаты корпоративным (у нас есть информация о транзакциях, корпоративный клиент)
}
```

# whitelisted_id.json

Конфиг для добавления в вайтлист ID пользователей. Доступные ID:
* user_device_id
* user_metrica_device_id
* user_personal_phone_id
* user_uid

Формат записи:

```json
{
    "added": "yyyy-mm-dd", // Дата добавления в вайтлист
    "comment": "Тестовая запись со всеми ключами", // Краткое описание причины добавления в вайтлист
    "issue": "TAXISECTEAM-7956", // Тикет с обоснованием
    "key": "00000000000000000000000000000000", // Идентификатор
    "ttl": "yyyy-mm-dd", // Дата, после которой ID можно убрать из вайтлиста (2999-12-31, если нахождение в вайтлисте перманентное)
    "login": "some-login" // Логин автора изменения
}
```
