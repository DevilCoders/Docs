## CLI

### Установка

```bash
npm link
```

### Использование

*   Вывести справку по доступным командам
    ```bash
    falcon -h
    ```
    
*   Примеры использования:

    ```bash
    # скомпилировать исходный typesript код в javascript и собрать бандлы
    falcon compile
    
    # запустить тесты
    falcon test
    falcon test -p src/service/helper/delay
    
    # запустить проект
    falcon dev
    ```

*   Можно использовать и без `npm link`, например:

    ```bash
    ./cli.js some command
    ```
    
    Но в этом случае не забудьте сделать `npm ci`.

*   Большая часть команд внутри себя вызывает другие программы, например, `falcon webpack` вызывает `node_modules/.bin/webpack`. Наши команды имеют свой собственный набор параметров и при этом  они не проксируют переданные параметры в вызываемые внутри программы. Например, `falcon start` запускает приложение, но вызов `falcon start --inpect` не включит debug режим у приложения – параметра `--inspect` нет у команды `falcon start` и наш CLI выдаст ошибку. 
    
    Однако, иногда требуется передать дополнительные параметры в вызываемую программу внутри команды и хочется сделать это без модификации кода команады. В этом случае вы можете передать необходимые параметры после `--`, например:

    ```bash
    falcon start -- --inspect
    ```
    
    Здесь `--` последовательность «double dash» означает конец передаваемых параметров в команду и всё указанное после может быть переданно командой в вызываемую программу внутри. В примере выше команда `falcon start` вызывает внутри себя `node` и передает ей всё указанное после `--`, то есть `--inspect`.

    Обратите внимание, что возможность передать параметры таким образом есть только в тех командах которые явно поддерживают такое поведение. Команда `falcon dev`, к примеру, просто игнорирует всё переданое после `--`, так как она запускает несколько разных фоновых процессов и нет никакой возможности понять куда именно стоит передать указанные таким образом параметры.
    
### Для разработчика

*   Исходный код команд расположен в папке `src/cli/`.

*   Файл команды должен быть с суффиксом `-command`, например: `src/cli/example-command.ts`.

*   Команда может быть запущена из TypeScript исходного кода, или из скомпилированного JavaScript кода.
    По умолчанию используется скомпилированный JS код.
    Чтобы запустить команду из исходного TS кода, нужно включить опцию в `cli.config.json`:

    ```json
    {
        "useSources": true
    }
    ```

*   [Пример команды](/src/cli/example-command.ts)

*   О других возможностях `usage`:
    *   [ts-command-line-args](https://github.com/Roaders/ts-command-line-args#usage-guide)
    *   [command-line-args](https://github.com/75lb/command-line-args#synopsis)

*   При выполнении команды доступен глобальный метод [cliRuntime()](/@types/cli.d.ts)

*   Команда строится исходя из ее расположения:

    ```bash
    falcon foo baz bar run
    # вызовет файл "src/cli/foo/baz/bar/run-command.ts"
    ```
