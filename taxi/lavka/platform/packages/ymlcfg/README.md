# Конфиг проекта

Некоторые вещи, вроде доступов к БД, состояния включенности частей проекта
хорошо оформлять в виде конфига проекта.

Структура проекта включает в себя нечто такое:

```txt
config/
      |- main.yml
      |- other.config.yml
      +- host-abc.yml
      +- host-cde.yml
      +- host-def.yml

```

Данный модуль просматривает установленную директорию, находит в ней `main.yml`,
принимает его за базисный конфиг-файл.

Затем применяется конфиг `host-$hostname.yml`, где `$hostname` - это текущее имя
хоста.

Это имя может быть взято (в порядке приоритета) 

- из переменной окружения `$CONFIGNAME`
- из переменной окружения `$HOSTNAME`
- из имени хоста

Информация из дополнительных конфигов замещает информацию в базисном.

Важно:

Дополнительные конфиги не могут определять новые секции, а только переопределять.

## Формат конфиг файла

Используется YAML. При этом файл может ссылаться на переменные окружения:

```yaml
# main.yml
db:
    pg:
        host: env:PG_HOST
        port: env:PG_PORT:5432
        user: env:PG_USER
        password: env:PG_PASSWORD
        database: env:PG_DB
```


Если положить файл, который частично переназначает те же переменные, то
итоговый конфиг будет переназначен.

Например:

```yaml
# host.yml
db:
    pg:
        host: 127.0.0.1
        port: 5432
```

Итого конфиг будет таким:


```yaml
db:
    pg:
        host: 127.0.0.1
        port: 5432
        user: env:PG_USER
        password: env:PG_PASSWORD
        database: env:PG_DB
```

Как видим две переменные переопределились.

Это можно использовать для разработки (разработчик может указать доступы к его тестовой
локальной БД), а так же для различающихся небольшими отличиями бакендов.


Конфиги с именем `host-<name>.yml` всегда исключаются из обработки и один из них, `<name>`
которого совпадает с `hostname` компьютера на котором он запущен будет обрабатываться
последним.


## API

```
from ymlcfg import cfg

host = cfg('db.pg.host')
port = cfg('db.pg.port')
```


`cfg` - всегда смотрит в текущую директорию в каталог `./config`
