## Новая BDU история заказов

Задача:

В сервисе `eats-orders-info`, сервисе истории по заказу, есть ручка `api/v1/orders`. Эта ручка отдает по запросу историю
заказов, состоящую из ответа коры, лавки и дополнительной информации по заказам (по пожертвованиям, по фидбекам).
Предлагается ввести новую ручку `/eats/v1/orders-info/v1/orders` с таким же функционалом, но реализованную с помощью
подхода BDU (Backend-Driven UI).

Входные значения: параметры для первого получения - `limit` - квери параметр, задающий размер батча для выборки заказов
с ручки; `offset` - количественный отступ для пропуска первой части заказов; параметры для обновления текущих данных

- `order_nrs` - массив номеров активных заказов, которых необходимо обновлять; общий параметр - `items_limit` -
  количество отображаемых позиций товаров.

Выходное значение: информация по истории заказов для итера, оформленная в виджеты.

**Цель**: сделать ручку, похожую на `api/v1/orders`, в стиле BDU - `/eats/v1/orders-info/v1/orders`, а также ручку для
обновления активных заказов `/eats/v1/orders-info/v1/refresh-orders`. Макет
фичи: [ссылка](https://h.yandex-team.ru/?https%3A%2F%2Fwww.figma.com%2Ffile%2FVzARvVqSDJdP1s1sprD6qq%2FИстория-заказов%3Fnode-id%3D3231%253A41683)
.

Описание особенностей новых ручек:

1. Раньше ручка истории заказов выдавала объемную информацию по заказам, теперь только информацию, необходимую для
   экрана
2. Отрисовка экранов должна следовать логике: нет виджета = не нужно его отрисовывать, иначе отрисовать
3. Кликнув по разным частям раскрытого заказа теперь можно будет: перейти в экран одного заказа, в трекинг или оставить
   оценку с переходом в список с предефами.
4. Ручка `/eats/v1/orders-info/v1/orders` будет указывать период для обновления истории по активным заказам (в данный
   момент времени присутствующих на экране) с помощью `/eats/v1/orders-info/v1/refresh-orders`. Первая ручка будет
   отдавать весь список, а вторая только те, что были переданы в массиве order_nr.

Логика взаимодействия фронта с бэком следующая:

1. Сначала идет поход в ручку `/eats/v1/orders-info/v1/orders`. Будут отданы заказы, полученные в соответствии
   с `cursor` и `limit`, если не пришли, то будут отданы по дефолтным значениям.
2. Если в ответе с бэка (с любой ручки) пришел `update_settings`, то фронту нужно обратиться по
   ручке `/eats/v1/orders-info/v1/refresh-orders` и передать в теле запроса массив `order_nrs_to_update`
   через `update_period_ms`.

Схема АПИ в формате `yaml` приложена в `bdu_orders_handle/api.yaml`. Пример отдаваемого на фронт `json`:

```yaml
{
  "pagination": { // обязательное поле (нет в ответе /refresh-orders), объект с настройками пагинации для ручки истории заказов
    "cursor": "123", //обязательное поле, курсор считанных данных, фронту нужно просто возвращать на бэк
    "has_more": true, // обязательное поле, равно false, если получены все заказы, иначе true
  },
  "update_settings": { // необязательное поле, настройки для обновления активных заказов, если они есть
    "order_nrs_to_update": [ "211111-123456" ], // обязательное поле, массив номеров активных заказов, которые нужно обновить, массив нужно возвращать на бэк
    "update_period_ms": "15000" // обязательное поле, величина периода обновления истории заказов в милисекундах
  }
    "orders": [ // обязательное поле
      {
        "order_nr": "211111-123456",
        "widgets": { //обязательное поле, все виджеты необязательны
          "general": { // необязательное поле
            "deeplink": "eda.yandex://order_history?orderNr=211111-123456", // обязательное поле, ссылка на экран детальной истории заказа
            "name": "Пицца Рим", // обязательное поле, по макету - имя плейса
            "place_image_url_pattern": "http://eda.yandex/asdasdzxc-{w}x{h}.jpg", // необязательное поле, шаблон-ссылка картинки для ресайза
            "date": "23 июля 16:10", // обязательное поле, форматированная строка по таймзоне заказа
            "currency": { // обязательное поле, структура-стандарт с валютой
              "code": "RUB", // обязательное поле, код валюты
              "sign": "₽", // обязательное поле, символ валюты
              "template": "$VALUE$ $SIGN$$CURRENCY$", // обязательное поле, шаблон заполнения поля стоимости
              "text": "руб.", // обязательное поле, краткое описание валюты без спецсимволов
            },
            "cost_value": "1049", // необязательное поле, величина полной актуальной стоимости заказа в отформатированном формате
            "cost_fallback_text": { // обязательное поле, объект ColoredText
              "text": "Стоимость обновляется", // обязательное поле, фоллбек-строка на случай, если не пришло cost_value
              "color": [
                {
                  "theme": "light", // обязательное поле
                  "value": "#000000" // обязательное поле
                },
                {
                  "theme": "dark",
                  "value": "#ffffff"
                }
              ]
            },
            "status": { // обязательное поле, объект ColoredText
              "text": "Готовится", // обязательное поле
              "color": [
                {
                  "theme": "light", // обязательное поле
                  "value": "#000000" // обязательное поле
                },
                {
                  "theme": "dark",
                  "value": "#ffffff"
                }
              ]
            }
          },
          "goods": { //необязательное поле
            "items": [ //обязательное поле
              {
                "title": "Огурчики", // обязательное поле, имя позиции
                "image_url_pattern": "http://eda.yandex/asdasdzxc-{w}x{h}.jpg", // обязательное поле, шаблон-ссылка картинки для ресайза
              }
            ],
            "total_items_number": "20", // обязательное поле, общее количество позиций
          },
          "tracking": { // необязательное поле
            "deeplink": "eda.yandex://tracking", // обязательное поле, диплинк, куда ведет сабтайтл
            "title": "Доставка к 16:30", // необязательное поле
            "subtitle": "Перейти к заказу", // обязательное поле, фронту нужно в конец последнец строки добавить шеврон
            "icons": [ // обязательное поле, объект IconTemplate из eats-orders-tracking, только без show_eta и show_animation
              {
                "uri": "http://eda.yandex/asdasdzxc", // обязательное поле
                "status": "pending" //обязательное поле, объект IconStatus, возможные статусы - pending, in_progress, finished, failed
              }
            ]
          },
          "feedback": { // необязательное поле
            "deeplink": "eda.yandex://feedback/{order_nr}", // обязательное поле, ссылка на экран для отзыва
            "title": "Как вам заказ?", // обязательное поле
            "icons": { // обязательное поле, иконки под разные стили
              "icons_selected": [ //обязательное поле, иконка для заполненной части оценки
                {
                  "theme": "light", // обязательное поле
                  "icon": "https://eda.yandex/feedback-icon-light-on" // обязательное поле
                },
                {
                  "theme": "dark", // обязательное поле
                  "icon": "https://eda.yandex/feedback-icon-light-on" // обязательное поле
                }
              ],
              "icons_unselected": [ //обязательное поле, иконка для незаполненной части оценки
                {
                  "theme": "light", // обязательное поле
                  "icon": "https://eda.yandex/feedback-icon-light-off" // обязательное поле
                },
                {
                  "theme": "dark", // обязательное поле
                  "icon": "https://eda.yandex/feedback-icon-light-off" // обязательное поле
                }
              ]
            }
          }
        }
      }
    ]
}
```