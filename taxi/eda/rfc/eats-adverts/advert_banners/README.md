# Рекламные баннеры

Рекламный баннер - баннер, который заводится на ресторан или бренд, с целью
наливания трафика в этот ресторан (ресторан бренда).

Тикеты:

- https://st.yandex-team.ru/EDACAT-2293
- https://st.yandex-team.ru/EDACAT-2294
- https://st.yandex-team.ru/EDACAT-2295
- https://st.yandex-team.ru/EDACAT-2296

## Как это работает сейчас

Коммерческий департамент заключает продажу, после чего создает баннер в админке
в разделе
[Еда.Клиенты коммуникации/Коммуникации в приложении](https://tariff-editor.taxi.yandex-team.ru/eats-communications/inapp).

Далее ID созданного баннера добавляет в widget_template
[BANNER_ADS](https://tariff-editor.taxi.yandex-team.ru/layout-constructor/widget-templates/edit/14).

Когда пользователь запрашивает главную, сервис eats-layout-constructor делает
запрос к сервису eats-communications за баннерами и из полученных баннеров
оставляет в рекламном блоке только те, чьи ID менеджер из коммерческого
департамента указал в BANNER_ADS.

## Проблемы существующего подхода

1. Ручное создание баннера, эксперимента под него, внесение баннера в widget
   template. Это очень error-prone подход.
2. Рекламный баннер может "пролезть" в нерекламный блок в случае ошибки в
   настройке layout-а.
3. Рекламные баннеры и все остальные баннеры логически не должны пересекаться.

## Как хотим сделать

### Научимся помечать баннеры как рекламные

В сервисах taxi-promotions/feeds-admin внесем изменения, чтобы у баннеров
появился флаг `advert`. Такие баннеры будут считаться рекламными.
Это флаг будем пробрасывать вплоть до eats-communications в payload-е баннера.

### Доработаем получение рекламных баннеров

Расширим виджет баннеров фильтром "рекламные": виджет будет игнорировать все те
баннеры, которые не соответствуют предикату ИЛИ не имеют флаг "реклама".
Параллельно с этим начнем форсированно игнорировать рекламные баннеры в случае,
если этот фильтр не стоит.

