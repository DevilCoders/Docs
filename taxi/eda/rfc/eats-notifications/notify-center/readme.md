## Опросник для ревью комитетом

> Этот опросник нужен для [архитектурного ревью комитетом](https://forms.yandex-team.ru/surveys/25357/). Его можно будет скопировать.

> После его написания можно пробежаться по списку из [этой статьи](https://stackoverflow.blog/2020/04/06/a-practical-guide-to-writing-technical-specs/). Он подскажет, какие аспекты еще стоит осветить.

**Название сервиса, в который вносятся изменения**

eats-notifications

**Какую задачу решаете?**

В приложении Еды нет места, где мы можем коммуницировать с итером более надёжно,
чем пуши и без задействования главного экрана (фулскрины, сторизы и т.д.).
Продукту нужно место, где итер увидит:
- извинения ресторана после негативного отзыва о заказе (критично для проекта «Подписка ресторанов»);
- историю пушей от Еды с промокодами / возвратом средств / маркетингом;
- коммуникации о новых фичах в приложении.

Для решения этой проблемы, предлагается сделать BDU экран в приложении,
которым можно полностью управлять с бэкэнда. Это позволит решить конкретную
задачу для извинения ресторанов прямо сейчас, а также без доработок на
клиентах расширить использование экрана для остальных продуктовых кейсов.

Figma: https://www.figma.com/file/uVHqOmDyqYWSbY3ZME6AyB/Центр-уведомлений?node-id=1%3A2

**Опишите архитектурные изменения**

В сервис eats-notifications добавляем эндпоинт, который по клиентской
авторизации вытаскивает из БД уведомления итеру. Уведомления, которые
отображаются на фронте, помечаются специальным тэгом.

Сервису понадобится индексы по `eater_id`, `project_id`, `template_id` 
в таблице `notifications` для быстрых выборок.

Чтобы определить, какие нотификации можно отображать итеру в приложении,
используем такси-конфиг с ключами нотификаций. Не патчим админку.

Чуть позднее появится тэг «только в центр уведомлений», которым можно
отметить уведомления, которые не нужно отправлять пушом, но можно
добавить в центр уведомлений итера.

**Планируется ли изменение нагрузки?**

Да. До 10-и RPS на новый клиентский эндпоинт. Будет настроен рейт-лимитер.

**Появляются ли новые фолбеки?**

—

**Появляются ли новые точки отказа?**

От сервиса eats-notifications начинает зависеть экран в клиентском приложении.

**Как осуществите миграцию на новое решение?**

Это новая функциональность, которая будет доступна в новых версиях
приложений.

**Комментарий**

Хочется сделать это за ближайшие три дня, давайте не затягивать арх. ревью.
В моменте решается конкретная задача с «Подпиской ресторанов».