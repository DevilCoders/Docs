# Логика бэкенда

Кэшбек будет работать под экспериментом. Учитываться будут версии приложения, иначе на старых девайсах сломается логика отображения. (Будет думать, что выводит скидку и выведет только плашку. Если заполнить text, то тогда скорее всего он закроет картинку самого плюса)

Переделал спеку на дискриминатор.
Логика заполнения следующая:
- скидка продуктом будет иметь тип product_promo. Это "2 по цене 1" и т.п. 
  У такого продукта может быть либо поле promoType.text либо promoType.pictureUri, а promoPrice, promoType.value = null.
  Пример:
  "promoTypes":[
    {
      "type": "product_promo",
      "id": 1,
      "name": "1 + 1",
      "pictureUri": "https://eda.yandex/uploads/promos/5b73/5b73e9d999e2a.png",
      "detailedPictureUrl": "https://eda.yandex/uploads/promos/5b73/5b73e9d999e2b.png",
      "text": "2 по цене 1"
    }
  ]
- скидка деньгами будет иметь тип price_discount. У такого продукта есть promoPrice и promoType.text. А promoType.value = null.
  Пример:
  "promoTypes":[
    {
      "type": "price_discount",
      "id": 1,
      "name": "Скидка 15%",
      "pictureUri": "https://eda.yandex/uploads/promos/5b73/5b73e9d999e2a.png",
      "detailedPictureUrl": "https://eda.yandex/uploads/promos/5b73/5b73e9d999e2b.png"
      "text": "-15%"
    }
  ]
- кэшбек будет иметь тип cashback. У такого продукта есть promoType.value. А promoPrice и promoType.text = null
  Пример:
  "promoTypes":[
    {
      "type": "cashback",
      "id": 1,
      "name": "Кэшбек 15",
      "value": 15
    }
  ]
В случаях, когда будет и скидка и кэшбек, будет 2 элемента в promoTypes. Первой будет идти скидка, второй кэшбек.


# Клиентская логика

На старых версиях ничего не поменяется: добавленные поля не будут никак обрабатываться и кэшбек присылаться не будет.

Различать типы promoTypes следует по полю type.

Механизм работы с объектами разных типов:
1. price_discount как и раньше, выводить text на фоне. Теперь поле text будет всегда.
2. product_promo если в полученном объекте есть поле text, то выводить текст на фоне как для price_discount. Если поле text отсутствует - отображать картинку из pictureUri. У элементов обязательно должно быть хотя бы одно из двух полей: text или pictureUri. Если в объекте оказывается и поле text и поле pictureUri, то поле text считать более приоритетным.
3. cashback выводить value на картинке плюса, как нарисовано в доке. Поле value будет всегда.

Если в массиве promoTypes несколько элементов, то отображать последовательно слева направо.


Мотивация поля value для кэшбека: первоначально была идея отображать его и на кнопке "Добавить" в карточке товара. 
В таком случае было бы логично умножать количество выбираемых товаров на кэшбек и отображать это количество. 
Сейчас от этого отказались, но это вполне может еще пригодится
