### Назначение

Библиотека веб-компонент на основе дизайн системы Go

### Storybook

- [Легаси версия](https://corp-storybook.ktnglazachev.front.taxi.dev.yandex-team.ru)
- [Актуальная версия](https://corp-storybook-2.ktnglazachev.front.taxi.dev.yandex-team.ru)

### Потребителю

- Легаси версия `npm i @yandex-taxi/go-web-components`
- Актуальная версия `npm i @gwc/main`, также возможна установка отдельных пакетов скоупа, если все не нужно.
- Также потребуется добавить `css-loader` в свою конфигурацию вебпака и настроить его, чтобы он процессил пакет(ты) библиотеки
- Для `typescript` также потребуется добавить дефинишен для `css` файлов

```ts
declare module '*.css' {
    const _default: Record<string, string>;
    export default _default;
}
```

### Разработчику

- [Спека](https://www.figma.com/file/wLzOt0Aq3w3C67DqpqDVUp/2-·-UI?node-id=0%3A1) в Figma
- Очередь проекта в st - [GWC](https://st.yandex-team.ru/GWC)
- Инициализация репы `npm run init`
- Запуск актуального сторибука `npm run storybook:new`
- Запуск легаси сторибука `npm run storybook:legacy`
- Сбилдить все пакеты `npm run build`
- Прогнать тесты `npm test`
- Публикация происходит через [сбоку](https://teamcity.taxi.yandex-team.ru/buildConfiguration/YandexTaxiProjects_Frontend_Monorepo_Releases_ReleasePackage?branch=go-web-components&buildTypeTab=overview&mode=builds) в Teamcity
- [react-aria](https://react-spectrum.adobe.com/react-aria/index.html)
- Чтобы запустить примеры из `examples`, нужно сначала сделать `npm run build`, затем запускать через лерну из корня, например `npx lerna --scope @gwc/examples-ssr run --stream start`, аналогично для других примеров

#### На что обращать внимание при разработке

- Для большинства компонент актуально, чтобы у них в пропсах были все пропсы их корневого HTML-элемента, чтобы можно было докинуть классы, стили, обработчики событий и тд
- Для большинства компонент актуально быть обернутыми в `forwardRef`, не забывайте, что функциональные компоненты не поддерживают `ref` без такой обертки
- Хочется избежать необходимости собирать библиотеку через `webpack`, или заставлять потребителей затаскивать себе кучу каких-нибудь вебпак-плагинов. Это исходит из соображений простоты, а так же того, что `webpack 4` в целом не умеет собирать в `es` модули, а в `webpack 5` это экперементальная фича, т.о. библиотека будет собрана только под `commonjs`, что исключает `tree-shaking`. Сейчас билд происходит просто через `tsc`, который умеет компилировать в `es`, а со стороны вебпака требуется только `css-loader`, который является одним из базовых лоадеров, который скорее всего и так есть в проекте. Поэтому, если вам хочется затащить сборку вебпаком, или добавить зависимость от каких-то еще плагинов/лоадеров, то сначала подумайте как обойтись без этого.
- Проверять работу компонентов в светлой и темной темах
- Проверять работу компонентов в rtl

### Скриншотное тестирование

Для скриншотного тестирования используется puppeteer + jest

Логика такая:

1) Перед тестами билдим сторибук
2) В тестах открываем главный файлик сторибука и переходим на страницу которая нужна
3) Дальше можно писать истории под разные компоненты и средставми пупитира хоть кликать хоть ховерить их и что угодно делать и сверять скриншоты.
4) Пример теста можно посмотреть packages/storybook/button/__tests__
