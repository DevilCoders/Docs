# Сасово-3 и новая фабрика

# Введение

![file:/noc/sasovo3/2.jpg](file:/noc/sasovo3/2.jpg)С появлением Сасово-3, необходимо модернизировать существующую фабрику на базе single chip коммутаторах. Сасово-1 и Сасово-2 будут переключены на нее после модернизации. Существующие Spine-1 из Sas-1/2 будут переключены на новые Spine-2 в Sas-3.![https://wiki.yandex-team.ru/noc/sasovo3/.files/sas3-1.png](https://wiki.yandex-team.ru/noc/sasovo3/.files/sas3-1.png)

На эту тему был создан тикет 
> NOCTODO-235
Существующий Spine-2 уровень представляет собой матрицу 4x4 из модульных коммутаторов Huawei и Juniper.На текущий момент Spine-2 в CC2 агрегирует порядка 4000 100гигабитных портов, для агрегации этого количества в новой фабрике достаточно 16 single chip коммутаторов 64x400G нового поколения.Порты 400G новой фабрики разбиваются на 4x100 для подключения Sas-1/2 или могут использоваться как есть для подключения Sas-3.

Новый Spine-2 уровень будет строится по подобию ДЦ Владимир и будет иметь 8 planes, в каждом из которых будет возможно иметь до 32 коммутаторов, то есть по схеме **8x32**.Таким образом общая емкость Spine-2 уровня может достигать **16384** 400G портов (65536x100G).На первом этапе достаточно будет иметь по 4 коммутатора в каждом plane (32 in total) с учетом новой емкости Sas-3.

Сасово-3 будет состоять из кластеров 17,16,15,14 и будет иметь следующие номера подов (согласно наименования предложенного Александром Клименко и Дмитрием Ершовым в тикете NOC-18940)
| SAS05 | 33,34,35,36 |
| - | - |
| SAS08/1 | 37,38,39,40,41,~~42~~ |
| SAS08/2 | 43,44,45,46,47,~~48~~ |
| SAS09/1 | 49,50,51,52,53,~~54~~ |
| SAS09/2 | 55,56,57,58,59,~~60~~ |
| SAS11/1 | 61,62,63,64,65,~~66~~ |
| SAS11/2 | 67,68,69,70,71,~~72~~ |
| SAS13/1 | 73,74,75,76,77,~~78~~ |
| SAS13/2 | 79,80,81,82,83,~~84~~ |
| SAS10 | 85,86,87,88,89 |
| SAS12 | 90,91,92,93,94 |
| SAS17 | 95,96,97,98,99,100,101,102,103 |
| SAS16 | 104,105,106,107,108,109,110,111 |
| SAS15 | 112,113,114,115,116,117,118,119 |
| SAS14 | 120,121,122,123,124,125,126,127 |
| EdgePOD CC1 | 32 |
| EdgePOD CC3 | 128 |

SAS01-04,06-07 - 1,2-31 зарезервированы под upgrade SAS1-4,6-7

Схематично новая фабрика будет выглядеть так (не все линки прорисованы)![file:/noc/sasovo3/fabric.jpg](file:/noc/sasovo3/fabric.jpg)Как видно из диаграммы, Сасово-1 подключается к фабрике через два Spine-1 коммутатора, а Сасово-2 - через 4.После создания новой фабрики, поды в Сасово-1/2 будут модернизированы до уровня нового Сасово-3, таким образом весь ДЦ Сасово будет иметь сходный дизайн и емкость.

Новая кабельная система (СКС) в новом Сасово-3 описана [здесь](https://wiki.yandex-team.ru/dmitrijjershov/sas3-cabling/)*"Уровень S2 размещается в проектируемом помещении коммуникационного центра (CC3). Логически стойки S2 делятся на 4 группы (block) по 8 стоек. Группы могут располагаться в одном или нескольких рядах."*

При разработек дизайна нового уровня S2, для увеличения отказоустойчивости новой фабрики, планируется формировать каждую стойку полным набором плейнов, таким образом снижая возможный эффект от полного отключения стойки (или нескольких стоек одновременно). При полностью собранной фабрики, отказ одной стойки будет уменьшать емкость S2 всего на 1/32.Схематично это выгядит следующим образом:

![https://wiki.yandex-team.ru/noc/sasovo3/.files/untitleddiagram-page-4.png](https://wiki.yandex-team.ru/noc/sasovo3/.files/untitleddiagram-page-4.png)Планируется что новые коммутаторы S2 (64 порта) будут занимать 2 rack units, всего 16RU из выделенных 32-х для оборудования (всего 48 в стойке).

Новый уровень S2 планируется к установке в КЦ-3. Исходя из архитектуры Сасово-1/2, каждый ряд состоит из 16 стоек, таким образом новый уровень S2 будет занимать два ряда стоек.![file:/noc/sasovo3/4.jpg](file:/noc/sasovo3/4.jpg)

Первый модуль из третьей очереди Сасово - Модуль 17![file:/noc/sasovo3/3.jpg](file:/noc/sasovo3/3.jpg)

На момент проектирования на рынке отсутствовали модели 64х400G, поэтому на первом этапе фабрика будет построена на свичах 32x400G, которые в дальнейшем переедут на уровень S1.![file:/noc/sasovo3/5.jpg](file:/noc/sasovo3/5.jpg)На этом этапе будет собрано 4 плейна.
### Наименование устройств

![file:/noc/sasovo3/s2-name.png](file:/noc/sasovo3/s2-name.png)![file:/noc/sasovo3/s1-name.png](file:/noc/sasovo3/s1-name.png)
### Нумерация портов

![file:/noc/sasovo3/7.jpg](file:/noc/sasovo3/7.jpg)
### Сборка стоек S2

![file:/noc/sasovo3/s2.jpg](file:/noc/sasovo3/s2.jpg)

Типовая стойка S2![file:/noc/sasovo3/cn1.jpg](file:/noc/sasovo3/cn1.jpg)
### Сборка стоек S1

![file:/noc/sasovo3/s1.jpg](file:/noc/sasovo3/s1.jpg)
### Стойки S1 модуля 17

{% cut "S1.95" %}

![file:/noc/sasovo3/95-1.jpg](file:/noc/sasovo3/95-1.jpg)

{% endcut %}



{% cut "S1.96" %}

![file:/noc/sasovo3/96.jpg](file:/noc/sasovo3/96.jpg)

{% endcut %}



{% cut "S1.97" %}

![file:/noc/sasovo3/97.jpg](file:/noc/sasovo3/97.jpg)

{% endcut %}



{% cut "S1.98" %}

![file:/noc/sasovo3/98.jpg](file:/noc/sasovo3/98.jpg)

{% endcut %}



{% cut "S1.99" %}

![file:/noc/sasovo3/99-1.jpg](file:/noc/sasovo3/99-1.jpg)

{% endcut %}



{% cut "S1.100" %}

![file:/noc/sasovo3/100-1.jpg](file:/noc/sasovo3/100-1.jpg)

{% endcut %}



{% cut "S1.101" %}

![file:/noc/sasovo3/101-1.jpg](file:/noc/sasovo3/101-1.jpg)

{% endcut %}



{% cut "S1.102" %}

![file:/noc/sasovo3/102-1.jpg](file:/noc/sasovo3/102-1.jpg)

{% endcut %}



{% cut "S1.103" %}

![file:/noc/sasovo3/103-1.jpg](file:/noc/sasovo3/103-1.jpg)

{% endcut %}



[Excel файл с кроссировками](file:/noc/sasovo3/rack-2021-12-09.xlsx)

Общая схема Сасово описана [здесь](https://wiki.yandex-team.ru/dmitrijjershov/dcnetreference/).