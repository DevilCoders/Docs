# Safe Diff. Процесс устранения безопасного Diff на сети

## Процедура тестирования

### Когда надо проводить тестирование

- Изменён Safe ACL в Generator в Ann

Процесс не применяется при hotfix в Аннушку.

#### Шаг 1

Завести тикет в ST. Внести описание изменений.

#### Шаг 2

Сделать бранч, назвав его кодом тикета, например, `NOC-12345`. Код тикета взять из <Шаг 1>

#### Шаг 3

Внести изменения в генератор или acl.

#### Шаг 4

Тестирование изменений на тестовой выборке оборудования.

#### Шаг 5

Сделать Merge Request/Pull Request в master Ann

#### Шаг 6

Из Шага 6 получаем набор Diff на сети.

##### Шаг 6.1

Для Safe Diff применяется процесс автоматического массового изменения на сети:
- Создается NOCRFCSS

#### Шаг 7

Применение (deploy) изменений


## Требования к процессу

-

1. Системой Чекист обнаружен дифф по генератору

Обнаружен новый дифф по какому-либо генератору, либо сету генераторов.
Чекист *как-то* подгружает объекты safe_acl.
Производится фильтрация п

- Генерируется дифф по устройствам
- Дифф делится по генераторам Аннушки
- К каждому генератору применяется safe_acl, формируя safe diff
- Каждый safe diff имеет свой scheduler по выкатке на ДЦ
- За один раз катим не больше чем в один ДЦ
- Деплой происходит частями в ДЦ
- В случае failure происходит откат всего диффа
- На время выкатки должен быть фриз на новые изменения
- Время выкатки должно отображаться в infra
- После деплоя должны происходить health tests в ДЦ
