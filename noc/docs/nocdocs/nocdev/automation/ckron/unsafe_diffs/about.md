# Катки Unsafe Diff

Процесс выкатки unsafe diff отличается от выкатки safe diff. Основное отличие:
- baseline: для выкатки применяется специальный мониторинг параметров сети
- rollback: в случае проблем на сети во время катки предусмотрен алгоритм отката к первоначальному состоянию
- canary group: чтобы не выкатывать все изменения на все устройства разом применяются специальные группы устройств

Высокоуровнево процесс выглядит так:
- Сотрудник эксплуатации пишет rule в crkon.yml
- Автоматика генерирует diff
- Diff порождается на какой-то set устройств сети
- Так как выкатывать на все устройства сразу мы не можем, то набор устройств передается в некий алгоритм, который принимает set устройств и возвращает set из Canary Group
- Для сгенерированных Canary Groups запускается процесс выкатки на Canary Group
- Если процесс выкатки проходит без ошибок, то производится deploy на сеть
- Если произошла ошибка, то производится rollback для выкаченных Canary Groups, призывается NOC эксплуататор/дежурный

![Процесс](./_images/img1.jpg)