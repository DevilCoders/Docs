# Создание и анонс сервиса

Чтобы создать и анонсировать в сети новый сервис:

1. На стартовой странице L3 manager нажмите кнопку **Add service**:
    
   - В поле **FQDN** укажите FQDN-адрес вашего сервиса. Адрес должен соответствовать [правилам rfс](https://tools.ietf.org/html/rfc1034): {#fqdn}
    
     - Максимальное количество символов — 63.
     - Допустимые символы — латинские буквы, цифры и дефис (-).
     - Первый символ — буква или цифра.
     - Последний символ — буква или цифра.
    
   - В поле **ABC service** укажите ссылку на сервис ABC, в котором у вас есть роль «Ответственный за l3» или «Системный администратор».
    
1. Нажмите кнопку **Add service**.
    
    Новый сервис появится в списке доступных вам сервисов:
    
    ![image](../_assets/new-service.png =600x153)
    
1. Перейдите на страницу сервиса и создайте новую конфигурацию кнопкой **Add new сonfig**.
1. Будет открыта страница конфигурации. На странице конфигурации нажмите кнопку **Add new virtual server**.
1. Укажите настройки виртуального сервера и нажмите кнопку **Save changes**. Полный список параметров приведен в разделе [Настройка виртуального сервера](config-settings.md).
    
    Обязательные параметры:
    
   - **Get new IP** — тип адреса, который будет назначен вашему серверу:
    
     - Internal IPv4 — IPv4 адрес для внутренних сервисов.
     - Internal IPv6 — IPv6 адрес для внутренних сервисов.
     - External IPv4 — IPv4 адрес для внешних сервисов.
     - External IPv6 — IPv6 адрес для внешних сервисов.
    
     Внешний сервис — это сервис, к которому будут подключаться из внешней сети. Примеры внешних сервисов:
    
     - Главная страница Яндекса.
     - Сервисы, к которым будут подключаться outsource-сотрудники, не имеющие доступа к VPN.
     - Все проекты клиентов Яндекс.Облака.
    
     На данном этапе необходимо выбрать только тип адреса. L3 manager самостоятельно выдаст и подставит конкретное значение IP-адреса в поле **IP**.
    
    - **Port** — порт вашего приложения, на который будут отправляться запросы пользователей.
    - **Protocol** — протокол подключения к вашему сервису: TCP, UDP или FWM (Firewall mark). Если вы хотите использовать протокол FWM, проконсультируйтесь с [командой L3](mailto:slb@yandex-team.ru).
    
1. Сохраните виртуальный сервер кнопкой **Save**.
1. Будет открыта страница конфигурации с новым виртуальным сервером. При необходимости добавьте другие виртуальные серверы, после чего сохраните конфигурацию кнопкой **Save**→**Save config**.
1. Если вам необходимо задать одинаковый список рилов для всех виртуальных серверов конфигурации, нажмите кнопку **Update RS groups**, укажите новый [список рилов](config-settings.md#section_lkx_rlf_sfb) и нажмите кнопку **Save changes**.
    
1. Нажмите кнопку **Deploy**→**Yes**. Спустя некоторое время L3 manager начнет деплой вашей конфигурации. Процесс деплоя описан в разделе [Анонс сервиса](statuses.md). L3 manager протестирует и доставит конфигурацию до L3 балансеров.
1. L3 балансеры получат конфигурацию, [проверят доступность ваших рилов](checks.md) и анонсируют ваш сервис. Статусы балансеров описаны в разделе [Анонс сервиса](statuses.md).
1. Спустя некоторое время L3 manager начнет передавать трафик на ваш сервис. Признаки успешно анонсированного сервиса:
    - [Статус конфигурации](statuses.md#conf-stat) — `ACTIVE`.
    - [Статусы балансеров](statuses.md#belencer-stat) — `ANNOUNCED`.
    - IP-адреса виртуальных серверов пингуются.
    - Рилы вашего сервиса получают трафик от пользователей.

   Если трафик пользователей не поступает или при деплое возникли ошибки, см. раздел [Решение проблем](troubleshooting.md).

