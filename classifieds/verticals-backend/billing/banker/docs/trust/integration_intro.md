## Введение в интеграцию

### Что такое Траст?
Trust предоставляет API для приема платежей, включая возможность печати и отправки в ФНС кассовых чеков (согласно 54-ФЗ).
Сервис Trust дает возможность другим сервисам Яндекса принимать платежи за товары и услуги.

### Зачем мы интегрируемся с Трастом?
Цель - перевести оплату физ лиц автору с ЮКассы на Траст и тем самым увеличить выручку.

Траст - внутренний сервис оплаты, единый для всех сервисов Яндекса. 
Когда пользователь привязывает банковскую карту при оплате, например, в Такси или в Кинопоиске, она привязывается к Yandex.Pay и становится доступна в Трасте.
Есть предположение, что оплата с помощью сохраненных карт будут стимулировать пользователей совершать больше покупок.
Кроме того, интеграция с Трастом позволит решить следующие задачи:
- [VSBILLING-4905: Яндекс.Плюс в физиках авто](https://st.yandex-team.ru/VSBILLING-4905)
- [VSBILLING-4724: Автоматизация признания выручки ФЛ в авто.ру](https://st.yandex-team.ru/VSBILLING-4724)
- [VSBILLING-4437: Поставка транзакций банкира для сверки](https://st.yandex-team.ru/VSBILLING-4437)

### Регистрация продукта
Все используемые продукты нужно зарегистрировать в рамках сервиса в Trust.
Сделать нужно это один раз через [ручку](https://wiki.yandex-team.ru/TRUST/Payments/API/Products/#sozdanieprodukta).

В дальнейшем при покупке в корзине нужно будет указывать лишь **product_id**.
Поле **fiscal_name** будет использоваться в чеке оплаты, который будет отправлен пользователю Trust'ом.
При создании продукта можно также указать nds по умолчанию.

Список продуктов составлен и описан в задаче [VSMONEY-3590: Завести в банкире услуги частников](https://st.yandex-team.ru/VSMONEY-3590).

### Паспортный uid пользователя
Многие запросу к трасту должны выполняться от имени пользователя, для этого используется заголовок `X-Uid`, в который необходимо передавать uid пользователя в Яндекс.Паспорте.
Есть следующие способы узнать uid:
* Свой паспортный uid можно посмотреть на странице https://api.passport.yandex.ru/accounts
* Получить паспортный uid по id пользователя autoru можно через ручку вертикального паспорта [getUserEssentials](http://passport-api.vrts-slb.test.vertis.yandex.net/swagger/?url=/api/2.x/#!/User/getUserEssentials)

### Полезные ссылки
- [Общая страница документации Trust](https://wiki.yandex-team.ru/TRUST/Payments/).
- [Глоссарий траста](https://wiki.yandex-team.ru/TRUST/Payments/#terminologija)
- [Архитектура траста](https://wiki.yandex-team.ru/trust/arch/)
- [NEWSERVICE-2469: Авто.ру: интеграция с Трастом](https://st.yandex-team.ru/NEWSERVICE-2469)
