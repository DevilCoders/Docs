# SUP 
## Документация
https://wiki.yandex-team.ru/sup/
https://doc.yandex-team.ru/sup-overview/
https://doc.yandex-team.ru/sup-api/concepts/about.html
https://push-beta.n.yandex-team.ru/docs/api-guide.html#_Отправка

## Чат поддержки 
https://t.me/joinchat/BtPURkIbkDwNR-7j9axkfw

## UI для отправки пушей
https://sup-frontend.yandex-team.ru

## Запуск пуша
Чтобы начать слать пуши в проде нужно, чтобы в СУП был прописан push_id нового пуша.
Для этого необходимо пройти специальную процедуру.

### Определить тип пуша и какие согласования он требует
https://wiki.yandex-team.ru/users/sp-rusanov/Pushi-tipy-v2/
Если кратко: все тексты надо прогнать через очередь EDIT, а маркетинговые еще и через маркетологов. 

### Сделать тикет про запуск пуша
https://wiki.yandex-team.ru/sup/newpush/

Важно при заполнении формы поставить галочки около версии ПП для android и ios. 
Если забыли, потом можно будет добавить в тэги тикета.

### Установить dev сборку ПП
https://beta.m.soft.yandex.ru/description?app=yandex&platform_shortcut=android&branch=superapp_testing-20.95

Ветку надо выбрать superapp_testing-<самое свежее число>. 
Ссылку из документации СУП на ветку dev использовать не надо, могут быть конфликты с ПП из play market.

### Начать слать пуши
У супа есть несколько контуров. 
Тестовые:
http://push-beta.n.yandex-team.ru
http://sup-priemka.n.yandex-team.ru (несмотря на название скриншотные тесты и приемку асесорами надо проходит в проде)
Продовый:
http://sup.yandex.net

Слать можно начинать со своим OAuth токеном. Все контуры доступны с ноутбука. 

В тестинге (и в проде до момента запуска пуша) пуши будут приходить только в ПП, где залогинен пользователь,
привязанный к стафу (независимо от способа отправки, даже по UUID). 
Для этого правила сделано исключение для проекта "sup", для проверки что вы вообще способны получить пуш у него отключены ограничения.

Чтобы начать получать пуши в тестинге, надо в настройках ПП поменять HOST_PUSH_SUBSCRIPTIONS 
(на sup-priemka.n.yandex-team.ru или sup-priemka.n.yandex-team.ru в зависимости от предпочитаемого контура),
после этого ПП сам должен залогинить вас в СУП.
Но если после этих действий sup-frontend.yandex-team.ru не показывает дял вашего puid привязанную dev сборку ПП,
то можно зарегистрировать себя самостоятельно через апи https://doc.yandex-team.ru/sup-api/concepts/user-login.html

Важно учитывать настройки лимитов https://doc.yandex-team.ru/sup-api/concepts/push-create/index.html#politiki-limitov-otpravki
Если настройка лимита не передается при отправке пуша, то используется дефолтная, а там небольшие значения и пуши перестанут приходить.
Для Объявлений создана тестовая политика "classified.test_policy", с ограничением 100 пушей в час.

После того как пуш протестирован в тестовом контуре, нужно начать слать пуши в проде пользователю залогиненому в dev ПП.
После этого можно будет переводить тикет про запуск пуша в статус "можно снимать скриншоты". 
Дальше, в идеале, робот все сделает сам (снимет скриншоты, отдаст асессорам, добавит в репозиторий СУП новый push_id). 

### Проведение эксперимента
Следующим этапом является проведение эксперимента. Пуши объемом меньше 5000 в день, можно запускать без него.
https://wiki.yandex-team.ru/sup/newpush/experiments/#priemkajeksperimentov

### Отладка
https://doc.yandex-team.ru/sup-api/common/debug.html
Помимо способов описанных в доке, найти информацию об устройствах пользователя можно на https://sup-frontend.yandex-team.ru

