# Используемое хранилище в сервисе

## Статус
Proposed

## Контекст
Для реализации consumer-based решения необходимо где-то хранить стейт пользователя.
В этом стейте находятся:
 - наличие объявлений
 - наличие привязанного яндексового аккаунта
 - выдан ли уже бонус
 - какие пуши отправлены

### Объем данных и нагрузка
Хранить стейт нужно для всех пользователей, которые размещали объявления.
Это примерно сотни тысяч пользователей в год.
Для каждого пользователя необходимо хранить несколько килобайт данных. Экстремально – мегабайт на пользователя.
Суммарно получается десятки-сотня гигабайт в год.

Нагрузку можно оценить количеством сообщений в топике с новыми/измененными объявлениями.
Сейчас это в пике около 1 тыс. сообщений в секунду.
Часть из этих сообщений можно отбросить сразу, и общая нагрузка будет ниже. 
Но такой метода дает оценку сверху.

### Кандидаты
В вертикалях сейчас в обиходе 2 вида баз данных: YDB и mysql/postgresql.

## Решение
Т.к. реляционная база проще в поддержке и требований к масштабированию нет, то выбран postgresql.

## Последствия

