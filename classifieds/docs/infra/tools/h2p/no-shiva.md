# Если вы живете не в Shiva

## Регистрация в Consul
Взаимодействие через **h2p** происходит только с сервисами, которые зарегистрированы в `Consul`.
Поэтому, вам могут понадобиться дополнительные манипуляции в зависимости от системы деплоя:
* **Jenkins**:
  * Необходимо описать все ваши провайдс в [карте сервисов](../../service-map.md)

* **Conductor**:
  * Необходимо описать все ваши провайдс в [карте сервисов](../../service-map.md)
  * Добавить в **Consul** теги `noshiva` и `service=<имя сервиса в карте сервисов>`

    [Пример](https://github.com/YandexClassifieds/review/blob/d0ef58ccd73519be3e8542e5b96224f37829f150/review-ugc/assembly/deb/review-ugc.consul.json#L7)

## Поход в конкретный инстанс сервиса, который живет в `Conductor`
Так как для инстансов сервиса в Кондукторе нельзя сделать уникальные **Consul**-теги, то единственным вариантом остается использование IP адреса.
Для этого надо создавать туннель напрямую через утилиту `ssh`:

Создание туннеля через утилиту `ssh`:

```shell
ssh -L 127.0.0.1:<локальный порт>:<адрес сервиса>:<порт сервиса> h2p.vertis.yandex.net -p 2222 -N
```

Например, чтобы попасть в сервис с ip `2a02:6b8:c03:7ae:0:1459:5ae4:ae49` в порт `26017`:

```shell
ssh -L 127.0.0.1:3000:[2a02:6b8:c03:7ae:0:1459:5ae4:ae49]:26017 h2p.vertis.yandex.net -p 2222 -N
```

После этого на указанном локальном порту откроется туннель, через который можно отправлять запросы (например, [http://127.0.0.1:3000](http://127.0.0.1:3000))

