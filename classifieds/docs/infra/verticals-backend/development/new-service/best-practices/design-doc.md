# Как писать дизайн-документы

Целью дизайн-документа (далее `дизайн-док`) является описание решения какой-то проблемы.
Решением проблемы может быть создание нового сервиса, либо заметное изменение в существующем.
Написание дизайн-дока преследует несколько целей:
 1. это способ подумать и описать все аспекты решения до начала разработки.
  в процессе написания зачастую находятся логические нестыковки.
 2. получение комментариев от других разработчиков. 
 Одна голова – хорошо, но две лучше. Другие люди помогут найти слабые стороны в вашем решениии,
  о которых вы могли не подумать.
 3. документирование для дальнейшего использования. 
 Новые разработчики в команде или другие смежники (менеджеры, тестировщики и пр.) могут пользоваться документом
  как документацией для понимания предметной области.

## Решаемая проблема
У любого решения есть какая-то проблема, которую оно призвано решить.
Здесь стоит написать эту проблему простым языком, стараясь по минимуму использовать жаргонизмы.
Если жаргонизмов избежать не выходит, стоит ввести или сослаться на существующий глоссарий.

## Решение
Далее описывается предлагаемое решение.
Чтобы помочь с оформлением дизайн-дока далее перечислены аспекты, которые могут влиять на выбор решения.
Не всё из предложенного может быть применимо для вашей проблемы, 
поэтому следует относиться к ним только как к справочнику.

### Модель
Описание сущностей и их поля, которые появляются в результате решения.
Плюс возможно краткое описание жизненного цикла этих сущностей.

### Схема хранения данных
Если предполагается хранение сущностей, то можно описать то, как они будут храниться.
Так же описание таблиц, которые нужны для совершения каких-либо операций. 
Например, индексные таблицы или таблицы с очередями.

Обычно описывается в виде списка таблиц (с полями и индексами).
Так же могут быть приведены примеры запросов для некоторых операций.

### Нагрузка
Какие нагрузки ожидаются на сервис или отдельные его части.
Какой объем данных планируется хранить, и как он будет расти со временем.

### Интеграции
Какие интеграции с другими сервисами появляются.
Например, http-запросы в другой сервис при обработке каждого документа.
Какая нагрузка на них ожидается?

### Масштабирование
Как сервис растет с ростом нагрузки или размера хранимых данных.
Какие ручные действия необходимо совершить для осуществления дальнейшего роста?

### Отказоустойчивость
Как сервис себя ведет при отключении дата центра, базы-данных и других зависимых сервисов.
Как ведет себя система при единичной ошибке обработки запроса/сообщения. 
Являются ли операции идемпотентными?

### Доступность для аналитики
Аналитика очень важна для понимания того, в какую сторону должен развиваться бизнес.
Здесь стоит описать, как данные вашего сервиса будут доступны для аналитических запросов.
Тут может быть ссылка на таблицу в yt с описанием схемы данных.
Ссылку стоит сопроводить кратким рассказом, каким образом готовятся эти данные и как часто они обновляются.

### Альтернативные решения
Какие альтернативные решения были рассмотрены, и почему они не подошли.

### План
Если решение предполагает несколько этапов, то нужно описать эти этапы 
и примерные моменты во времени когда они будут закончены. 

### Будущее развитие
Какие еще изменения будут происходить в системе в ближайшем или отдаленном будущем.
Эти изменения могут влиять на выбор решения, т.к. от него зависит сложность проведения этих изменений.  

### Риски

Какие риски могут быть у предлагаемого решения по вашему мнению.
Что-то что по вашему мнению не должно происходить, но если бы оно происходило, то другое решение подходило бы лучше.
*TODO*: написать пример.

## Примеры дизайн-доков

Несколько примеров дизайн-доков существующих сервисов вертикалей:
 - [Broker](https://docs.yandex-team.ru/classifieds-infra/broker/design)
 - [Palma](https://docs.yandex-team.ru/classifieds-infra/palma/design)
 - [Uploader](https://wiki.yandex-team.ru/vertis/uploader/)
 - [Worm](https://wiki.yandex-team.ru/vertis/worm/)
 - [Complaints](https://wiki.yandex-team.ru/vsqmanagement/complaints/Complaints2/)

## Ссылки
Что еще почитать по теме?

Статья в 4 частях от Джоэля Спольски:
 - [Часть 1](https://www.joelonsoftware.com/2000/10/02/painless-functional-specifications-part-1-why-bother/)
 - [Часть 2](https://www.joelonsoftware.com/2000/10/03/painless-functional-specifications-part-2-whats-a-spec/)
 - [Часть 3](https://www.joelonsoftware.com/2000/10/04/painless-functional-specifications-part-3-but-how/)
 - [Часть 4](https://www.joelonsoftware.com/2000/10/15/painless-functional-specifications-part-4-tips/)

## Инструменты

Для рисования графиков/схем могут быть полезны эти инструменты:
 - [drawio](https://drawio.yandex-team.ru)
 - [mermaid](https://mermaid-js.github.io/mermaid-live-editor/)
 - [yed](https://www.yworks.com/products/yed)
