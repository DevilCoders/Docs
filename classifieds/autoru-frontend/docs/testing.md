# Тестирование
Дока про то, как готовить данные.

## Пользователи

Каждую ночь пользователи и объявления переливаются из прода в дев и тестинг.
В dev-окружении (через PHP-страницу авторизации пока ещё) можно залогиниться под любым пользователем с прода с дефолтным паролем (autoru). На реактовской форме авторизация происходит через код.
В тестинге - по коду (можно взять в базе).

Где взять SMS-код для подтверждения телефона:
```
mysql -h mysql.dev.vertis.yandex.net -P 3305 -u <LOGIN_HERE> -p<PASSWORD_HERE>
select * from users.sms_logs where to_phone=79854406491;
```
или одной командой вывести дату и код из последней записи этой таблицы:
```
mysql -h mysql.dev.vertis.yandex.net -P 3305 -u <LOGIN_HERE> -p<PASSWORD_HERE> -e "select rdate, outgoing from users.sms_logs where to_phone=79854406491 order by rdate desc limit 1;"
```

`79854406491` — номер для тестирования, на него не могут позвонить.

Список инстансов БД в деве тут: https://wiki.yandex-team.ru/vertis-admin/storage/mysql/dev/

Если нужно какое-то специфичное объявление, удобно найти его в листинге и залогиниться под продавцом. --Для этого можно зайти под модератором (например, slider5) на объявление и скопировать оттуда номер телефона.-- Модераторские права есть далеко не у всех (об этом ниже). А данные продавца можно взять из БД:
```
   offer_id => user_id в all7.sales;
   user_id => phone в users.phone_numbers
```

NB: Чтоб зарегать нового пользователя, лучше сделать ленивую авторизацию, так как страничка паспорта пишет вообще в другую базку (¯\_(ツ)_/¯).

Для автосервисов механика такая:

- незахваченный сервис можно захватить, нажав на странице сервиса ссылку "Я владелец";
- чтобы редактировать захваченный сервис, можно залогиниться под принадлежащими ему телефоном либо почтой.

## Данные

[Как создать промо-код](https://beta.wiki.yandex-team.ru/autoru-dev/Testing/Kak-sozdat-promo-kod/)

Так как VIN стал обязательным полем (ну ладно, можно ввести СТС вместо него), мы завели список для нужд тестирования:
[Список VIN-кодов](https://beta.wiki.yandex-team.ru/autoru-dev/Testing/Spisok-VIN-kodov/)


## Хочу модераторскую панель

Тут не всё так просто. Модераторская панель есть у тестировщиков, например. Но, если просто залогиниться под таким аккаунтом, вместо модераторской панели будет большая белая пустота с надписью **Нет доступа**. Чтобы панель появилась, нужно авторизоваться тем же логином на yandex.ru. Так что, если ОЧЕНЬ надо, можно попросить доступ у dinoskova@.

