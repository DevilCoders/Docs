# lib/instruments

Термин "instrumented" в контексте разработки ПО означает систему (приложение), обмазанную логами, метриками и прочими подобными вещами, позволяющими собирать информацию о том, что происходит внутри системы. Эта библиотека содержит утилиты, которые мы используем для этих целей ("инструменты").

Библиотека состоит из четырех более-менее переплетенных вещей: утилиты для логов, трейсов, метрик и мониторингов.

## Вещи, о существовании которых полезно знать

- `Logging` — устаревший трейт, добавляющий в класс логгер. Устаревший потому, что не поддерживает трейсы, которые, кажется, хочется протащить вообще везде.
- `TracedLogging` — новая версия `Logging` с поддержкой трейсов.
- `LogUtils.findClassName` — метод, подбирающий хорошее имя для логгера по классу. (Хорошее — это то, которое по возможности без всяких долларов или `anon`.)
- `Traced` — Базовый интерфейс для трейса.
- `OperationalComponents` — трейт, предоставляющий доступ к `ops: OperationalSupport` — объекту, содержащему реестры метрик и мониторингов.
- `OperationalAware` — расширение `OperationalComponents` и `OperationalSupport` одновременно. Позволяет во внутренних (анонимных) классах, создаваемых в контексте `OperationalComponents`, использовать по желанию или `ops`, или реестры напрямую.

## Вещи, которые хочется сюда перенести

- Хелсчеки всех сортов и расцветок
- Остатки трейсинга
- `FutureMonitor2`

## Вещи, с которыми пока непонятно, что делать

- `MdcLogging` выглядит как что-то, что должно быть полностью заменено на `Traced`.
- `ziologging` написано для первого ZIO, нужно как минимум переделать на второй. Кроме того, далеко не все приложения используют ZIO, поэтому тащить классы, которые от него зависят, во все приложения не хочется.
- `DBIOMonitor`, наверное, будет выглядеть лучше в гипотетическом `lib/slick`.
