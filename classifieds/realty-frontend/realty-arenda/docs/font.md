# Шрифт лендинга

На лендинге помимо стандартного YS Text используется кастомный, купленный шрифт "Halvar Breitschrift".

Полный шрифт весит ~50кб, при этом используется только для заголовков. Поэтому напрямую его использовать не хочется.

Вместо этого мы вырезаем из шрифта только самое необходимое:

- U+0410-044F Кириллица
- U+0401,U+0451 ёЁ
- U+0020-002F Знаки препинания 1
- U+0030-0039 Цифры
- U+003A-0040 Знаки препинания 2 
- U+20BD - ₽

Результат ~12кб

Если потребуется добавить в шрифт новый символ, необходимо сделать следующее:
1. Отредактировать файл `realty-arenda/tools/font/make-subset.sh`, добавив в параметры нужный диапазон unicode-символов.
2. Запустить команду `make subset-font`

Для работы команды нужно установить [fonttools](https://github.com/fonttools/fonttools)

# Тех. детали

Шрифт попадает в клиентскую статику и вместе со всем остальным заливается на CDN во время сборки. 

Чтобы подключить шрифт к новой странице нужно:
1. Добавить импорт `view/styles/arenda-font.css` в нужно клиентском бандле
2. Добавить в контроллере страницы параметр preloadLinks, чтобы при SSR на страницу прописался прелоад шрифта (это позволяет сильно минимизировать эффект "моргания")

```js
.dataProviderDecl('prefetch-font', [], function(data) {
    const routeData = this.req.router.route.getData();
    const { assets } = bundles[routeData.bundle];

    // Из клиентского бадла вытаскиваем все шрифты
    data.preloadLinks = getPrefetchFonts(assets);
});
```

