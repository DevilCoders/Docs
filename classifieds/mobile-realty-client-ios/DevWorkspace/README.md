# Dev-project

## Что это
Автономный проект (workspace в директории `DevWorkspace` в корне репозитория) для подключения только необходимых пакетов с целью дальнейшей их разработки.

## Почему
Основной проект очень сильно разросся и уже включает в себя около 100 пакетов. Изменение даже небольших кусков кода приводит к ощутимому времени ожидания окончания процесса сборки.

## Зачем это нужно
Ускорить цикл "edit-compile-run" при разработке новых фич.

## Как пользоваться
В общем – как и основным проектом.

Dev-проект использует ту же кодовую базу, что и основной проект.

### Общее в проектах
**Пакеты**<br/>
Относительные пути (например, вместо `YREPackages` теперь `../YREPackages`).

**.swiftlint**<br/>
Симлинк на `.swiftlint` основного проекта.

**.ruby-version**, **.ruby-gemset**<br/>
Gemset используется тот же.

### Разное в проектах
**Gemfile** – copy-paste из основного проекта.<br/>
Использует относительные пути.

**Podfile** – copy-paste из основного проекта.<br/>
Использует относительные пути.
Необходим для проведения экспериментов.

**Инициализация DI-контейнеров, фабрик**<br/>
Исходит из необходимости использовать только те сервисы и модули, которые необходимы, остальное – заглушать.

### Правила использования
Dev-проект – изолированное окружение, предназначенное для разработки на машинах каждого разработчика. То есть изменения в этом проекте **не должны** попадать в репозиторий.

Стоит рассматривать проект как подготовленный шаблон для своих экспериментов.

Директория `DevWorkspace` внесена в `.gitignore`.
Это сделано специально, чтобы не тащить в git окружение шаблона.

### Подготовка
```shell
cd DevWorkspace
bundle install
pod install
```

### Пример использования
Разработка Формы Подачи.

Чтобы начать разрабатывать UI-компоненты, необходимо подключить (к основному таргету) только сам модуль:
```ruby
pod 'YREUserOfferFormModule'
```

Для тестирования жизненного цикла модуля, необходимо подключить создание модуля через ModuleFactory:
```ruby
pod 'YREModuleBuilder/UserOfferForm'
```
Чтобы модуль собирался, необходимо подключить реализации для модуль-зависимостей к ModuleFactory (смотрим ModuleDeps в YREModuleFactory/UserOfferForm):
```ruby
pod 'YREModuleBuilder/Chats'
pod 'YREModuleBuilder/Workspace'
pod 'YREModuleBuilder/PlacePicker'
pod 'YREModuleBuilder/UserOfferPhoto'
```

## Q/A

Q: Почему это не target в основном проекте?<br/>
A: Изоляция от основного проекта:
  * низкий риск что-то сломать – случайно не пролить в основной проект экспериментальные изменения
  * чистое окружение – исключить влияние окружения основного проекта
  * вскрывает проблемы внутри зависимостей и между зависимостями
  * просто откатывать изменения
  * UI-тесты и unit-тесты основного таргета не модуляризованы и тянут лишнее, проще работать с меньшим объемом кода
