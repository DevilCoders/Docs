### Рассылка о показанных адресах пользователя, сбор данных

#### Задача
Для каждого пользователя посчитать, сколько раз созданные им в НЯК адреса выводились в результатах поиска в гео-приложениях. Создание адресов и их вывод в поиске ограничены каждый своим заданным периодом. Берем в расчет показ адреса в поиске, при котором пользователь кликнул на него или увидел этот адрес на карте.

#### Источники
* Geocube: логи запросов в геопоиск (https://yt.yandex-team.ru/hahn/navigation?path=//home/geosearch-prod/geocube&)
* Origin whitelist: значения origin, которые генерируют пользователи (//home/maps/core/nmaps/production/mailing/geocube_human_origin_white_list)
* Users dump: список пользователей с их статусами (https://yt.yandex-team.ru/hahn/navigation?path=//home/logfeller/logs/nmaps-edits-log&)
* Nmaps edits log: лог правок пользователей (https://yt.yandex-team.ru/hahn/navigation?path=//home/logfeller/logs/nmaps-edits-log&)

Основными исходными данными являются логи Геокуба. Там собирается информация о поисковых запросов (как пользовательских, так и сервисных) и о кликах пользователей на поисковую выдачу. Для результатов запросов имеется информация об id объекта, к которому относится данный результат. Это позволяет выбрать интересующие нас объекты из всех поисковых запросов.

#### Обработка показов
Некоторые из запросов являются автоматическими, их мы отфильтровываем по известному списку типов запросов.

Каждый запрос в геопоиск хранит список результатов и информацию о взаимодействии с каждым элеметом. Имеется информация о кликах на каждый результат, а также геометрия области карты, которую увидел пользователь. Из этих данных мы можем составить список адресов, которые увидел кто-либо из пользователей. Одним уникальным показом мы считаем тройку (пользователь, поисковая сессия, объект-адрес).

Данный список соединяем с авторами данных адресов и агрегируем. В результате для каждого пользователя получаем число различных адресов этого пользователя, которые встречались в выдаче, а также общее число показова этих адресов.
