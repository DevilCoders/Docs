# Как использовать

Если кто-то что-то исправил в скрипте или ты им никогда не пользовался, то запускай сперва его в dry-run режиме на тестовом окружении!!
Тестов нет, сломаться может что угодно и лучше перестраховаться.

## Разбиение на чанки

Если список чеков в формате JSON содержит очень много чеков, что требует большого кол-ва времени, то можно поделить его
на чанки. Сгенерировать чанки можно, запустив `generate_chunks.py`. Скрипт ожидает наличие файла input.json.

## Обработка ошибок

Здесь нужно различать ошибки, вызванные самими чеками (если там не сходятся суммы) и ошибки, вызванные
временным сбоем в кассе. Скрипт `remove_success_from_input_file.py` решает эту проблему, создавая
копию input.json, в которой находятся только те исходные чеки, для которых не было успешного пробития
или не было ошибки сумм.

Скрипт сохраняет исходный input.json в копию автоматически, после чего перезаписывает его. Далее
нужно повторить генерацию чанков и их обработку. total_results.jsonl при этом удалять не надо.

## Генерация результатов

После нескольких итераций должны остаться только те чеки, у которых ошибка в суммах. Далее
нужно вызывать скрипт convert_logs_to_success_and_fail_parts. Данный скрипт генерирует два выходных файла:

* Файл успехов - то, для чего удалось выбить чеки коррекции.
* Файл ошибок - сюда помещаются те записи из total_results.jsonl, для которых не было впоследствии
успешного пробития. Поскольку записей об ошибках может быть несколько, для каждого trust_delivery_id сюда
помещается запись, которая шла в логе последней.


