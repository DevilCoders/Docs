Консольная утилита позволяет обработать сделки ICO, собрав исполняемый файл.

ya make
./ICO --input-filename "input file name" --output-filename "output file name"

Входной файл - форматированные сделки и отчёты, подтянутые из базы данных. По сделке счета из отчётов фильтруются по принципу "Включить, потом исключить из включенного".

В нужную колонку аналитики можно вписать "звёздчатый" фильтр, который будет считать, что на месте звёздочки может быть любая строка. Например, 505050 удовлетворяет фильтру 50*.
Все фильтры звёздчатые, кроме НУ - там могут быть значения 0-9, A-Z, *. 

Первая таблица фильтрации определяет весь период, вторая - предыдущий период, они работают независимо.

Заполнение формул в ячейках таблицы или пустых ячеек вне параметров и таблиц фильтрации приведёт к неопределённому поведению.

Параметры сделки, находящиеся сверху от таблиц, должны присутствовать все. Ячейку со значением можно оставить пустой.
