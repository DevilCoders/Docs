### Что делает сервис
Сервис выполняет композ писем (сборка eml), отправляет обычные письма, отложенные письма, сохраняет/удаляет черновики, проставляет метки отправленности. Логирует сделанное в user_journal.

### Импакт на пользователей от отключения сервиса
Не работает отправка писем и сохранение черновиков.

### Импакт остановки тачки/ДЦ
Балансер перенаправляет нагрузку на другие тачки/ДЦ, нагрузка на них возрастает пропорционально.

### Особенности деплоя
Особенностей нет. Катим сначала на канарейку, наблюдаем за приборами. Если все хорошо, продолжаем катить весь кластер.

### Критичные метрики
* [5xx](https://nda.ya.ru/t/2cLY79233VvJXQ)
* [4xx](https://nda.ya.ru/t/0spSlp8y3VvJYP)
* [Ошибки сохранения черновиков](https://nda.ya.ru/t/wT9-Sh023VvJYV)
* [/composeDraft](https://nda.ya.ru/t/eZabYFrq3VvZQe)
* [/composeMessage](https://nda.ya.ru/t/PuOuKZH93VvZR3)

### Куда ходит
#### База
Ходит и в MDB и в XDB.
* Получение папок
* Простановка меток answered, forwarded
* Удаление черновиков

#### blackbox
Ходим в ручку userinfo за информацией о пользователе по юиду. В случае ошибки ответим 500.
#### captcha
Ходим генерировать новую и проверять введённую пользователем капчу. В случае ошибки ответим 500.
#### reminders
Ремайндеры нужны для отменяемой и отложенной отправки. Есть новая и старая инсталяция ремайндеров. В новой создаются новые ремайндеры, из старой только удаляются перед установкой. Установка и удаление всех ремайндеров происходит с ожиданием ответа, кроме ремайндера о неответе. В случае ошибки ответим 500.
#### sanitizer
Засылаем только html-письма и получаем список инлайновых аттачей. В случае ошибки ответим 500.
#### settings
Получаем несколько настроек пользователя: дефолтное имя, дефолтный адрес, сохранять ли в отправленные. Если не получили ответ, то сфолбечимся к информации из паспорта или параметров запроса.
#### sharpei
Для получения шарда пользователя и определяем живость мастера. В случае ошибки ответим 410 или 500.
#### smtpgate
Отправляем письма (в т.ч. отложенные), сохраняем черновики, шаблоны. В случае ошибки ответим 500.
#### smiles
Ходим за файлами на статику. В случае ошибки ответим 500.
#### mulcagate
Ходим для сохранения и скачивания аттачей. В случае ошибки ответим 500.
