# Работа с Pytorch
Таски для работы torch необходимо наследовать от класса `market.monetize.stapler.v1.tasks.torch.TorchTask`

Особенности работы с torch заключается в том что весь исполняемый полезный код должен содержаться в методе `run_torch`.
Метод `run` не используется.

    Весь код ключая все импорты, даже logging.

Дело в том, что в момент построения графа происходит сохранение метода `run_torch` во внешний файл для передачи его на YT.
В `Nirvana` этот файл будет передан в специальный кубик `gpu_app_runner` где файл будет исполнен как внешний скрипт.

Это связано с тем, что сборка бинарного приложения включающего в себя библиотеки и зависимости длф torch и CUDA пока невозможен, поэтому используется такой нестандартный способ запуска кода.
Такой метод исполнения позволяет использровать внешнее окружение Job перации с настроеным `torch` и прочими библиотеками.
В свою рочередь это накладывает большое ограничение на использование модулей и библиотек в окружении скрипта run_torch.
Если вам требуется какая-то библиотека или модуль, то необходимо собрать новый `layer` для gpu_app_runner операции, а лучше обратиться к разработчикам `Stapler`

    Нельзя указывать импорт внешних зависимостей из проекта arc


