## Формирует ченжлог тикетов трекера, результат экпортирует на вики, шлет отбивку в телеграм чат

### Минимальный набор переменных окружения для запуска шедулера:
- **ISSUE_CHANGELOG_GEN_TOKEN** – токен для Трекера, Вики и Стаффа. Задаётся исключительно через созданием секрета `env.ISSUE_CHANGELOG_GEN_TOKEN` [Vault](https://sandbox.yandex-team.ru/admin/vault). Лучше запускать от робота.
- **QUERY** – фильтр Стартрека по которому ищем список тикетов. Например, `Queue: MARKETFRONT and Status: Open`.
- **FROM_DATE** - показывать изменения от даты. Формат `2021-11-01` или относительно текущего времени `+0d (/([+-]+)(\d+)([hwdm]+)/)` где w - week, d - day, m - month, h - hour;
- **TO_DATE** - показывать изменения до даты. Формат такой же, как у `FROM_DATE`
- **EXPORT_WIKI_PATH**- пусть для экспорта на вики. Если задать `test`, страница будет `https://wiki.yandex-team.ru/test`
- **EXPORT_WIKI_TITLE** - заголовок страницы на вики

### Опциональные переменные для сбора ченжлога
- **VERBOSE** - показывать в выводе id полей. Может помочь отсеять ненужные поля
- **IGNORE_CHANGES_BY** - отфильтровывать изменения по автору
- **IGNORE_FIELDS** - не выводить изменения указанных полей
- **GROUP_TICKETS_BY** - выводит иерархию тикетов, а не плоский список. Значение по умолчанию = `parent`
- **FETCH_SUBTASKS_BY_PROJECT_LINK** - получив проекты по `QUEUE` пробует достать подзадачи по полю `Project Link`. Значение по умолчанию = `1`
- **HIDE_LINKS** - не выводить изменение связей. Значение по умолчанию = `1`
- **IGNORE_TAGS_PATTERN** - не выводить изменения тегов по регулярке
- **CHANGELOG_SIZE** - сколько событий ченжлога запрашивать (с конца) из трекера на каждый тикет, по умолчанию 50, влияет на скорость шедулера, если нужно за день лог, то стоит уменьшить, хотя бы до 25.

### Опциональные переменные для телегам бота
- **TG_BOT_TOKEN** – токен бота
- **TG_CHAT_ID** – id чата
- **TG_MESSAGE_TEMPLATE** - сторока шаблон lodash template, доступные переменные: `wikiUrl` - адрес вики страницы, куда произошёл экспорт ченжлога
- **PARSE_MODE** - стилизация сообщения бота. `Markdown` или `HTML`. По умолчанию `Markdown`

Больше опций поддерживается используемой библиотекой [issues-changelog-generator](https://github.yandex-team.ru/crewman/issues-changelog-generator), при необходимости их использования можно их поддержать в этом скрипте.
