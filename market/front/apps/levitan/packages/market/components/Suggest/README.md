# Компонент Suggest

## Отличия от b2b-компонента

В большей части компонент market/components/Suggest - копипаста b2b/components/Suggest на 2022-07-05.
Но есть и отличия:

1. Suggest из market дополнительно проксирует в TextField пропсы label, labelInside, size, mask, TextField.
2. Suggest из market имеет читаемый displayName.
3. Suggest из market поддерживает trigger = "focus", "hover-focus", "click", а не только trigger="click"
4. Suggest из market отображает выпадающее меню сразу после того, как пользователь ввел что-то в поле ввода (вызов метода showPopover)
   Компонент из b2b не будет отображать меню, если пользователь выбрал элемент мышкой или через Enter и начал менять значение.
5. Suggest из market имеет собственные стили Popover, которые не имеют дополнительных паддингов.
6. Suggest из market не наследуется от market/Select, но самостоятельно поддерживает core/Select.


## API

Обязательные пропсы:
- `value` или `valueLabel` - значение в поле ввода.
- `onChange` - обработчик события на изменение в поле ввода.
- `onSelect` - обработчик события выбора элемента из выпадающего меню.
- `children` - содержимое выпадающего меню.

## Конфигурация

Для наглядности см. примеры в index.mdx в market и b2b.

### Поиск
Поиск по введенному значению и отображение результатов выполняется во внешнем коде родительского компонента.
Для корректной работы необходимо:
1) подписаться на событие onChange - в обработчике события выполнить нужную операцию, 
**сохранить результаты поиска на стейт родительского компонента**.
2) Отобразить результаты в нужном виде через проп children компонента Suggest.
   
### Отображение результатов поиска

Для вида отображения по умолчанию можно использовать компоненты из components/OptionGroup:Option и
components/OptionGroup:OptionGroup.

Вы можете использовать кастомный шаблон отображения, но для того, чтобы компонент Suggest мог корректно
обработать выбор элемента (клики мышкой по элементам выпадающего списка или нажатия на стрелки клавиатуры), необходимо выполнить
следующие условия:

1. На элемент результата поиска добавить **атрибут role="option"**. (см getOption и getOptionNode в
core/components/OptionsController/OptionsManager)
2. На элемент результата поиска добавить **атрибут data-value**. Значение атрибута data-value будет приходить
первым параметром в [обработчик события onSelect](#выбор-элемента-из-результатов-поиска)
3. При переключении элемента с помощью стрелок клавиатуры OptionsManager навешивает **атрибут data-hovered="true"**
(см hoverNode в core/components/OptionsController/OptionsManager). Соответственно в стилях кастомного шаблона
отображения необходимо завязаться на **атрибут data-hovered="true"** для визуального выделения элемента,
на который переключились с помощью стрелок.

Необязательные условия:
1. На элемент результата поиска добавить **атрибут data-label**. Значение атрибута data-label будет приходить
вторым параметром в [обработчик события onSelect](#выбор-элемента-из-результатов-поиска)
2. При выборе элемента с помощью клика мышью или нажатием клавиши Enter на клавиатуре OptionsManager навешивает
**атрибут data-selected="true"** (см selectNode в core/components/OptionsController/OptionsManager).
Соответственно в стилях кастомного шаблона отображения необходимо завязаться на **атрибут data-selected="true"**
для визуального выделения выбранного пользователем элемента.


### Выбор элемента из результатов поиска

Для выбора элемента из результатов поиска необходимо подписаться на событие onSelect компонента Suggest.   
Событие генерирует OptionsManager. В событии прилетают:
1. Первый параметр - **значение атрибута data-value** с выбранного элемента.
2. Второй параметр - **значение атрибута data-label или textContent** с выбранного элемента.

## Архитектура компонента

Компонент Suggest унаследован от компонента Select. Компонент Select - выпадающий список с выбором одного значения.
Архитектура двух компонентов одинаковая, и единственное значимое отличие заключается лишь в том, что Select в качестве
Controller использует компонент кнопки, в то время как Suggest в качестве Controller использует компонент поля ввода
(TextField)

> Подробнее об архитектуре компонента Select можно узнать из соответствующего README (market/components/Select/README.md).

