# Получение информации о похожих товарах  (resolveSimilar)

**Request:**
```js
{
  "params": [
    {
      "hid": 91491, // id категории
      "skuId": "100131945205", // оно же msku-id, market-sku и т.д. Cтрока по паттерну [1-9]\d*
      "productId": 14112311, // необязательный параметр

      /**
       * Снепшот корзины для прайсдропа
       *
       * Необязательный параметр, по умолчанию []
       */
      "cartSnapshot": [
          {
              "sku": "sku",
              "wareMd5": "wareMd5",
          }
      ],

      /**
       * Из айтемов корзины выбирает те,
       * которым по всему сервису нужно отображать скидку прайсдропа
       *
       * Необязательный параметр, по умолчанию true
       */
      "useCartPriceDropMark": false,

      /**
       * Номер страницы в запросе
       *
       * Необязательный параметр, по умолчанию 1
       */
      "page": 1,

      /**
       * Кол-во результатов на страницу в запросе
       *
       * Необязательный параметр
       *
       * По умолчанию сейчас внутри в resolveAlsoViewed передаётся pageSize - 20,
       * а в resolvePrime - 24 (его вызываем, если в resolveAlsoViewed 0 результатов)
       */
      "pageSize": 5,
    }
  ]
}
```

**Логика работы хэндлера:**
1. Если не передан `productId`, запрашиваем у репорта `sku` по `skuId` через плейс `sku_offers`. И из данных по `sku` получаем `productId`
2. Запрашиваем товары, которые "также смотрят", у репорта через плейс `also_viewed` (резолвер `resolveAlsoViewed`). Если там пришли какие-то результаты, возвращаем их (предварительно нормализуя)
3. Если в `also_viewed` нет результатов, запрашиваем товары из той же категории у репорта через плейс `prime` (резолвер `resolvePrime`), прокидывая `hid`, и возвращаем нормализованный результат

**Примеры ответа:**
1. [если возвращается ответ resolveAlsoViewed](https://paste.yandex-team.ru/2161221)
2. [если возвращается ответ resolvePrime](https://paste.yandex-team.ru/1849332)

Понять, какой вариант ответа, можно по полю `label` в коллекции `searchResultSource`:
 - `resolveAlsoViewed` - `alsoViewed`,
 - `resolvePrime` - `prime`
