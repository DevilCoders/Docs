# Резолверы включения флагов миграции репорта

Включают переопределение хоста репорта флагом на s3. Сделано для проекта backbone в ожидании админки конфигов

## Как?

На `s3` заведен файл JSON, в котором прописаны возможности для отключения
- Конфиг учитывает раскатку по ДЦ и хостам
- Конфиг _асинхронно_ кешируется в памяти инстанса, и достается _синхронно_ также из кеша
    - Т.е. после обновления конфига в s3 пройдет некоторое время, пока он раскатится по процессам
    - Доступ к конфигу в коде осуществляется синхронно

## Пример конфига

```json
{
  "__notice": [
    "Любое изменение в этом файле должно согласовываться с @grumpy или @yuraaka",
    "Присутствует вероятность отрезать фронтенд Маркета от репорта. Действуй на свой страх и риск",
    "В `source` пишется искомая подстрока в названии хоста; в `target` <host>:<port>"
  ],
  "overrides": {
    "report": {
      "byHost": {
        "sas2-0243-52e-sas-market-prod--d06-23430.gencfg-c.yandex.net": [
          {
            "source": "warehouse-report.vs.market.yandex.net",
            "target": "eb.vs.market.yandex.net:17051"
          }
        ]
      },
      "byDc": {
        "vla": [
          {
            "source": "warehouse-report.vs.market.yandex.net",
            "target": "eb.vs.market.yandex.net:80"
          }
        ]
      }
    }
  }
}
```

## Как обновить конфиг?

Смотри в [readme.md](../readme.md) выше по файловой структуре
