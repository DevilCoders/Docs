Ассемблер - функция, которая в зависимости от типа виджета преобразует полученные для него данные в удобный для обработки на мобильных устройствах формат

Как работает новый стек.

1. На CMS описываются:
- виджеты
- их параметры (тайтл и т.п.)
- куда ходить за данными для виджета (какие резолверы)
- или статические данные. Например дисклеймер (который в самом низу). Он одинаковый для всех товаров. Еще могут быть баннеры или популярные категории.
- ассемблер, который обрабатывает полученные данные и отдаёт в нужном формате для мобилок

2. На ФАПИ:
- ходит в резолверы за данными
- преобразует данные в формат, нужный мобилкам (в ассемблерах)
- добавляет события аналитики (в какой момент слать, каким транспортом слать, посылаемый json)
- добавляет параметры для действий (переходов, нажатий на кнопки)
- даже если данные заданы на CMS, эти данные попадают в ассемблер, чтобы например сгенерить аналитические события на них
- когда для данных, заданных в cms, описан ассемблер - мы прогоняем их через него, иначе отдаем как пришли в массив content

3. На мобилках
- получили виджеты
- отрисовали
- при нажатиях, берём параметры, которые пришли с ФАПИ и выполняем действие с этими параметрами
- полученные события аналитики отправляем, когда прописано

Текущая страница КТ на CMS
http://templator.vs.market.yandex.net:29338/tarantino/getcontextpage?device=phone&domain=ru&format=json&qualifier=mobile_scheme_product_card&type=apps_common_page&zoom=full

Пример ответа ФАПИ на морде
https://paste.yandex-team.ru/7923418

**ТОЛЬКО ДЛЯ КТ!**
Из ассемблера всегда возвращается объект
{content: [], widgetParams: {}}
content -- все, что должно лежать в массиве content
widgetParams -- все остальные поля, которые должны быть вынесены на уровень виджета


Что еще важно знать:
1. (ДЛЯ МОРДЫ) Все данные из cms приходят в полях виджета, все данные из ресурсов складываются в массив content;
2. Мобилки вообще не знаю про ресурсы и не должны о них знать;
3. Ресурсы могут быть разного типа (группа резолверов, статически json, может еще тип со временем придумается);
4. У некоторых ресурсов могут быть ассемблеры, это свойство самого ресурса (например, из ответа фапи всегда нужно собрать модельку для мобилок, а для статики - это не всегда нужно).
5. так как ассемблеры могут брать данные как от ответов резолверов, так и готовые данные из cms, мы передаем в ассеблер такой объект, что:
- в поле resolvers лежи ответ от резолверов
- в поле staticContent лежат статические данные из поля content у виджета
- в поле cmsData лежат дополнительные данные для ассемблера(для аналитики): виджет, регион, тип ассемблера, id изначальной cms-страницы
пример статических данных:
type HotlinksStaticData = {
    staticContent: {
        type: string,
        deeplink: string,
        title: string,
        imageUrl: string,
    },
    cmsData: {
        type: 'HotlinkSnippet',
        widget: Widget,
        cmsPageId: CmsDeclarationId,
    },
};
пример данных от резолвера:
type ArticlesAndModelsData = {
    resolvers: {
        resolveArticlesAndModels: {
            result: VisibleEntityId[],
            collections: VisibleEntityCollection & ArticleCollections,
        },
    },
    cmsData: {
        type: 'ArticleSnippet',
        widget: Widget,
        cmsPageId: CmsDeclarationId,
    },
};

