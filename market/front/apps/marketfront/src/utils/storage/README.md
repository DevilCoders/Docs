LocalStorageProvider
=

Класс для работы с localStorage. Позволяет кэшировать сущности и синхронизировать
коллекции между вкладками.

При создании инстанса указывается имя коллекции,
это соответствующее поле в localStorage, в него мы пишем и по этому имени фильтруем
storage events.\
Также указывается функция-валидатор для сущности и функция-"определятор протухания".
Последняя — опциональная.

Зависимости
-
* `local-storage` — обертка над Storage API с фоллбеком в объект.

Что умеет:
-
* Инициализировать поле новыми данными, удаляя все, что было раньше.
* Чтение (get) происходит из закэшированного объекта. При наличии изменений сначала сохранит
все, что есть, а затем вернет значение. Можно получить все имеющиеся данные через
getFullCollection
* Запись (set/remove) — отложенная.
Имеется очередь изменений, каждое изменение хранит время. Сохраняется по вызову save
или get/getFullCollection, синхронизируя изменения по времени.
* Реагирует на storage events, перезаписывает закэшированный объект при внешнем
изменении, синхронизируясь с текущими изменениями.
* Для передачи изменений наружу есть RxJS Subject (storageEventStream) c изменениями,
на который можно подписаться.
* При какой-либо ошибке с localStorage/отсутствии блокируется, все методы возвращают
дефолтные значения.
* Валидирует сущности и проверяет тухлость в каждый момент обновления извне и первоначальной
инициализации (во время создания объекта).
* Смотрит в версию приложения. Если валидация поля не прошла, а версия изменилась, хранилище
не будет изменено, а класс заблокируется как при ошибке. Это сделано, чтобы в момент раскатки
релиза (<=100%) с изменениями по схеме сущности и валидации у пользователей не возникало
сайд эффекта в виде бесконечного цикла перетирания хранилища "на свой лад" при переключении двух
конкурирующих вкладок с разными версиями и схемами валидации.
* Изменения с хранилищем, происходящие извне (с других вкладок/окон) применяются только в момент
видимости страницы, чтобы не расходовать ресурсы неактивными вкладками. Используется Page Visibility
API с фолбэком на события focus/blur.
