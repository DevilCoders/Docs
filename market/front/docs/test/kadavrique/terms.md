# Терминология

Для того, чтобы проще понимать написанное далее в разделах, связанных с Кадавриком, следует определиться с терминологией.

## Сервер

[Node.js http server](https://nodejs.org/api/http.html#http_class_http_server), принимающий и обрабатывающий запросы к API Кадаврика и API моков.

**API Кадаврика** - набор URL-адресов, при обращении к которым осуществляется управление внутренним состоянием Кадаврика (работа с сессиями и стейтом).

**API моков** - отдельный тип запросов со специфичными заголовками, за обработку которых отвечают моки бекендов. Собственно, API моков и эмулирует поведение реальных бэкендов.

## Сессия

Период времени, в течении которого выполняется тест. Одновременно - и изолированный namespace, в рамках которого создаются и редактируются данные, необходимые для работы моков.

Например, пользователь, созданный в каком-то моке, в рамках одной сессии не будет доступен из другой.

У каждой сессии есть свой **идентификатор**.

## Мок

Класс, наследует от базового класса [Mock](https://a.yandex-team.ru/arcadia/market/front/apps/kadavrique/src/Mock.ts) и реализует фиктивную бизнес-логику реального бекенда. Экземпляр класса создается при первом обращении к одному из его методов и существует в рамках текущей сессии.

Примеры моков можно посмотреть [здесь](https://a.yandex-team.ru/arcadia/market/front/apps/kadavrique/src/mocks) и [здесь](https://a.yandex-team.ru/arcadia/market/front/apps/kadavrique/mocks).

## Конфиг моков

Конфиг файл, который описывает, какой запрос в бэкенд в какой мок и в какой его метод следует перенаправить.

Выглядит это [так](https://a.yandex-team.ru/arcadia/market/front/apps/kadavrique/options/mocks.js).

## Стейт

Хранилище данных, соответствующее текущему состоянию приложения. Стейт привязан к сессии. Стейт может быть инициализирован и изменен как со стороны мока, так и со стороны теста.

Пример изменения стейта Кадаврика: мы мокаем запросы на создание нового отзыва о товаре и на получение отзывов. В моке при создании нового отзыва - добавляем его в стейт, чтобы далее вернуть отзывы из стейта при запросе на получение отзывов.

## Объектная модель, сущность

Модель данных, которую используют реальные бекенды в ответах на запросы по API (продукт, категория и т.д.).

**Фабрика сущности** - функция, которая возвращает сгенерированную сущность на основе её микроформата с применением пользовательских значений для её полей.

**Микроформат сущности** - описание структуры сущности в формате JSON Schema. Декларации (микроформаты) всех сущностей находятся в репозитории микроформатов.

На настоящий момент взят курс на удаление генерации на лету моковых данных по микроформатам (в схемах зачастую бывает oneOf и другие параметры, вносящие энтропию в тесты, что приводит к их нестабильности), однако в старых моках это может встретиться.
