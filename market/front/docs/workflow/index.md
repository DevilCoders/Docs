# Рабочий процесс

Данный документ описывает рабочий процесс во фронтенде всех сервисов Маркета: Arcadia, Sandbox, StarTrack, Arcanum, код-ревью, тестирование, деплой.

## Памятка разработчику

### Перед тем, как приступить к задаче
*Работа над задачей начинается с [трекера](https://wiki.yandex-team.ru/tracker). Если ты первый раз слышишь о таком, то вот тебе [Руководство по Трекеру](https://wiki.yandex-team.ru/tracker/vodstvo/) или вот тебе [Видеокурс](https://www.youtube.com/playlist?list=PLjEKjSpX1kHVJ2Bew2Xp99c7pty0ksbj-).*

1. Убедись, что задача ещё актуальна. Признаками устаревшей или уже выполненной задачи могут быть: допотопная дата создания, наличие коммитов, большое количество комментов.
2. Внимательно ознакомься с требованиями. Они должны быть описаны в тикете или в вики (в тикете ссылка), иметь четко сформулированные критерии готовности и не допускать двоякого толкования. Если по требованиям возникли вопросы, лучше перевести тикет в "Требуется информация" и эти вопросы задать.
3. Определи "масштаб" задачи и исходя из него прими решения по следующим пунктам:
   1. Требуется ли привлечение тестировщика на ранних этапах - актуально для больших проектных задач или фундаментальных изменений в сервисе. Если требуется, то договорись о назначении ответственного тестировщика и введи его в курс дела.
   2. Где лучше хранить и актуализировать требования? Для долгоживущих задач лучше создать страницу в вики и там вести обсуждения и фиксировать изменения по ходу разработки.

### Разработка задачи
1. **Переведи тикет в статус "В работе"**. Не забываем этот шаг, т.к. он выполняет функцию оповещения заказчика о начале работ, а также позволяет в каждый момент времени посмотреть текущие задачи разработчика.
2. Обнови основную ветку разработки и для каждого репозитория, задействованного в задаче, создай новую ветку. Пример "хороших" имён веток: `MARKETFRONT-12345-card-redesign`, `MARKETFRONT-4321-checkout-bugfixes`.
`(trunk=) $ arc checkout -b MARKETFRONT-7345-test-feature`. Подробно процесс работы с Arcadia описан в разделе [{#T}](arcadia-flow.md).
3. Выполняя задачу, добавляй в commit-message номер тикета из стартрека `MARKETFRONT-123: поправил запятую`. Благодаря этому, в истории кода легко находится задача, в рамках которой код менялся. Также все коммиты, сделанные в рамках тикета можно будет увидеть в стартреке и стаффе во вкладке "Коммиты".
4. Время от времени (можно ежедневно) актуализируй свои ветки относительно основной ветки согласно правилам работы с ветками (выше);
5. Разработка задачи завершается PR`ом в основную ветку разработки:
   1. заголовок обязательно должен содержать идентификатор тикета, по которому велась разработка. Например: `MARKETFRONT-123: проект такой-то`.
   2. PR должен проходить все включенные на данный момент валидации (unit-тесты, codestyle);
   3. в описании следует указать информацию о задаче и особенности, которые важны для проведения код-ревью;
6. Как только, по твоему мнению, разработка задачи завершена, укажи в тикете необходимую техническую информацию (зависимости от бэкендов, необходимость патчить конфиги и т.д.) и переводи задачу в статус **Need Code Review**. Проверь, что к задаче подцепился PR из Arcanum.
7. Дальше идёт [код-ревью](https://wiki.yandex-team.ru/Market/frontend/workflow/codereview).
8. После успешного прохождения код-ревью задача будет автоматически переведена в статус **Resolved** (**Решен**). Проверь, что в тикете указана вся необходимая для тестирования информация, собраны нужные стенды, в PR-е прошли все актуальные проверки,  и переводи тикет в статус **Ready for check** (**Можно проверять**), чтобы тестировщики знали, что задачу нужно взять в проверку. При переводе в тикета в проверку автоматически запустятся автотесты. Проследи, чтобы не было падений, вызванных твоими изменениями. Если тесты упали в твоей задаче, их нужно починить. Если тесты не запустились, можно запустить их по ссылке из твоего PR-а.
9. Если тестировщик найдет ошибки в твоей задаче, он переведет ее в статус "Есть замечания". Чтобы их исправить, нужно вернуть задачу обратно в работу и заново пройти цикл до статуса **Можно проверять**.
10. После успешной проверки задачи тикет нужно перевести в статус  **Ждет релиза** - так релизная команда узнает, что его нужно будет забрать в ближайший релиз. Скорее всего, это сделает тестировщик, проверяющий твою задачу. Добавься в [релизный чатик](https://t.me/joinchat/AtTuIlhx6DjWCUG3CclSAQ ) - если с твоей задачей будут какие-то сложности (упавшие проверки, конфликты при мерже), там тебя призовут для починки.
11. После успешной проверки в составе релиза твоя задача будет выкачена в прод, а код в составе релизной ветки вмержен в мастер. Тикет закроется автоматически.

### Эксперименты

[{#T}](experiments.md)

### Код-ревью

[{#T}](codereview.md)

### Тестирование

[{#T}](testing.md)

### Дизайн-ревью
Процесс дизайн-ревью в данный момент не имеет своего конкретного места в pipe-line решения задачи (потому что требуется меньшинству задач), поэтому на усмотрение разработчика дизайн-ревью проводится либо после написания кода, либо после code-review, либо после тестирования.
Лично я (@e-abbakumov) советую проводить дизайн-ревью как можно раньше, желательно еще до code-review.
Потому что правок от дизайнеров может быть очень много и код придется проверять и тестировать еще раз.

Как проводить дизайн-ревью? Собираем стабильный стенд и отправляем его дизайнеру. Дизайнер смотрит и присылает нам правки, мы все исправляем.
Если правки расходятся с тем, что написано в спеке или отражено в макетах – попросите дизайнера проактуализировать информацию в документах, чтобы эти дизайн-правки не возвращали вам тестировщики.

### Релизы
[{#T}](releases.md)
