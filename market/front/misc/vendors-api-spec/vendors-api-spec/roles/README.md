# Ресурс /roles

## GET /authoritiesByVendor/[target_uid]/

Получение данных о ролях текущего пользователя UID={target_uid}, с перечислением id вендоров, для которых выдана роль

### Примечания
  - **target_uid** `<UID>` пользователя для которого идет запрос
  - Используется в админке и для различения пользователей по ролям и доступам к услугам
  - Ручка доступна только менеджеру

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация

### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **roles** `Map<String, Array[Long]>` - словарь из имен ролей в список айдишников вендоров, список имен ролей [перечислен тут](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)

## GET /authorities/[target]/vendor/[vendorId]

Получение списка ролей roles пользователя с UID={target} или Login={target} для вендора с айдишкой vendorId

### Примечания
  - **target** `<Number|String>` - UID или логин пользователя для которого идет запрос на получение списка ролей
  - **vendorId** `<Number>` - ID вендора
  - Используется в админке
  - Ручка доступна только менеджеру и администратору

### Параметры
  - **uid** `<Number>` - UID пользователя от которого идет запрос, авторизация
  
### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **roles** `<Array[String]>` - список ролей, варианты [перечислены тут](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)

## GET /authorities/uids/vendor/[vendorId]/role/[role]

Возвращает список uid-ов пользователей обладающих указанной ролью для заданного вендора

### Примечания
  - **vendorId** `<ID>` вендора
  - **role** `<String>` имя роли, которая может быть назначена через кабинет вендора или менеджера, подмножество [этого списка](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - Используется в админке и при создании/редактировании карточки вендора
  - Ручка доступна обоим менеджерам, администратору и пользователю с доступом к настройкам

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация
  
### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **users** `<Array[Object]>` - список юзеров
        - **uid** `Number` - User ID
        - **login** `String` - Логин из паспорта
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)
#### [Неверные параметры вызова](https://github.yandex-team.ru/market/vendors-api-spec#Неверные-параметры-вызова)
  - Попытка вывести uid-ы для роли, которая не редактируется через API
  
## PUT /authorities/uids/vendor/[vendorId]/role/[role]

Устанавливает список uid-ов пользователей обладающих указанной ролью для заданного вендора

### Примечания
  - **vendorId** `<ID>` вендора
  - **role** `<String>` имя роли, которая может быть назначена через кабинет вендора или менеджера, подмножество [этого списка](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - Ручка выдает роль для пользователей, переданных в данных и отнимает роли у прочих. 
  - Используется в админке и при создании/редактировании карточки вендора и работает по принципу "все или ничего": либо всему набору переданных пользователей будет установлена роль, либо, в случае возникнования ошибок, сохраняется текущий набор.
  - Ручка доступна менеджеру, администратору и пользователю с доступом к настройкам

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация
  
### Данные
  - **logins** `<Array[String]>`: список логинов или uid пользователей, которые должны иметь данную роль.

  
### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **users** `<Array[Object]>` - список юзеров
        - **uid** `Number` - User ID
        - **login** `String` - Логин из паспорта
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)
#### [Неверные параметры вызова](https://github.yandex-team.ru/market/vendors-api-spec#Неверные-параметры-вызова)
  - Попытка назначить или отнять роль, которая не редактируется через API (These roles can't be granted or revoked programmatically via API)
  - Попытка назначить или отнять админскую роль с авторизацией отличной от менеджера или саппорта(Admin role can be granted or revoked by manager or support only)
  - Редактирование роли для UID от лица того же UID (UID can't grant or revoke own roles)
  - Попытка выдать роль для вендора, не пользующегося соответствующей услугой (These roles can't be granted to vendor without corresponding product)
  - Попытка выдать роль, которая пока не поддерживается соответствующей услугой
#### [Нет такого вендора](https://github.yandex-team.ru/market/vendors-api-spec#Несуществующий-объект-данных)
  - Попытка выдать роль для несуществующего вендора (Vendor with specified ID not found)

## PUT /authorities/[target]/vendor/[vendorId]

Добавление списка ролей roles пользователю с UID={target} или Login={target} для вендора с айдишкой vendorId

### Примечания
  - **target** `<Number|String>` - UID или логин пользователя для которого идет запрос на добавление прав
  - **vendorId** `<Number>` - ID вендора
  - Используется в админке и при создании/редактировании карточки вендора
  - Ручка доступна только менеджеру, саппорту и администратору, причем администратор не может назначать роль администратора

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация
  
### Данные
  - **roles** `<Array[String]>`: список ролей, может содержать [такие строки](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)

### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **status** `<Boolean>` - как прошло добавление, по факту если не было исключений, то всегда будет возвращаться true
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)
#### [Неверные параметры вызова](https://github.yandex-team.ru/market/vendors-api-spec#Неверные-параметры-вызова)
  - Попытка назначить или отнять роль, которая не редактируется через API
  - Попытка назначить или отнять админскую роль с авторизацией отличной от менеджера или саппорта
  - Редактирование роли для UID от лица того же UID
  - Попытка выдать роль для вендора, не пользующегося соответствующей услугой
  - Попытка выдать роль для несуществующего вендора
  - Попытка выдать роль, которая пока не поддерживается соответствующей услугой

## DELETE /authorities/[target]/vendor/[vendorId]

Удаление списка ролей roles пользователю с UID={target} или Login={target} для вендора с айдишкой vendorId

### Примечания
  - **target** `<Number|String>` - UID или логин пользователя для которого идет запрос на удаление прав
  - **vendorId** `<Number>` - ID вендора для которого идет запрос на удаление прав
  - Используется в админке и при создании/редактировании карточки вендора
  - Ручка доступна только менеджеру, саппорту и администратору, причем администратор не может удалять роль администратора

### Параметры
  - **roles** `<String>`: строка со списком ролей в виде перечисленных через запятую следующих возможных строк [отсюда](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация
  
### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **status** `<Boolean>` - как прошло удаление, по факту если не было исключений, то всегда будет возвращаться true
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)
#### [Неверные параметры вызова](https://github.yandex-team.ru/market/vendors-api-spec#Неверные-параметры-вызова)
  - Попытка назначить или отнять роль, которая не редактируется через API
  - Попытка назначить или отнять админскую роль с авторизацией отличной от менеджера или саппорта
  - Попытка отнять роль для несуществующего вендора
  - Редактирование роли для UID от лица того же UID

## GET /authorities

Получение списка всех возможных ролей пользователя

### Примечания
  - Используется в админке для того чтобы выбирать роли для выдачи из списка всех ролей
  - Ручка доступна всем - гостевой доступ

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация

### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **roles** `<Array[String]>`: список ролей, может содержать [такие строки](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#authorities)
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)

## GET /permissions

Получение списка всех возможных разрешений пользователя

### Примечания
  - Может использоваться в админке, но на данный момент нужно для целей контроля совместимости бекенда и фронта
  - Ручка доступна всем - гостевой доступ

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация

### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **permissions** `<Array[String]>` - список разрешений, сейчас может содержать строки [отсюда](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#permissions) 
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)

## GET /permissionsByVendor/[target_uid]

Получение данных о разрешениях пользователя со списком вендоров для которых они выданы

### Примечания
  - **target_uid** `<UID>` пользователя для которого идет запрос на определение доступных разрешений
  - Используется фронтом для определения к каким разделам, страницам или табам есть доступ у пользователя по конкретным вендорам
  - Ручка доступна всем - гостевой доступ
  - Пустой список вендоров является валидным значением для разрешения и указывает на распространение разрешения на всех существующих вендоров, например, в случае кабинета менеджера

### Параметры
  - **uid** `<UID>` пользователя от которого идет запрос, авторизация

### Ответ
  - **meta** `<Object>`
  - result `<Object>`
    - **item** `<Object>`
      - **permissions** `Map<String, Array[Long]>` - словарь из имен разрешений в пустой или непустой список айдишников вендоров (см. "Примечания"), имена разрешений [перечисленные тут](https://github.yandex-team.ru/market/vendors-api-spec/tree/master/roles/enums#permissions)
  - errors `<Error[]>`

### Ошибки

#### [Стандартные](https://github.yandex-team.ru/market/vendors-api-spec#Стандартные-ошибки)
