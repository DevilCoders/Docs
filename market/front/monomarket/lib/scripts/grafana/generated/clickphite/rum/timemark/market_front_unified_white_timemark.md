# rum/timemark/market_front_unified_white_timemark
    
## Common properties

  * **Owner:** `marketfrontend`
  * **Table:** `timemark`

## Splits

```json
{
    "service_white": "multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' )",
    "pageId": "arrayJoin(['any-page', replaceAll(page, ':', '_')])",
    "buckets_start": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_end": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_duration": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_init": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_dcl": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_ready": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_long-task-all": "if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all)))",
    "buckets_long-task-self": "if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self)))",
    "buckets_long-task-unknown": "if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown)))",
    "buckets_fp": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_fcp": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_lcp": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "buckets_llep": "if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time)))",
    "expFlags": "replaceAll(arrayJoin(exp_flgs), '=', '_'))",
    "region": "replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_')",
    "browser": "concat(browser_name, '-', browser_version_major)",
    "requester": "arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ])",
    "testId": "arrayJoin(test_ids)"
}
```

## Filters

```json
[
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint'",
    "environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint'",
    "environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint'",
    "environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint'"
]
```

## Resulting metrics

  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}`](#025a4b67122cfdd3bb0902bd9e87b5d6)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#60448dded2f5a7e9e94c323a04683de9)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}`](#97f10386ac281ed73be06674bed19862)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#03ad17da3024a54bf611256901a582f3)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}`](#59c056a53e1a8e9e85d28fcc6bc6c9e1)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#c4972a3649e3fe81474c485d57939afd)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}`](#51e6660d633e75462536d5164053ced8)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#bb88da60524104647d718af58ea2cd02)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}`](#57acdbc560250cae0b27b55b64bd3b08)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#6746c562d68b07579671a8d00b743a49)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}`](#04765d46f6bf443ca57619d05b0e1d92)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#c9c0157def42d8d84266bbb29da4749d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}`](#35b1a75121ddc5591c3581f11fbfc9fe)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.quantiles`](#fe6bc32ee9f91c1879f7aeecef134b1d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}`](#f9f8a90c219397c4a85e8119665ed921)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.quantiles`](#9252a88385409e28fdfae59074d9b0fb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}`](#b905c5b8b51708c7489fb2b48bd63e5d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles`](#bfeb8930fca4d84bcc1082b9e0beb39c)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}`](#503ac274b1511d36f6b4faaf0a6c84f0)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.quantiles`](#4101446590cac1d8cac28a0da1ea6aa1)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}`](#066cbb5917a4fd345f8b95becd2cecd1)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles`](#3e6d053fcc529fb30c837b2cfcfaf18f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}`](#db4a2d2d87abdd1f0484296ec2db6c12)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.quantiles`](#8b3b2d846af65644cd3863a63da10d81)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}`](#314ed22398de81945ab3b56583186d81)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#ea988a4f661c6d562028aa761983c1c3)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}`](#df42fc7e203ec8df227890ef904a1a73)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#1dd8019845d779066d61f6aebf0c742b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}`](#1a9f4b4e38aaadbef54f0e1f87a17c29)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#cddcd49d5e5e23c7d0349925316c7880)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}`](#aa4477cca2c69babf4116a8caad06482)
  * [`market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.quantiles`](#d2ee80f4b8c17a614636cff6f3e0faf4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#41495689747ec833a8183d728b251c97)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#b463b634d82f32c0206bcbeb33dd4858)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#d49a67f67a3b594ef976dce0be8a9aa3)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#f1cd12961cbd8c6f8136893efe495f13)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#3c5f76022baa5503b9021cca0b4de117)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#88c73732d2bfe78c138fa1a6304a894b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.dcl.quantiles`](#5c8ce10d4ed2bc18099dfdea5ef335be)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.init.quantiles`](#5aea6ca1bb6faa411d6074fe8edd2bab)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles`](#a49f5069e79a1f468e76279908c773c3)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles`](#90fafc1a6ce5f34ac1dbaf3e9190ba7b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles`](#729cdfc558ca5d48df6b5c6cb0544917)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles`](#975786194fa3ee096c62db6ec9c101b9)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#ff58481727765e2508bc44c8be4481e4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#83f99c95a2895ab1376a4144acefb5b7)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#91a96180b1a08143dbf976d31a0d10b0)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles`](#af5af4106d9822f06d98bce45eb95977)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#2aae2cdc8e448f624e9dcafb60009e97)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#b3041d1a9a5287064118bac7f68f8e06)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#9c9bcf1ad02099b350af7eb614a08587)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#f5c6819a996822fb4432ba4879aac570)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#022f37ef5e670b23e2578bd35737e5fd)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#b2320838f380727488664498f55e55bc)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.dcl.quantiles`](#ef9d9e4d9c3335c8e7ec76faaf547bfc)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.init.quantiles`](#7843ab07f0b3fa94eca6b55fe0f7e5e3)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fcp.quantiles`](#2b28ae9928f9c9dcb3b8e4b20966cbbe)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fp.quantiles`](#94e61e2b3e0e7366a91e9d51a8a215f4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.lcp.quantiles`](#4c601e9ed743c8fafd36b6f5b9545fcb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.llep.quantiles`](#2a5bcc6b485e33ec9c7b2e0928808898)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#3effa813a26549342c6482404734be95)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#f2786d3cf87207c168ffcf61bea0dca2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#10db33639c64ec40bedfc296b535f3e2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.ready.quantiles`](#02cebd16b8f0826d154f64692a456909)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}`](#57d09c94e41eb9744400502cd07b2021)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#3b63613d5962f50814f7779ae09288e6)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}`](#ca52f59f4b8a3f06b6760b6607093348)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#2b511beb5db7250d99ff46a1240b2640)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}`](#9b87a1431e85ec602daad692d2dd8fd2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#7c91f625daf93a6811b85cf03dd64fc4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}`](#77b8d691a05981c4a11ad974bbb5b372)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#3b38563b5cec2439bdea5a20f6d3fbaf)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}`](#a61ab76fb1710dfd1b72f5ab962a9ff4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#0e4dbfd329b2ffe2c4914cd8e26ec9c8)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}`](#60f545f2d6a7e437a23e948f89f8d79a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#36070b89b22a2e12426bc27a47367eeb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}`](#08cdf010aaa20648ee1054cb4f3828f8)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.quantiles`](#96f50c2d72b5d44a52b6d3616a316a11)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.buckets.${buckets_init}`](#0e9a4ee0a6cc9b67a88ee97d986330b5)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.quantiles`](#014d5b97dd549abf948c64d772c08d2b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}`](#7c934259ebd05693e59846a1f4a97225)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.quantiles`](#b4c2254a0334fe019414f607353a247b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}`](#5cf7cdde300af943f623d64d3a0a614f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.quantiles`](#3bfc409411d9d8ae2e6aa3378248d212)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}`](#061aed3788c81063e06e3e1aeabad5d4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.quantiles`](#e12d1e6e2b849f43159a890e0db6a6fc)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}`](#89e52b46e469c420f681bea7fc56ee03)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.quantiles`](#4a233adc4292012801b3d1f0d56ed63e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}`](#636225f5e6b899c5dabd2e7ef692279f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#3d9654eab58c37f032b53852f9c1e4e4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}`](#4a03afe51bc1a4963b4788fc26fe3fbb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#f82be4815757aeeafc0b70f0b75911ae)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}`](#a6b8e932d5b0ca0b11b3ee653bae5989)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#f927bf60e893e2b981ab1e77f004d9dc)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}`](#ce22f61ff69b534d51e0c657c7a40eee)
  * [`market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.quantiles`](#1ac9e2fd2807ec9253f664f6ab4ab73c)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}`](#468112fd9f5de708441498043e3a3152)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#8dfdce4daaf35d48d4ad6234f5364748)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}`](#76376037c0983c49a97430a7be3a42b4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#7fe024b357481a49a666951e476411a2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}`](#cf8f5b0065ef2ef2b6382254cb1f4305)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#78705f66fe78aefd40bd63abb7d2474a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}`](#ff0fa5a8fdfa39d85986ae8e31c5a108)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#f4006c53afd806ccf303e3fba04ae021)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}`](#e088d0e677c4bf41ecde7f3eef09632e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#08fe43f3b9c692ab023d237a42dd1f7d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}`](#7d3a51f5422698d81ab8c513d50d6ab8)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#1947c0bc0046b4ba56f9411053871c67)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}`](#b4c0580635a9d326c3e8d394fc7b62a7)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.quantiles`](#2efd7195255bb9c3320051fdef625400)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}`](#5a6d31969ace0f7ec6e10bc561ae91e7)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.quantiles`](#829e0dc0fd993da5a49fa46500753b07)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}`](#8015e027cd33ea8fe634eafdde1366db)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles`](#5bc3b8eb2ac0ada7bafce2549b0b4827)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}`](#94b72c6d3e2129a7de3934e09f7f0b8a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.quantiles`](#c8e2437edb754b029db8a5cb181aec84)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}`](#921829f26b878208383119a574976d97)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles`](#ea8a4651c94b04384c2b7485933becff)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}`](#14fdc255828e00187cb95963fd34f422)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.quantiles`](#c4a280a8fcd56d470ae901a815a870f7)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}`](#20613a3f95b2bb2882d92067af5f76a7)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#38cde9835f94bb25bd09e448b519b70d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}`](#a1cfb1581bbdf6d40bb3aaf4110efecb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#a62da6ceb2d7deb8ae201fff48a16c97)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}`](#3049aea5d31aa8ebd69ed10698145802)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#9c0d5833c0d3f0e1f627baa7e2208e80)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}`](#4217f8b619086935c8c81ed0868e8f2a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.quantiles`](#fd59c44523450bcbe9511e7908e18ce6)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}`](#a2e630ca853bcc57d569fe83da954696)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#97428a459d63d8aa0cf972d03ee1f305)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}`](#c2a8f0e9ff2ad2f3f5d2dde4130cc2b4)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#fce5f58b6af9d5c895bf2fd32f0fc691)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}`](#02a3d246f3d08b014cad2b1c52453581)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#c077ef816c1cacc5043faedcb029e782)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}`](#62d5b1461eb9fb1e0de9bccbb8575198)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#9fefe8970a7bc5425a73c7143a7bbb60)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}`](#39c59ee6f79f266297fc95065ef172c1)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#701da39b4e0d27790bec2c3bd084167a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}`](#fb34c222989dbf8dafb550afc82b9d1a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#4b0fa7472887268606fe837856f78a4f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}`](#7245cd6c346964f12302c562c231bda6)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.quantiles`](#81a443e194198514cfe47fc909341b45)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.buckets.${buckets_init}`](#d95dcff358729b63d86e61423c22d1d2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.quantiles`](#08b74709158be7ceaa996c8e05e5671e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}`](#47287d3d49577fac8c99a6c5f4318dab)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles`](#458ffacd18c590dba62c7a0dacc8c38b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}`](#38ce485d68a86879eb53a80d58c3245a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.quantiles`](#3e359d1ba46e4f21855cd2a934822d86)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}`](#a326ff5d59d6a4cd849c32493bac94b1)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles`](#b50892fbb33177668f5b8056df03fc3f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}`](#fa71b97dec1cc15f745c01649209567e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.quantiles`](#f180edf8de7eefd914594661995e1769)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}`](#7046d2dc5d06a2fe7d29272c8978e72d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#efa035c746ed9067399d9d6c9ba19ab0)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}`](#88168a86cc637627515ce9d8f7fb8e39)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#cc516fb306f70cd67787b03fe6664351)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}`](#1f5b160e1250469b0ca6190b8b347875)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#4b77ef00df4a52f9ee9bfbc7edd57e3e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}`](#122d31693875518173f518f77d37f700)
  * [`market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.quantiles`](#bec322034e225bf72342720b3a5073a5)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}`](#856f889511e39d70e2a7c872d9114445)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#e659f85513dae65a32da84daa4b047a8)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}`](#c801e191682c3ca9a7c8caacef7cd079)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.quantiles`](#307b7a0438af73e0616b9f1403431e14)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}`](#03815f925f2204a0d7c45b41d04ca2d2)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.quantiles`](#96871731aa2b3cc89d55f55ac050cd9a)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}`](#9397b3f681982e0624168cd461533f66)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#175eab0790038a3d5ede5ba27d63ad93)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}`](#6d4885baeb15ecff77b366a62eef6759)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#44e4e385128f6f85979feb246dea0f3e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}`](#9e9a29ad59b919cc56de6c262e5a9f08)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#838dd2fc080fe0060999685f6dcdd50e)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}`](#06f37f22ce8f0e691dbdca96b7589ae9)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.quantiles`](#a580c2c5863036abdc3455d174ecf2aa)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.buckets.${buckets_init}`](#4a7594c6fc3b04dfc5d4eb6a2c761c31)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.quantiles`](#c596ea3b7d4b65b350b4e9f2b0bed80f)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}`](#3161f1bc2973c5a5d41ff79bcf0273ff)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.quantiles`](#ee2c37b00577376e7900e9721df9f0cb)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}`](#5ad07b5f2b423e440d33961cad9825c6)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.quantiles`](#faf0035d43f76e02e25de752ae8045ea)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}`](#fd49c3bd934f3082b3f57a47bfc80bcf)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.quantiles`](#668acb1f718f94154c75f7a3155b6b6d)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}`](#ad3008110718165678adc45abcbee831)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.quantiles`](#a30827fb19ce17c6773ba490662491ef)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}`](#8d4ab81c7d3f9f9c3024c85b071b040b)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#d6dc784662d476bfb67ce66e25327adc)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}`](#c689c7478849bde322acc5f0abddb37c)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#f8b3b759d4361fb49d718090d944fc53)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}`](#607ead2d593636cf9933c397c095d953)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#e530df55f275b0014bc87c00fe974788)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}`](#1d1b371a4684243c9709ac5c73fe5d53)
  * [`market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.quantiles`](#ea23e4065798a65fbcba5dcc1b1a5bab)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#76f803b6f6d7325979b4eb19b25f9b2d)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#e4b906df4abc21c337f36d0512549f89)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#dbd3aac0e411f99f89164944ae513ee0)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#3a8b63af60583568cba3ad7e0362dd3b)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#faa2abf1d00233820e322ec703130c97)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#585ac4fc5e2e8d52b9ac6eb23167bfe3)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles`](#7eff54b0847ecfe63cbe15b7114c0a8d)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles`](#9107319802d730382696080c6a981a13)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles`](#046ae29c3e41c23209e4277d0c381485)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles`](#29a73fb7d8655cc44e7c75a6e690f2a8)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles`](#035f012990c043854cef265ecbd8d8d3)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles`](#ce1729f409cc8c1ef93b92135139f54d)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#2ef201147dc3e87b678319b4344659c2)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#55d18721a5df50ad533d58bcafb205ae)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#6bd5379bdea76c6eb378229ad9543628)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles`](#baee6b9d3e813c33e8e2ac4427e97088)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#d8a13db3e6bbe7c51598e7d4ae244922)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#8ff8951fb39a696fc16fc4c351cc76b4)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#bff35ce8287327ef3cf446d535ee77a5)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#7609242867fb7de8f6b2c1cab2ec1625)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#7258ac49ba88c054766d3fc89c3ec66e)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#171782027c7d4512967a32e8c701448a)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles`](#c21f9a9e72410849c7e422f379582bff)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles`](#02fa724c648113b82044cc2ea0c49862)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles`](#f2f8009cf7c72d5120a968ab6cc0225b)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles`](#872b406a3724f2d8661f3af511f1123a)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles`](#179c89308e7489c16cba1301ac559ee3)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles`](#06e9fbc3e17462b13d473b080f733c28)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#fd61275abf4608f0e754e904aca89fdc)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#a11ab1511b17e221c0a57764e69055fc)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#fcacc149839f3f1c84cb8f86e2e8b96e)
  * [`market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles`](#cdb201ba2afda8196c33e248b0156659)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#42ff58491ff64e1549309c6b395f890b)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#cdb93be248fb18f0a3bf8463be0b314e)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#7c830b8cc48ae5ca6c680922c9aeee06)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#72578f21f9c95dbcefc2ba65ba26a45b)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#0ba897c26ad668052161a3b1abc64a72)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#adcb0372ece1d2cc5677da8cd48033eb)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles`](#b995d16e68e38f7cc912f6b70edbd21e)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles`](#cdc93f8313f0f325a79389d4d97c45c0)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles`](#fa96617dd4518708f04021edd88dad72)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles`](#05d15fe73b46a878ce38f957ad1874a8)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles`](#90668a8b0e41fb653cbb109987c6bb16)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles`](#606e723c2fd04b5a56b03261e40dd724)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#058c0b36c16e0becd0137b07c9b39d2f)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#34ac607d4adfcb1075fa1e7a5f0272a0)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#b9aa8f0a7a1d0a9e35a5bc95bb84916e)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles`](#40c65c0aaae1b7f55db6cce908eb5024)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles`](#087133b2321d66fbdc61938d73131756)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles`](#ca7c7bbf9f3235f1af400347884a5a13)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles`](#3c3108711185087d16e772543f62c002)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles`](#4174918534e649bc7536f60d6dc4bec8)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles`](#3baf281394b81f90868052b2eb249563)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles`](#d465664a0f849b9ade85fd280e50abbf)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles`](#59b50992b3723e138083f8340607fc2b)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles`](#e5c3d7f893436685c49b384986747901)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles`](#c13cfb0143ba93c789773cdf31a3c0c1)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles`](#30866ad252eeac7b9843c01d121b5265)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles`](#07efa3cbb2550be5d518e8e44fcc911c)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles`](#6f78d007d3f825ec4b1d1ccb7aa41c43)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles`](#b8b1040da2f004394ee97d4df8f12121)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles`](#a53e93b6da7636a1e718abc83810b119)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles`](#e1809f114e3feba29460c9d06c51edd0)
  * [`market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles`](#00369a4a41516954801cb7776ba0544d)

## Metrics

#### <a id='838dd2fc080fe0060999685f6dcdd50e'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='36070b89b22a2e12426bc27a47367eeb'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c9c0157def42d8d84266bbb29da4749d'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4b0fa7472887268606fe837856f78a4f'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1947c0bc0046b4ba56f9411053871c67'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='44e4e385128f6f85979feb246dea0f3e'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='0e4dbfd329b2ffe2c4914cd8e26ec9c8'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='6746c562d68b07579671a8d00b743a49'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='701da39b4e0d27790bec2c3bd084167a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='08fe43f3b9c692ab023d237a42dd1f7d'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='175eab0790038a3d5ede5ba27d63ad93'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3b38563b5cec2439bdea5a20f6d3fbaf'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='bb88da60524104647d718af58ea2cd02'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9fefe8970a7bc5425a73c7143a7bbb60'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f4006c53afd806ccf303e3fba04ae021'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='96871731aa2b3cc89d55f55ac050cd9a'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7c91f625daf93a6811b85cf03dd64fc4'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c4972a3649e3fe81474c485d57939afd'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c077ef816c1cacc5043faedcb029e782'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='78705f66fe78aefd40bd63abb7d2474a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='307b7a0438af73e0616b9f1403431e14'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2b511beb5db7250d99ff46a1240b2640'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='03ad17da3024a54bf611256901a582f3'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fce5f58b6af9d5c895bf2fd32f0fc691'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7fe024b357481a49a666951e476411a2'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e659f85513dae65a32da84daa4b047a8'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3b63613d5962f50814f7779ae09288e6'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='60448dded2f5a7e9e94c323a04683de9'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='97428a459d63d8aa0cf972d03ee1f305'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='8dfdce4daaf35d48d4ad6234f5364748'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c596ea3b7d4b65b350b4e9f2b0bed80f'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='014d5b97dd549abf948c64d772c08d2b'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9252a88385409e28fdfae59074d9b0fb'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='08b74709158be7ceaa996c8e05e5671e'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='829e0dc0fd993da5a49fa46500753b07'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a580c2c5863036abdc3455d174ecf2aa'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='96f50c2d72b5d44a52b6d3616a316a11'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fe6bc32ee9f91c1879f7aeecef134b1d'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='81a443e194198514cfe47fc909341b45'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2efd7195255bb9c3320051fdef625400'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ea23e4065798a65fbcba5dcc1b1a5bab'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1ac9e2fd2807ec9253f664f6ab4ab73c'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d2ee80f4b8c17a614636cff6f3e0faf4'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='bec322034e225bf72342720b3a5073a5'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fd59c44523450bcbe9511e7908e18ce6'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='faf0035d43f76e02e25de752ae8045ea'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3bfc409411d9d8ae2e6aa3378248d212'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4101446590cac1d8cac28a0da1ea6aa1'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3e359d1ba46e4f21855cd2a934822d86'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c8e2437edb754b029db8a5cb181aec84'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ee2c37b00577376e7900e9721df9f0cb'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b4c2254a0334fe019414f607353a247b'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='bfeb8930fca4d84bcc1082b9e0beb39c'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='458ffacd18c590dba62c7a0dacc8c38b'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5bc3b8eb2ac0ada7bafce2549b0b4827'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='668acb1f718f94154c75f7a3155b6b6d'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e12d1e6e2b849f43159a890e0db6a6fc'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3e6d053fcc529fb30c837b2cfcfaf18f'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b50892fbb33177668f5b8056df03fc3f'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ea8a4651c94b04384c2b7485933becff'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a30827fb19ce17c6773ba490662491ef'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4a233adc4292012801b3d1f0d56ed63e'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='8b3b2d846af65644cd3863a63da10d81'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f180edf8de7eefd914594661995e1769'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c4a280a8fcd56d470ae901a815a870f7'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b2320838f380727488664498f55e55bc'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='88c73732d2bfe78c138fa1a6304a894b'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='022f37ef5e670b23e2578bd35737e5fd'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3c5f76022baa5503b9021cca0b4de117'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f5c6819a996822fb4432ba4879aac570'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f1cd12961cbd8c6f8136893efe495f13'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9c9bcf1ad02099b350af7eb614a08587'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d49a67f67a3b594ef976dce0be8a9aa3'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b3041d1a9a5287064118bac7f68f8e06'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b463b634d82f32c0206bcbeb33dd4858'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2aae2cdc8e448f624e9dcafb60009e97'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='41495689747ec833a8183d728b251c97'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7843ab07f0b3fa94eca6b55fe0f7e5e3'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5aea6ca1bb6faa411d6074fe8edd2bab'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ef9d9e4d9c3335c8e7ec76faaf547bfc'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5c8ce10d4ed2bc18099dfdea5ef335be'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='02cebd16b8f0826d154f64692a456909'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='af5af4106d9822f06d98bce45eb95977'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='94e61e2b3e0e7366a91e9d51a8a215f4'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='90fafc1a6ce5f34ac1dbaf3e9190ba7b'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2b28ae9928f9c9dcb3b8e4b20966cbbe'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a49f5069e79a1f468e76279908c773c3'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4c601e9ed743c8fafd36b6f5b9545fcb'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='729cdfc558ca5d48df6b5c6cb0544917'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2a5bcc6b485e33ec9c7b2e0928808898'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='975786194fa3ee096c62db6ec9c101b9'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='171782027c7d4512967a32e8c701448a'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='585ac4fc5e2e8d52b9ac6eb23167bfe3'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7258ac49ba88c054766d3fc89c3ec66e'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='faa2abf1d00233820e322ec703130c97'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7609242867fb7de8f6b2c1cab2ec1625'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3a8b63af60583568cba3ad7e0362dd3b'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='bff35ce8287327ef3cf446d535ee77a5'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='dbd3aac0e411f99f89164944ae513ee0'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='8ff8951fb39a696fc16fc4c351cc76b4'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e4b906df4abc21c337f36d0512549f89'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d8a13db3e6bbe7c51598e7d4ae244922'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='76f803b6f6d7325979b4eb19b25f9b2d'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='02fa724c648113b82044cc2ea0c49862'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9107319802d730382696080c6a981a13'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c21f9a9e72410849c7e422f379582bff'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7eff54b0847ecfe63cbe15b7114c0a8d'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cdb201ba2afda8196c33e248b0156659'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='baee6b9d3e813c33e8e2ac4427e97088'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='872b406a3724f2d8661f3af511f1123a'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='29a73fb7d8655cc44e7c75a6e690f2a8'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f2f8009cf7c72d5120a968ab6cc0225b'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='046ae29c3e41c23209e4277d0c381485'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='179c89308e7489c16cba1301ac559ee3'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='035f012990c043854cef265ecbd8d8d3'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='06e9fbc3e17462b13d473b080f733c28'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ce1729f409cc8c1ef93b92135139f54d'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d465664a0f849b9ade85fd280e50abbf'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='adcb0372ece1d2cc5677da8cd48033eb'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3baf281394b81f90868052b2eb249563'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='0ba897c26ad668052161a3b1abc64a72'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4174918534e649bc7536f60d6dc4bec8'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='72578f21f9c95dbcefc2ba65ba26a45b'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3c3108711185087d16e772543f62c002'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7c830b8cc48ae5ca6c680922c9aeee06'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ca7c7bbf9f3235f1af400347884a5a13'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cdb93be248fb18f0a3bf8463be0b314e'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='087133b2321d66fbdc61938d73131756'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='42ff58491ff64e1549309c6b395f890b'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e5c3d7f893436685c49b384986747901'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cdc93f8313f0f325a79389d4d97c45c0'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.init.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='59b50992b3723e138083f8340607fc2b'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b995d16e68e38f7cc912f6b70edbd21e'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.dcl.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='00369a4a41516954801cb7776ba0544d'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='40c65c0aaae1b7f55db6cce908eb5024'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.ready.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='30866ad252eeac7b9843c01d121b5265'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='05d15fe73b46a878ce38f957ad1874a8'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c13cfb0143ba93c789773cdf31a3c0c1'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fa96617dd4518708f04021edd88dad72'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='07efa3cbb2550be5d518e8e44fcc911c'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='90668a8b0e41fb653cbb109987c6bb16'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='6f78d007d3f825ec4b1d1ccb7aa41c43'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='606e723c2fd04b5a56b03261e40dd724'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.llep.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(time%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9e9a29ad59b919cc56de6c262e5a9f08'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='60f545f2d6a7e437a23e948f89f8d79a'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='04765d46f6bf443ca57619d05b0e1d92'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fb34c222989dbf8dafb550afc82b9d1a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7d3a51f5422698d81ab8c513d50d6ab8'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='6d4885baeb15ecff77b366a62eef6759'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a61ab76fb1710dfd1b72f5ab962a9ff4'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='57acdbc560250cae0b27b55b64bd3b08'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='39c59ee6f79f266297fc95065ef172c1'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e088d0e677c4bf41ecde7f3eef09632e'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9397b3f681982e0624168cd461533f66'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='77b8d691a05981c4a11ad974bbb5b372'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='51e6660d633e75462536d5164053ced8'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='62d5b1461eb9fb1e0de9bccbb8575198'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ff0fa5a8fdfa39d85986ae8e31c5a108'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.ttr.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.ttr.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='03815f925f2204a0d7c45b41d04ca2d2'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9b87a1431e85ec602daad692d2dd8fd2'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='59c056a53e1a8e9e85d28fcc6bc6c9e1'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='02a3d246f3d08b014cad2b1c52453581'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cf8f5b0065ef2ef2b6382254cb1f4305'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_start%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_start

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.start.buckets.%24%7Bbuckets_start%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_start%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.start')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_start%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_start
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c801e191682c3ca9a7c8caacef7cd079'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ca52f59f4b8a3f06b6760b6607093348'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='97f10386ac281ed73be06674bed19862'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c2a8f0e9ff2ad2f3f5d2dde4130cc2b4'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='76376037c0983c49a97430a7be3a42b4'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_end%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_end

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.end.buckets.%24%7Bbuckets_end%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_end%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.end')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_end%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_end
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='856f889511e39d70e2a7c872d9114445'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.firstScreen.metrics.tti.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='57d09c94e41eb9744400502cd07b2021'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='025a4b67122cfdd3bb0902bd9e87b5d6'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a2e630ca853bcc57d569fe83da954696'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='468112fd9f5de708441498043e3a3152'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_duration%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_duration

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.firstScreen.metrics.tti.duration.buckets.%24%7Bbuckets_duration%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_duration%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'page.firstScreen.tti.duration')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_duration%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_duration
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4a7594c6fc3b04dfc5d4eb6a2c761c31'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.buckets.${buckets_init}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_init%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_init

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.init.buckets.%24%7Bbuckets_init%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_init%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_init
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='0e9a4ee0a6cc9b67a88ee97d986330b5'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.buckets.${buckets_init}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_init%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_init

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.init.buckets.%24%7Bbuckets_init%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_init%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_init
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f9f8a90c219397c4a85e8119665ed921'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_init%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_init

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.init.buckets.%24%7Bbuckets_init%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_init%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_init
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d95dcff358729b63d86e61423c22d1d2'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.buckets.${buckets_init}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_init%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_init

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.init.buckets.%24%7Bbuckets_init%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_init%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_init
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5a6d31969ace0f7ec6e10bc561ae91e7'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_init%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_init

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.init.buckets.%24%7Bbuckets_init%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_init%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'js_framework_inited')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_init%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_init
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='06f37f22ce8f0e691dbdca96b7589ae9'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_dcl%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_dcl

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.dcl.buckets.%24%7Bbuckets_dcl%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_dcl%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_dcl
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='08cdf010aaa20648ee1054cb4f3828f8'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_dcl%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_dcl

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.dcl.buckets.%24%7Bbuckets_dcl%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_dcl%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_dcl
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='35b1a75121ddc5591c3581f11fbfc9fe'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_dcl%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_dcl

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.dcl.buckets.%24%7Bbuckets_dcl%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_dcl%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_dcl
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7245cd6c346964f12302c562c231bda6'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_dcl%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_dcl

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.dcl.buckets.%24%7Bbuckets_dcl%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_dcl%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_dcl
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b4c0580635a9d326c3e8d394fc7b62a7'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_dcl%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_dcl

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.dcl.buckets.%24%7Bbuckets_dcl%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_dcl%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'load')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_dcl%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_dcl
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1d1b371a4684243c9709ac5c73fe5d53'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_ready%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_ready

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.ready.buckets.%24%7Bbuckets_ready%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_ready%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_ready
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='8d4ab81c7d3f9f9c3024c85b071b040b'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_all%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_long_task_all

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-all.buckets.%24%7Bbuckets_long-task-all%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_all%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_long_task_all
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='c689c7478849bde322acc5f0abddb37c'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_self%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_long_task_self

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-self.buckets.%24%7Bbuckets_long-task-self%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_self%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_long_task_self
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='607ead2d593636cf9933c397c095d953'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_unknown%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_long_task_unknown

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.buckets.%24%7Bbuckets_long-task-unknown%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_unknown%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_long_task_unknown
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ce22f61ff69b534d51e0c657c7a40eee'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_ready%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_ready

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.ready.buckets.%24%7Bbuckets_ready%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_ready%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_ready
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='636225f5e6b899c5dabd2e7ef692279f'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_all%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_long_task_all

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.buckets.%24%7Bbuckets_long-task-all%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_all%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_long_task_all
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4a03afe51bc1a4963b4788fc26fe3fbb'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_self%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_long_task_self

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.buckets.%24%7Bbuckets_long-task-self%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_self%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_long_task_self
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a6b8e932d5b0ca0b11b3ee653bae5989'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_unknown%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_long_task_unknown

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.buckets.%24%7Bbuckets_long-task-unknown%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_unknown%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_long_task_unknown
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='aa4477cca2c69babf4116a8caad06482'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_ready%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_ready

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.ready.buckets.%24%7Bbuckets_ready%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_ready%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_ready
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='314ed22398de81945ab3b56583186d81'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_all%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_long_task_all

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.buckets.%24%7Bbuckets_long-task-all%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_all%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_long_task_all
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='df42fc7e203ec8df227890ef904a1a73'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_self%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_long_task_self

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.buckets.%24%7Bbuckets_long-task-self%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_self%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_long_task_self
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1a9f4b4e38aaadbef54f0e1f87a17c29'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_unknown%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_long_task_unknown

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.buckets.%24%7Bbuckets_long-task-unknown%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_unknown%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_long_task_unknown
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='122d31693875518173f518f77d37f700'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_ready%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_ready

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.ready.buckets.%24%7Bbuckets_ready%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_ready%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_ready
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7046d2dc5d06a2fe7d29272c8978e72d'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_all%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_long_task_all

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.buckets.%24%7Bbuckets_long-task-all%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_all%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_long_task_all
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='88168a86cc637627515ce9d8f7fb8e39'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_self%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_long_task_self

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.buckets.%24%7Bbuckets_long-task-self%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_self%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_long_task_self
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1f5b160e1250469b0ca6190b8b347875'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_unknown%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_long_task_unknown

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.buckets.%24%7Bbuckets_long-task-unknown%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_unknown%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_long_task_unknown
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4217f8b619086935c8c81ed0868e8f2a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_ready%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_ready

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.ready.buckets.%24%7Bbuckets_ready%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_ready%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_ready%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_ready
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='20613a3f95b2bb2882d92067af5f76a7'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_all%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_long_task_all

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.buckets.%24%7Bbuckets_long-task-all%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_all%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_all)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_all)))%20as%20buckets_long_task_all%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_long_task_all
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a1cfb1581bbdf6d40bb3aaf4110efecb'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_self%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_long_task_self

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.buckets.%24%7Bbuckets_long-task-self%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_self%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_self)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_self)))%20as%20buckets_long_task_self%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_long_task_self
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3049aea5d31aa8ebd69ed10698145802'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_long_task_unknown%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_long_task_unknown

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.buckets.%24%7Bbuckets_long-task-unknown%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_long_task_unknown%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(long_task_unknown)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(long_task_unknown)))%20as%20buckets_long_task_unknown%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_long_task_unknown
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5ad07b5f2b423e440d33961cad9825c6'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_fp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.fp.buckets.%24%7Bbuckets_fp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_fp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='5cf7cdde300af943f623d64d3a0a614f'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_fp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.fp.buckets.%24%7Bbuckets_fp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_fp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='503ac274b1511d36f6b4faaf0a6c84f0'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_fp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fp.buckets.%24%7Bbuckets_fp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_fp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='38ce485d68a86879eb53a80d58c3245a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_fp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fp.buckets.%24%7Bbuckets_fp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_fp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='94b72c6d3e2129a7de3934e09f7f0b8a'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_fp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fp.buckets.%24%7Bbuckets_fp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_fp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3161f1bc2973c5a5d41ff79bcf0273ff'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_fcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.fcp.buckets.%24%7Bbuckets_fcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_fcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='7c934259ebd05693e59846a1f4a97225'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_fcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.buckets.%24%7Bbuckets_fcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_fcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b905c5b8b51708c7489fb2b48bd63e5d'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_fcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.buckets.%24%7Bbuckets_fcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_fcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='47287d3d49577fac8c99a6c5f4318dab'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_fcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.buckets.%24%7Bbuckets_fcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_fcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='8015e027cd33ea8fe634eafdde1366db'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_fcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_fcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.fcp.buckets.%24%7Bbuckets_fcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_fcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'paint.first-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_fcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_fcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fd49c3bd934f3082b3f57a47bfc80bcf'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_lcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_lcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.lcp.buckets.%24%7Bbuckets_lcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_lcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_lcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='061aed3788c81063e06e3e1aeabad5d4'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_lcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_lcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.buckets.%24%7Bbuckets_lcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_lcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_lcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='066cbb5917a4fd345f8b95becd2cecd1'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_lcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_lcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.buckets.%24%7Bbuckets_lcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_lcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_lcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a326ff5d59d6a4cd849c32493bac94b1'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_lcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_lcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.buckets.%24%7Bbuckets_lcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_lcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_lcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='921829f26b878208383119a574976d97'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_lcp%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_lcp

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.lcp.buckets.%24%7Bbuckets_lcp%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_lcp%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-contentful-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_lcp%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_lcp
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ad3008110718165678adc45abcbee831'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_llep%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    pageId,
    buckets_llep

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.paint.llep.buckets.%24%7Bbuckets_llep%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_llep%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        pageId,
        buckets_llep
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='89e52b46e469c420f681bea7fc56ee03'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_llep%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    region,
    pageId,
    buckets_llep

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.paint.llep.buckets.%24%7Bbuckets_llep%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_llep%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        region,
        pageId,
        buckets_llep
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='db4a2d2d87abdd1f0484296ec2db6c12'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_llep%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    browser,
    pageId,
    buckets_llep

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.llep.buckets.%24%7Bbuckets_llep%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_llep%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        browser,
        pageId,
        buckets_llep
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fa71b97dec1cc15f745c01649209567e'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_llep%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    pageId,
    buckets_llep

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.paint.llep.buckets.%24%7Bbuckets_llep%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_llep%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        pageId,
        buckets_llep
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='14fdc255828e00187cb95963fd34f422'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%2C%0A%20%20%20%20buckets_llep%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    count() / 60 as value_0,
    service_white,
    requester,
    browser,
    pageId,
    buckets_llep

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
    if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.paint.llep.buckets.%24%7Bbuckets_llep%7D'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20count()%20%2F%2060%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%2C%0A%20%20%20%20%20%20%20%20buckets_llep%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'largest-loading-elem-paint')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%2C%0A%20%20%20%20%20%20%20%20if(roundToExp2(time)%20%3E%2032000%2C%20'more_32000'%2C%20toString(roundToExp2(time)))%20as%20buckets_llep%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        count() / 60 as value_0,
        service_white,
        requester,
        browser,
        pageId,
        buckets_llep
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId,
        if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='d6dc784662d476bfb67ce66e25327adc'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3d9654eab58c37f032b53852f9c1e4e4'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ea988a4f661c6d562028aa761983c1c3'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='efa035c746ed9067399d9d6c9ba19ab0'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='38cde9835f94bb25bd09e448b519b70d'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='3effa813a26549342c6482404734be95'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='ff58481727765e2508bc44c8be4481e4'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fd61275abf4608f0e754e904aca89fdc'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='2ef201147dc3e87b678319b4344659c2'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b8b1040da2f004394ee97d4df8f12121'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='058c0b36c16e0becd0137b07c9b39d2f'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-all.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_all%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f8b3b759d4361fb49d718090d944fc53'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f82be4815757aeeafc0b70f0b75911ae'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='1dd8019845d779066d61f6aebf0c742b'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cc516fb306f70cd67787b03fe6664351'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a62da6ceb2d7deb8ae201fff48a16c97'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f2786d3cf87207c168ffcf61bea0dca2'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='83f99c95a2895ab1376a4144acefb5b7'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a11ab1511b17e221c0a57764e69055fc'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='55d18721a5df50ad533d58bcafb205ae'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='a53e93b6da7636a1e718abc83810b119'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='34ac607d4adfcb1075fa1e7a5f0272a0'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-self.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_self%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e530df55f275b0014bc87c00fe974788'></a>market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.total.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='f927bf60e893e2b981ab1e77f004d9dc'></a>market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20region%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    region,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.region.splits.%24%7Bregion%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20region%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(regionToName(regionToCountry(region)%2C%20'en')%2C%20'%20'%2C%20'_')%20as%20region%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        region,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='cddcd49d5e5e23c7d0349925316c7880'></a>market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.browser.splits.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='4b77ef00df4a52f9ee9bfbc7edd57e3e'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.splits.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='9c0d5833c0d3f0e1f627baa7e2208e80'></a>market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20browser%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
    service_white,
    requester,
    browser,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    concat(browser_name, '-', browser_version_major) as browser,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.requester.browser.splits.%24%7Brequester%7D.%24%7Bbrowser%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20browser%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20concat(browser_name%2C%20'-'%2C%20browser_version_major)%20as%20browser%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0,
        service_white,
        requester,
        browser,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        concat(browser_name, '-', browser_version_major) as browser,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='10db33639c64ec40bedfc296b535f3e2'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.splits.%24%7BexpFlags%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='91a96180b1a08143dbf976d31a0d10b0'></a>market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20service_white%2C%0A%20%20%20%20expFlags%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
    service_white,
    expFlags,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')

GROUP BY metric_ts,
    multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
    replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.%24%7Bservice_white%7D.expFlags.requester.splits.%24%7BexpFlags%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20service_white%2C%0A%20%20%20%20%20%20%20%20expFlags%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20service_white%20!%3D%20'undefined_service'%20and%20expFlags%20!%3D%20''%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20multiIf(%20vhost%20in%20('market.yandex.ru'%2C'market.yandex.ua'%2C'market.yandex.by'%2C'market.yandex.kz')%2C%20'white_desktop'%2Cvhost%20in%20('m.market.yandex.ru'%2C'm.market.yandex.ua'%2C'm.market.yandex.by'%2C'm.market.yandex.kz')%2C%20'white_touch'%20%2C%20'undefined_service'%20)%20as%20service_white%2C%0A%20%20%20%20%20%20%20%20replaceAll(arrayJoin(exp_flgs)%2C%20'%3D'%2C%20'_'))%20as%20expFlags%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0,
        service_white,
        expFlags,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti')
    
    GROUP BY metric_ts,
        multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white,
        replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='fcacc149839f3f1c84cb8f86e2e8b96e'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='6bd5379bdea76c6eb378229ad9543628'></a>market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('market.yandex.ru'%2C%20'market.yandex.ua'%2C%20'market.yandex.by'%2C%20'market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='e1809f114e3feba29460c9d06c51edd0'></a>market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.splits.%24%7BtestId%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```
#### <a id='b9aa8f0a7a1d0a9e35a5bc95bb84916e'></a>market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles

[Preview query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%0A%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20testId%2C%0A%20%20%20%20requester%2C%0A%20%20%20%20pageId%0A%0AFROM%20market.timemark%0A%0AWHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%0AGROUP%20BY%20metric_ts%2C%0A%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A%0AORDER%20BY%20metric_ts%20LIMIT%2010)
```SQL
SELECT
    multiply(intDiv(timestamp, 60), 60) AS metric_ts,
    quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
    testId,
    requester,
    pageId

FROM market.timemark

WHERE date = today() and timestamp > now() - 60 * 60
    AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')

GROUP BY metric_ts,
    arrayJoin(test_ids) as testId,
    arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
    arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId

ORDER BY metric_ts LIMIT 10
```

[Diagnostic query:](https://yql.yandex-team.ru/?query_type=CLICKHOUSE&query=use%20marketclickhouse%3B%0A%0ASELECT%20%0A%20%20%20%20'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.%24%7BtestId%7D.%24%7Brequester%7D.%24%7BpageId%7D.standard.metrics.tti.long-task-unknown.quantiles'%20AS%20title%2C%20%0A%20%20%20%20count()%20AS%20cnt%0A%20%20%20%20%20%0AFROM%20(%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20multiply(intDiv(timestamp%2C%2060)%2C%2060)%20AS%20metric_ts%2C%0A%20%20%20%20%20%20%20%20quantilesTimingIf(0.5%2C0.6%2C0.7%2C0.80%2C0.90%2C0.95%2C0.97%2C0.99%2C0.995%2C0.997%2C0.999%2C1)(long_task_unknown%2Cenvironment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%20as%20value_0%2C%0A%20%20%20%20%20%20%20%20testId%2C%0A%20%20%20%20%20%20%20%20requester%2C%0A%20%20%20%20%20%20%20%20pageId%0A%20%20%20%20%0A%20%20%20%20FROM%20market.timemark%0A%20%20%20%20%0A%20%20%20%20WHERE%20date%20%3D%20today()%20and%20timestamp%20%3E%20now()%20-%2060%20*%2060%0A%20%20%20%20%20%20%20%20AND%20(environment%20%3D%20'PRODUCTION'%20and%20vhost%20in%20('m.market.yandex.ru'%2C%20'm.market.yandex.ua'%2C%20'm.market.yandex.by'%2C%20'm.market.yandex.kz')%20and%20name%20%3D%20'tti')%0A%20%20%20%20%0A%20%20%20%20GROUP%20BY%20metric_ts%2C%0A%20%20%20%20%20%20%20%20arrayJoin(test_ids)%20as%20testId%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B%20'any-requester'%2C%20multiIf(%20is_robot%20%3D%201%2C%20'robot'%2C%20indexOf(kv_keys%2C%20'puid')%20%3E%200%2C%20'logged-in'%2C%20'anonymous'%20)%20%5D)%20as%20requester%2C%0A%20%20%20%20%20%20%20%20arrayJoin(%5B'any-page'%2C%20replaceAll(page%2C%20'%3A'%2C%20'_')%5D)%20as%20pageId%0A)%0A%0AGROUP%20BY%20metric_ts%0AORDER%20BY%20cnt%20DESC%0ALIMIT%201)
```SQL
SELECT 
    'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, 
    count() AS cnt
     
FROM (
    SELECT
        multiply(intDiv(timestamp, 60), 60) AS metric_ts,
        quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0,
        testId,
        requester,
        pageId
    
    FROM market.timemark
    
    WHERE date = today() and timestamp > now() - 60 * 60
        AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti')
    
    GROUP BY metric_ts,
        arrayJoin(test_ids) as testId,
        arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester,
        arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId
)

GROUP BY metric_ts
ORDER BY cnt DESC
LIMIT 1
```


## Overall Diagnostics

### Portion #1

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #2

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #3

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #4

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #5

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #6

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'js_framework_inited') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'load') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'paint.first-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'largest-loading-elem-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #7

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.ttr.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.start.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.end.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.firstScreen.metrics.tti.duration.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.init.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'js_framework_inited') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.dcl.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'load') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.ready.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.fcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'paint.first-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #8

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.lcp.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-contentful-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.paint.llep.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(time,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'largest-loading-elem-paint') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.ttr.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.ttr.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #9

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.start.buckets.${buckets_start}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_start FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.start') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_start ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.end.buckets.${buckets_end}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_end FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.end') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_end ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.firstScreen.metrics.tti.duration.buckets.${buckets_duration}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_duration FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'page.firstScreen.tti.duration') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_duration ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_init FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_init FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_init FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_init FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.init.buckets.${buckets_init}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_init FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'js_framework_inited') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_init ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_dcl FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_dcl FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #10

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_dcl FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_dcl FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.dcl.buckets.${buckets_dcl}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_dcl FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'load') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_dcl ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_ready FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_long_task_all FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_long_task_self FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_long_task_unknown FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_ready FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_long_task_all FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_long_task_self FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_long_task_unknown FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_ready FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_long_task_all FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_long_task_self FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_long_task_unknown FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_ready FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_long_task_all FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_long_task_self FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_long_task_unknown FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.ready.buckets.${buckets_ready}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_ready FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_ready ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #11

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.buckets.${buckets_long-task-all}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_long_task_all FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_all) > 32000, 'more_32000', toString(roundToExp2(long_task_all))) as buckets_long_task_all ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.buckets.${buckets_long-task-self}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_long_task_self FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_self) > 32000, 'more_32000', toString(roundToExp2(long_task_self))) as buckets_long_task_self ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.buckets.${buckets_long-task-unknown}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_long_task_unknown FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(long_task_unknown) > 32000, 'more_32000', toString(roundToExp2(long_task_unknown))) as buckets_long_task_unknown ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_fp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_fp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_fp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_fp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fp.buckets.${buckets_fp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_fp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_fcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_fcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_fcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_fcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.fcp.buckets.${buckets_fcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_fcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'paint.first-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_fcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_lcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_lcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_lcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_lcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.lcp.buckets.${buckets_lcp}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_lcp FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-contentful-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_lcp ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, pageId, buckets_llep FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, region, pageId, buckets_llep FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #12

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, browser, pageId, buckets_llep FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, pageId, buckets_llep FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.paint.llep.buckets.${buckets_llep}' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, count() / 60 as value_0, service_white, requester, browser, pageId, buckets_llep FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'largest-loading-elem-paint') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId, if(roundToExp2(time) > 32000, 'more_32000', toString(roundToExp2(time))) as buckets_llep ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-all.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_all,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```
### Portion #13

```SQL
SELECT * FROM (
    SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-self.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_self,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.total.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.region.splits.${region}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, region, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(regionToName(regionToCountry(region), 'en'), ' ', '_') as region, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.browser.splits.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.splits.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.requester.browser.splits.${requester}.${browser}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') as value_0, service_white, requester, browser, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, concat(browser_name, '-', browser_version_major) as browser, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.splits.${expFlags}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.${service_white}.expFlags.requester.splits.${expFlags}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') as value_0, service_white, expFlags, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and service_white != 'undefined_service' and expFlags != '' and name = 'tti') GROUP BY metric_ts, multiIf( vhost in ('market.yandex.ru','market.yandex.ua','market.yandex.by','market.yandex.kz'), 'white_desktop',vhost in ('m.market.yandex.ru','m.market.yandex.ua','m.market.yandex.by','m.market.yandex.kz'), 'white_touch' , 'undefined_service' ) as service_white, replaceAll(arrayJoin(exp_flgs), '=', '_')) as expFlags, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_desktop.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('market.yandex.ru', 'market.yandex.ua', 'market.yandex.by', 'market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.splits.${testId}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
    UNION ALL SELECT 'market-front-unified.rum_timemark.v1.white_touch.testId.requester.splits.${testId}.${requester}.${pageId}.standard.metrics.tti.long-task-unknown.quantiles' AS title, count() AS cnt FROM ( SELECT multiply(intDiv(timestamp, 60), 60) AS metric_ts, quantilesTimingIf(0.5,0.6,0.7,0.80,0.90,0.95,0.97,0.99,0.995,0.997,0.999,1)(long_task_unknown,environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') as value_0, testId, requester, pageId FROM market.timemark WHERE date = today() and timestamp > now() - 60 * 60 AND (environment = 'PRODUCTION' and vhost in ('m.market.yandex.ru', 'm.market.yandex.ua', 'm.market.yandex.by', 'm.market.yandex.kz') and name = 'tti') GROUP BY metric_ts, arrayJoin(test_ids) as testId, arrayJoin([ 'any-requester', multiIf( is_robot = 1, 'robot', indexOf(kv_keys, 'puid') > 0, 'logged-in', 'anonymous' ) ]) as requester, arrayJoin(['any-page', replaceAll(page, ':', '_')]) as pageId ) GROUP BY metric_ts ORDER BY cnt DESC LIMIT 1
) ORDER BY cnt DESC
```

