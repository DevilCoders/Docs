# Скрипты для работы с нашими инсталляциями PostgreSQL
И всякие полезности, их использующие (см. подпапки).

* `./pgaas.sh` - Основаной скрипт для работы с БД.
  Всё можно сделать с его помощью, но для этого нужно
  передать очень много параметров
  (в основном переменные окружения. описаны в самом файле,
  но тут стоит упомянуть, что на его работу влияет переменна `PG_CMD`,
  определяющая, какой командой подключаться,
  например `psql` (по умолчанию) или `pg_dump`),
  поэтому есть много вспомогательных скриптов, которые вызывают его:
  * `./testing-pgaas.sh` - подключается к тестингу (хосты зашиты именно тут)
  * `./prod-pgaas.sh` - подключается к проду
  * `./testing-pg_dump.sh` - подключается к тестингу с помощью `pg_dump`,
    используюя `./testing-pgaas.sh` c переопределённой `PG_CMD`.
  * `./prod-pg_dump.sh` - подключается к проду с помощью `pg_dump`
* `./run-sql.sh` - полуает на вход команду для подключения к БД
  (`psql`, `./testing-pgaas.sh` или `./prod-pgaas.sh`),
  схему по-умолчанию и набор sql файлов, и выполняет их,
  подключившись переданной командой и
  предварительно установив `search_path` в переданную схему,
  а часовой пояс на Московское время.
  Вывод печатается на стандартный вывод в TSV.
  У него тоже многова-то параметров, поэтому есть сокращения:
  * `./local-run-sql.sh` - запускает переданные sql-файлы локально
  * `./testing-run-sql.sh` - запускает переданные sql-файлы в тестинге
  * `./prod-run-sql.sh` - запускает переданные sql-файлы в проде
* `./install-pgaas-dir.sh` - простой способ установить локально (почти) только эту папку.
  Это может быть полезно, если вся Аркадия не нужна, а эти скрипты позапускать хочется.
  Делалось для Лёши, чтобы он мог почистить накопившиеся задачи:
  [OCRM-868](https://st.yandex-team.ru/OCRM-868).
  Внутри написано, как запустить. Предлагаемая команда (используется svn)
  скачает этот скрипт и запустит его, а он уже склонирует этот кусочек Аркадии
  в `~/arcadia`.
