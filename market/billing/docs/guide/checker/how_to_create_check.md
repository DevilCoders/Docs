##Получение прав
Для заведения сверок нужно получить права в IDM:
<br>Права на создание/изменение/удаление сверок
<br>![Схема прав в чекере](../../_assets/images/checker/idm-rights.png)

Матрица ролей
<br>![Матрица ролей](../../_assets/images/checker/role-matrix.jpg)
- ADMIN - может всё
- SCHEDULER_CREATOR - Может создавать/изменять/удалять сущности
- SCHEDULER_CHANGER - Может редактировать сущности и запускать сверки
- SCHEDULER_APPROVER - Может апрувить сверки/импорты
- SCHEDULER_RUNNER - Может смотреть результат и запускать сверки
- VIEW_ONLY - Роль только на просмотр


##Заведение сверки
  Адрес админки биллинга https://billing-admin.market.yandex.ru/checkers
  Через главную страницу и панель сбоку
  ![Подсказка где найти меню](../../_assets/images/checker/checker-hint1.png)
* **Планировщик** информация по импорту/сверок
* **Запуски** список запусков импорта/сверок
* **Справочники** список сверяемых сущностей
* **Лог событий** список информации для аудита


Жмём **Создать +**
![Создать+](../../_assets/images/checker/create+.png)

Заполняем поля
![Заполняем поля](../../_assets/images/checker/fill_form.png)

**Первый компонент**, **второй компонент** и **сущность** можно выбрать что угодно, если запрос без плейсхолдеров (про них ниже).

**Уровень эскалации** влияет на то, будет ли создаваться тикет с призывом ответственных лиц.
!!CRIT!! - создается тикет и прызываются ответственные люди за компонент (выбранный в поле первый/второй компонент)

**Результирующая папка** - можно указать папку в которой квота сверщика по-умолчанию **//home/market/production/mstat/dictionaries/mbi/mbi_checker**
Можно так же добавить плейсхолдер для создания папки в зависимости от того, как часто запускается сверка:
//home/market/production/mstat/dictionaries/mbi/mbi_checker/some_folder/**%(TIME_WINDOW_UNIT)**
Если сверка ежедневная, то реальная папка будет
//home/market/production/mstat/dictionaries/mbi/mbi_checker/some_folder/DAYS

В поле **Результирующая таблица** можно вписать плейсхолдер %(DATE_TO) тогда запись будет идти в таблицы с новым днём (в запросе должен быть использован плейсхолдер %(RESULT_FOLDER_NAME)/%(RESULT_TABLE_NAME) во вставке)

**Расписание запусков** - cron расписание запусков (используется для определения даты и времени запуска)
**Тип временного окна** - определяет единицу измерения для поля размер временного окна
**Размер временного окна** - Размер периода сверки (X дней/недель/месяцев/лет) в зависимости от типа временного окна

**Yql-запрос** - текст запроса, перед отправкой в yql-http-api будут подставлены все плейсхолдеры (если есть в тексте запроса)
Например текст:
$param1 = '%(DATE_TO)'; будет изменен на $param1 = '2022-07-12'; (текущая дата)

###Список апруверов
После заполнения всех полей жмём "Создать" и просим апрувнуть/активировать сверку кого-то из списка:
<br>[Репин Павел](https://staff.yandex-team.ru/pavel-repin)
<br>[Хмелинский Павел](https://staff.yandex-team.ru/hmepas)
<br>[Быстров Андрей](https://staff.yandex-team.ru/andreybystrov)
<br>[Белоусов Сергей](https://staff.yandex-team.ru/mexicano)

###Запуск/Просмотр результатов
Кнопка запуска:
![Кнопка запуска](../../_assets/images/checker/check_start.png)

В списке сверок есть кнопка у каждой сверки просмотра результатов
![информация о запуске](../../_assets/images/checker/check_task.png)

Откроется список всех запусков текущей версии:
![Все запуски](../../_assets/images/checker/check_tasks.png)

Если нажать на id в первой колонке то откроется подробная информация в том числе со ссылкой на тикет:
![Детальная информация конкретного запуска сверки](../../_assets/images/checker/check_task_full_info.png)

###Список всех плейсхолдеров
<br>DATE_FROM - дата начала сверки
<br>DATE_TO - дата окончания (текущая дата)
<br>PREV_DATE_TO - предпоследний день сверки (обычно вчера)
<br>RESULT_TABLE_FOLDER - результирующая папка сверки
<br>RESULT_TABLE_NAME - папка результата сверки
<br>FIRST_COMPONENT_NAME - название первого сверяемого компонента
<br>SECOND_COMPONENT_NAME - название второго сверяемого компонента
<br>FIRST_COMPONENT_TABLE_PATH - полный путь к таблице первого сверяемого компонента
<br>SECOND_COMPONENT_TABLE_PATH - полный путь к таблице второго сверяемого компонента
<br>COMPONENT_NAME - название компонента (для импорта данных)
<br>COMPONENT_TABLE_PATH - таблица импортируемых данных (для импорта)
<br>TIME_WINDOW_UNIT - тип временного окна (DAYS/MONTHS/YEARS)

[README.md с актуальными плейсхолдерами](https://a.yandex-team.ru/arc_vcs/market/checker/README.md?rev=r7915422#L1)
