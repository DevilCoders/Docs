# Стиль кода

## Reatom и реакции

Часто реакции Reatom содержат поход за данными в ресурсы. В таком случае стоит разделить логику похода на три части: поход, успех и неудача. Получается, это три экшена с тремя реакциями. Бонусы такого решения:

- Кнопки можно подписать на экшены и делать их pending во время исполнения запроса
- Failed экшены можно сопровождать всплывающими уведомлениями или отслеживать в логах общим решением

## Логика в контроллере не должна дублировать логику в реакции

Например, на странице есть фильтр и отображение отфильтрованных данных, фильтрация при этом производится на бэке, а контроллер сразу знает исходные параметры фильтра. Тогда логика в контроллере может частично дублироваться с логикой в реакции. Стоит вынести такую логику в общий хелпер в корне директории страницы.

## Reatom и его селекторы

Реатом позволяет создать атом, который будет использоваться только как селектор. На практике это показалось плохим по производительности решением, и от него было принято решение отказаться. Кроме того, сущности вида Entity1ToEntity2 сложно поддерживать.

# Тестирование

## Юнит-Тесты

```bash
nvm use
npm i
npm test
```

## Гермион-тесты

```bash
nvm use 16
npm i
```

Далее нужно в одном терминале запустить локальный селениум
```bash
nvm use 16
npm run selenium

# после первого запуска можно запускать немного быстрее:
npm run selenium:start
```

Для локальных тестов, в другом терминале запустить сам клиент
```bash
nvm use 16
API_HOST='http://dev-backend-host:123' npm start
```

И в другом терминале запустить сами тесты
```bash
nvm use 16
npm run test:hermione
```

Тесты можно запустить не только на локальном клиенте, но и стороннем хосте (тогда локально его запускать не нужно)
```bash
nvm use 16
BASE_URL='http://some-host-with-client.ru' npm run test:hermione
```

Плюс к тому можно использовать селениум-грид, тогда не нужно запускать локальный селениум (не работает для локального тестирования)
```bash
nvm use 16

GRID_URL='http://selenium:selenium@sg.yandex-team.ru:4444/wd/hub' BASE_URL='http://some-host-with-client.ru' npm run test:hermione
# - или если нужен именно этот грид, то
BASE_URL='http://some-host-with-client.ru' npm run test:hermione:grid
```

------
PS. можно не вызывать каждый раз `nvm use`, если установить дефолтную версию ноды:
```bash
nvm install 16
nvm alias default 16
```
