#### Entities

В этой директории хранятся описания бизнес-сущностей, которыми мы оперируем в коде. Каждая сущность лежит в директории с именем в camelCase в единственном числе. В каждой такой директории могут быть следующие файлы:

`types.ts` - содержит в себе тип сущности и тип для атома данной сущности. Также может содержать типы для `raw` версий данной сущности.

`fetchActions.ts` - содержит в себе декларации всех возможных действий, связанных с данной сущностью как синхронных, так и асинхронных. В случае асинхронных действий содержит описание реакций на данные действия.

`atoms.ts` - содержит в себе декларации атомов, связанных с данной сущностью. (Про атомы см. https://reatom.js.org/#/glossary)

`schema.ts` - содержит в себе правила перевода из `raw` форматов в единый формат (В большей степени нормализация и другие необходимые операции т.д.)

`getters.ts` - содержит в себе реализацию взаимодействия с инстансом данной сущности.

`mapping.ts` - содержит в себе строгое описание возможных значений сущности, если оно константно.

`fetchActions.ts` - содержит в себе вызовы к бэку и их обработку.

`index.ts` - экспортирует все из вышеописанных файлов для удобства работы в `ide`.

#### Вызов к бэку и его обработка
Метод апи оборачивается в action через фабрику declareActionFetch
```typescript jsx
export const findPrinterFetch = declareActionFetch(ApiClient.findPrinter);
```
Можно навешивать обработчики прямо при объявлении (предпочтительно)
```typescript jsx
export const findPrinterFetch = declareActionFetch(ApiClient.findPrinter, {
    onDone: (result, store) => {},
    onFail: (result, store) => {},
});
```
Можно навешивать обработчики внутри `view.tsx || settings.tsx` используя handleAction 
(используется в случае совместного использования сущности несколькими приложениями)
```typescript jsx
...
handleAction(findPrinterFetch.done, (store, payload) => {})
handleAction(findPrinterFetch.fail, (store, payload) => {})
...
```
#### Типизация сущности

1. Всегда заводите отдельный тип на `id`:

```typescript jsx
export type EntityId = string;

export interface Entity {
  id: EntityId;
}
```

В 90% случаев делает дальнейший код более читаемым:
```typescript jsx
const foo = (id: EntityId) => {};

// vs

const bar = (id: string) => {};
```

2. Поля сущности должны быть максимально строгими:
```typescript jsx
type SkuId = string | number;

// vs

type SkuId = string;
```

Если разные источники присылают данные в разном формате, чиним это через преобразования в `schema` + `enum` в приоритете, если возможно. 

