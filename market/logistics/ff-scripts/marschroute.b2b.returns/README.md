## Скрипт для получения и сохранения в FFWF информации по возвратам на склад Маршрута.

Скрипт реализован на Kotlin, запускать необходимо на Java 11.


### Необходимые проперти для скрипта
Название | Описание
--- | ---
`marschroute.url` | Url Маршрута
`marschroute.api.key` | Api key для запросов в Маршрут, можно посмотреть в Секретнице для wrap-marschroute
`ffwf.database.driver` | Название драйвера базы FFWF
`ffwf.database.url` | Строка подключения к базе FFWF
`ffwf.database.username` | Пользователь в базе FFWF, можно посмотреть в Секретнице для FFWF
`ffwf.database.password` | Пароль для пользователя в базе FFWF, можно посмотреть в Секретнице для FFWF
`ffwf.database.commit.insert` | true - автоматически выполнить вставку полученных из Маршрута возвратов в базу FFWF, false - только залоггировать запросы к базе в лог-файл, вставку не выполнять
`marschroute.id` | Идентификатор Маршрута в LMS
`fetch.only.closed.returns` | Вытаскивать из Маршрута только возвраты в статусе 30 (закрытые)
`startrack.url` | Url Стартрека
`startrack.token` | Токен для доступа в Стартрек, можно брать токен робота Робокотов
`inbounds.startrack.queue` | Очередь Стартрека, в которой будет создаваться тикет о том, что необходимо загрузить возвраты в Аксапту
`inbounds.startrack.assignee` | Исполнитель тикета по загрузке возвратов в Аксапту, поле опциональное
`orders.startrack.queue` | Очередь Стартрека, в которой будет создаваться тикет о том, что необходимо вернуть деньги по заказам
`orders.startrack.assignee` | Исполнитель тикета по возврату денег по заказам, опционально
`wrap.marschroute.database.url` | Строка подключения к базе прослойки Маршрута
`wrap.marschroute.database.username` | Пользователь в базе прослойки Маршрута, можно посмотреть в Секретнице
`wrap.marschroute.database.password` | Пароль для пользователя в базе прослойки Маршрута, можно посмотреть в Секретнице

### Запуск из Idea
Для локального запуска из Idea достаточно в working directory положить соответствующий properties файлик (название - `marschroute-returns.properties`), после чего запустить main метод в файле `Main.kt`.

### Сборка
Для того, чтобы собрать исполняемый jar-архив со всеми зависимостями приложения зависимостями нужно вызвать команду `./gradlew fatJar`

### Запуск Jar-архива
Запуск без аргументов - `java -jar marschroute.b2b.returns-all-1.0-SNAPSHOT.jar`

Запуск с указанием интервала дат - `java -jar marschroute.b2b.returns-all-1.0-SNAPSHOT.jar '17.12.2019' '19.12.2019'` 
