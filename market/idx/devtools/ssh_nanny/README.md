# Тулза для удобного ssh до инстансов в няне

## Тулза умеет
* Подключиться к любому сервису, переданному в опции service. Например `--service production_market_idxapi_fast_sas`
* Выбрать сервис из захардкоженного списка (предоставленного isabirzyanov@, за что ему большое спасибо) по невнятному описанию. Например `sas fast idxapi prod`
* Инстанс для подключения выбирается случайно (by default) или детерминировано с помощью опции instance. Например `--instance 0`
* Agent forwarding, как обычно, с помощью на флага `-A`
* Исполнить команду на инстансе. Например `--command 'ls .'`

## Немного о деталях реализации
* Для определения списка инстансов используется Nanny API.
* Тулза после определения hostname'a инстанса запускает команду ssh и пробрасывает до неё stdin, stderr и stdout
* Так как тулза реализована на go, для её запуска не обязательно звать `ya make`, запуск возможен и с помощью `go run`
* By design тулза при наличии нескольких подходящих сервисов подключится к случайному

## Примеры
* `go run main.go --service production_market_offersrobot2_sas --instance 0` –– Подключиться к первому инстансу продового робота в сасово
* `./ssh_nanny --command 'ls logs/idxapi' prod idxapi` –– Подключиться к любому продовому idxapi и полистить его логи
* `go run main.go --service production_market_idxapi_fast_vla -A` –– Подключиться к любому инстансу продового синего fast idxapi во владимере с agent forwarding.
* `./ssh_nanny --instance 1 blue miner prod` –– Подключиться ко второму инстансу продового синего майнера в любом ДЦ.

