# Работа с переводами

[Практики локализации](https://clubs.at.yandex-team.ru/verstka/6350)

Переводы находятся в [Танкере](https://tanker.yandex-team.ru/?project=yandex_lavka&branch=frontend).

Для работы с переводами на уровне кода используется утилита [i18n](https://github.yandex-team.ru/search-interfaces/frontend/blob/f5b00cb03d009996a9744b81617123871d3a0b4f/packages/i18n/README.md)

Для создания ключей в Танкере и выгрузки переводов, используется [tanker-kit](https://github.yandex-team.ru/search-interfaces/frontend/blob/f5b00cb03d009996a9744b81617123871d3a0b4f/packages/tanker-kit/doc/overview.md)

## Структура

На уровне проекта лежат кейсеты. Кейсет содержит ключи. Ключ имеет переводы на нужные языки.

В качестве ключа используется фраза на русском языке (равная переводу на русский язык).

Кейсет - это путь до папки, в которой лежат файлы, требующие переводов.

## Работа с танкером

Перед началом работы необходимо [сгенерировать OAUTH token](https://nda.ya.ru/3SjQY7) и добавить его в переменные среды как TANKER_TOKEN.
Например, для текущей сессии консоли это выглядит так:

```bash
export TANKER_TOKEN=<your tanker token>
```

> ! Запускать tanker нужно из корня проекта, чтобы подтянулись конфиги из [./tanker](../.tanker)

## Как добавить перевод

1. Импортируем модуль и кейсеты:

Создавать папку `Header.i18n` при этом необязательно, она создастся танкером автоматически. Но проект не запустится без этой папки и переводов в ней.

```ts
import createI18n from '@yandex-int/i18n'
import * as keyset from './Header.i18n'

const i18n = createI18n(keyset)
```

2. Используем полученную функцию перевода в коде. Контекст указывать обязательно. Контекст отображается в танкере и помогает переводчикам понять контекст использования перевода:

```tsx
<Button
  label={i18n('Текст для перевода', {
    context: 'Контекст для переводчиков',
  })}
/>
```

3. Смотрим список полученных ключей

```bash
npx tanker keys
```

3. Отправляем переводы в Танкер (аргумент пути опционален, при его отсутствии будут отправлены все новые найденные в library ключи):

```bash
npx tanker push
```

4. Если все прошло успешно, то найденные в указанной директории ключи перевода окажутся [в Танкере](https://tanker.yandex-team.ru/?project=yandex_lavka&branch=master). При этом значением ключа для русского языка окажется сам ключ.

5. Синхронизируем переводы на локали:

```bash
npx tanker sync
```

После этого шага в локализованной секции должна появиться директория `Header.i18n` с правильным содержимым кейсетов. При отсутствии английской версии будет использована русская.

6. Если в кейсетах все указано правильно, то переводы должны корректно попадать в сборку. Теперь изменения можно коммитить.
