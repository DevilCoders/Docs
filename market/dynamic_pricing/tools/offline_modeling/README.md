=== Что и как тут делать ===

1. Что это?
Это набор инструментов, которые позволяют моделировать на истории.
На самом деле это скрипт написанный на Вальгалле, который запускает два этапа - подготовка данных и сам расчёт на заданом временном промежутке. Скрипт - это modeling_effect.py
Вальгала - этой инструмент для запуска Нирваны из кода. То есть на выходе будет граф, который берет некоторые данные из продакшена, а некоторые мы готовим заранее и запускает его.

2. Инструкция по шагам.
a. Сперва надо сконфигурировать сценарии, которые мы будем тестировать.
    1) Настроить параметры (токены, даты, названия)
    В bin/__main__.py точка входа в которой представлены основные параметры, доступные в системе. В том числе даты.
    Аналогично параметры можно задать при запуске бинарника.
    2) Конфигурационные файлы
    Удалить конфиги из папки config (csv, json).
    Скопировать продовые конфиги в папку /config. Взять файлы можно отсюда:
    market/dynamic_pricing/pricing/dynamic_pricing/config_generator/bounds_config.json
    market/dynamic_pricing/pricing/dynamic_pricing/config_generator/pricing_config.json
    market/dynamic_pricing/pricing/dynamic_pricing/rules_uploader/bounds_groups.csv
    market/dynamic_pricing/pricing/dynamic_pricing/rules_uploader/price_groups.csv
    market/dynamic_pricing/pricing/dynamic_pricing/rules_uploader/vendors_rules.csv
    market/dynamic_pricing/pricing/dynamic_pricing/rules_uploader/sku_exception_list.csv
    Можно их настраивать руками или же python скриптами которые помогают делалать простые сценарии быстрее.
    Нужно понимать, что все кубики в графе берут исполняемые файлы прямо из сэндбокса, последней версии, поэтому и конфиги лучше копипастить последней версии. А затем менять в них, что душе угодно (для автоматизации этого есть скрипт update.sh).
b. Компиляция и запуск
    1) компилировать
    "./ya make market/dynamic_pricing/tools/offline_modeling/ -t --checkout" - команда компилирует питон в бинарник. Можно добавить параметры аналогично пункту 2.a.1 например: --label my_experiment_2000
    И затем запустить его "market/dynamic_pricing/tools/offline_modeling/bin/offline_modeling". В случае успеха вы увидете url по которому досупен Нирвановский граф.
    Но чисто теоретически можно запустить bin/__main__.py и получить такой же Нирвановский граф, без компиляции. Не проверялось.
    Для запуска вальгалы нужен Нирвана токен. Он берется из переменных окружения. На линуксе можно добавить следующим образом:
    export NIRVANA_TOKEN=AAAA-AAAAAXXXXXAAAA
    токен можно получить тут: https://oauth.yandex-team.ru//authorize?response_type=token&client_id=637ca17604cb4dfa90b262952c00b1e9

3. Что умеет?
    а. брать конфиги
    b. имеет инстументы для быстрых правок конфигов
    с. запускать часть продового пайплайна Нирваны начиная с этих конфигов.
    d. надо иметь в виду, что многие данные тем не менее берутся с прода.
    e. имеет параметры для запуска графа, такие как: даты, токены, настройки YT.
        так же есть такая опция как find_timestamp - позволяет найти timestamp, если данных за конкретный час не было в проде. Порядок часов - ['08:00:00', '12:00:00', '16:00:00', '04:00:00'] можно поменять в utility.py
    f. в целом, можно вносить коррективы в любые операции. Или добавить кубики, которые будут копировать данные с продакшена. Удалили за ненадобностью, примеры можно посмотреть тут https://a.yandex-team.ru/arc/trunk/arcadia/market/dynamic_pricing/tools/offline_modeling/prepare_data_operations?rev=r7160857

4. Моменты
    1) нужны доступы в нирвану и в наши проекты монетизационные. Просить тут:
    https://dispenser.yandex-team.ru/nirvana/projects/market-money
    https://nirvana.yandex-team.ru/roles/nirvana.flowchart.market_money
    2) Для того, чтобы это всё делать нужен ssh подключение. Как его настроить, спрашивайте на wiki и у коллег
    3) опция --start - служит для моментального запуска графа, аналогично граф можно запустить и из интерфейса Нирваны
