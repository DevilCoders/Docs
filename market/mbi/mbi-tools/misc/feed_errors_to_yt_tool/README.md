# Утилита для загрузки ошибок при обработке ассортиментных фидов.

Предполагается скрипт запускать по требованию аналитиков, когда возникнет необходимость в исследовании, предположительно раз в месяц.

## Как запускать.
 1. Копируем фалйы в отедльную директорию на braavos.market.yandex.net. Далее все команды выполняем из этой директории.
 2. Идем в базу биллинга с запросом из feed_query.sql результат сохраняем в dsv разделенный точкой с запятой, файл называем src.csv и копируем в рабочую директорию.
 3. Инициализируем переменные для yt из export_vars.sh 
 4. Командой ./recreate_table.sh yyyy-mm-dd создаем таблицу в yt
 5. Запускаем ./do.sh yyyy-mm-dd|tee out.log, где yyyy-mm-dd текущая дата. Запускать рекомендуется в скрине, т.к. операция долгая.
 6. Получаем результат в таблице //home/market/production/mbi/assortment_feed_errors_stat/yyyy-mm-dd
 

##Прочее
###Как выполнять команды в скрине
Скрин создает сессию независимую от соединения с сервером. Даже если отвалится соединение локальной машины с сервером, команды в скрине продолжат выполняться. 
Нужно создать сесссию, подключиться с ней и выполнять команды как из под обычного ssh.
###Команды: 
Создать сессию: screen -S session_name

Посмотреть сессии: screen -ls

Присоединиться к сессии: screen -x session_name

Выйти из сессиии: ctrl-a d 

 