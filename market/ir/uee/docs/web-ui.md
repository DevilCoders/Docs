## Веб-интерфейс
Доступ к веб-сервису есть по умолчанию у всех сотрудников Маркета. Для внешних пользователей необходимо запросить роль Аналитик в [ABC сервиса](https://abc.yandex-team.ru/services/uee-api/?scope=analitics).

Создать новую задачу на обогащение можно по [ссылке](https://ir-ui.market.yandex-team.ru/#/uee/create)
Потребуется либо загрузить xlsx-файлик прямо в интерфейс, либо указать путь к YT-таблице на hahn либо arnold. В таблице каждая строка (кроме первой) должна соответствовать отдельному офферу, столбцов может быть сколько угодно. В дальнейшем надо будет указать в каких столбцах хранятся содержательные данные об оффере. Соответственно, если есть столбец с тайтлами или описаниями офферов, надо запомнить их названия и дальше выбрать их в соответствующих полях из выпадающего списка. Чем больше разнообразных данных доступно, тем точнее и полнее будет результат, но обязательным полем является только Title (для обогащения Smartmatcher-ом еще id маркетной категории - об этом ниже). UEE использует YT как промежуточное место хранения данных, так что даже загруженные в интерфейс xlsx попадут туда.

Пытаться обогатить оффера через UEE можно в любых объемах, просьба на всякий случай предупредить нас в чатике поддержки о запуске обогащения, если количество строк в вашей выгрузке более 50 миллионов.

Доступно 3 способа обогащения:
- Ultracontroller (UC) - основной инструмент матчинга в Маркете, работает в основном на правилах и обеспечивает высокую точность матчинга на уровне **98%**, но не очень высокую полноту. При обогащении через UC ваша таблица будет поделена на батчи по 100k офферов, которые будут параллельно обогащаться по HTTP-API через production UC с ограничением на число обращений в секунду.
- Smartmatcher (SM) - альтернативный способ обогащения, в основном использующий машинное обучение. При точности порядка **85%** обеспечивает бОльшую полноту по сравнению с UC. Естественное ограничение контракта по сравнению с UC - необходимость указания id маркетной категории. Обогащение через SM происходит синхронно через вызов графа в Nirvanа и передачу ему пути до вашей таблицы
- Комбинированное обогащение (SM + UC) - более длительный процесс обогащения, включающий в себя преимущества обоих способов. Сначала оффера пытаются сматчиться через UC, потом оставшееся пытается доматчиться через SM. Точность матчинга будет не ниже 85%, но матчинг даже совсем небольшого списка офферов может занять от 3 часов.

В результате обогащения вы получите ссылку на YT-таблицу, в которой ваш исходный документ будет дополнен столбцами model_id и sku_market_id (матчинг от UC в режимах UC и UC+SM), а также output_sm_result (матчинг от SM в режимах SM и UC+SM), если какие-то значения в данных столбцах равны 0, значит данный оффер ни с чем не сматчился по UC. В поле output_sm_result нужно смотреть на поля document_id (id sku куда матчили) и confidence (уверенность матча). Процесс небыстрый, из-за оверхеда на запуск различных компонент обогащение что одной строчки, что 100 000 строчек может занимать примерно одинаковое время - в зависимости от типа обогащения минимум от получаса до нескольких часов. При переходе процесса в финальное состояние (Успешно завршено или Завершено с ошибкой) вы получите письмо на почту.

Для продвинутых пользователей есть вкладка "Текстовый лог", где можно отслеживать процесс обогащения и при большом объеме файла получать оценку оставшегося времени. Помимо служебных задач перекладывания данных между системами, для обогащения через УК можно следить за логами задач типа UCEnrichWorkerTasks - пишется, сколько батчей обработано, сколько еще осталось. Для обогащения SM пишется стандартный прогресс от Nirvana, он менее информативный, но в том числе можно найти ссылку на бегущий граф. Текст известных ошибок также пробрасывается на эту вкладку.
