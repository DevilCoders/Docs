## Что делает
Отправляет detach запрос в инстансы указанной реплики указанного сервиса, 
шарды закрываются на индексацию и загружают табличку в YT, 
затем эта тулза merge-ит получившиеся таблицы и пишет `published_index`.

## Как использовать
Указать много аргументов:
* Обязательные 
    * `-s` -- указать имя сервиса 
    * `-t` -- указать `ctype` сервиса (prestable, stable, stable-kv)
    * `--index-path` -- указать путь к итоговому блобу
    * `-p`, `--publish-path` -- путь к итоговому опубликованному индексу
    * `-yt` -- указать прокси
* Необязательные
    * `-d` -- `dry-run`, не отправляет detach-запросы, не делает таблички, а выводит запросы и итоговый файл в `stdout`
    * `-i` -- номер реплики, по умолчанию 1

## Хочу запустить detach руками на одну машинку
Тут надо поправить порт контроллера, `min_shard`, `max_shard`. Если хотите дождаться, пока запись в таблицу завершится, можно поменять `async=yes` на `async=no`
```curl 'localhost:23053/?command=synchronizer&action=detach&async=yes&min_shard=0&max_shard=5460&upload_to_yt=1&yt_proxy=arnold&yt_path=//home/derrior/ugc_kv&sharding_type=url_hash'```

## Как отслеживать статус?
Скоро он будет выводиться тулзой, а пока в узле кипариса `//tmp/saas/detach_to_yt` есть вершинка с таймстемпом, идём туда. Каждый шард берёт лок и пишет табличку. Можно отслеживать количество локов и записанных таблиц (так как они делают это параллельно, нужно только чтобы видеть, что что-то происходит)

## Что дальше?
Теперь можно воспользоваться тулзой [dump_fullarc_to_yt](https://a.yandex-team.ru/arc/trunk/arcadia/saas/tools/dump_fullarc_to_yt), чтобы посмотреть подокументные данные