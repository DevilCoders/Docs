## Утилита для подготовки файлов с обученными моделями

Используется в [графе обучения](https://nirvana.yandex-team.ru/flow/db60050e-f535-4e02-b68d-315bee6ff5b2/graph) и в отдельном [кубике](https://nirvana.yandex-team.ru/operation/d9c31252-3729-457a-9353-2e723928ea1d) из него.

### Описание режимов работы

_create\_model\_json\_params_
Создаёт json файл с параметрами для обучения модели, автоматизируя подстановку размеров входов моделей и реализуя возможность патчить конфигурации через параметры командной строки.

_find\_embeddings\_ranges_
Режим считает на пуле модели (learn_pool) минимум и максимум для каждого значения документных и запросных эмбеддингов, которые строит обученная модель.
Результат сохраняет в табличку: `<pool-dir>/model/model_embedding_min_max_stats`
Также сохраняет Ranges для документной модели в протобуф с ее описанием. В запросную модель не добавляет.
Делается это для экономии памяти при хранении эмбеддингов путем компрессии float в байт и обратно.
Используется для построения метадока [здесь](https://a.yandex-team.ru/arc/trunk/arcadia/extsearch/images/robot/index/metadoc/lib/factors/nn_over_dssm_features.cpp?rev=r8194726#L59) при подсчете сжатых эмбеддингов.

_model\_meta\_info_
Режим считывает ModelMeta из файла на YT в локальный файл из параметров командной строки.

_upload\_models_
Режимы для загрузки моделей и информации о параметрах обучения на YT.
