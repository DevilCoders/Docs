# Библиотека для канонизации урлов видео

- [Точка входа](https://a.yandex-team.ru/arc/trunk/arcadia/extsearch/video/kernel/canolib/videocanonization.h)
- [Тесты](https://a.yandex-team.ru/arc/trunk/arcadia/extsearch/video/kernel/canolib/ut-canonization/ut.cpp)

**Библиотека работает в двух режимах:**
1. ECS_LOCAL - используется пакет локальных конфигов
2. ECS_DEFAULT - используется вкомпиленный конфиг

**Форматы урлов:**
1. EVUT_URL - по умолчанию. Остальные режимы для продвинутых пользователей.
2. EVUT_ORIGINAL_RUL - преобразование kiwi(роботного)-урла с сохранением схемы. В первую очередь используется для уменьшения объемов роботной базы и проклейки дублей с разными схемами, где это оправдано.
3. EVUT_CONTENT_URL - преобразование контентного урла видео к урлу канонической страницы.
4. EVUT_THUMB_URL - преобразование урла картинки.
5. EVUT_ORIGINAL_TO_THUMB_URL - преобразование оригинального урла страницы в урл картинки.
6. EVUT_PARSED_URL - преобразование ParsedUrl. Используется для правильной канонизации главного урла (EVUT_URL).

**Поддерживаемые флаги канонизации:**
- NeedSchemePrefix - дописывать схему для входных урлов, если ее нет.
- KeepSchemePrefix - сохранять схему для преобразованного урла.
- ReplaceWithReSchemePrefix - заменять исходную схему на схему правила канонизации, если она указана в правиле.

