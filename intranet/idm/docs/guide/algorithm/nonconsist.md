# Разрешение неконсистентностей

{% include [nonconsist-reasons](../_includes/entities/nonconsist/id-nonconsist/reasons.md) %}


Подробная схема и описание к ней представлены ниже.

![](../image/nonconsist.svg)

1. IDM сравнивает свою таблицу ролей с таблицей системы.
1. Если IDM обнаружит несоответствие между таблицами, заводит запись в таблице неконсистентностей:
    1. Если в таблице IDM присутствует роль, которая отсутствует в таблице системы, удаляет роль из своей таблицы.
    1. Если в таблице IDM отсутствует роль, которая присутствует в таблице системы, IDM переводит роль в состояние «Импортирована» (копирует роль в свою таблицу). Перейдите к шагу 3.
    
1. IDM проверяет политики, принятые в системе:

   #|
   || Политика | Действие|| 
   ||IDM доверяет системе | **3.1.** Применяет workflow системы, переводит роль в статус «Активная» и состояние «Выдана». Перейдите к шагу 6.||
   ||IDM не доверяет системе и отзывает роль | **3.2.** Переводит роль в статус «Неактивная» и состояние «Отозвана».

   **3.3.** Применяет workflow системы, переводит роль в статус «Запрошена». Перейдите к шагу 4.||
   ||IDM не доверяет системе и перезапрашивает роль | **3.4.** Применяет workflow системы, переводит роль в статус «Запрошена» и состояние «Перезапрошена». Роль необходимо подтвердить в течение 14 дней. Перейдите к шагу 4.||
   |#
    
1. IDM отправляет push-уведомление в систему.
1. Подтверждающий в системе получает уведомление и принимает решение о выдачи роли:
    1. Если решение положительное, IDM переводит роль в состояние «Выдана» и присваивает статус «Активная». Перейдите к шагу 6.
    1. В противном случае IDM переводит роль в состояние «Отозвана» и присваивает статус «Неактивная». Перейдите к шагу 6.
    
1. IDM отправляет сотруднику уведомление о статусе роли.
1. Сотрудник получает уведомление.

