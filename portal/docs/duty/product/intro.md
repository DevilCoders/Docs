# Дежурство по продукту
Текущий основной дежурный: [https://abc.yandex-team.ru/services/home/duty/?role=914](https://abc.yandex-team.ru/services/home/duty/?role=914)
Текущий запасной дежурный: [https://abc.yandex-team.ru/services/home/duty/?role=915](https://abc.yandex-team.ru/services/home/duty/?role=915)

[Дежурные тикеты](https://st.yandex-team.ru/issues/440894)

Основная обязанность дежурного – **своевременная реакция на проблему и принятие мер призванных минимизировать потери**. Дежурный **не обязан** решать все проблемы самостоятельно. В большинстве случаев, самый быстрый способ восстановить работоспособность сервиса – это призвать наиболее подходящего человека способного решить проблему. Дежурный **обязан** реагировать на срабатывание мониторингов и уметь оценить критичность проблемы.

Дежурный по продукту занимается решением проблем, которые не терпят откладывания до итерации планирования.

## Идеология {#ideology}
Качества хорошего дежурного:
* **ответственность** - оперативно реагировать на мониторинги, не замалчивать проблемы
* **критичность** - искать недостатки процессов/сервиса и сообщать о них команде
* **командность** - если кому-то из команды требуется совершить действие с продом, то это надо делать совместно с дежурным; также дежурный должен не бояться просить помощи
* **осознанность** - понимать совершаемые действия, задавать вопросы, по возможности смотреть пулл-реквесты
* **проактивность** - улучшать жизнь дежурным, делая [задачи с тегом duty](https://st.yandex-team.ru/issues/?_f=type+priority+key+summary+description+status+resolution+created+updated+assignee+parent&_q=queue%3A+HOME+and+Tags%3A+duty+and+Status%3A+Open+and+Assignee%3A+empty%28%29). Эти задачи нужно линковать к дежурной и брать в спринт

## Время дежурства
Дежурство начинается в 11:00 по Московскому времени во вторник и длится неделю. Дежурство продолжается на выходных и в праздники. Если дежурный знает, что не сможет дежурить бо́льшую часть дня, то стоит договориться о замене с запасным дежурным. Замену следует провести через график дежурств в ABC (открываем [График дежурств](https://abc.yandex-team.ru/services/home/duty/), наводим указатель на нужную полоску с дежурством и нажимаем в появившемся окошке "Назначить на меня", [скриншот](https://jing.yandex-team.ru/files/dkhlynin/2022-07-08_12-18-27.png)).

## Обязанности дежурного
В обязанности дежурного входит:
- Слежение за состоянием сервиса:
  - Чат [Morda Product (monitoring)](https://t.me/joinchat/BlyRegsiusIHkvRRW8y7Ug) (пользуйтесь `/list_events` в чате, чтобы видеть текущее состояние проверок; на ночь чат можно мьютить)
  - [Дежурная панель](https://yasm.yandex-team.ru/template/panel/morda_lights_dezh/mode=full/) в Головане
  - Дашборд со всеми проверками Морды в [Juggler](https://juggler.yandex-team.ru/project/portal/dashboard?project=portal)
  - Дашборд ошибок в [Кибане](https://portal-kibana.yandex.net/app/kibana#/dashboard/AWKFZoJ3IhB4Gh_c1Xop?_g=())
- Минимизировать ущерб от поломок (закрыть ДЦ и прочие меры снижения ущерба)
- Отвечать на звонки по событиям мониторинга
- Участие во всех инфраструктурных правках на бэкенде
- Следить за отсутствием ошибок на [графике BACKEND CRIT](https://yasm.yandex-team.ru/template/panel/morda_lights_dezh/mode=full/11/)
- Принимать меры для уменьшения общего фона ошибок Морды и проводить чистку [disabled_log_messages](https://madm.yandex-team.ru/edit?export_file=disabled_log_messages&stage=production)
- Отвечать на вопросы [Дежурной смены](https://wiki.yandex-team.ru/jandekspoisk/sepe/dezhurnajasmena/) (Марти), отслеживать важные [чаты](#chats)
- Релизы и контроль за стабильностью после релиза
- Участие в учениях Поискового портала и Морды
- Следить и участвовать в регламентных работах в ДЦ
- Чинить мониторинги и тюнить алерты
- Диагностировать поломки и собирать отладочную информацию
- Искать ответственных за поломанные сервисы и уведомлять смежные команды об их поломках (если они не видят проблему сами)
- Диагностировать упавшие тесты на РЦ (разрешить или заблокировать релиз, передать локализованную проблему дальше)
- Делегировать проблемы дальше, если не может сделать сам (звать на помощь)
- Вести тикет дежурства (каждый день отдельным комментарием, пример [тут](https://st.yandex-team.ru/HOME-80442))
- Посещать [стендап по дежурствам](https://calendar.yandex-team.ru/event/59591445)
- Помогать приходящим с вопросами в чате [Morda Duty](https://t.me/+cY2NsC262es3NjUy), либо найти того, кто может помочь. Не решайте проблемы в личках, в чате вопрос могут помочь решить более опытные коллеги, а также есть история.
- Заведение тикетов на найденные проблемы
- Изучение инфраструктуры и способов диагностики проблем с ней
- Заводить инциденты (кроме инцидентов из-за багов)

{% note warning %}

Если вы вдруг сталкиваетесь с проблемой, которую не знаете как решить, или у вас не хватает рук, то подключайте второго дежурного / остальную команду. Ни в коем случае не забивайте на горящий мониторинг.

{% endnote %}

{% note tip %}

Чат мониторинга крайне желательно мьютить на ночь, чтобы спокойно спать, доверившись лишь звонкам от мониторинга.

Если на вашем мобильном устройстве настроен телефонный ассистент от Алисы или другого голосового помощника, то проверьте настройки приложения, чтобы звонки мониторинга не сбрасывались. Желательно добавить номер мониторинга в список контактов.

{% endnote %}

## Начало
- При заступлении на дежурство нужно размьютить чаты: { #chats }
  - [Координация больших факапов](https://t.me/joinchat/BeUD0kQlNiNqon4C7SSIlQ)
  - [Морда (факапочная)](https://t.me/joinchat/BlyRekEwILp56Vu030x2gg)
  - [Morda Product (monitoring)](https://t.me/joinchat/BlyRegsiusIHkvRRW8y7Ug)
  - [Покатушки Морды](https://t.me/joinchat/BlyRek7XrnZIJpDaD8C3kQ)
  - [Регламентные работы и учения ДЦ](https://t.me/joinchat/PaZhvX5pm5phcPFN)
  - [Факапочная мобильной морды](https://t.me/joinchat/BEdJXBlXz0dBmZGck_IiDQ)
  - [Morda Duty](https://t.me/+cY2NsC262es3NjUy)
  - [Учения поиска](https://t.me/+mLULtqAcu8BmOTgy) (вне учений можно мьютить)

- Если еще не добавлен, то добавить в свой календарь [календарь плановых работ](https://calendar.yandex-team.ru/week?embed&layer_ids=32047&tz_id=Europe/Moscow).

- Ознакомиться с предстоящими регламентными работами и учениями в [календаре плановых работ](https://calendar.yandex-team.ru/week?embed&layer_ids=32047&tz_id=Europe/Moscow) и [https://st.yandex-team.ru/DRILLS-2](https://st.yandex-team.ru/DRILLS-2). Любой релиз должен быть начат **не позднее чем за 1.5 часа** до начала любых крупных работ/учений, которые могут повлиять на работоспособность Морды (прогрузка вертикали WEB не относится к таковым).

- Принять смену от предыдущего дежурного: 
  - Получить всю информацию о текущих проблемах.
  - Принять от предыдущего дежурного по инфре тикет на дежурство, либо создать его самому по [шаблону](https://st.yandex-team.ru/createTicket?template=1543&queue=HOME). В тикете дежурного есть несколько пунктов, которые необходимо будет выполнить за время дежурства. Выполнять большинство из них можно в любое время, но нужно учитывать релизы / регламентные работы / учения.

## Передача смены
  - Передать новому дежурному информацию о всех имеющихся проблемах на [встрече по передаче дежурства](https://calendar.yandex-team.ru/event/59591440)
  - Завести тикет для нового дежурного по [шаблону](https://st.yandex-team.ru/createTicket?template=1543&queue=HOME), прикрепить его к своему тикету и поменять автора тикета на нового дежурного, чтобы не досаждали отбивки в почту из нового тикета. Информацию по нерешенным проблемам сгрузить в новый тикет.
  - Закрыть свой тикет
