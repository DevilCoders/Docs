[![oko health](https://badger.yandex-team.ru/oko/repo/morda/stories/health.svg)](https://oko.yandex-team.ru/repo/morda/stories)
# stories
Репозиторий для хранения json'ов stories.
Настроены проверки:
- eslint всех скриптов из lib и scripts
- Проверка того, что схема для сториз - валидная схема (schemas/json-schema-v7.json)
- Валидация json всех сториз по схеме (schemas/story.json)
- Валидация всех используемых картинок (тип, размер изображения, размер файла)

## Как добавить новую стори

Сториз следует располагать в stories/desktop и stories/touch соответственно их типу.
Каждая стори описывается yml файлом, который должен содержать:
- *id* уникальный id стори
- *story* относительный путь до json файла
- *teaser_text* текст, которым будет подписана стори в тизере
- *bgcolor* цвет подложки в тизере
- *imgurl* относительный путь до картинки для тизера (либо урл, по которому можно скачать картинку, см далее)
- *bk*
- *bk_tag*

Новые сториз следует добавлять через pull-request'ы.

1.
Mac
`brew install libjpeg`
*nix
`apt install libjpeg`

2
`npm ci`

3. Перед пушем следует воспользоваться скриптом для скачивания и оптимизации картинок:

`./scripts/save-local-images </path/to/your/story.yml>`

Для экономии времени, перед пушем следует убедиться, что новая стори проходит проверки.

`npm run check-stories`

## Куда класть картинки

Картинки нужно класть рядом с соответствующим json'ом.
При пуше в master все картинки, на которые есть ссылки, будут залиты в s3, и будет создан tsv файл, содержащий все сториз,
и архив с json и tsv представлением каждой стори.

## Как получить готовый tsv

Дождаться, пока ваш PR будет вмерджен в master и на странице
https://github.yandex-team.ru/morda/stories/commits/master
забрать tsv либо archive
