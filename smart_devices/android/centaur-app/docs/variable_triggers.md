## О переменных и триггерах

### Референсы

1. [Постановка от дивкита](https://wiki.yandex-team.ru/divkit/expressions/)
2. [Картинка о предполагаемой архитектуре](https://st.yandex-team.ru/CENTAUR-547/attachments/45106877?)
3. [Дока про Lua](https://www.lua.org/manual/5.1/manual.html)

### Описание решение

В div верстку на уровне узла "states" добавляется узел с такой примерно конструкцией

```js
"variable_triggers": [
    {
        "conditions": "<div triggers condition>",
        "conditions_lua": "<lua triggers condition>",
        "actions": [
            {
                "url": "<div action>"
            }
        ]
    },
]
```

Где

* "div triggers condition" - описание условия в дилекте divkit'а
* "lua triggers condition" - то же самое условие но в диалекте луа, зачем два раза чуть ниже
* "div action" - набор действий в виде див экшнов

Все это образует известную например в геймдеве концепцию [rule based system](https://en.wikipedia.org/wiki/Rule-based_system)

Описание условия в двух видах необходимо ввиду того, что divkit эту функциональность еще не доделал, и в рамках центавры была сделана реализация на lua.  Поэтому пока работает реализация на lua, но в будущем мы хотим бесшовно перейти на divkit и поэтому уже сейчас надо писать условиях в двух видах корректно.

#### Div Triggers Condition

В общем виде логическое выражение в котором есть знаки логических операций (```!```, ```||```, ```&&```) и можно использовать переменные в виде ```@{isRadioPlaying}```

Список и описание переменных ниже, важно что само имя переменной в Div и Lua Triggers Action совпадают

#### Lua Triggers Condition

логическое выражение на языке lua с обязательной конструкцией return, стоит воспринимать его как тело функции check. Допустимы любые луа операции, в том числе булевы (```not```, ```or``` и ```and```, да в lua они такие), и переменные. Синтаксис использования переменных такой - всё состояние устройства собирается в табличке ```appState``` (табличка - lua'шные термин, воспринимайте это как объект с публичными полями). Имена переменных такие же как в дивном условии, поэтому проверка играния радио будет выглядеть так ```appState:isRadioPlaying()``` (важен доступ к табличке appState и семантика вызова фукнции).

### Описание переменных

#### Радио

* **isRadioPlaying** - играет ли сейчас радио, можно строить условия на положительном или отрицательном значении, [тут](https://a.yandex-team.ru/arc_vcs/smart_devices/android/centaur-app/src/main/assets/div/radio_player_div.json?rev=a825211751a93bd9eebc179055307d44facc9812#L237) например сделано для обоих вариантов
  * div - ```@{isRadioPlaying}```
  * lua - ```appState:isRadioPlaying()```


#### Музыкальный плеер

tbd

#### Видео плеер

tbd