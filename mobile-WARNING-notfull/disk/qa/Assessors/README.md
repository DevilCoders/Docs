# Run_assessors
Скрипт для запуска асессоров: он создает тикет в ST и версию с ранами в TP для тестирования. 
Скрипт запускается с python 2.7

####Установка сертификата для бронировщика
1. Скачиваем корневой сертификат (https://crls.yandex.net/YandexInternalRootCA.crt)
2. Помещаем сертификат в папку mobdisk-test/Assessors

####  Поля, которые нужно заполнить один раз перед первым использованием скрипта
Эти данные нужно заполнить в файле `parameters.json` (необходимо переименовать файл `parameters.json.example` на `parameters.json` )

* `AUTH_ST` - токен для авторизации в StarTrack (для его получения порйдите по ссылке https://oauth.yandex-team.ru/authorize?response_type=token&client_id=5f671d781aca402ab7460fde4050267b)

* `AUTH_TP` - токен для авторизации в TestPalm (для его получения пройдите по ссылке https://testpalm.yandex-team.ru/internal/profile)

* `NEW_TP_TOKEN` - токен для авторизации в новой TestPalm (для его получения пройдите по ссылке https://wiki.yandex-team.ru/testpalm/testpalmdoc/api/, найдите строку OAuth токен можно получить здесь. Нажмите на слово зadдесь)

* `AUTH_YT` - токен для авторизации в YT ( для его получения пройдите по ссылке http://locke.yt.yandex.net/auth/)

* `AUTH_nirvana` - токен для авторизации в нирване (для его получения пройдите по ссылке https://oauth.yandex-team.ru/authorize?response_type=token&client_id=637ca17604cb4dfa90b262952c00b1e9 )

* `requester` - ваш логин в Yandex

* `teamcity_password` - ваш пароль в Yandex

* `yaDiskToken` - нужно запросить доступ к секрету у @nogert https://yav.yandex-team.ru/secret/sec-01d9a8s32s0863jr55743s3pmy/explore/versions

####  Поля, которые нужно заполнять каждый раз перед использованием скрипта
* `telegram` - ссылка на чат в телеграме для запуска асессоров, должна быть константа с ссылкой на чатик в q в процессе автозапуска

* `build` - опциональное поле с ссылкой на билд в Яндекс.Диске для запуска асессоров, так как в скрипте можно скачать последнюю сборку из teamCity

* `special_conditions` - спецусловия для запуска асессоров в Hitman

#### Файлы со сьютами
Имя файла со сьютами состоит из система_типРана, например `android_Business Logic.py`
Можно добавить/удалить сьют или отредактировать версии, на которых запускаются асессоры.
Типы рана:
* `Acceptance` - раны аспантанса без автоматизированных кейсов
* `Business Logic` - раны бизнесс логики
* `Regression` - раны регресса 
* `Update` - раны на обновление
* `Custom` - рандомные раны, тут можно подставлять id нужного сьюта и менять окружения. Этот непостоянный TestRunType нужен именно для запуска сьютов не на регулярной основе. 
#####Сьюты не сформированы для Android
* `Smoke` - смок ран
* `CurrentSprint` - формируется сьют для кейсов с тегом CurrentSprint, которые нужно перепроверить для этого релиза. Каждый раз это будет новый набор кейсов.

```
suites = [
    "id_сьюата" #Название сьюта из пальмы
]

versions = [
    "окружение 1", "окружение 2"
]
```
Список окружений для запуска асессоров можно посмотреть тут https://wiki.yandex-team.ru/eva/search/assessors-testing/Navyki-zadanijj/

####Перед запуском
1. Нужно залить сборку Диска в аккаунт ass.disk
2. Получить ссылку на билд
3. В файле `parameters_example.json` в поле `build` вставить ссылку на билд
```
"build" : "https://yadi.sk/d/HIMAnonPX93HGQ"
```