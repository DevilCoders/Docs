# Вьюер Самовара

## Ссылки на вьюер:
* [Основной вьюер](https://samovar-primary-arnold-gageboard.n.yandex-team.ru/viewer)

Для внешних сотрудников доступны немного ограниченные в функционале версии вьюера:
* [Основной (на кластере Arnold)](https://samovar-primary-arnold-gageboard.ext.yandex.net/viewer)
* [Запасной (на кластере Hahn, данные могут обновляться с задержкой](https://samovar-backup-hahn-gageboard.ext.yandex.net/viewer)


--------------
Основная вкладка для просмотра данных об обходе страниц сайта и всего хоста целиком: **viewer**:

[![samovar_top](https://jing.yandex-team.ru/files/oddeye/browser_puGvxv0ZFN.png)](https://jing.yandex-team.ru/files/oddeye/browser_puGvxv0ZFN.png)

Здесь располагаются поля с данными об обходе как определенных страниц, так и хоста. Важно учитывать, что в этом описании не будут указаны абсолютно все поля: их может быть очень большое число, которые создаются для различных потребителей. Если вам нужно получить какие-то определенные сведения, вы можете найти эти поля по аналогии с примерами ниже. В примерах перечислены часто востребованные поля. 


{% note info %}

Даты обращений в Самоваре указываются в часовом поясе проверяющего.

{% endnote %}

## Вкладка URL
- **AddTime** - время, когда впервые обошли ссылку.

Чтобы посмотреть коды ответа, нужно проверять вкладки:

- **CrawlResult** - здесь можно посмотреть данные о последнем обходе.

{% cut "Во вкладке есть данные" %}

[![samovar_fields](https://jing.yandex-team.ru/files/oddeye/browser_yCDhUYxWcI.png)](https://jing.yandex-team.ru/files/oddeye/browser_yCDhUYxWcI.png)


{% endcut %}


- **CrawlHistory** - то же самое, но с историей обхода, можно посмотреть списки последних обращений к странице. Сверху идут самые последние, от более новых к более старым.
- **BadCrawlResult** - информация о том, когда получили плохой код ответа.
- **BadCrawlHistory** - аналогично, история обхода с плохими кодами.
Важный момент: если в **badcrawl** есть плохие коды ответа, это не значит, что сейчас получаем плохой код ответа, однако в истории есть проблемы. На эти данные можно ориентироваться, если пользователь жалуется, что страницы выпадали из поиска, например.
- **IsBannedByRtAntispam** - забанен ли url антиспамом. Если стоит значение true - значит, урл забанен. Если при этом в поиске с оператором url ссылка отображается как свежая, это означает, что страница забанена именно в свежести, она есть в поиске, но не будет ранжироваться по запросам. В этом случае показываем обращения коллегам из антиспама.
- **IsValidByCrawlResult** - показываем валидность ссылки. Если значение false, это означает, что ссылка не валидная, мы не смогли найти на нее достоверных внешних ссылок. Чтобы урл проиндексировался, необходимо, чтобы на такую страницу вели внешние ссылки, например, из файла sitemap или других доступных страниц сайта.
- **JupiterFastBanHistory** и **JupiterFastBanResult** - отображаются для URL, попавших в быстрый бан. Покажут коды ответов и даты обращений. Быстрый бан - это автоматическое удаление страниц из поиска сразу после того, как с них был получен плохой код ответа, т.е. ошибки 4XX и 5XX. Таким образом несуществующие страницы пропадают из поиска быстрее. Такие страницы переодически перепроверяются повторно, поэтому, если доступ к ним вернулся, они будут включены в выдачу вновь. Баном это называется условно из-за механизма, который скрывает страницы на поиске. 

{% cut "Что можно посмотреть" %}

[![samovar_fastban](https://jing.yandex-team.ru/files/gella/browser_LYXhPnhNnr.png)](https://jing.yandex-team.ru/files/gella/browser_LYXhPnhNnr.png)

[![samovar_fastban_history](https://jing.yandex-team.ru/files/gella/browser_ToDQdLzze6.png)](https://jing.yandex-team.ru/files/gella/browser_ToDQdLzze6.png)

{% endcut %}

- **RedirSourceInfo** - если ссылка является целью редиректа, здесь можно узнать источник редиректа.

[![samovar_redirect](https://jing.yandex-team.ru/files/gella/browser_IbFMmaHDp5.png)](https://jing.yandex-team.ru/files/gella/browser_IbFMmaHDp5.png)

- **UrlType** - тип страницы. regular - HTML-страница, sitemap - файл sitemap.
- **ValidState** - информация о валидности страницы. В частности, можно посмотреть, откуда была найдена страница (пригодится для ответов на вопрос "откуда ссылки").

[![samovar_validity](https://jing.yandex-team.ru/files/oddeye/browser_q5fgvAw7Vd.png)](https://jing.yandex-team.ru/files/oddeye/browser_q5fgvAw7Vd.png)

- **SitemapContentProps** - ОТОБРАЖАЕТСЯ ТОЛЬКО ДЛЯ ФАЙЛОВ SITEMAP. В поле показываются данные об ошибках в файлах sitemap. Если поле "Errors": {}, то в sitemap ошибок нет. "IsSitemapIndex" указывает, является ли sitemap файлом индекса (содержит ссылки на другие sitemap), если значение true - значит, это файл индекса sitemap.
- **SitemapBasisState** - информация о том, с каких сайтов получен проверяемый sitemap. На примере видно, что на проверяемый файл ссылается множество robots.txt с разных сайтов (что определенно является ошибкой на стороне пользователя):

[![samovar_sitemap](https://jing.yandex-team.ru/files/gella/browser_gWD8qtxRkC.png)](https://jing.yandex-team.ru/files/gella/browser_gWD8qtxRkC.png)

{% note info %}

Файлы sitemap не прорастают в отдельные данные, их можно проверять как обычные урлы.
Поля во вьюере кликабельны: чтобы открыть подробные данные, нужно щелкнуть на правое поле вьюера.

{% endnote %}

## Вкладка Host
- **AddTime** - время добавления хоста. Важно учитывать, что это время добавления именно Самовара, в Лемуре могут быть куда более старые данные. Чтобы убедиться, стоит проверять Юпитер и вкладку Lemur.
- **CountersState** - здесь можно посмотреть статистику по числу обхода ссылок за день.
IP - IP-адрес, по которому мы обращаемся к сайту.
- **RobotsTxt** - информация о robots.txt сайта, включая последний полученный документ.
- **UserData (DirectData)** - информация о посещениях сайта за дни. К сожалению, в общее значение числа не складываются, информация показывается списком.
- **HostStatusHistory** - информация о статусе хоста за последние посещения. 1 означает, что сайт доступен и успешно индексируется.

{% cut "Полный список состояний сайта" %}

OK = 0,
FINISHED = 1,
TERMINATED = 2,
HUGE_QUEUE = 3,
BUSY = 4,
CONNECT_LOST = 5,
DISALLOWED = 6,
SUBS_CONNECT_FAILED = 7,
HUGE_ROBOTS = 10,
BAD_ROBOTS = 11,
DNS_ERROR = 12,
TEMP_DNS_ERROR = 13,
CONNECT_FAILED = 14,
RECLUSTER_FAKE = 15,
DNS_SPAM = 16,
SSL_CONNECTION_ERROR = 17,
UNINITIALIZED = 20,
CONNECT_LOST_INIT = 21,
BUSY_DONTRY = 22,
OK_INIT = 23

{% endcut %}

- **SitemapsState** - информация о Sitemap сайта, когда добавлен, откуда узнали  о нем. Например, _sourcetype_ **SS_WEB_MASTER** означает, что файл был добавлен в Яндекс.Вебмастере в соответствующий раздел.

## Вкладка Lemur
Здесь хранятся данные, которые были взяли из старого инструмента Lemur. Проверять тут можно значения addtime, так как Лемур мог узнать о сайте гораздо раньше, а также ValidState, чтобы узнать, из каких источников узнали о ссылке ранее.
- **Host urls**
В этой вкладке можно посмотреть, какие ссылки известны на сайте.

[![samovar_host_urls](https://jing.yandex-team.ru/files/oddeye/browser_83T3NAJxRN.png)](https://jing.yandex-team.ru/files/oddeye/browser_83T3NAJxRN.png)

- **Crawl info**
В этом разделе можно посмотреть более подробные сведения об обходе страницы. Например, хостовые лимиты на обход сайта (указывается максимально возможное число запросов в секунду) и политики обхода.
- **In links**
Сокращенное от incoming links - информация о входящих ссылках на страницу.
Ссылки кликабельны, нажав на ссылку, можно открыть окно с деталями. В частности, в следующем поле можно увидеть текст, с которым ссылка добавлена на страницу:

[![samovar_incoming_links](https://jing.yandex-team.ru/files/oddeye/browser_NdldNk0aDI.png)](https://jing.yandex-team.ru/files/oddeye/browser_NdldNk0aDI.png)

- **Out links**
Исходящие ссылки - схоже прошлой вкладке, в данном разделе можно посмотреть, какие ссылки мы нашли на самой проверяемой страницы.

## Вкладка Push writer
Используется для отправки пушей. Если не знаете, что делаете, лучше не трогать эту вкладку, т.к. она позволяет отправить любые пуши.
