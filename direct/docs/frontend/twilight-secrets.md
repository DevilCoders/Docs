# Секреты Искорки

## Знакомство

Искорка — это [робот](https://staff.yandex-team.ru/robot-twilight) фронтенда директа, которого мы нещадно эксплуатируем

Как мы эксплуатируем Искорку:
- используем её токены для походов в [танкер](https://tanker.yandex-team.ru) при работе с переводами
- список пополняется

## Как установить себе секреты

Для установки требуются две вещи:
- доступ к секретам в [секретнице](https://yav.yandex-team.ru/secret/sec-01e7f91ehb25rw8rpgq2ge1je9/explore/versions)
- общеяндексовый инструмент `ya`

Доступ к секретам автоматически появляется у всех постоянных сотрудников службы фронтенда директа, для буткемперов доступ нужно выдавать отдельно. За доступом можно обратиться к старшим товарищам

Инструмент `ya` можно установить несколькими способами:
- (рекомендуемый): установить аркадию [по инструкции](https://doc.yandex-team.ru/arc/setup/arc/install.html?lang=ru) и использовать аркадийный ya-tool. Для этого, после установки аркадии, в каталоге с примаунченным репозиторием будет доступен `$(arc root)/ya`
- установить напрямую бинарник [по инструкции](https://wiki.yandex-team.ru/yatool/distrib/)


После выполнения этих условий нужно выполнить команду

```bash
cd arcadia # переходим в каталог с аркадией
YA_TOOL=$(arc root) # указываем путь к ya-tool
TWILIGHT_SECRETS=sec-01e7f91ehb25rw8rpgq2ge1je9 # id секрета с токенами
DIR=/etc/direct-tokens/twilight # каталог с будущими секретами
$YA_TOOL/ya vault get version $TWILIGHT_SECRETS -o env > ~/tmp_env
sudo mkdir -p $DIR
sudo mv ~/tmp_env $DIR/.env
```

При выполнении данной команды будет запрошен sudo пароль, чтобы токены можно было положить в каталог `/etc`. Это нормально, спокойно вводим пароль
