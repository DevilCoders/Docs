# UserBlockProcessor

### Продукт/подсистема

Остановка кампаний заблокированных пользователей

### Роль в работе продукта/подсистемы

Ess-процессор выставляет statusShow = 'No' для кампаний заблокированных пользователей и блокирует всех пользователей этого же клиента.
Отдельный процессор, так как в Директе множество мест блокировки клиента, но не везде в них останавливаются кампании. Доработать все такие места выглядит дорого

### Датафлоу

Следит за изменением поля `user.statusBlocked` в `No`, для таких пользователей останавливает все кампании на клиенте и сбрасывает у них statusBsSynced, а так же блокирует всех пользователей для этого клиента

### Способы наблюдения за текущим состоянием
- [Отставание по шардам](https://nda.ya.ru/t/Lcatz-JD3wuM2n)
- [Количество обработанных объектов по шардам](https://nda.ya.ru/t/nZJHE-m53wuM8S)
- [График отставания вычитки топика ESS-роутером](https://nda.ya.ru/t/UojTmwBC3wuM9h)


### Какая функциональность пострадает от отказа джобы

Остановка кампаний заблокированных пользователей


### Как пользователи (или команда) заметят проблему и через какое время

Соседние сервисы могут заметить открутки кампаний заблокированных пользователей. [Пример](https://st.yandex-team.ru/DIRECTSUP-35678).
Кроме того, пользователи могут жаловаться, что им пришло письмо о блокировке, но кампании крутятся

### Контакты разработчиков и менеджеров

Разработчики: [Марина Спиридонова](https://staff.yandex-team.ru/mspirit), [Сергей Журавлёв](https://staff.yandex-team.ru/zhur)


### Желательное время исправления в случае поломки

День - два.


### Способы регулирования работы джобы

- [Общие способы регулирования работы ESS-процессоров](../jobs-common.md#control-ess)

### Известные причины поломок

- Проблемы с LogBroker, ESS.


### Дополнительно: тонкости и подводные камни
