### Продукт/подсистема

Превью оферов для еком доменов.

### Роль в работе продукта/подсистемы

Отправляет в MBI живые еком домены, ранее не отправленные и с заданным числом офферов.

### Датафлоу

- Из ppc-property читает минимальное количество офферов на хосте (```MIN_OFFERS_COUNT_BY_HOST_FOR_SEND_TO_MBI```), с которым домены будут отправлены в MBI.
- Читает из MySQL таблицы ```ppcdict.ecom_domains``` домены, которые не были отправлены в MBI ```market_feed_id == null```, при условии, что количество офферов больше заданного или домен был добавлен через ```Internal Tools```, т.е. ```is_permanent = true```.
- Для каждого домена дергается маркетная ручка ```/direct/site/preview```.
- Для отправленных доменов обновляются поля ```market_feed_id, market_shop_id, market_business_id``` в соответствии с полученными результатами вызова.

### Способы наблюдения за текущим состоянием
- [Juggler-проверка](https://juggler.yandex-team.ru/check_details/?host=checks_auto.direct.yandex.ru&service=jobs.SendEcomDomainToMBIJob.working.production)
- [Логи](https://direct.yandex.ru/logviewer/short/BQgRjjuC4Hh4ir) (не забудьте исправить даты!)
- [Solomon мониторинги](https://nda.ya.ru/t/sQKgGOAs4aVMaA) - линия ```ecom_domains_sent_to_MBI``` отображает количество доменов, отправленных в MBI; линия ```ecom_domains_not_sent_to_MBI``` отображает количество доменов, которые будут отправлены в MBI

### Какая функциональность пострадает от отказа джобы

Перестанут добавляться превью для еком доменов.

### Как пользователи (или команда) заметят проблему и через какое время

В таблице ```ppcdict.ecom_domains``` перестанут добавляться/обновляться офферы, а следовательно для новых магазинов будет отсутствовать превью.

### Контакты разработчиков и менеджеров

Разработчики: [Дмитрий Анощенков](https://staff.yandex-team.ru/dmitanosh) <br/>
Менеджеры: [Дмитрий Уляшев](https://staff.yandex-team.ru/ulyashevda)

### Желательное время исправления в случае поломки

В течение суток

### Способы регулирования работы джобы

- Свойство из ppc-property ```MIN_OFFERS_COUNT_BY_HOST_FOR_SEND_TO_MBI``` - задает минимальное количество офферов, домены с которыми будут отправлены в MBI.

### Известные причины поломок


### Дополнительно: тонкости и подводные камни
