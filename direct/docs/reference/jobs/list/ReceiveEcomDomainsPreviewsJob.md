### Продукт/подсистема

Превью оферов для еком доменов

### Роль в работе продукта/подсистемы

Добавляет новые оффера для превью.
Новые оффера появляются после отправки хостов в MBI (```SendEcomDomainToMBIJob```)

### Датафлоу

- Из ppc-property читает количество повторов чтения из топика за один запуск джобы (```PREVIEW_TOPIC_READS_COUNT```)
- Получает офферы из топика ```bannerland/blrt/preview-offers-output```
- Ищет домены, для которых они предназначены (по ```businessId``` или домену) из MySQL таблицы ```ppcdict.ecom_domains```
- Аггрегирует офферы под один домен и конвертирует их в json, после чего обновляет поле ```preview_offers``` вместе с датой последнего добавления офферов ```last_modified_preview```

### Способы наблюдения за текущим состоянием
- [Juggler-проверка](https://juggler.yandex-team.ru/check_details/?host=checks_auto.direct.yandex.ru&service=jobs.ReceiveEcomDomainsPreviewsJob.working.production)
- [Логи](https://direct.yandex.ru/logviewer/short/r-QPI8AP4FTVkz) (не забудьте исправить даты!)
- [Solomon мониторинги](https://nda.ya.ru/t/sQKgGOAs4aVMaA) - линия ```ecom_domains_with_preview``` отображает количество доменов с офферами

### Какая функциональность пострадает от отказа джобы

Перестанут добавляться превью для новых доменов

### Как пользователи (или команда) заметят проблему и через какое время

Таблица ```ppcdict.ecom_domains``` перестанет обновляться, а следовательно для новых магазинов будет отсутствовать превью оферов

### Контакты разработчиков и менеджеров

Разработчики: [Дмитрий Анощенков](https://staff.yandex-team.ru/dmitanosh) <br/>
Менеджеры: [Дмитрий Уляшев](https://staff.yandex-team.ru/ulyashevda)

### Желательное время исправления в случае поломки

В течение суток

### Способы регулирования работы джобы

- Свойство из ppc-property ```PREVIEW_TOPIC_READS_COUNT``` - задает количество чтений из топика за один запуск джобы

### Известные причины поломок


### Дополнительно: тонкости и подводные камни
