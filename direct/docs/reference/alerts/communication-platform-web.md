# communication-platform
[Ссылка на проверку в juggler](https://juggler.yandex-team.ru/raw_events/?query=host%3Ddirect.solomon-alert.java-web+%26+service%3Dcommunication-platform&project=direct.prod&last=1DAY)
[Ссылка на проверку в solomon](https://solomon.yandex-team.ru/admin/projects/direct/alerts/communication_platform_clicks_loss)

## Описание { #description }
Проверяет, что в платформе коммуникаций в Цезаре не сломалась обработка событий, отсылаемых из Директа. Проверка смотрит на график отправки событие в logbroker и на график отбработки платформы коммуникации. Проверка срабатывает, если на последнюю отправку долго не было отклика на графике обработки.

## Диагностика { #diagnostics }
Из-под супер-смотрителя из [отчета](https://direct.yandex.ru/internal_tools/#send_personal_event) отправляем себе попап (можно без заполнения). Если проблемы с созданием собыий нет, то через 5-10 секунд ручка ответит ОК. Если есть проблемы, то ручка через 30 секунд выдаст статус с ошибкой.
Далее проверяем обрабатываются ли действия пользователя. Из-под того же пользователя заходим в [гриды](https://direct.yandex.ru/dna/grid?ulogin=sanangar). Если событие в прошлом пункте создалось, то всплывет попап. Жмем крестик и обновляем страницу до тех пор пока попап не перестанет показываться. Секунд через 5-10 это должно произойти. Если нет, то есть проблемы с обработкой действий пользователя.

## Решение { #solution }
Если при диагностике проблем не нашли, то наши отправки уже должны были перевести мониторинг в состояние ОК. Если этого не произошло, то проблема в мониторинге или полноте данных, по которым работает мониторинг. В таком случае следует поставить даунтайм на мониторинг и передать ответственным за платформу ([a-dubov](https://staff.yandex-team.ru/a-dubov)).
Если диагностика выявила проблемы с обработкой событий, то следует выключить фичу communication_messages_enabled, чтобы не спамить пользователям попапы, потому что их клики по крестику не обрабатываются. Это отключит попапы для всех пользователей до тех пор пока мы не починим обработку.
