# Metrika Node Tools

Набор компактных утилит и хелперов общего назначения для node.js сервисов

**Ключевой момент – универсальность и компакнтость.**

Не стоит добавлять в этот пакет:
- UI компоненты
- проектоспецифичные хелперы
- универсальные, но сложные и объемные утилиты (например, общий HTTP сервер)
- утилиты, использующие браузерный API

**Каждую добавленную утилиту необходимо описать в документации ниже и написать набор тестов**

## Состав пакета
- error.ts - обертка над типом Error и набор универсальных ERROR_CODES
- logger.ts – универсальный класс логирования
- optional.ts - обертка над опциональными значениями.
    + Позволяет не писать проверок !value (бросает исключение при отсутствии значения)
    + Метод getOrDefault, возвращающий дефолтное значение, если нет основного
    + Cемантичная проверка наличия значения isPresent
- smart-promise.ts - обертка на стандартными промисами
    + Возможность отмены промиса, с вызовом отдельного canceller колбэка
    + Дедлайн исполнения промиса
    + Возможность резолвить и реджектить промис, вне колбэка, передаваемого в конструктор
    + Цепочка зависимостей при отмене промиса
- string.ts — набор утилит форматирования / работы со строками
    + isEmpty – возврает истину, когда передаваемая строка пустая
    + cut - возвращает подстроку с троеточием
    + decodeBase64ToUtf - декодирует base64 в utf
    + formatNumber - приводит число к нужному кол-во цифр, заполняя старшие разряды нулями
    + formatTime - форматирует время (чч:мм:cc:ммм)
- url — набор утилит работы с url
    + joinPath - безопасно склеивает фрагменты path
    + joinUrlPath – добавляем к path URL дополнительный сегмент
- uuid.ts — утилиты для работы с UUID
- ip.ts — утилиты для получения и форматировани IP адресов
- utils.ts – набор утилит общего пользования
    + sleep – возвращает промис, резолвящийся спустя инервал времени, переданный в параметрах
    + noop – функция заглушка, которая ничего не делает
    + compact - фильтр, отсеивающий null и undefined из массива; в отличие от .filter убирает отсеянное из типа
- config - утилиты формирования конфигураций на основе переменных окружения
    + tvm – конфиг tvm аутентификации
    + http - порт для http
- app-supervisor.ts — каркас приложения с обработкой сигналов ОС
