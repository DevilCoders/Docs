# DWH ApiCall

Минимальный клиент к API DWH для публикации заданий и опроса их статуса.
Код используется для походов в API из Нирваны.

Порто-слой достаточный для функционирования данного скрипта:
https://nirvana.yandex-team.ru/layer/d4c4901c-c6ef-4856-b159-8d849577dcec

**Использование**:

1. Получить TVM ид и секрет для TMV-клиента, который будет обращаться к API;

2. Удостовериться, что DWH сконфигурирован для получения запросов от упомянутого клиента;

3. Положить данные запускаемой задачи в in.json;

4. `$ python3 apicall.py --tvm-id 123 --tvm-secret xxx`

   * вместо указания в командной строке можно заполнить переменные окружения `TVM_ID` и `TVM_SECRET`
   * `--in-testing` - обратиться к api на тестовом стенде dwh
   * `--data-file` - указать имя файла с исходными данными для отправки в API (умолчание: in.json)
   *` --out-wait-result` - указать имя файла с резултатом ожидания работы, полученным от API (умолчание: wait_result.json)
   * `--hint` - подсказка к создаваемому запуску работы (поддерживает markdown)

**Запуск тестов**

`ya make -t`
