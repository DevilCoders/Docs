```
 _______    ___           ___           _______.
|   ____|  /   \         /   \         /       |
|  |__    /  ^  \       /  ^  \       |   (----`
|   __|  /  /_\  \     /  /_\  \       \   \
|  |    /  _____  \   /  _____  \  .----)   |
|__|   /__/     \__\ /__/     \__\ |_______/

```

# Тарификатор 3.1: python faas сервер для хостинга калькуляторов.

## Принцип действия:

1. Собираем http сервер: `ya make -D FUNCTION=billing.hot.faas.lib.python.example.foo.async_foo -D FUNCTION_PEERDIR=billing/hot/faas/lib/python`. В результате получаем бинарь, в котором прошит путь до произвольной аркадийной функции и нужная директория запирдирена
2. http сервер с одной ручкой `POST /call`
3. При обращении в эту ручку вызывается вшитая на шаге 1 функция. Она должна принимать два аргумента: `processor_request: ProcessorRequest` — это объект сгенерированный из proto-схемы из `billing/hot/faas/lib/protos/faas.proto` и `context` — объект с вспомогательными вещами. А возвращать функция должна объект ProcessorResponse из той же proto-схемы

http-сервер выполняет сериализацию тела запроса из `json/protobuf` в объект (в зависимости от заголовка `Content-Type`) и отдает ответ в форматах `json/protobuf` (в зависимости от заголовка `Accept`).

* Если функция асинхронная (`async def`), она будет выполнена в общем лупе.
* Если функция синхронная (`def`), то она будет выполнена через run_in_executor

В обоих случаях вызов обернут в `wait_for`, таймаут можно задать через конфиг или переменную окружения `FUNCTION_TIMEOUT`.
