### Общее
1. Ноки ругаются если при нагрузочном тестировании стрелять в балансер.
   Это связано с тем, что в балансере на наши нужды заложен определенный rps на общественном оборудовании.
   При нагрузочном тестировании мы его превышаем, начинаем отжирать чужой ресурс, что может создать у других сервисов проблемы.

1. Стрелять будем по конкретному поду, двум подам, всем подам. На основании этого увидим как масштабируется нагрузка.
1. Для стрельбы в конкретный Pod заказана дырка https://puncher.yandex-team.ru/tasks?id=602b8360e755052c49155052
1. Дырки 8080 с машин разработки я заказывать не стал - можно зайти в под и пострелять там по localhost
1. При стрельбе по nginx стреляем в 443 порт. Например. `billing-accounts-api.ifblsajhhkurxipa.vla.yp-c.yandex.net:443`


Сценарии и что как проверялось лучше посмотреть в тикете
https://st.yandex-team.ru/BILLING-49

### Скрипты подготовки патронов
Крайне кривые, но работают.
* Скрипты готовят данные через апи аккаунтера (если нужно)
* генерят запросы и пишут их в файл
* заливают файл в лунапарк через его апи
* готовят конфиг танка для запуска/запусков и печатают его
Чтобы запустить стрельбу надо открыть лунапарк, вставить конфиг в поле с конфигом и запустить стрельбу.

Разбираться в скриптах лучше начинать с main. Не все что там написано используется
и вычистить их времени у меня не хватило

### Неочевидное
* Заполнять конфиг в форме через поля firestarter https://lunapark.yandex-team.ru/firestarter/
  и в особенности заливать патроны через форму крайне не рекомендуется - долго и не удобно
* Стрелял я через Phantom. Request-style запросами https://yandextank.readthedocs.io/en/latest/tutorial.html#request-style
* Чтобы стрелять по нескольким мишеням надо воспользоваться мульти-тестами https://yandextank.readthedocs.io/en/latest/core_and_modules.html#multi-tests
При этом мишень описанная вне раздела `multi` тоже будет обстреляна и по ней определяется расположение танка.

* Танкисты хмурятся на стрельбу из танка в другие датацентры, но меня не поймали.
  Тем не менее этим лучше не злоупотреблять

* Иногда после обновления подов танк не может попасть по их dns имени.
  Тогда надо взять ipv6 адрес бокса и указать его в качестве мишени `[2a02:6b8:c09:1e03:0:50a0:1b0:1]:443`
  Но надо учитывать что танк при этом автоматически выбраться не сможет и надо передавать конкретный
  ```use_tank: 'vla1-4599-all-rcloud-tanks-30169.gencfg-c.yandex.net'```
  вместо ```use_tank: 'nanny:production_yandex_tank'```
