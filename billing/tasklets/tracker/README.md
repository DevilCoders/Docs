# Тасклеты для работы с Трекером

## Общие параметры

- `config.tracker.api_url`: URL до API Трекера, например `https://st-api.test.yandex-team.ru`, может быть опущен
- `config.tracker.user_agent`: UserAgent всех отправляемых запросов в Трекер (по-умолчанию `billing.tasklets.tracker`)
- `config.tracker.token.uuid`, `config.tracker.token.key`: OAuth-токен Трекера

## IssueCreate

### Описание

Тасклет позволяет создать задачу в Трекере.
Возвращает ключ задачи в `a.key`.

### Используемые параметры

- `config.queue`: очередь, в которой требуется создать задачу
- `config.type`: slug типа задачи, которую требуется создать
- `config.summary`: заголовок задачи
- `config.description`: описание задачи
- `config.assignee`: исполнитель
- `config.followers`: список, наблюдатели
- `config.components`: список, компоненты
- `config.tags`: список, теги

## IssueComment

### Описание

Тасклет позволяет оставить комментарий в задаче в Трекере.
Возвращает ключ задачи в `issue.key` и ID комментария в `long_id`.

### Используемые параметры
- `issue.key`: ключ задачи, в которой нужно оставить комментарий
- `config.text`: текст комментария
- `config.summonees`: список, логины тех, кого требуется призвать в комментарий

## IssueTransition

### Описание

Тасклет позволяет выполнить переход в другой статус в задаче в Трекере.
Ничего не возвращает.

### Используемые параметры
- `issue.key`: ключ задачи, в которой нужно изменить статус
- `config.transition`: slug перехода, который нужно выполнить
- `config.resolution`: slug резолюции, который нужно установить (может быть опущен)
- `config.comment`: комментарий, который требуется оставить в тикете (может быть опущен)

## WaitConfirmation

### Описание

Тасклет позволяет дождаться подтврждения в задаче в Тикете.
Есть возможность задать ожидание подтверждения от нескольких человек.
Ничего не возвращает.

### Используемые параметры

- `issue.key`: ключ задачи, в которой нужно дождаться подтвреждения
- `config.approve`: настройки подтверждения
  - `config.approve.count`: количество людей, которые должны подтвердить
    - может отсутствовать, тогда подтверждение не требуется
  - `config.approve.logins`: список, логины людей, от которых ожидается подтверждение
  - `config.approve.words`: список, слова, которые отслеживаются как подтверждающие (например `ок`, `подтверждено`)
    - если не указано, то проверяются `ок`, `подтверждено`, `подтверждаю`
- `config.reject`: настройки прерывания ожидания
  - `config.reject.sentences`: список предложений, которые прерывают flow (например `не ок`, `не подтверждаю`)
    - может быть не указано, тогда ожидание подтверждения будет отталкиваться от настроек прерывания по статусу или ждать бесконечно
  - `config.reject.status`: slug статуса, которые прерывает flow
  - `config.reject.resolution`: slug резолюции, которая прерывает flow
    - может быть не указано, тогда проверяется только статус
- `config.checks`: проверки, которые потребуют дополнительного подтверждения (например выкладка в пятницу или в конце рабочего дня)
  - `config.checks.holidays`: проверка того, что CI Flow не пытается выполниться в пятницу, предпраздничный или праздничный день
    - `config.checks.holidays.enabled`: включает или выключает проверку (по-умолчанию выключена)
    - `config.checks.holidays.country_id`: ID страны из GeoBase (по-умолчанию `225`, Россия)
  - `config.checks.time`: проверка того, что CI Flow запущен в рабочее время
    - `config.checks.time.enabled`: включает или выключает проверку (по-умолчанию выключена)
    - `config.checks.time.start`: начало рабочего дня (часы, включительно, по-умолчанию `10`)
    - `config.checks.time.finish`: конец рабочего дня (часы, exclusive, по-умолчанию `19`)
    - `tz`: часовой пояс (по-умолчанию `Europe/Moscow`)
  - `config.checks.approve`: настройки дополнительного подтверждения
    - настраивается аналогично `config.approve`
