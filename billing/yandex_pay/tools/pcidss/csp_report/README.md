# Анализатор CSP репортов

Сделан по подобию [анализатора](https://github.yandex-team.ru/kaleda/pci-dss-csp-alerts) от Маркета.

Если в отчет анализатора попадает хотя бы одна строка, то создается тикет в целевой очереди. Нужно чтобы владелец токена (робот) имел права на создание тикетов в очереди. По умолчанию происходит проверка за последний час. Отчет идемпотентный — на каждое событие будет создан один тикет.

Конфигурировать запуск можно как через переменыне окружения, так и через флаги. Например:

`CSP_REPORT_PROJECT=yandexpay CSP_REPORT_PAGE=payment-form CSP_REPORT_QUEUE=YAPAYPCIDSS  CSP_REPORT_SUMMARY="Нарушение CSP на форме Yandex.Pay" ./csp_report -csp_report_dt=2021-06-01`

Для исключения хоста из отчетов, его нужно добавить в `whitelist.json`.
