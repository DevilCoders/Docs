## Эксперименты
#### Что это?
Эксперимент - это возможность протестировать любое новшество (или изменение существующей функциональности) на контролируемой (небольшой) по размеру аудитории пользователей Яндекса. Это обязательный этап для запуска новой функциональности на Поиске.
#### Что может взорвать?
Главная опасность выкатки экспериментов в том, что взорваться может что угодно, из-за этого не рекомендуется выкатка экспериментов совместно с релизами затрудняяющими установить причину проблемы (балансер, антиробот, голован)
#### Когда обычно приезжает в очередь?
По будням два раза в день - утренняя и вечерняя выкладка, в выходной как правило один раз в день.
#### Когда обычно катим?
По будням желательно успеть прокатить утреннюю и вечернюю выкатку экспериментов, из-за этого если в rviewer будет очередь - экспериментам будет одна приоритет, сразу переместятся вверх очреди. В выходные марти выкатывает релиз экспериментов в дневное время.
#### Сколько катится?
30 минут. Это 5 минут на prestable sas, 20 минут пауза, далее 5 минут на все локации сразу.
#### Как катать?

{% note warning %}

**Эксперименты** катаются теперь только через CI

{% endnote %}

## Выкатка через CI

1. Зайти в AB-testing [очередь](https://a.yandex-team.ru/projects/experiments/ci/releases/timeline?dir=quality%2Fab_testing%2Fci%2Fconfigs%2Fproduction%2F222&id=per-location-release).
2. Интересует `[production] config #222 experiments release XX` слева.
3. Проваливаемся в deploy со статусом `Waiting For Manual Trigger`.

{% note info %}

Если необходимо заблокировать куб, то следует сделать ЛКМ по нему, далее для `manual trigger not configured` сделать `enable`, появится Гэндальф для ручного старта куба.

{% endnote %}

{% note info %}

При ошибках в кубах и при необходимости пропустить куб, следует внутри него сделать skip interupted job. Иллюстрация [тут](https://jing.yandex-team.ru/files/lensws/ci_malysheva.mp4).

{% endnote %}

#### При необходимости отката
1. Выбрать в [очереди production config #222 experiments release](https://a.yandex-team.ru/projects/experiments/ci/releases/timeline?dir=quality%2Fab_testing%2Fci%2Fconfigs%2Fproduction%2F222&id=per-location-release) релиз на который надо откатиться.
1. Выбрать на открывшимся таймлайне нужную выкатку, к которой надо откатиться кнопкой `rollback to`.
1. Убрать галочку с отключением `autorun`

Аналогом уведомлений о релизах в CI служит [дашборд в juggler](https://juggler.yandex-team.ru/dashboards/marty_releases/).  
В дашборде можно перейти по ссылке вида `Release is waiting for manual trigger` или `waiting for release`.


#### Кого призывать при проблемах?
При проблемах, эксперименты можно сразу откатить - это быстро. Далее нужны дежурные от [сервиса ab](https://warden.yandex-team.ru/components/ab).
