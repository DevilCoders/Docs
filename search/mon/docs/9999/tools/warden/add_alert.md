# Как добавить алерт?
Сервисы представлены как наборы функциональностей, к которым у нас может быть привязано произвольное количество графиков/алертов.
  
Если вы уже заводили функциональность, для которой вы собираетесь добавить алерт, то переходим к пунтку **Заводим алерт**.

## Заводим функциональность
Выбираем нужную компоненту и на странице компоненты нажимаем на кнопку "Functionality":

![Кнопка functionality](../../_assets/functionality_button.png)

Далее нажимаем на кнопку "Add Functionality":

![Кнопка functionality](../../_assets/add_functionality_button.png)

Далее в открывшемся окне заполняем параметры функциональности:

![Кнопка functionality](../../_assets/add_functionality_form.png)

- **Name** - наименование функциональности.  
- **Description** - описание функциональности. 
- **Weight** - вес функциональности для расчета метрики YDT. 
- **Target ST Queue** - целевая очередь для создания тикетов на инциденты. По-умолчанию, очередь SPI - поле заполнять в этом случае не требуется.  

## Заводим алерт

Открываем функциональность, в которую мы хотим добавить алерт и нажимаем на кнопку "+" в разделе ALERTS.

![Кнопка functionality](../../_assets/add_alert_button.png)

В открывшемся окне заполняем параметры алерта:

![Кнопка functionality](../../_assets/add_alert_form.png)

- **Name** - наименование алерта
- **URL** - ссылка на головановский алерт или juggler проверку
- **Category** - тип алерта:
- **BOOLEAN** - произвольная метрика, по которой YDT не рассчитывается,
- **ERROR_PERC** - процент ошибок,
- **ERROR_ABS** - алерт на абсолютное количество ошибок (требует графика с абсолютным количеством запросов для вычисления доли ошибок).
- **LOSS** - алерт на абсолютное количество ошибок без вычисления процента (не требует графика с абсолютном количеством запросов).
- **Normalize metric calculation by RPS** - нормализует график, как если бы rps был равен заданному персентилю за день (требует графика с абсолютным количеством запросов для вычисления доли ошибок, значение персентиля).
(доступно только при включённой опции Calculate Metric или Calculate Background Metric)
- **Create SPI** - заводить Тикет в трекере при срабатывании алерта
- **Calculate Metric** - рассчитывать метрику (можно YDT) в инцидентах по данной функциональности по данному графику
- **Calculate Background Metric** - рассчитывать фоновую метрику (можно YDT)
(недоступно для типа алерта BOOLEAN)
- **Use Weight Function** - при подсчёте фоновой метрики использовать весовую функцию.
(доступно только при включённой опции Calculate Background Metric)
Про опции Create SPI, Calculate Metric, Calculate Background Metric подробно описано тут.
- **Start incident processing flow** - стартовать протокол координации инцидента.
(доступно только при включённой опции Create SPI)
- **Calculation offset** - нужен, если данные доезжают до графиков не сразу. Тогда фоновый даунтайма будет считаться с константной задержкой в прошлое на n секунд.
(работает только для Соломоновских алёртов, доступно только при включённой опции Calculate Background Metric)
- **Alert Crit Threshold** - нужен для соломоновских графиков в основном, чтобы указать допустимые значения на графиках. Ниже этого порога значения будут сглаживаться весовой функцией.
(доступно только при включённой опции Calculate Background Metric)

#### Почему галочки не нажимаются
- Опция Start incident processing flow может быть активна только вместе с Create SPI
- Опция Calculate Metric не может быть активна, если в данной функциональности уже есть алерт с включённой опцией Calculate Metric

