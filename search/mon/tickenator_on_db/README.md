Тикенатор — сервис предназначенный для заведения тикетов. Заводит тикеты с помощью автоматики из [Beholder](https://wiki.yandex-team.ru/Beholder/)'а, из интерфейса http://tickenator.z.yandex-team.ru, а часть пользователей ходят напрямую в API.
### Локальный запуск
1. Собрать `ya m`.
2. Перед запуском: в переменных окружения DB_URL можно указывать какая база используется (нужно указать), в MODE режим запуска ([один из](https://a.yandex-team.ru/arc/trunk/arcadia/search/martylib/mode/__init__.py?rev=7051229#L17)) (стоит указать, по дефолту PROD, в коде могут быть завязки на это), при локальном запуске например: `env DB_URL=postgresql+psycopg2://postgres:postgres@localhost:5432/tickenator_db MODE='DEV' bin/./tickenator run server tickenator component-controller`. Таблицы создавать не нужно, достаточно создать только саму базу.
3. Запустить `bin/./tickenator run <modules>`, где `<modules>` — список модулей из `bin/modules.py`, к каждому модулю можно обращаться по его алиасу (пример [алиаса](https://a.yandex-team.ru/arc/trunk/arcadia/search/mon/tickenator_on_db/src/services/admin.py?rev=7075496#L109)), например `./tickenator run raft server tickenator model idm component-controller`. `server` запускать обязательно
4. Если нужно будет дергать ручки, то надо указать в переменных среды две переменных `STATIC_USER_ROLES=tickenator-prestable/admin:tickenator-prestable/lol STATIC_USER='some_login'` (если на самом деле проверок прав не будет происходить (в ручку нет вызова IdmRole(), то можно указывать какие угодно значения, это чтоб не ходил в webauth на middleware, куда нет доступа обычно))
5. Чтоб отправлять запросы в локально поднятый сервис, надо запустить еще [serval](https://a.yandex-team.ru/arc/trunk/arcadia/balancer/serval?rev=7051229), указав путь к конфигам: `./serval -c $ARCADIA_ROOT/search/mon/tickenator_on_db/serval_configs/serval_config.yaml` и можно слать запросы на 8888 порт
6. После того как что-то было изменено в протоколах надо запускать horadric ([локально собранный](https://a.yandex-team.ru/arc/trunk/arcadia/search/horadric2/cli) или `ya tool horadric`), чтоб он перегенерил файлы кодогенерации. Про horadric дока [вот](https://a.yandex-team.ru/arc/trunk/arcadia/search/horadric2/doc/README.md).
7. Логи у нас бинарные и читать их надо с помощью [tracedump](https://wiki.yandex-team.ru/sawmill/tracedump/) (локально, а с сервиса через sawmill). Если нет сил читать доку сейчас, то tracedump собирается [тут](https://a.yandex-team.ru/arc/trunk/arcadia/search/martylib/trace/tracedump/bin), чтоб посмотреть логи без фильтрации можно вызвать `tracedump -m0 -fu tickenator.blob` (-u заливает в гуй), чтоб поискать по имени трейса ([пример](https://a.yandex-team.ru/arc/trunk/arcadia/search/mon/tickenator_on_db/src/reducers/task_steps/__init__.py?rev=7270122#L122) трейса в коде) `tracedump -n 'post run' -fu tickenator.blob`, чтоб поискать по значению поля трейса `tracedump -q 'task=some_task_id,another_field=some_value' -fu tickenator.blob`.