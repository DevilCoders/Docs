# Общая схема оценки качества Поиска

Основными источниками информации, используемой для разработки алгоритма ранжирования и оценки качества поиска, являются поисковые лог-файлы и база асессоров (база оцененных запросов).

Все запросы пользователей к поисковой системе сохраняются в поисковые лог-файлы. Каждая запись лог-файла содержит текст запроса, информацию о географическом местоположении пользователя и другую сопутствующую информацию. Ежедневно из поисковых лог-файлов случайным образом равномерно выбирается определенное количество (на данный момент — несколько десятков) запросов. Эти запросы анализируются администраторами службы асессоров. Запросы, не имеющие смысла и запросы поисковых роботов исключаются из дальнейшего рассмотрения.

Для каждого из оставшихся запросов скачивается ответ поисковой системы Яндекса в разных конфигурациях (с выключенным мусорным шардом, переранжированиями и т.п.) и других ведущих поисковых систем (Google, Yahoo, BING и т.д.). Из ответа каждой поисковой системы выбираются десять URL, формирующих первую страницу поисковой выдачи (20 для поиска по изображениям и видео). Выборки объединяются в одну, дублирующие URL удаляются, оставшиеся — перемешиваются случайным образом.

Таким образом, для каждого запроса получается некоторый «перемешанный обобщенный ответ» нескольких поисковых систем. Данный ответ содержит результаты, которые поисковые системы сочли наиболее релевантными запросу. Из текста каждого запроса и «обобщенного ответа» формируется набор заданий, поступающих на обработку [асессорам](asessorsDept.md).

Асессоры оценивают соответствие каждого URL интенту пользователя, производящего запрос, выставляя каждому URL [оценку релевантности](judgeDocs.md). Оцененные запросы накапливаются в базе асессоров.

Общая схема наполнения базы оцененных запросов представлена на рисунке.
![](../images/assessors_scheme.png)
Оценки базы асессоров используются для расчета значений ряда метрик. Расчет выполняется ежедневно. Полученные значения позволяют оценивать качество работы алгоритма ранжирования.

Основной метрикой, отражающей корректность работы поискового алгоритма, является метрика **pfound**.

Основной задачей подразделений, отвечающих за улучшение определенных характеристик поиска, является улучшение значений метрик, отражающих эти характеристики. При этом значения других метрик не должны быть ухудшены и абсолютно недопустимо уменьшение значения метрики **pfound**. Резкие изменения значений метрик являются основанием для анализа процессов, происходящих в поисковой системе.

При выпуске новой версии алгоритма выполняется процедура приемки, включающая проверку значений метрик. Одним из условий приемки алгоритма поиска является сохранение или увеличение значений метрик. Если алгоритм проходит приемку, он выкатывается (начинает использоваться для формирования поисковой выдачи всем пользователям поисковых сервисов Яндекса).

## Узнайте больше {#learnmore}

- [Офлайн-метрики. Справочник аналитика](https://doc.yandex-team.ru/analytics/metrics-offline-desc/concepts/about.html)
