# Исторический график

Значения метрик, рассчитанные для конкретной исторической точки, не позволяют формировать точные выводы о качестве поиска. Более корректным является анализ динамики метрик. Для анализа динамики используются исторические графики.

Существуют следующие типы исторического графика:

- [Дельта плюс](#deltaplus).
- [По абсолюту](#byabsolute).
- [По абсолюту (spam)](#byabsolutespam).
- [KPI 1000](#kpi1000).
- [KPI 1000 (spam)](#kpi1000spam).
- [Потери ideal pfound](#idealpfoundloss).
- [Потери ideal pfound KPI 2010](#idealpfoundkpi2010loss).
- [Потери ideal pfound KPI 2011](#idealpfoundkpi2011loss).

Доступные наборы метрик, потоков и языков запросов зависят от типа исторического графика.

Динамику качества поиска можно оценить для определенного класса запросов, применив требуемый фильтр на свойства запроса. Допускается фильтрация запросов по региону.


## Дельта плюс {#deltaplus}

Правая крайняя точка на графике (соответствующая текущему времени) является абсолютным значением метрики. Остальные точки графика вычисляются в виде дельты усредненных значений метрики, подсчитанных на пересечении по запросам двух соседних серпов.

При построении графика учитывается неравнозначность оцененности разных выдач. Если при нахождении дельты на основе двух выдач в первой выдаче оценено семь документов, а во второй только пять, то оцененность этих выдач уравнивается путем выкидывания двух оценок из первой выдачи.

Побочным эффектом в случае сильной смены выдачи и резкого падения оценености является резкий скачок графика вверх.

Резкие скачки на этом графике свидетельствуют о серьезных изменениях в качестве алгоритма поиска или в поисковой базе данных. Общее падение графиков всех поисковых систем вниз свидетельствует о «протухании» выдачи. С другой стороны, по этому графику нельзя судить об общих тенденциях изменения качества поиска. Так, если качество поиска сильно возросло, но при этом возрастало оно постепенно (без больших скачков), то рост качества поиска будет хорошо заметен на графике [по абсолюту](#byabsolute), но практически не отразится на графике дельта плюс.

По умолчанию отображается метрика **judged-pfound**.


## По абсолюту {#byabsolute}

Каждая точка графика является средним значением метрики, вычисленной для серпа на соответствующую дату. Исторический график по абсолюту отражает общие тенденции изменения качества поиска. Может быть использован для анализа долговременных трендов.

По умолчанию отображается метрика **judged-pfound**.


## По абсолюту (spam) {#byabsolutespam}

Каждая точка графика является средним значением метрики потока Spam, вычисленной для серпа на соответствующую дату. В остальном аналогичен типу [По абсолюту](#byabsolute).

По умолчанию отображается метрика **spamDCG-10**.


## KPI 1000 {#kpi1000}

Каждая точка графика является средним значением метрики, вычисленной для серпа по фиксированному набору запросов на соответствующую дату.

Набор запросов, формирующих KPI 1000, остается неизменным. Раз в год добавляется новый набор из 1000 запросов, который отражается на графике в качестве отдельного потока. Например, поток «Я.KPI 2010» отражает динамику выбранной метрики для Яндекса по зафиксированному в 2010 году набору запросов.

Запросы, формирующие KPI 1000, оцениваются с глубиной 10. При этом выполняется ежедневная дооценка top-5 для всех запросов.

Использование KPI 1000 позволяет решить следующие проблемы:

- частая смена выборки запросов (актуально при анализе динамики метрики на длинных временных отрезках);
- низкая оцененность выдачи (за счет ежедневной дооценки top-5).

По умолчанию отображается метрика **pfound-5**.


## KPI 1000 (spam) {#kpi1000spam}

Каждая точка графика является средним значением спам-метрики, вычисленной для серпа по фиксированному набору запросов на соответствующую дату.

Имеет следующие отличия от [KPI 1000](#kpi1000):

- набор запросов (используется запросы из потока «Spam»);
- отражает динамику метрик потока «Spam».

По умолчанию отображается метрика **spamDCG-10**.


## Потери ideal pfound {#idealpfoundloss}

При обработке поискового запроса выполняется анализ документов, которые могут быть включены в поисковую выдачу. Так как ранжирование результатов поиска является ресурсоемкой процедурой, предварительно выполняется фильтрация ряда документов, которые, наиболее вероятно, не должны быть включены на верхние позиции результатов поиска. Фильтрация является многоступенчатой и может приводить к потере части релевантных документов.

На графике отражаются потери значений выбранной метрики на разных этапах фильтрации. Каждый этап представлен отдельным потоком на графике.

По умолчанию отражаются абсолютные значения метрики **judged-pfound**, рассчитанные для поисковой выдачи на соответствующей потоку стадии фильтрации. При необходимости могут быть отражены изменения значений относительно выбранного этапа фильтрации. Для этого необходимо нажать название соответствующего потока в блоке полей выбора потоков. В этом случае график, соответствующий выбранному потоку, представлен прямой, параллельной оси абсцисс. Данный график принимается за единицу, а остальные отражают отличия значений от выбранного.

Получение сведений о потерях метрик из-за различных фильтров, применяемых при ранжировании, выполняется с помощью сервиса Batch Mode.

Список фильтров, отражаемых на историческом графике, с описанием причины фильтрации приведен в [приложении](../reference/idealpfoundloss.md).

Наибольшее значение на графике имеет поток «Идеальный ответ». Под идеальным ответом подразумевается поисковая выдача, упорядоченная по релевантности.

Критическими являются потери на потоках, соответствующих следующим статусам:

- `NOT_IN_BASE` — потери робота. Указывают на потери из-за документов, которые не проиндексированы.
- `FILTERED_BY_QUORUM` и `NOT_TOUCHED` — потери, связанные с фильтрацией по кворуму.
- `FILTERED_BY_FASTRANK` — потери, связанные с фастранком.

Остальные статусы являются техническими, потери на них должны быть незначительными. Большие потери для остальных статусов указывают на технические сбои при построении графика или неисправности в индексе.

### Узнайте больше {#learnmore}

- [Глоссарий (термины и жаргонизмы в поиске)](http://wiki.yandex-team.ru/JandeksPoisk/Dokumentacija/Glossarijj)

## Потери ideal pfound KPI 2010 {#idealpfoundkpi2010loss}

График отражает потери метрик, рассчитанных для идеального ответа на группе запросов потока [KPI 1000](#kpi1000) 2010 года.


## Потери ideal pfound KPI 2011 {#idealpfoundkpi2011loss}

График отражает потери метрик, рассчитанных для идеального ответа на группе запросов потока [KPI 1000](#kpi1000) 2011 года.

