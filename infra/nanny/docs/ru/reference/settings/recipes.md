#  Настройка рецептов {#recipes-config}
Выкладка сервиса делится на 3 этапа:

* создание "конфигурации" (которая соответствует ревизии сервиса) в системе выкладки
* подготовка "конфигурации" на машинах (стадия **PREPARE**)
* активация "конфигурации" на машинах (стадия **ACTIVATE**)
Все стадии делегированы сервису Кубики (Alemate). Описание процесса - это _рецепт_ в терминах alemate. Рецепт в свою очередь оперирует _конфигурацией_ в понятиях CMS/bsconfig (в дальнейшем ISS). Стадия создания конфигурации не доступна для кастомизации пользователям. Остальные - доступны.

Для выкладки вам понадобится 1 или 2 рецепта. Возможны следующие варианты:

1. Рецепт, который занимается одновременно и подготовкой и активацией конфигурации.
1. Рецепты разделены: один занимается подготовкой, другой - активацией.

Для первого вариант для удобства создан универсальный рецепт, который подойдёт большинству пользователей - [_activate_service_configuration.yaml](http://nanny.yandex-team.ru/ui/#/alemate/recipes/_activate_service_configuration.yaml/). Его надо указать в списке "Activate Recipes". Prepare Recipes при этом **нужно** не указывать.

Во втором варианте необходимо указать 2 рецепта: один в разделе "Activate Recipes", другой - "Prepare Recipes". Так же, для удобства, созданы 2 рецепта, которые подойдут большинству пользователей: [_repo_prepare_snapshot.yaml](http://nanny.yandex-team.ru/ui/#/alemate/recipes/_repo_prepare_snapshot.yaml/) и [_repo_activate_snapshot.yaml](http://nanny.yandex-team.ru/ui/#/alemate/recipes/_repo_activate_snapshot.yaml/).

Для добавления рецепта переходим в раздел "Recipies", нажимаем на кнопку "Add" и описываем рецепт(ы).
![Recipies](https://jing.yandex-team.ru/files/sshipkov/service_recipes.4036560.png)

* Identifier
Уникальное название рецепта и его параметров (контекста) в рамках данного сервиса. Предполагается, что мы можем использовать один и тот же рецепт с разными настройками. Например, "common" и "fast". Этот идентификатор будет использоваться в дальнейшем при нажатии кнопки "Deploy".
* Recipe filename
Название файла рецепта. Например, описанный выше `_activate_service_configuration.yaml`.
* Short description
Человеко читаемое описание, например, `Common deploy script`.
* Recipe context
Параметры, которые необходимо прокинуть в рецепт.
Т.к. рецепты находятся в разделе информационных атрибутов (блок **Information**), то для сохранения изменений необходимо нажать соотвествующую кнопку "Save" и описать изменения.