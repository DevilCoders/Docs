# Конструктор метарецептов

В конструктор метарецептов из дашборда можно перейти, нажав на **Actions → Recipes → Create Dashboard Recipe**.

UI конструктора состоит из двух основных частей: staging area и графа метарецепта.

Граф метарецепта содержит вершину START, а также вершины-кубики. Направленные дуги между вершинами задают очередность выполнения кубиков. У каждой вершины (кроме START) есть два «порта»: входящий и исходящий. С помощью мыши можно перемещать вершины и соединять исходящие порты с входящими.

Staging area играет чисто вспомогательную роль. Например, при создании нового рецепта, там будут содержаться activate-кубики для всех сервисов дашборда. Также с помощью кнопки «New Task» туда можно добавить произвольные кубики. Из staging area кубик можно перетащить в граф метарецепта.

Если навести курсор на кубик, появится множество кнопок для управления его поведением:

![img](https://jing.yandex-team.ru/files/sshipkov/screenshot2016-08-02at13.31.59-1.1f9aa1d.png)

Кнопки позволяют:

* **Show** — просмотреть параметры кубика;
* **Edit** — отредактировать параметры;
* **Manually confirm** — задать необходимость ручного подтверждения таска;
* **Skip** — пропустить исполнение таска;
* **Ban** — пропустить исполнение таска, а также всех последующих за ним, к которым нет путей через данный или другие незабаненные кубики;
* **Delete** — удалить кубик. Если кубик находится в графе, кнопка переместит его в staging area. Если кубик находится в staging area, то он будет удален.

Метарецепты можно видеть в списке **Actions → Recipes**. Там же можно кликнуть на любой из них и отредактировать.

Метарецепт можно применить, нажав на странице дашборда на **Actions → Deploy**, и в появившемся селекте выбрать идентификатор интересующего метарецепта.

Интерфейс снова покажет конструктор — на случай, если перед деплоем в метарецепт хочется внести некоторые изменения (например, поскипать кубики или забанить ветку исполнения). Во все set_snapshot_target_state кубики будут подставлены идентификаторы текущих снапшотов сервисов, входящих в дашборд. Чтобы понять, какие точно изменения будут выкачены, можно воспользоваться кнопкой Show Diff.

По нажатии на кнопку Deploy в кубиках будет создана таскгруппа, а в Няне — объект deployment, и откроется страница для наблюдения за процессом выкладки.
Список всех выкладок можно посмотреть, в дашборде перейдя по **Actions → Deployments**.

