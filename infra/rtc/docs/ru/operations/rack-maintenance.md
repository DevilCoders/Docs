# Обслуживание стойки
## Назначение
Сопровождение проведения itdc-работ со стойками в ДЦ, такими как:
1. Перемещение стойки внутри ДЦ с сохранением адресации.
2. Перемещение стойки внутри ДЦ без сохранения адресации.
3. Перемещение стойки внутри ДЦ в MTN сегмент.
4. Перемещение стойки между ДЦ.
## Планирование работ. Общие правила
1. Заказчик работ формирует перечень [соответствующих itdc-тикетов](https://st.yandex-team.ru/issues/?fixVersions=%5B53793%5D&queue=%5B%22ITDC%22%5D) по регламентному обслуживанию стоек в ДЦ 
**не позднее** вторника недели, предшествующей работам.
2. SRE формирует соответствующие [st/HARDWAREIO](https://st.yandex-team.ru.ru/hardwareio/),
каждый тикет соответствует работам на отдельной стойке. 
3. По сформированным тикетам SRE проводит согласования в соответствии с проектами хостов в стойке, регламентированный срок согласования до 2х дней

## Методика проведения работ в зависимости от проектов
### YT проекты 
* К данным wall-e проектам относятся кластера с тегом `yt` в wall-e
* Запрашиваются в maintenance через CMS **за сутки** до проведения работ
* Согласование и разрешение проблем с уходом хостов в maintenance:
  * [дежурные YT](https://calendar.yandex-team.ru/week?embed&layer_ids=42060&tz_id=Europe/Moscow)
  * В случаях недоступности дежурных: [Павел Сушин](https://staff.yandex-team.ru/psushin) и [Максим Бабенко](http://staff.yandex-team.ru/babenko)
### YP проекты
* К данным wall-e проектам относятся кластера с тегом `yp` в wall-e и не содержащие тег `yt`, также аналогичные правила распространяются на кластера с тегом `rtc.cohabitation-enabled` (сожительство YP/gencfg)
* Если YP сегмент в котором находятся запрашиваемые хосты отличен от `default` необходимо согласование [дежурного YP](https://abc.yandex-team.ru/services/yp/duty/)
* Допустимо запросить не более двух стоек в SAS/MAN/VLA и не более одной в IVA/MYT в рамках работ
* При наличии в перечне хостов в wall-e проектах содержащих тег `yp_master`  SRE призывает [дежурного YP](https://abc.yandex-team.ru/services/yp/duty/) в тикете и согласовывает дальнейшие действия по данным хостам
* Запрашиваются в maintenance через CMS не менее чем за **три рабочих дня** до проведения работ
  * В случае срочных внеплановых работ, а также работ на машинах в проектах с тегом `rtc.gpu-nvidia`(в gpu сегменте), SRE RTC необходимо уведомить [дежурного Nanny](https://abc.yandex-team.ru/services/SR/duty/) не позднее чем за сутки до проведения работ.
  * В случае проблем с выводом машин YP в maintenance в регламентированный срок (3 рабочих дня) машины сдаются в  [дежурного Nanny](https://abc.yandex-team.ru/services/SR/duty/) через [telegram чат Wall-E<>YP & Nanny](https://t.me/joinchat/Tx2iCcuh33Cgkhyp) и призывом в [тикете в HARDWAREIO](https://st.yandex-team.ru.ru/hardwareio/) 
  
День заказа работ  | День проведения
----------------|----------------------
понедельник       | четверг
вторник     | пятница
среда   | понедельник
четверг       | -
пятница    | вторник
пятница | среда

### GenCfg projects 
* к данным проектам относятся wall-e проекты `rtc`, `rtc-mtn`, `rtc-all-dynamic`, `rtc-all-dynamic-mtn`, `rtc-yabs-mtn`
* `rtc-yabs-mtn` - БК, координация [Иваном Строканевым](https://staff.yandex-team.ru/bahbka) и [Артемом Желтковым](https://staff.yandex-team.ru/rmcf). У коллег ручное снятие нагрузки со стойки, необходимо уведомлять не позднее чем за 2 дня, а начинать перевод в maintenance, не позднее вечера предыдущего дня.
* `rtc-mtn` - Большинство хостов базовые, но настоятельно рекомендуется [проверять](../instance-resolver.md) состав сервисов на хостах. Координация по базовым с [Олегом Кац](https://staff.yandex-team.ru/okats?from=suggest) и [Денисом Генераловым](https://staff.yandex-team.ru/mcden). Уведомлять не позднее чем за 2 рабочих дня. Старт перевода в maintenance за 2 дня до работ, выключение вечером дня предшествующего началу работ

## Проведения внеплановых и срочных работ
Допускается запрос и проведение срочных или внеплановых работ. Подобные работы обрабатываются SRE RTC не ранее чем за два дня до планируемой даты проведения.
Тикеты внеплановых и срочных работ должны иметь [соответствующий приоритет в очереди](https://st.yandex-team.ru/issues/?fixVersions=%5B53793%5D&queue=%5B"ITDC"%5D&priority=%5B"blocker"%2C"critical"%5D&resolution=%5B"empty%28%29"%5D) не ниже `critical`.
Подобные работы являеются форс-мажором и их число должно быть минимальным.
Проведение подобных работ без значимого обоснования не допускается.

