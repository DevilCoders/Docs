## points_for_period

Скрипт для выгрузки дорожных событий из логов.

Собирает из лога воедино все события, относящиеся к одной и той же инфоточке.

Примеры запуска:

Выгрузить все созданные точки за неделю
```
./points_for_period -f json -t days -b 2021-08-02 -e 2021-08-09 -o points_20210802_20210809.json --operation_types point_added,point_updated
```

Выгрузить все пользовательские сообщения о ДТП в Москве, которые были показаны, вместе с голосами и комментариями
```
./points_for_period -f json -s -t days -b 2021-08-02 -e 2021-08-09 -o points_20210802_20210809.json --operation_types preset_shown_points_votes_comments --filter_tag accident --filter_region 213
```

Параметры запуска:
  * `-i` - позволяет указать конкретный путь лога (по умолчанию использует стандартное расположение)
  * `-s` - использовать shown-log (лог, в который попадают только точки, 
  которые были показаны пользователям, туда пападают не все события)
  * `-b`, `-e` - задают время начала и конца выгружаемого интервала. Если указываются даты, 
  то начальная дата включается в интервал, а конечная - нет. Помощь по возмоджым форматам указания
  даты и времени - надо запустить скрипт с ключом `-l`
  * `-f` - формат вывода: `json` или `table`
  * `-t` - какие таблицы логов использовать: почасовые (`hours`) или дневные (`days`)
  * `--only_new` - оставить только точки, которые были созданы в указанный период времени
  * `--only_shown` - оставить только точки, которые были показаны пользователям
  * `-d` - Оставить только точки, у которых время появления больше начального момента времени
  и при этом время окончания жизни меньше финального момента времени
  * `-o` - Задает имя файла с результатом, если не указано, будет выведено на stdout
  * `--filter_tag` позволяет указать тег интересующих нас точек (можно указать только один).
  Например: `--filter_tag accident`
  * `--filter_region` - позволяет указать region_id - будут выбраны только точки из соответствующего региона
  * `--operation_types` - позволяет указать типы событий, которые нужно выгрузить.
  Поддерживаются события `point_added` (добавление точки), `point_updated` (обновление точки), 
  `point_shown` (точка отображена на карте), `vote` (голоса за/против точки), `comment_shown` (показан
  комментарий). Можно указать любое подмножество этих событий через запятую. Также можно
  воспользоваться готовыми preset'ами: `preset_point_add_update` соответствует
  `point_added,point_updated` или `preset_shown_points_votes_comments` соответствует 
  `point_shown,vote,comment_shown`. 

На каждую инфоточку будет создана строчка таблицы или элемент списка в json. При этом комментарии и голоса
будут добавлены в соответствующее поле инфоточки в json, но не попадут в результат в виде таблицы.



