В архиве есть несколько файлов

- `.env` - сюда мы записываем переменные, подробности ниже
- `data.xlsx` - из этого файла мы считываем данные для создания пред-заказов
- `index.js` - скрипт который создает пред-заказы
- `fetch-results.js` - скрипт который запрашивает список ранее созданных пред-заказов с бэкенда

## Переменные (.env)

- `OAUTH_TOKEN` - OAuth токен используемый для авторизации
- `COMPANY_ID` - ID компании в "Рабочем месте логиста" (yandex.ru/courier)

## Создание пред-заказов + отправка смс

### Предварительно нужно заполнить `data.xlsx`

| #   | order_number  | phone        | delivery_interval                                     | sms_language	| sms_company_name | sms_order_number |
| --- | ------------- | ------------ | ----------------------------------------------------- | ------------ | ---------------- | ---------------- |
| 1   | 123           | +7XXXXXXXXXX | 2021-10-27T16:00:00+05:00 - 2021-10-27T16:00:00+05:00 | es	          | My company	     | order-777        |

> **delivery_interval** - Опциональный параметр. Формат "Date - Date". ISO 8601
> **sms_language** - Обязательный параметр. На каком языке будет отправлено sms. Поддерживается `uz` и `es`.
> **sms_company_name** - Опциональный параметр. Используется если в шаблоне sms нужно указать название компании.
> **sms_order_number** - Опциональный параметр. Используется если в шаблоне sms нужно указать номер заказа.

### Запуск скрипта создания предзаказов

```sh
node index.js
```

### Результат

По итогу будет создан `sms_results.xlsb`

## Выгрузка пред-заказов

Здесь можно получить заполненные пользователями данные. Будут выгружены те предзаказы id которых указаны в файле `sms_results.xlsb`.

### Запуск скрипта

```sh
node fetch-results.js
```

### Результат

По итогу будет создан `pre-orders.json`

Примерное содержание

```json
[
  {
    "id": "108",
    "number": "preoder-9",
    "phone": "+56932208771",
    "created_at": "2022-04-12T18:42:08.789939+00:00",
    "delivery_info": {
      "address": "Arturo Prat 1157, Santiago, Región Metropolitana, Chile",
      "time_zone": "UTC",
      "comment": "Класс",
      "status": "active",
      "point": {
        "lat": -33.4602915,
        "lon": -70.6473394
      },
      "delivery_interval": {
        "from": "2022-04-12T13:00:00+00:00",
        "to": "2022-04-12T17:00:00+00:00"
      }
    }
  }
]
```
