# Шаг 2. Тестирование продукта

Перед внедрением продукта (и до формирования технического задания на доработки своих систем, если они потребуются) рекомендуется определиться с перечнем необходимых данных и настроек. Для этого нужно протестировать работу алгоритма на нескольких примерах реальных данных (например, за разные дни), и получить устраивающие вас результаты маршрутизации.

1. Выгрузите в шаблон Excel данные за несколько разных дней (либо хотя бы частично автоматизируйте эту выгрузку), чтобы можно было беспрепятственно тестировать планирование на разных данных.

1. Важно: через Excel некоторые операционные схемы реализовать нельзя (например, [допланирование маршрута](https://yandex.ru/routing/doc/vrp/concepts/additional-planning.html)). Также при использовании Excel поддерживаются не все возможности API (полный список полей шаблона приведен в разделе [Инструкция по заполнению](https://yandex.ru/routing/doc/vrp/concepts/excel-fill-guide.html)). Тем не менее в 99% случаев для тестирования достаточно средств Excel.

1. Для дальнейшей настройки планирования узнайте больше о возможностях продукта (см. раздел [Справочник атрибутов и опций](https://yandex.ru/routing/doc/vrp/concepts/properties-general.html)).

1. Ознакомьтесь с [принципами работы алгоритма](https://yandex.ru/routing/doc/vrp/concepts/routing-algorithm.html). Это поможет в понимании его особенностей и в интерпретации результатов. Следует помнить, что алгоритм формирования маршрутов — это модель, которую можно настраивать. Результат ее работы полностью зависит от исходных данных и настроек.

1. Для оценки результатов планирования желательно привлекать специалистов, которые непосредственно занимаются построением маршрутов. Они могут знать нюансы, которые не отражены в данных и настройках. Сформулируйте перечень конкретных замечаний к маршрутам. Проверьте, нет ли в документации опций, которые могли бы помочь устранить замечания.

1. Если в вашем планировании возникают нераспределенные заказы, посмотрите на перечень [возможных причин](https://yandex.ru/routing/doc/vrp/concepts/undelivered-orders.html) их появления.

1. В исходных данных особое внимание обратите на сервисное время: оно должно быть реалистичным. Если его задать с запасом, маршруты получатся очень пессимистичными (потребуется больше машин/курьеров). Если указать недостаточное время, результат, наоборот, будет чересчур оптимистичным.
   - Для проверки значений сервисного времени вычислите величину:

      _Средняя длительность смены − Среднее фактическое количество точек за смену x Усредненное сервисное время_.

      В результате должно остаться какое-то разумное время, чтобы курьер мог передвигаться между точками.

      Важно использовать в расчете именно усредненное время. Если курьер в девяти случаях из десяти тратит на точке 10 минут и в одном случае из десяти – 30 минут, то среднее время на обслуживание составит: _(9 x 10&nbsp;мин + 1 x 30&nbsp;мин) / 10 = 12&nbsp;мин_.

   - Имейте в виду, что при значительном количестве заказов даже небольшая разница во времени на 1 заказ может привести в итоге к разнице в количестве курьеров. Например, на 200 заказах разница в сервисном времени в 2 минуты — это практически полный день работы курьера: _200 x 2 мин = 400&nbsp;мин = почти 7&nbsp;ч_.

1. Обратите внимание на настройки [стоимости использования транспорта](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#stoimost-avtomobilia-ili-kurera). Это не транспортные тарифы, а именно настройки алгоритма. При первых запусках планирования стоит оставить значения по умолчанию (`cost.fixed` = 3000, `cost.km` = 8 , `cost.hour` = 100) или вообще не заполнять эти поля (тогда будут использоваться значения по умолчанию). Принципы настройки следующие:

   - Чем больше значение, тем выше стоимость использования данного ресурса для алгоритма (а значит, алгоритм будет менее склонен выбирать именно этот ресурс).
   - Крайне нежелательно явно ставить 0 в `cost.km` и в `cost.hour`.
   - Для машин разной вместимости нужно указывать разную стоимость (тем больше, чем больше вместимость).

1. Ознакомьтесь с наиболее распространенными [замечаниями к маршрутам и способами их устранения](common-improvements.md).

1. Поменяйте настройки и спланируйте маршруты повторно. Если после нескольких итераций изменения и применения настроек не удается получить реалистичные маршруты, обратитесь в техническую поддержку (по электронной почте [routing-support@yandex-team.ru](mailto:routing-support@yandex-team.ru) или через форму [Обратной связи](https://yandex.ru/routing/doc/vrp/concepts/feedback.html)).

1. На этом шаге важно получить хороший вариант маршрутизации, чтобы понять, какие именно настройки алгоритма использовать и каких данных не хватает для интеграции. Эти моменты нужно будет учесть в дальнейшем при внедрении продукта.

   Также сейчас можно выявить не формализованные особенности в рабочих процессах. Часто эти знания держат в уме люди, которые занимаются построением маршрутов на практике. Наиболее распространенные проблемы:

   - Адреса заказов хранятся в некорректном формате (для точного геокодирования их приходится редактировать вручную).
   - Нет данных о времени обслуживания. Часто на сервисное время сильно влияет объем/состав заказа (иногда нужно подбирать формулу расчета, например 1 минута на каждые 100&nbsp;кг). Также время может зависеть от точек (нужно создавать справочник различных значений времени обслуживания для разных адресов доставки).
   - Нет верных данных о вместимости машин.
   - Нет корректной информации о временных окнах на адресах.
   - Нет сведений о совместимости машин и заказов.

1. Когда получены маршруты, к которым нет критичных замечаний «на бумаге», по ним можно проехать. Но не всегда пилотирование продукта можно начать без организационных или технических изменений. Например, может требоваться интеграция с уже используемыми информационными системами. В этом случае переходите к [Шагу 4](integration.md).

   Если особенности вашего бизнеса позволяют быстро организовать проезд по маршрутам, можно приступить к [Шагу 3](ride.md).


<p class="p"><a href="feedback.html" class="xref button">Написать в службу поддержки</a></p>
