# Устойчивые к изменению окон доставки маршруты

Зачастую при доставке клиент не может принять заказ в указанное время по не зависящим от курьера причинам. При этом клиент все еще хочет получить заказ, даже с нарушением временного окна. При идеально запланированном маршруте это невозможно, так как курьер уже обязан отправиться на следующий заказ, и задержки приводят к нарастающим проблемам с доставкой последующих заказов.

Яндекс Маршрутизация позволяет строить маршруты, устойчивые к вероятному изменению временных окон доставки. При этом заказы группируются ближе друг к другу, чтобы курьер мог доставить другой заказ, а затем вернуться обратно. При таком планировании маршруты получаются менее оптимальными по другим параметрам (пробег, время, количество машин), но более устойчивыми к нарушению временных окон.

Для получения таких маршрутов используйте опцию `options.proximity_factor` со значением от 0 до 10, где 0 - отсутствие группировки заказов, а 10 - максимальная группировка заказов. Мы рекомендуем значения от 0 до 0.6. Более высокие значения могут привести к чрезмерной группировке точек доставки и сильному ухудшению маршрута.


### Как это работает

При построении маршрутов с активированной опцией `options.proximity_factor` Яндекс Маршрутизация несколько раз меняет последовательность точек при вычислении оптимального времени и километража маршрута, имитируя таким образом изменения временных окон на заказах. При этом указанное значение работает как коэффициент, с которым штраф за вероятное изменение времени или длины маршрута добавляется в решение. При таком подходе алгоритму становится выгоднее объединять в один маршрут близко лежащие точки даже не смотря на то, что общее решение от этого может стать хуже.

{% note %}

Использование опции `options.proximity_factor` как правило ухудшает остальные метрики решения. У улучшения клиентского сервиса всегда есть обратная сторона - необходимо использовать больше ресурсов или маршруты становятся менее оптимальными по пробегу или общему времени, поэтому эту опцию рекомендуется использовать только при соответствующих требованиях.

{% endnote %}


<p class="p"><a href="feedback.html" class="xref button">Написать в службу поддержки</a></p>
