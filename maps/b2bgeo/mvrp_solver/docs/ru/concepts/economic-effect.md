# Оценка экономического эффекта от внедрения

Яндекс Маршрутизация оптимизирует решение по показателю “Стоимость с учетом штрафов”.

Стоимость работы курьеров задается в таблице `Vehicle`. Штрафы начисляются за нарушения ограничений планирования, например, опоздание на заказ, нарушение смены водителя и другие. У штрафов есть стандартные рекомендованные значения (заданы в XLS-шаблоне), которые вы можете настроить в зависимости от требований.

Следуя инструкциям ниже вы сможете оценить экономический эффект от внедрения Яндекс.Маршрутизации в вашей компании. Для этого мы рассчитаем стоимость маршрутов ваших Логистов, построим маршруты с помощью Маршрутизатора Яндекса и сравним стоимость.

## Подготовка данных

Подготовьте маршруты за один день, спланированные вашим логистом. Рекомендуется выбирать наиболее загруженный день.

Адреса заказов должны быть геокодированы (в формате географических координат). Если вам нужно провести геокодирование – воспользуйтесь картами, либо [API геокодера](https://tech.yandex.ru/maps/geocoder/).

Соберите информацию о фактическом времени окончания маршрута для каждого маршрута в этот день. Если известно, что на каком-то из маршрутов были происшествия, исключите затраченное на это время.


## Загрузка маршрутов Логиста

- Откройте интерфейс Планирования [Яндекс.Маршрутизации](https://yandex.ru/courier/) и скачайте XLS шаблон.
- Заполните листы `Orders` (заказы), `Vehicles` (машины), `Depot` (склад) информацией подготовленной в предыдущем пункте;
- Привяжите заказы к машинам согласно плану ваших логистов. Для этого:

    - в таблице `Vehicles` укажите номер машины в поле `Свойства ТС`;
    - в таблице `Orders` укажите номер машин в поле `Необходимые свойства машины`;

- В таблице `Vehicles` укажите все составляющие стоимости.
- Запустите задачу в режиме `Low`, чтобы рассчитать метрики решения логиста. Расчет в данном режиме – удобный способ быстро рассчитать метрики уже готового решения.

{% note %}

Планирование с качеством `Low` не обеспечивает высокого качества оптимизации. Чтобы получить надежные результаты, используйте режимы `Normal` или `High`.

{% endnote %}


Ура! Вы произвели свой первый расчет. В полученном решении обратите внимание на строку Итого, это суммарные метрики решения.


## Подбор параметров планирования


Прежде всего, таблица `Недоставленные заказы` должна быть пустой. Если там есть заказы – значит заданы несовместимые ограничения.  Причина недоставки указана в последней колонке таблицы. Устраните проблему в исходном запросе и перезапустите задачу.

Если в строке **Итого** стоимость со штрафами не равна стоимости без штрафов, значит логист нарушает ограничения задачи (либо ограничения не строгие). Чаще всего логист знает более точную информацию о существующих ограничениях задачи. Для сравнения решений в равных условиях необходимо задавать одинаковые ограничения. Соответственно, нужно расширить ограничения в задаче таким образом, чтобы штрафы приблизились к нулю.

Маршрут за маршрутом, сравните фактическое время окончания маршрута, со временем окончания, которое рассчитал сервис Маршрутизации. Если время совпадает, значит поле `Время обслуживания` (лист `Orders`) задано правильно.

Если в реальной жизни водитель возвращается раньше или позже – измените значение `Время обслуживания` и перезапустите расчет.

Когда время окончания маршрута по маршрутизатору совпадет с реальной жизнью – зафиксируйте найденное `Время обслуживания` и переходите к следующему шагу.

Обратите внимание на показатель `Загрузка`. Если в полученном решении вы видите перегрузы, значит логист считает, что это допустимо. Подберите значение допустимого перегруза, например 108%, для всех машин. И перезапустите задачу.

{% note %}

Обратите внимание на количество опозданий. Если опоздания не являются разовым исключением - значит логист считает, что опоздания допустимы. Если по времени опоздания незначительные – установите в запросе Жесткое временное заказа = `FALSE`. Если логист опаздывает больше чем на час, то следует расширить временные окна.

{% endnote %}

Если решение логиста содержит другие штрафы, значит логист нарушает что-то еще, либо считает данные ограничения не важными. Наведите мышку на желтый треугольник в строке маршрута, чтобы увидеть, какие ограничения нарушены. Настройте соответствующие ограничения в запросе таким образом, чтобы штрафов не было.


## Автоматическая маршрутизация

Используйте запрос полученный в результате выполнения пункта "Подготовка данных". Сохраните параметры запроса, чтобы провести сравнение ручного и автоматического планирования в условиях одинаковых ограничений.

Для выполнения автоматической маршрутизации:

- В таблице `Orders` (заказы) удалите теги с номерами ТС.
- На Лист `Vehicles` (машины) добавьте ВСЕ доступные вам машины и их цены. Маршрутизатор выберет те машины, которые оптимально использовать.
- Запустите оптимизацию задачи в режиме `Normal`.
- Сравните решение Логиста с решением Яндекса по метрике `Стоимость со штрафами`.

{% note %}

Свяжитесь с вашим менеджером в Яндексе, чтобы обсудить полученный результат. В письме укажите ссылку на решение Логиста, и ссылку на автоматическую маршрутизацию.

{% endnote %}


<p class="p"><a href="feedback.html" class="xref button">Написать в службу поддержки</a></p>
