# Инструкция по заполнению Excel

## Общее описание

Пример заполненного файла Excel содержится [тут](https://yandex.ru/routing/doc/vrp/concepts/example.html). Допустимые форматы для загрузки: xls, xlsx, xlsm.

Для корректной загрузки данных для маршрутизации книга Excel должна обязательно содержать следующие листы:

-   `Orders` — информация о заказах;

-   `Vehicles` — информация о машинах\\курьерах;

-   `Depot` — информация о точке склада.

Опционально книга Excel может содержать следующие листы:

-   `Incompatible_order_types` — информация о несовместимых типах заказов;

-   `Location_groups` — настройки групп заказов;

-   `Options` — опции маршрутизации;

-   `Routes` — данные о предопределенных маршрутах (маршруты логиста или маршруты прошлого планирования, которые надо сохранить в текущем планировании).

Книга Excel также может содержать листы с другими наименованиями и дополнительной информацией для пользователя — на корректности загрузки это не отражается.

Для корректной загрузки заголовок таблицы на листе (первые несколько строк с названием поля и техническим наименованием атрибута) должен оставаться неизменным. При этом допускается удаление необязательных столбцов (добавление других столбцов с зарезервированными наименованиями), при условии, что не будет возникать пустых столбцов между столбцами с данными.

## Описание листов Excel

### Orders

На данном листе содержится информация о заказах. Строго говоря, каждая строка на данном листе — это не заказ, а пункт (location). Поэтому:

- если осуществляется простая доставка с точки склада, то каждая строка
соответствует заказу;

- если осуществляется доставка из точки А в точку B, то данный заказ будет разбит на 2 строки, одна из которых будет соответствовать пункту получения (pickup), а вторая — пункту доставки (delivery);

- также, в случае старта\\завершения машины\\курьера из\\в точке, отличной от точки склада — данная точка должна быть заведена на этом листе.

{% note "Примечание."  %}

Для листа Orders достаточно заполнить следующий минимум полей (если осуществляется доставка со склада):

-   номер заказа;

-   координаты и\\или адрес заказа;

-   временное окно заказа;

-   объемно-весовые характеристики заказа (вес и\\или объем и\\или количество грузовых мест).

В остальных полях можно оставить значения по умолчанию (или оставить их пустыми) — этого будет достаточно для первого запуска задачи на маршрутизацию.

{% endnote %}

Описание допустимых полей на листе Orders приведено в таблице ниже.

| **Группа полей Excel**  | **Атрибуты** |  **Комментарий к заполнению**  |  **Обязательное поле**  |
| ---------- | ---------- | ---------- | ---------- |
| Номер заказа, дополнительный номер заказа | id, ref  |  Рекомендуется указывать номер заказа в id (ref можно не заполнять или заполнить аналогично id). Значение id должно быть уникально для всего листа (ref может быть не уникальным). Если id не заполнено, то при загрузке данных из Excel и отправке задачи на маршрутизацию оно заполняется как 1, 2, 3…Если заполняется id для заказа, то рекомендуется также указать id для склада (или не указывать в id заказов – 0, поскольку это значение зарезервировано для склада). В некоторых случаях поля используются следующим образом: id заполняют внутренним идентификатором из учетной системы, ref – номером документа (возможно не уникальному), но к которому привыкли пользователи. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#identifikator-zakaza) |  Да (одно из полей)  |
| Широта, долгота	| point.lat, point.lon | Координаты точки заказа: широта (point.lat), долгота (point.lon). Важно убедиться, что координаты не перепутаны местами и нет координат, которые по значениям сильно отличаются от остальных (как правило это признак ошибочного геокодирования – при маршрутизации такой адрес может оказаться очень далеко от остальных и такой заказ не попадет ни в один из маршрутов).	[Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#koordinaty-zakaza) | Нет, если указывается адрес заказа (при загрузке через интерфейс можно геокодировать адрес) |
| Наименование получателя, адрес получателя | title, address	| Информационные поля, которые потом отображаются в интерфейсе планирования. |	Нет (но если координаты заказа не заполнены, то адрес указывать обязательно) |
| Телефон получателя | phone | Используется только для сценария экспорта результатов планирования в [Мониторинг](https://yandex.ru/routing/doc/delivery/concepts/about.html). | Нет |
| Временное окно |	time_window | Если временное окно относительно (то есть в формате 10:00 – 18:00), то важно учитывать сдвиг этого временного окна относительно даты планирования (которая указывается при запуске задачи на маршрутизацию), Подробнее [тут](https://yandex.ru/routing/doc/vrp/concepts/properties-of-time-window.html#otnositelnyi-format-vremennykh-okon) и [тут](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#vremennoe-okno-zakaza) | Да |
| Жесткое временное окно (TRUE/FALSE) |	hard_window |	TRUE – временное окно не может быть нарушено ни при каких обстоятельствах. FALSE – временное окно может быть нарушено (если это повлияет на более оптимальное использование ресурсов). Поле можно оставить пустым – тогда будет считаться, что временное окно мягкое (то есть его можно нарушить). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#vremennoe-okno-zakaza). |	Нет
Время обслуживания на адрес, сек; время обслуживания на заказ, сек |	shared_service\_<br/>duration_s, service_duration_s |	Время, которое машина\курьер проведет на точке заказа (в секундах). Подробнее [тут](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#multizakazy) и [тут](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#servisnoe-vremia-pri-dostavke-zakazov). | Необходимо заполнить для корректной маршрутизации (формально поле не обязательно).
| Вес (брутто), кг; кол-во занимаемых мест; габариты, м (ширина, глубина, высота) |	shipment_size.<br/>weight_kg,<br/> shipment_size.<br/>units, shipment_size.<br/>volume.width_m, shipment_size.<br/>volume.depth_m, shipment_size.<br/>volume.height_m | Объемно-весовые характеристики заказа. Обязательно должны быть меньше максимальной вместимости машины\курьера (если больше, то необходимо разбивать на несколько заказов). shipment_size.weight_kg – вес брутто заказа, shipment_size.units – количество грузовых единиц заказа. Объем вычисляется как произведение shipment_size.volume.width_m,shipment_size.volume.depth_m, shipment_size.volume.height_m. Поэтому можно указать объем в одном из этих полей, а остальные поставить 1. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#ves-zakaza). | Необходимо заполнить для корректной маршрутизации (формально поле не обязательно) |
| Тип груза (bulk/rigid/<br/>fixed_bottom) | shipment_size.<br/>volume.type | По умолчанию габариты не учитываются (значение bulk). Если габариты важны, используются значения: rigid — груз может быть повернут произвольно (т. е. любая его сторона может находиться на дне кузова автомобиля); fixed_bottom — определенная сторона груза должна располагаться на дне кузова (как в случае с паллетой). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#gabarity-zakaza) | Нет |
| Ориентация (all_axes/<br/>height) | shipment_size.<br/>volume.align | Учитывается, если shipment_size.volume.type = rigid или fixed_bottom. Значения: all_axes — все оси груза должны быть параллельны осям кузова автомобиля (груз определяется как параллелепипед с габаритами, определенными в shipment_size.volume.width_m, shipment_size.volume.depth_m, shipment_size.volume.height_m); height — только высота груза (shipment_size.volume.height_m) должна быть параллельна высоте кузова. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#orientatsiia-zakaza-v-avtomobile) | Нет |
| Необходимые свойства машины |	required_tags |	Параметры совместимости заказов и машин. Для одного заказа можно указать несколько тегов, теги указываются через запятую. Тег представляет собой любую строку, которая понятным для пользователя образом идентифицируют необходимое свойство машины\курьера. Для данного заказа может быть подобрана только машина, содержащая весь набор тегов, указанный на заказе. При указании тегов важен регистр символов. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#sovmestimost-zakaza-i-avtomobilei) | Нет |
| Штрафы: за минуту нарушения окна доставки, за факт нарушения окна доставки, за факт ранней доставки, за каждую минуту ранней доставки, за факт опоздания, за каждую минуту опоздания |	penalty.<br/>out_of_time.<br/>minute, penalty.<br/>out_of_time.fixed, penalty.<br/>early.fixed, penalty.<br/>early.minute, penalty.<br/>late.fixed, penalty.<br/>late.minute |	Штрафы за нарушение временного окна заказа. Рекомендуется оставить значения по умолчанию (fixed = 1000, minute = 17) или пустым (в этом случае будет использовано значение по умолчанию). Изменения данного поля желательно только когда понятно его влияние на маршрутизацию. Изменение может потребоваться для сценариев: опоздания на заказ недопустимы (но возможно приезжать раньше временного окна) или наоборот; нарушение временных окон приемлемо, если это ведет к более оптимальному использованию ресурсов. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#shtrafy-za-narushenie-vremennykh-okon-zakazov) |	Необходимо заполнить для корректной маршрутизации (формально поле не обязательно)
| Штрафы за недоставку |	penalty.drop |	Рекомендуется оставить значение по умолчанию 1 000 000 или пустым (в этом случае будет использовано значение по умолчанию). Не использовать значение 0. Изменение данного поля требуется только для сценариев, в которых ожидается, что должны возникать нераспределенные заказы. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#shtrafy-za-nevypolnenie-zakaza) |	Необходимо заполнить для корректной маршрутизации (формально поле не обязательно) |
| Тип заказа (pickup/delivery)	| type	| Один из типов заказов: delivery, pickup, drop off, garage. Поле можно оставить пустым – тогда будет считаться, что заказ имеет тип delivery (доставка со склада). | Необходимо заполнить для корректной маршрутизации (формально поле не обязательно). |
| Место назначения (для заказов с типом pickup)	| delivery_to	| Используется только для сценариев, в которых есть pickup заказы. Поле заполняется только для заказов с типом pickup. В данном поле необходимо указать id связанного заказа c типом delivery. Важный момент – идентификатор, определенный в delivery_to должен быть уникален для каждого pickup заказа. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#priem-i-dostavka)	| Нет |
| Отвезти в любую из точек	| delivery_to_any	|  Используется только для сценариев, в которых есть pickup заказы. Поле заполняется только для заказов с типом pickup. В данном поле необходимо указать id связанного заказа c типом drop off. Важный момент – идентификатор, определенный в delivery_to_any может повторяться для разных pickup заказов. |	Нет |
| Тип совместимости с другими заказами	| load_types	| Параметры совместимости заказов между собой. Для одного заказа можно указать несколько значений load_types, значения указываются через запятую. Load_types представляют собой любую строку, которая понятным для пользователя образом идентифицируют необходимое свойство заказа. При указании Load_types важен регистр символов. Если заполняются значения load_types, то несовместимые типы заказов необходимо заполнить на листе **Incompatible_order_types**. Несовместимые типы заказов не могут быть назначены при планировании в один рейс одного ТС\курьера. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#nesovmestimost-zakazov). | 	Нет |
| Время загрузки заказа на складе	| depot_duration_s |	Для заказов с типом delivery - это время погрузки заказа на складе. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#servisnoe-vremia-na-zagruzku-zakaza-na-sklade). |	Нет |
| Время готовности заказа на складе	| depot_ready_time |	Время, когда заказ готов к выдаче на складе. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html?lang=ru#vremia-gotovnosti-zakaza-na-sklade). |	Нет |

### Vehicles

На данном листе содержится информация о доступных ресурсах (машинах или курьерах). Не обязательно указывать конкретные транспортные средства\\ФИО, можно указать абстрактные ресурсы, а назначением конкретных машин\\курьеров на полученные маршруты заниматься уже отдельно и вне сервиса оптимального планирования маршрутов.

Важно корректно указать все имеющиеся ресурсы на момент планирования:

- если это собственный транспорт (курьеры) — то необходимо перечислить их с учетом плановой недоступности для выполнения маршрутов\\времени рабочей смены;

- если это наемный транспорт (курьеры) и их количество заранее неизвестно, — то необходимо указать их в том количестве, которые обычно привлекается для такого объема заказов. Если есть вариативность по типам, то для каждого типа необходимо указать максимальное количество привлекаемых машин (например, используются наемные машины 1,5 т и 3 т, и каждый раз может привлекаться до 10 машин, но количество машин каждого типа заранее неизвестно, то можно указать 10 одинаковых строк для 1,5 т и 10 одинаковых строк - для 3 т).

{% note "Примечание."  %}

Для листа Vehicles достаточно заполнить следующий минимум полей:

-   номер транспортного средства\\курьера;

-   вместимость транспортного средства\\курьера;

-   время работы.

В остальных полях можно оставить значения по умолчанию (или оставить их пустыми) — этого будет достаточно для первого запуска задачи на маршрутизацию.

{% endnote %}

Описание допустимых полей на листе Vehicles приведено в таблице ниже.

| **Группа полей Excel**  | **Атрибуты** |  **Комментарий к заполнению**  |  **Обязательное поле**  |
| ---------- | ---------- | ---------- | ---------- |
| Логин курьера, название или номер машины |	id,ref	| 	Рекомендуется указывать номер машины\курьера в ref (id можно не заполнять). Значение id должно быть уникально для всего листа (ref может быть не уникальным). Если id не заполнено, то при загрузке данных из Excel и отправке задачи на маршрутизацию оно заполняется как 0, 1, 2… Поле id также важно для сценария экспорта результатов планирования в мониторинг - оно используется как логин курьера в [мобильное приложение](https://yandex.ru/routing/doc/delivery/concepts/about.html). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#identifikator-avtomobilia). | Да (одно из полей) |
| Грузоподъемность, кг; Макс. загрузка, % веса; Кол-во доступных мест; Макс. загрузка, % мест; Размер места для груза, м (Ширина, Глубина, Высота); Макс. загрузка, % объема |	capacity.<br/>weight_kg, capacity.<br/>limits.weight_perc, capacity.<br/>units, capacity.<br/>limits.units_perc, capacity.<br/>volume.width_m, capacity.<br/>volume.depth_m, capacity.<br/>volume.height_m, capacity.<br/>limits.volume_perc	| Параметры вместимости машины\курьера. capacity.weight_kg – грузоподъемность в кг; capacity.units – грузоподъемность в грузовых единицах. Вместимость по объему вычисляется как произведение capacity.volume.width_m, capacity.volume.depth_m, capacity.volume.height_m. Поэтому можно указать вместимость по объему в одном из этих полей, а остальные поставить 1. Помимо номинальной вместимости желательно указать в параметрах limits – возможные перегрузы\плановые недогрузы транспортных средств (особенно, если это практикуется при построении маршрутов вручную или с помощью других программ). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#vmestimost-avtomobilia-ili-kurera). |	Необходимо заполнить для корректной маршрутизации (формально поле не обязательно) |
| Стоимость использования ТС: за км пути, за посещение одного заказа, за час работы, за факт использования ТС, за 1 рейс |	cost.km, cost.location, cost.hour, cost.fixed, cost.run |  Стоимость использования ТС\курьера для алгоритма (это не тариф, это именно ориентир для алгоритма при выборе того или иного варианта маршрутизации). Стоимости cost.km и cost.hour не должны быть равны 0. Если неизвестно, что как заполнять данные поля – лучше оставить значения по умолчанию (cost.fixed = 3000, cost.hour = 100, cost.km=8) или оставить пустыми (в этом случае будут использованы значения по умолчанию). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#stoimost-avtomobilia-ili-kurera). |	Да |
| Свойства ТС, несовместимые свойства ТС |	tags, excluded_tags	| Параметры совместимости заказов и машин. Для одного ТС можно указать несколько тегов, теги указываются через запятую. Тег представляет собой любую строку, которая понятным для пользователя образом идентифицируют необходимое свойство машины\курьера. Для заказа может быть подобрана только машина, содержащая весь набор тегов, указанный на заказе.  При указании тегов важен регистр символов. excluded_tags  используются для кейса, когда машин\тегов слишком много и проще теги настраивать методом исключения (то есть указывать на машинах свойства, которых у них нет). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#tegi-avtomobilia)  | Нет |
| Возврат на склад в конце смены (TRUE/FALSE), место парковки после работы |	return_to_depot, finish_at	| 	Параметры возврата машины\курьера после завершения маршрута (1. на склад, 2. в произвольную точку, 3. сначала на склад, потом в произвольную точку). По умолчанию return_to_depot = true (то есть машина возвращается на склад), если поле оставить пустым, то будет использовано значение по умолчанию. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#vozvrat-na-sklad-v-kontse-rabochego-dnia) | Нет |
| Макс. число рейсов |	max_runs	| 	Максимальное количество рейсов, которое может быть выполнено за все указанные смены. По умолчанию 1. Под рейсом в алгоритме подразумевается выезд со склада (depot) и развоз заказов до возврата на склад (при этом – если осуществляется возврат на точку, которая имеет координаты, равные координатам склада, то это не засчитывается за рейс). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#neskolko-reisov-avtomobilia-v-den) |	Нет |
| Коэф. скорости передвижения |	travel_time\_<br/>multiplier	| Коэффициент ускорения\замедления ТС\курьеров относительно рассчитанной скорости по статистике. Рекомендуется не использовать на начальных запусках маршрутизации, а по мере получения определенного опыта использования сервиса. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#korrektirovka-vremeni-dvizheniia-avtomobilia) | Нет |
| Коэф. сервисного времени |	service_duration\_<br/>multiplier, shared_service\_<br/>duration\_<br/>multiplier	| 	Коэффициент ускорения\замедления ТС\курьеров относительно сервисного времени. Рекомендуется не использовать на начальных запусках маршрутизации, а по мере получения определенного опыта использования сервиса. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#korrektirovka-vremeni-obsluzhivaniia) | Нет |
| IMEI	| Imei	|  IMEI GPS трекера данного транспортного средства. Используется только для сценария экспорта результатов планирования в мониторинге. [Подробнее](https://yandex.ru/routing/doc/delivery/concepts/about.html). | Нет |
| Метод передвижения	| routing_mode	| Заполняется только если ТС\курьеры имеют разный способ передвижения (например – автомобиль и общественный транспорт). Если способ передвижения у всех одинаковый – то заполнять данные поле нет необходимости - при запуске задачи на маршрутизацию можно выбрать способ передвижения, который будет использоваться для всех. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#rezhim-marshrutizatsii) |	Нет |
| Место старта маршрута, заезжать на склад после старта маршрута? (TRUE/FALSE) |	start_at, visit_depot\_<br/>at_start	| 	Параметры стартовой точки машин\курьеров до начала маршрута. По умолчанию все стартуют с точки склада. Можно указать другую стартовую точку, а также указать необходимость заезда на склад после выезда из стартовой точки. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#start-avtomobilia-ne-so-sklada) |	Нет |
| Смены	|   | Для одного транспортного средства\курьера может быть указано несколько смен. Все они заполняются в одну строку по следующему принципу – сначала указывается группа полей с префиксом shifts.0, затем shifts.1, shifts.2 и так далее. Данный номер служит идентификатором смены для сервиса планирования маршрутов.	| Да, как минимум 1 смена обязательна |
| Время начала и конца смены	| shifts.N.<br/>time_window	| 	Время доступности водителей для планирования маршрутов. Если машины\курьеры обычно работают, например, с 9 до 17 (но небольшие переработки иногда случаются), то лучше сразу указать доступное время работы, например, с 9 до 17:30). При простановке временного окна смены важно учитывать время в начале маршрута\время в конце маршрута, поскольку алгоритм считает, что это время входит во время работы машины\курьера. Также, если машина\курьер возвращается на склад – это время также учитывается во времени работы машины\курьера (и должно быть отражено в окне смены). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#smeny-raboty-avtomobilia-ili-kurera) |	Да |
| Жесткое временное окно TRUE/FALSE	| shifts.N.<br/>hard_window	| 	TRUE – временное окно смены не может быть нарушено ни при каких обстоятельствах. FALSE – временное окно смены может быть нарушено (если это повлияет на более оптимальное использование ресурсов). Поле можно оставить пустым – тогда будет считаться, что временное окно мягкое (то есть его можно нарушить). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#smeny-raboty-avtomobilia-ili-kurera) | Нет |
| Время на подготовку к смене, с	| shifts.N.<br/>service_duration_s	| 	Данное время имеет смысл ставить только в случае нескольких последовательных смен машины, даже с пересекающимися временными окнам (например, смена 1 - 9 до 14, смена 2 - 13 до 18, то есть смена 1 может закончиться раньше 14, но точно не позже, также смена 2 – может начаться не раньше 13, но может и позже). Если необходимо задействовать 2 смены при планировании маршрутов, то данный параметр добавляется дополнительно между 2 этими сменами. [Подробнее](сделать отдельное описание этого параметра)	| Нет |
| Штраф за минуту нарушения окна смены, штраф за факт нарушения окна смены, штраф за минуту раннего начала смены, штраф за факт раннего начала смены, штраф за минуту позднего завершения смены, штраф за факт позднего завершения смены |	shifts.N.<br/>penalty.<br/>out_of_time.<br/>minute, shifts.N.<br/>penalty.<br/>out_of_time.fixed, shifts.N.<br/>penalty.<br/>early.minute, shifts.N.<br/>penalty.<br/>early.fixed, shifts.N.<br/>penalty.<br/>late.minute, shifts.N.<br/>penalty.<br/>late.fixed | 	Штрафы за нарушение временного окна заказа. Рекомендуется оставить значения по умолчанию (fixed = 1000, minute = 17) или пустым (в этом случае будет использовано значение по умолчанию). Изменения данного поля желательно только когда понятно его влияние на маршрутизацию.Изменение может потребоваться для сценариев:  раннее начало смены недопустимо (но возможно завершать смену позднее) или наоборот; нарушение временного окна смены приемлемо, если это ведет к более оптимальному использованию ресурсов; используется жесткое окно смены и параметр [Максимальная продолжительность смены](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#maksimalnaia-prodolzhitelnost-smeny). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#smeny-raboty-avtomobilia-ili-kurera) |	Нет |
| Мин. число остановок, шт; штраф за каждую остановку меньше минимального кол-ва, штраф за факт недостижения минимального количества остановок | shifts.N.<br/>minimal_stops, shifts.N.<br/>penalty.<br/>stop_lack.<br/>per_stop, shifts.N.<br/>penalty.<br/>stop_lack.fixed	| 	Рекомендуется не использовать на начальных запусках маршрутизации (оставить пустым). В дальнейшем можно использовать для обязательного использования собственного транспорта. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#ogranichenie-kolichestva-ostanovok-v-smene)	| Нет |
| Макс. число остановок, шт; штраф за каждую остановку больше максимального кол-ва, штраф за факт превышения максимального количества остановок |  shifts.N.<br/>maximal_stops, shifts.N.<br/>penalty.<br/>stop_excess.<br/>per_stop, shifts.N.<br/>penalty.<br/>stop_excess.fixed |	Рекомендуется не использовать на начальных запусках маршрутизации (оставить пустым). В дальнейшем можно использовать для ограничения количества точек в маршруте: для большегрузных машин (если это нельзя ограничить другими средствами, например, сервисным временем на заказах); для установи практического ограничения количества точек на маршруте (если, например, проверено на практике, что маршрут больше определенного количества точек курьер не выполнит без нарушений из-за возникновения тех или иных непредвиденных обстоятельств). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#ogranichenie-kolichestva-ostanovok-v-smene) |	Нет |
| Макс. длительность смены, сек	| shifts.N.<br/>max_duration_s	| 	Рекомендуется не использовать на начальных запусках маршрутизации (оставить пустым). В дальнейшем можно использовать для ограничения времени работы машин\курьеров, когда нет заданного окна смены (то есть оно очень широкое), но нужно, чтобы выполнялось ограничение по времени работы машины\курьера. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#maksimalnaia-prodolzhitelnost-smeny) |	Нет |
| Посещенные заказы, время первого посещенного заказа	| shifts.N.<br/>visited_locations, first_visited\_<br/>location\_<br/>started_at	|  В поле shifts.N.<br/>visited_locations можно перечислить id тех заказов, которые уже были назначены на данную ТС. При перечислении важна последовательность. Опционально в поле first_visited_location_started_at можно указать время старта для первого заказа. Используется в случаях [допланирования] (https://yandex.ru/routing/doc/vrp/concepts/additional-planning.html), а также в случаях, когда нужно зафиксировать часть маршрута (или маршрут целиком), причем в нужной последовательности. | Нет|
| ID группы балансировки |	shifts.N.<br/>balanced_group_id	| Рекомендуется не использовать на начальных запусках маршрутизации (оставить пустым).Если возникнет потребность получать более равномерные маршруты, то можно заполнить группы балансировки на листе Options и в данном поле указать идентификатор группы балансировки. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/balanced-groups.html) |	Нет |
| Перерывы |  | Для одного транспортного средства/курьера можно указать несколько перерывов. Они описываются в одной строке: сначала группа полей с префиксом rest_schedule.breaks.0, затем с rest_schedule.breaks.1, rest_schedule.breaks.2 и т. д. | Нет |
| Время работы до отдыха | rest_schedule.<br/>breaks.N.<br/>work_time_range_till_rest | Продолжительность работы до перерыва. В ней учитываются периоды движения, ожидания и сервисное время на заказах и складе. Задается как диапазон времени в относительном формате. Например, значение 04:00–05:00 указывает, что отдых должен начаться не ранее, чем через 4 часа, но не позднее, чем через 5 часов после начала работы. Если перерывов несколько, в каждом указывается диапазон времени работы после завершения предыдущего перерыва. Например, если в первом перерыве задано 04:00–05:00, а во втором — 02:00–03:00, то первый перерыв должен начаться между 4 и 5 часами после начала работы, а второй — между 2 и 3 часами работы после завершения первого перерыва. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#rezhim-raboty-kurera) | Нет |
| Длительность перерыва, секунды | rest_schedule.<br/>breaks.N.<br/>rest_duration_s | Продолжительность перерыва (в секундах). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#rezhim-raboty-kurera) | Нет |
| Штраф за факт начала перерыва раньше, Штраф за каждую минуту перерыва раньше срока, Штраф за факт начала перерыва позже, Штраф за каждую минуту перерыва позже срока | rest_schedule.<br/>breaks.N.<br/>penalty.early.fixed, rest_schedule.<br/>breaks.N.penalty.<br/>early.minute, rest_schedule.<br/>breaks.N.penalty.<br/>late.fixed, rest_schedule.<br/>breaks.N.penalty.<br/>late.minute | Перерыв — мягкое ограничение: в некоторых случаях он может начинаться раньше или позже диапазона, определенного в поле work_time_range_till_rest. Алгоритм учитывает штрафы: early — для начала перерыва раньше срока; late — для начала перерыва позже срока. Чем больше значения штрафов, тем менее предпочтительно нарушение ограничения. Рекомендуется использовать значения по умолчанию (fixed = 1000, minute = 17) или пустые (тогда будут использованы значения по умолчанию). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#rezhim-raboty-kurera) | Нет |


### Depot

На данном листе содержится информация о складе, с которого будет производиться отгрузка. На данном листе заполняется только одна строка — если используется несколько складов (и отгрузка с них происходит независимо) — то необходимо использовать разные файлы Excel.

Строка склада обязательна для заполнения. Если машины\\курьеры стартуют не со склада и не возвращаются на склад в конце маршрут (то есть нет никакой точки, к которой они были бы как-то привязаны) — то в качестве склада можно указать координаты любой точки, например, координаты офиса или координаты центра города.

{% note "Примечание."  %}

Для листа **Depot** достаточно заполнить следующий минимум полей:

-   название склада (можно просто «Склад»);

-   координаты склада;

-   время работы склада (можно поставить максимально широко — с 00:00-23:59 на текущие сутки планирования или с 00:00-1.23:59 — на текущие и следующие сутки планирования).

В остальных полях можно оставить значения по умолчанию (или оставить их пустыми) — этого будет достаточно для первого запуска задачи на маршрутизацию.

{% endnote %}

Описание допустимых полей на листе **Depot** приведено в таблице ниже.

| **Группа полей Excel**  | **Атрибуты** |  **Комментарий к заполнению**  |  **Обязательное поле**  |
| ---------- | ---------- | ---------- | ---------- |
| Номер склада, Название склада	| Id, ref	| 	Id склада не должно повторять ни один из id заказов (то есть id заказов и склада должны быть уникальны). Если id не заполнено, то при загрузке данных из Excel и отправке задачи на маршрутизацию оно заполняется как 0. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#identifikator-sklada) |	Да |
| Широта, Долгота	| point.lat, point.lon	| 	Координаты точки склада: широта (point.lat), долгота (point.lon). Необходимо указать именно координаты, в интерфейсе нет возможности указать и геокодировать адрес склада. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#koordinaty-sklada) |	Да |
| Время работы склада	| time_window	| 	Если нет каких-то специальных требований ко времени возврата машин на склад\пропускной способности склада, то рекомендуется указывать максимально широкое время работы склада (например, 00:00 – 23:59 для планирования только в рамках одного дня или 00:00 – 1.23:59 – в рамках 2-х суток). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#vremennoe-okno-sklada)	| Да |
| Жесткое время работы склада, TRUE/FALSE	| hard_window	| 	TRUE – временное окно склада не может быть нарушено ни при каких обстоятельствах. FALSE – временное окно склада может быть нарушено (если это повлияет на более оптимальное использование ресурсов). Поле можно оставить пустым – тогда будет считаться, что временное окно мягкое (то есть его можно нарушить). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#vremennoe-okno-sklada) | Нет |
| Гибкое время старта TRUE/FALSE	| flexible_start_time	| 	Если важно получать от сервиса требуемое время старта машины\курьера – то нужно использовать данный параметр. Если время работы курьера отсчитывается от времени начала смены, то включать данный параметр нет необходимости. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#gibkoe-vremia-starta) | Нет |
| Время обслуживания в начале маршрута, с; время обслуживания в конце маршрута, с	| service_duration_s, finish_service_duration_s	| 	Необходимо заполнять с учетом временного окна [смены](https://yandex.ru/routing/doc/vrp/concepts/properties-of-vehicles.html#smeny-raboty-avtomobilia-ili-kurera). Например, если нужно заполнить только время, которое должно добавляться только между рейсами, то можно поступить следующим образом: 1. Использовать только service_duration_s.  2. Время начала первой смены сделать раньше на значение service_duration_s. Например, водители работают с 9 до 17, необходимо учесть между рейсами 30 минут на загрузку, в начале маршрута – машины уже загружены, то есть в 9 водители выезжают, значит, необходимо поставить смену с 8:30 до 17, а параметр service_duration_s сделать равным 1800 (тогда алгоритм будет считать, что работа начинается в 8:30, полчаса уходит на загрузку — то есть выезд возможен в 9:00. А в дальнейшем между рейсами будет добавляться эти полчаса).	[Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#servisnoe-vremia-na-sklade) | Нет |
| Штраф за минуту нарушения окна работы склада, фиксированный штраф за факт нарушения окна работы склада, штраф за факт приезда раньше окна работы склада, штраф за каждую минуту раннего приезда, штраф за факт приезда позже окончания работы склада, штраф за каждую минуту опоздания на склад	| penalty.out_of_time.minute, penalty.out_of_time.fixed, penalty.early.fixed, penalty.early.minute, penalty.late.fixed, penalty.late.minute	| 	Штрафы за нарушение временного окна заказа. Рекомендуется оставить значения по умолчанию (fixed = 1000, minute = 17) или пустым (в этом случае будет использовано значение по умолчанию). Изменения данных полей желательно только когда понятно их влияние на маршрутизацию. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#shtrafy-za-narushenie-vremennogo-okna-sklada) | Нет |
| Пропускная способность, кг/час; пропускная способность, мест/час	| throughput.kg_per_hour, throughput.units_per_hour |	Для начальных запусков маршрутизации рекомендуется оставить эти поля пустыми. Прежде чем использовать параметры пропускной способности, рекомендуется использовать параметр flexible_start_time, на практике он дает такой же эффект распределения времени старта машин во времени. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-depot.html#propusknaia-sposobnost-sklada) |  Нет |
| Фиксированный штраф за нарушение пропускной способности, штраф за каждый килограмм превышения пропускной способности, штраф за каждое место превышающее пропускную способность	| penalty.throughput.fixed, penalty.throughput.kg, penalty.throughput.unit |	Для начальных запусков маршрутизации рекомендуется оставить эти поля пустыми. Далее можно использовать значения по умолчанию (penalty.throughput.fixed = 1000, penalty.throughput.kg = 50, penalty.throughput.unit = 100) и корректировать их, исходя из получаемых результатов. |	Нет |

### Incompatible_order_types

На данном листе содержатся настройки несовместимых типов заказов. Если несовместимость заказов не используется (поле load_types), то данный лист можно не заполнять.

На данном листе всего 2 столбца: в столбце [type](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html/nesovmestimost-zakazov) необходимо указать одно значение load_types, а в столбце [incompatible_load_types](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html/nesovmestimost-zakazov) перечислить через запятую значения несовместимых с ним load_types. Каждую пару несовместимых load_types достаточно указать только один раз.

Например, если несовместимы типы 1,2,3,4, то достаточно указать такие строки:

| [type](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html/nesovmestimost-zakazov) | [incompatible_load_types](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html/nesovmestimost-zakazov) |  
| --------- | --------- |
| 1	| 2,3,4 |
| 2 |	3,4 |
| 3 | 	4 |

### Location_groups

На данном листе содержатся настройки групп заказов. Если группы заказов не используется (поле [options.location_groups](grouping-locations.md), то данный лист можно не заполнять.

|Группа полей Excel|Атрибуты|Комментарий к заполнению|Обязательное поле|
| ---------- | ---------- | ---------- | ---------- |
|Название группы|title|Наименование группы. Не влияет на планирование, только для удобства использования нескольких групп|Нет|
|Идентификаторы заказов|location_ids|Список id заказов, входящих в группу. Разделяются запятыми. Один заказ может входить только в 1 группу|Да|

### Options

На данном листе содержатся опции маршрутизации. Опции заполняются в одну строку. Для первого запуска маршрутизации значения на данном листе можно не заполнять и оставить пустыми.

Описание допустимых полей на листе **Options** приведено в таблице ниже.

| **Группа полей Excel**  | **Атрибуты** |  **Комментарий к заполнению**  |  **Обязательное поле**  |
| ---------- | ---------- | ---------- | ---------- |
| Объединять заказы в мультизаказы?	| merge_multiorders	| 	Рекомендуется ставить TRUE – в большинстве случаев это ожидаемый сценарий. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/properties-of-orders.html#multizakazy) |	Нет |
| Минимизация риска опозданий	| minimize_lateness_risk	| 	Рекомендуется оставить FALSE (это значение по умолчанию) и не использовать на начальных запусках маршрутизации. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/options-and-opportunities.html) |	Нет |
| Фактор устойчивости маршрута	| proximity_factor	| 	Рекомендуется оставить 0 (это значение по умолчанию) и не использовать на начальных запусках маршрутизации. Если возникнет потребность получать более сгруппированные маршруты, – то данное значение можно постепенно повышать с небольшим шагом (например, 0.1). Если география точек по определению имеет большой разброс (например, город и область), – то не рекомендуется использовать большие значения (больше 0,5). [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/planning-proximity.html) | Нет |
| Избегать платные дороги	| avoid_tolls	| 	Если нет специальных требований по использованию платных дорог, то рекомендуется оставить FALSE (это значение по умолчанию) и не использовать на начальных запусках маршрутизации. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/avoid-tolls.html) |	Нет |
| Штраф за недоставку пропорционален весу/объему заказов | weighted_drop_penalty | По умолчанию — FALSE. Значение TRUE рекомендуется применять в сценариях, когда у заказов существенно различается вес/объем и используются ТС разного тоннажа (при этом количество ТС такое, что для развоза всех заказов их утилизация должна быть высокой). | Нет |
| Идентификатор группы балансировки, штраф за отклонение по времени, штраф за отклонение по количеству остановок |	balanced_groups.N.id, balanced_groups.N.penalty.hour, balanced_groups.N.penalty.stop |	Рекомендуется оставить значения по умолчанию и не использовать на начальных запусках маршрутизации. Если возникнет необходимость получать более равномерные маршруты, то можно заполнить группы балансировки и для начала использовать значения по умолчанию (balanced_groups.N.penalty.hour = 200, balanced_groups.N.penalty.stop = 100). Затем можно постепенно менять эти настройки, исходя уже из получаемых результатов. Может быть указано несколько групп балансировки. Все они заполняются в одну строку по следующему принципу – сначала указывается группа полей с префиксом balanced_groups.0, затем balanced_groups.1, balanced_groups.2 и так далее. [Подробнее](https://yandex.ru/routing/doc/vrp/concepts/balanced-groups.html) | Нет |

### Routes

Данный лист заполняется в следующих ситуациях:

-   когда нужно учесть в планировании результаты предыдущего планирования (Подробнее см. [Допланирование](https://yandex.ru/routing/doc/vrp/concepts/additional-planning.html)), данный лист повторяет ситуацию с допланированием, когда машины еще не выехали со склада;

-   когда необходимо смоделировать (рассчитать метрики) уже готового планирования (например, ручного планирования).

На данном листе важен порядок строк — для данного ID машины предполагается, что заказы развозились в том порядке, в котором они перечислены сверху вниз.

| **Группа полей Excel**  | **Атрибуты** |  **Комментарий к заполнению**  |  **Обязательное поле**  |
| ---------- | ---------- | ---------- | ---------- |
| ID машины	| vehicle_id	| 	Идентификатор машины\курьера, для которого определен набор назначенных заказов.| Да (если используется лист Routes). |
| Смена	| shift_index	|	Номер смены, используемый в шаблоне Excel (0,1,2…) |Да (если используется лист Routes)  |
| Номер заказа	| location_id	|	Идентификатор заказа, который был назначен на данную машину\курьеру. |	Да (если используется лист Routes) |
| Время старта	| start_time	|	Заполняется только для первого заказа. Время старта, которое необходимо использовать для данного маршрута. Можно не заполнять, тогда время будет выбрано исходя из остальных параметров планирования. |	Нет |


<p class="p"><a href="feedback.html" class="xref button">Написать в службу поддержки</a></p>
