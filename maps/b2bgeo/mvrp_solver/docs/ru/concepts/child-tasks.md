# Дочерние задачи

Запуски планирования маршрутов можно связывать друг с другом по `task_id`. В результате на родительскую задачу будет ссылаться одна или несколько дочерних. Это позволяет перейти к списку связанных задач по идентификатору родительского решения, чтобы продолжить работу с любой из них.

Дочерними задачами могут быть отредактированные версии первоначального результата. Помимо изменений, которые логист делает по своим соображениям, в решение вносятся корректировки при [допланировании](https://yandex.ru/routing/doc/vrp/concepts/additional-planning.html). Если новые запуски оптимизации выполнять со ссылкой на исходную задачу, актуализированные маршруты можно загружать в систему-источник по родительскому идентификатору.

Другой сценарий — сравнение разных решений одной задачи. Можно запросить список дочерних `task_id` по идентификатору родительского планирования, чтобы сопоставить показатели разных версий и выбрать предпочтительный вариант. Метрики решения доступны в поле `result.metrics` [ответа API](https://yandex.ru/routing/doc/vrp/ref/MultipleVehiclesRouting/getMVRPTaskResult.html#code_200).

## Как это работает

Связь устанавливается через query-параметр `parent_task_id`, в котором передается ID родительского решения при добавлении задачи маршрутизации. (Этот идентификатор возвращается сервисом после постановки родительской задачи.)

[Список дочерних задач](https://yandex.ru/routing/doc/vrp/ref/ChildTasks/getChildTasks.html) включает `task_id` связанных решений и времена их запуска `added_at`. Получив этот массив по `parent_task_id`, можно перейти к скачиванию результатов, с которыми вы хотите работать дальше.

**Пример**

Выполнено построение маршрутов в первом планировании:

[Запрос API (JSON)](https://courier.yandex.ru/vrs/api/v1/log/request/45bdc861-e3092338-d9bcefe3-b781a771) ⋅ [Ответ API](https://courier.yandex.ru/vrs/api/v1/result/45bdc861-e3092338-d9bcefe3-b781a771)

Результат был скорректирован логистом (один заказ перекинут на менее загруженного курьера). Сформировано новое решение:

[Запрос API (JSON)](https://courier.yandex.ru/vrs/api/v1/log/request/6a77f7b6-b1d8395-cf78f99b-f991a17f) ⋅ [Ответ API](https://courier.yandex.ru/vrs/api/v1/result/6a77f7b6-b1d8395-cf78f99b-f991a17f)

При отправке запроса с отредактированным решением в query-параметре `parent_task_id` был указан идентификатор исходного планирования, чтобы вторая задача стала дочерней по отношению к первой.

В [списке дочерних задач](https://yandex.ru/routing/doc/vrp/ref/ChildTasks/getChildTasks.html) содержится информация об отредактированном решении:

``` JSON
[
   {
   "task_id":"6a77f7b6-b1d8395-cf78f99b-f991a17f",
   "added_at":1595945738.01598
   }
]
```


<p class="p"><a href="feedback.html" class="xref button">Написать в службу поддержки</a></p>
