# Пример использования протокола.

## Описание:
Есть два типа серверов: distributor и consumer.
distributor - имитирует работу предиктора, т. е. у него появляются данные(файлы), которые нужно
разослать всем consumer
consumer - имитирует работу mtinfo, т.е. получает и сохраняет файлы от предиктора/других mtinfo
и рассылает их(если потребуется) в другие mtinfo.


## Usage:

Создаём конфиги системы(defaultServers.json - пример готового), создаём файлы в директории
distributor/tmp/, которые будет отправлять предиктор, создаём конфиг для предиктора с информацией об
этих файлах.(каждому предиктору - свои файлы и свой конфиг).

(Здесь и далее все скрипты нужно запускать из папки, в которой они лежат. Некоторые скрипты могут не
работать не под линуксом)

Можно воспользоваться скриптом file_generator:

```bash

cd file_generator

./file_generator -C 1000

mv files.json ../distributor/distr.json

./file_generator -S 100000000 -C 10

mv files.json ../distributor/distr2.json

```

Запускаем серверы скриптом bootstrapper/bootstrapper. Запускать с -h, чтобы увидеть параметры.
Скрипт читает конфиг с конфигурацией серверов(default_servers.json) и запускает требуемое количество процессов.

Default:

```bash
cd bootstrapper

./bootstrapper
```

Ждём, когда серверы закончат работ(можно смотреть через htop)

Далее можно вручную смотреть логи/файлы которые переслались в папках distributor/logs, commonServer/tmp/,
commonServer/logs/

Запускаем killer, который убьёт отработавшие процессы и сам пропарсит логи и проверит файлы.

```bash
cd bootstrapper/killer/

./killer
```

Он создаст файлы:
* finalLog.log - лог всего стенда
* checker.log - лог с ошибками/важными моментами.
* badfiles.txt - список, файлов, которые должны были быть доставлены, но что-то пошло не так.
