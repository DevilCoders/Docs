# Усреднение пробок

Библиотека для усреднения проездов. Содержит 3 семейства функций:

* `interpolateIterative` — экспоненциальная интерполяция с переданным коэффициентом. Более свежие проезды по итогу вносят больший вклад
* `interpolateIterativeDropSlow` — аналогично, но с применением фильтрации медленных проездов (см. ниже)
* `interpolateIterativeDropSlowFilter` — помимо этого также записывает по выходному итератору отфильтрованные проезды. Это может быть полезно для расчёта интерполяции по части проездов. В этом случае фильтрация уже произведена, и можно использовать обычную интерполяцию. Например, используется в [`realtime_jams`](/arc/trunk/maps/analyzer/libs/realtime_jams).

## Фильтрация медленных проездов

Логика достаточно простая, но действенная. Фильтрация регулируется двумя параметрами:
* `dropK` — коэффициент превышения; если проезд больше в `dropK` раз, чем пробка на текущем этапе интерполяции, то он считается подозрительным, и откладывается. Если он по итогу последний, то не учитывается.
* `useK` — коэффициент использования; если _следующий_ после подозрительного проезд в `useK` раз больше, чем пробка, то считаем, что мы действительно столкнулись с большой пробкой, и учитываем _оба_ проезда.
* `useBaseTime` — сравнивать первый проезд с базовым временем проезда (если он передан), чтобы иметь возможность отфильтровать первый проезд
