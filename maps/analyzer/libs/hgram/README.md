# Hgram for Yasm

Библиотека для заполнения гистограммных метрик.<br>
Используется совместно с [`yasm-metrics`](/arc/trunk/arcadia/maps/libs/yasm-metrics).<br>
По сути просто дискретный набор величин - границ, между которыми укладывается метричное значение, при этом значения за пределами корзин попадают в граничные корзины.

# Сложность

- `at`, `[]` - `O(logN)`, внутри `upper_bound`
- `clear()` - `O(N)`

# Использование

См. также [тесты](/arc/trunk/arcadia/maps/analyzer/libs/hgram/tests/tests.cpp).

Создать пустую гистограмму можно либо явно передав все граничные значения (дубликаты будут удалены), либо из границ и кол-ва диапазонов / шага диапазона.

Например, создадим гистограмму от `0.0` до `10.0` с шагом `1.0`:
```cpp
#include <maps/analyzer/libs/hgram/include/hgram.h>

namespace hgram = maps::analyzer::hgram;

void test() {
    auto h = hgram::Hgram::equalSized(0.0, 10.0, 1.0);
    // первая корзина: [0.0, 1.0)
    h[-100.0] += 1.0;
    h[0.0] += 1.0;
    h[0.1] += 1.0;
    h[0.5] += 1.0;
    h[0.6] += 1.0;
    // вторая корзина: [1.0, 2.0)
    h[1.0] += 1.0;
    // очистить - сбросить все веса в 0.0
    h.clear();
}
```

Чтобы преобразовать в метричное значение для [`yasm-metrics`](/arc/trunk/arcadia/maps/libs/yasm-metrics), нужно позвать функцию `toYasmMetric`:
```cpp
hgram::toYasmMetric("get-timings_ahhh", h);
```

# TODO

Заметки, что можно реализовать:
1. `O(1)` вместо `O(logN)`, если границы расставлены равномерно или логарифмически
2. Динамические границы, т.е. например задаётся только шаг. Т.о. исключается опасность случайно указать недостаточный верхний/нижний лимит.
3. Логарифмическая шкала
