# Доступность в Картах

При создании новых компонентов/рефакторинге старых необходимо помнить о доступности

1. Убедиться, что компонент соответствует дизайн паттернам

В списке паттернов найдите тот компонент, который вы разработали и убедитесь что ваш компонент соответствует ему: https://www.w3.org/TR/wai-aria-practices-1.1/#aria_e (Пункт 3 Design Patterns and Widgets)

2. Протестировать новый функционал с клавиатуры

Минимальное, что нужно сделать, попробовать понавигироваться клавиатурой и посмотреть, что все в порядке:

- если это фокусируемый компонент, то при навигации с клавиатуры фокус должен быть виден (Для снятия фокуса при клике мышью нужно пользоваться хуком `usePressed` из `hooks/use-pressed.tsx`)
- если компонент кликабельный, то он должен реагировать на нажатие пробела или энтера (Для этого есть хок `withClickable` и хук `useClickable` из `core/clickable/with-clickable.tsx`)
- проверить, что компонент находится в нужном направлении обхода при навигации с клавиатуры
- все кнопки и интерактивные элементы должны иметь понятное текстовое описание, не забываем про `aria-label` у элементов и `alt` атрибут у картинок
- если компонент не несет какой-либо полезной информации для незрячих, необходимо скрыть его от читалок с помощью `aria-hidden` и скрыть из навигации с помощью `tabIndex=-1`. Можно воспользоваться константой `HIDDEN_PROPS` из `utils/accessibility.ts`(читайте описание константы)
- для модалок, попапов, диалогов необходимо переносить фокус внутрь модала(ловушка фокуса). Нужно воспользоваться `core/focus-lock/focus-lock.tsx`
- если почему-то не получается воспользоваться правильным семантическим элементом, надо не забывать про проставление верного атрибута `role`
- если кнопка/кликабельный элемент разворачивает/скрывает какой-то модал/попап, необходимо на кнопку повесить атрибут `aria-haspopup=true` и `aria-expanded={true/false}`(в зависимости от того раскрыт или закрыт попап/модал сейчас)

Совет: лучше используйте семантически правильные html элементы, по типу кнопок, ссылок, заголовков и т.д, там правильное поведение при навигации заложено из коробки

:no_entry_sign: Не используйте tabIndex больше 0, поскольку программы чтения с экрана при перемещении по странице руководствуются порядком DOM, а не порядком перехода по Tab. Для того чтобы изменить порядок следования элементов при переходе по Tab, следует изменить их порядок в DOM.

3. Протестировать функционал в скринридере

Опционально, но очень хорошо так делать

На macOs есть встроенный скринридер voiceOver, инструкцию по использованию можно посмотреть [тут](https://wiki.yandex-team.ru/search-interfaces/a11y/a11y-testing/#voiceover)

Для теста нужно:

1. Включить скринридер Command + F5
2. Дойти до своего блока скринридером(Оценить корректность положения блока относительно остальных/соседних блоков.)
3. Пройти свой блок скринридером по Tab/Shift+Tab

### Линтер

Теперь в картах есть линтер по доступности

Основные ошибки:
* [jsx-a11y/no-static-element-interactions](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/main/docs/rules/no-static-element-interactions.md)
* [jsx-a11y/click-events-have-key-events](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/main/docs/rules/click-events-have-key-events.md)

Для избежания таких ошибок следует использовать либо семантически кликабельные элементы(`<button/>`, `<a/>`)
Если это не подходит, необходимо использовать компонент `Clickable`, хок `withClickable` или хук `useClickable`
Можно использовать обычный `<div>` с обработчиками кликов, если ему добавить атрибут `aria-hidden` (используйте только если точно уверены, что элемент не должен произноситься читалкой)


