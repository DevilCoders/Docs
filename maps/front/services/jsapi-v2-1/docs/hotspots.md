О том, что это такое и как пользоваться, можно прочитать в [публичной документации](https://tech.yandex.ru/maps/doc/jsapi/2.1/dg/concepts/hotspots/about-hotspots-docpage/).

## Устройство хотспотов
Для обеспечения интерактивности хотспотных объектов на каком-либо pane на этом pane создается hotspot.Manager.

### Хотспоты геообъектов
Сущности на карте (геообъекты) создают для себя хотспотные объекты, реализующие интерфейс [IHotspot](https://github.yandex-team.ru/mapsapi/jsapi-v2/blob/master/src/interface/i-hotspot.js).

Оверлеи добавляют свои хотспотные объекты в менеджеры хотспотов, привязанные к нужному eventPane через метод `hotspot.Manager.addHotspots()`.
То есть если 2 оверлея лежат на одной карте, но в разных пейнах, они будут помещать свои хотспотные объекты в разные менеджеры.

`hotspot.Manager` хранит сущности в контейнерах `hotspot.Container`.

`hotspot.InternalContainer` - служебная сущность, в нее ничего добавлять не надо. Она используется внутри `hotspot.Container`.

Объекты внутри контейнера отсортированы по x и для всех объектов посчитана максимальная ширина. Это позволяет очень быстро находить объект, в который попадает текущая координата курсора. Плюс в каждом `InternalContainer` лежат объекты, схожие по размерам. Маленькие с маленькими, большие с большими - это тоже для оптимизации поиска.

### Хотспотные слои
Хотспотные слои загружают данные по требованию. Как только человек навел мышку на тайл, для которого нет данных, происходит их загрузка. Тайлы не кешируются программно.

Слой может запросить данные для тайла, который сейчас не является активным (пользователь на навел мышкой). Подгрузка тайлов вне активной области вызывается методом `hotspot.Layer.getObjectInPosition`. Данные, которые подгружаются для данных вне активного тайла, складываются во временный контейнер данных и не влияют на работу пользователя с текущим активным тайлом.

Слои для себя создают индивидуальные контейнеры — `hotspot.layer.Container` (наследник `hotspot.Container`). Слои самостоятельно добавляют свои контейнеры в менеджер хотспотов через метод `hotspot.Manager.getContainerList().insert`.

### Как связаны контейнеры и менеджер хотспотов
Все контейнеры добавляются в сущность `hotspot.containerList`.

На каждый пейн навешивается специальный контроллер, который отвечает за хотспотные события (`hotspot.paneEventController`).

Этот контроллер ловит события от пейна и передает на обработку в менеджер хотспотов.

Менеджер хотспотов получает событие пейна. Он берет координаты этого события и начинает искать объект, на котором надо эмулировать событие.
Событие приходит изначально от какого-то пейна, менеджер хотспотов перебирает все контейнеры с хотспотными шейпами, которые относятся к этому пейну.
Начинает он перебирать контейнеры в порядке убывания zIndex, пока не найдет активный объект.

Далее на этом активном объекте прокидываются нужные события. Некоторые события прокидываются на карту (это зависит от модели интерактивности).
Если активный объект не найден, то события просто проходят без изменения через менеджер и идут себе дальше на пейн-карту и тд.

![Hotspots diagram](images/hotspots.png)
