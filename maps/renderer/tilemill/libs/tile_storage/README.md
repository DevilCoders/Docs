# хранение тайлов

Для хранения тайлов используется простой формат, состоящий из четырех частей:

1) Заголовок фиксированной длины в ([формате flatbuffers](fbs/header.fbs)),  
хранит версию, позиции и размер остальных секций внутри файла.

2) Секция с дедуплицированными данными тайлов,  
последовательно хранит (сжатое) содержимое всех тайлов как есть, без каких-либо разделителей.

3) Секция с информацией обо всех тайлах,  
для каждого тайла хранится его оффсет внутри второй секции и размер.  
Формат этой секции описан [тут](tile_index.md).

4) Секция с метаинформацией о файле, в [формате flatbuffers](fbs/params.fbs).  
Содержит в том числе информацию о настройках хранения двух предыдущих секций.

Одно из преимуществ такого способа хранения - простота записи содержимого тайлов.
Тайлы можно записывать в файл прямо в процессе их генерации,
сохраняя в памяти только небольшую информацию об их позиции и размере.
Эту информацию после завершения генерации можно обработать и записать в третью секцию.
