[Репорт или отчёт](https://doc.yandex-team.ru/stat/report-overview/) — это средство визуализации предварительно рассчитанного набора данных в Яндекс.Статистике.

**Публикация в продакшен производится только от имени [robot-maps-analytics](robot-maps-analytics).**

#### Общие свойства отчетов
1. Мультипроектность
   - проект, для которого расчитывается метрика, храним в специальном поле project типа project. Возможные значния описаны в [lib/constants.py](https://a.yandex-team.ru/arc/trunk/arcadia/maps/analytics/lib/constants.py?rev=r7209933#L42)
   - загружаем значение метрик для всех сервисов в проект `Maps_Plus_Beta`
   - при необходимости создаем новые проекты на стате
2. Дименшен операционной системы называем – os
   - возможные значения: android/ios/macos/windows
3. География
   - TODO – определить общий формат географии
4. Переиспользуем константы из [lib/constants.py](https://a.yandex-team.ru/arc/trunk/arcadia/maps/analytics/lib/constants.py)

#### Добавление YQL-отчетов

1. Создайте отчет в статистике. YQL может пушить данные в статистику, но не умеет создавать отчёт. Поэтому отчёт нужно создать вручную.
2. Отлаживаемся в [тестовом стате](https://stat-beta.yandex-team.ru/) :
    - Выбираем путь для отчёта. Важно, чтобы отчёт был привязан к какому-то проекту. Например, Maps/qa/zbp.
    - Создаем отчет в статистике.
        - dimensions — это срезы (например, v-team)
        - measures — это метрики (например, вес багов)
    - В ответственных указываем   [maps-analytics](https://abc.yandex-team.ru/services/maps-analytics/), а также проектный abc-сервис. Личные доступы отрываем.
3. После в YQL делаем таблицу и публикуем её в статфейс через инструкцию **UPSERT INTO**.
4. Делаем PR с yql и ссылкой на отчёт.
    - Отводим локальную ветку.
    - Для добавления нового отчета создаем новую директорию в `maps/analytics/reports`. Если необходимо уточнение по проектам, создаем поддиректорию, например `maps/analytics/reports/qa/zbp/web-maps`.
    - В головной директории (из примера выше: `maps/analytics/reports/qa/zbp/`) отчета в README.md описываем суть метрики, даем ссылки на отчеты в стате.
    - Рядом прикладываем файл `query.sql` , куда копируем код запроса yql с подробными комментариями о происходящем в коде. Если есть проектная папочка по метрике (`maps/analytics/reports/qa/zbp/web-maps`), кладем файл с запросом туда.
    - Отправляем pr, дожидаемся ревью.
5. После прохождения ревью заменяем тестовый стат на [продовый](https://stat.yandex-team.ru/).
6. Проделываем все шаги, что делали в stat-beta. Настройки отчёта можно скопировать.
7. Настраиваем запуск в реакторе. Для создания реакции обратитесь к [дежурному](https://abc.yandex-team.ru/services/maps-analytics/?scope=dutywork)
