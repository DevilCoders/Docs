# Как работает сопоставление треков

Исходные предположения:

* Есть две (или больше) последовательности точек (координаты и метка времени) от разных устройств - голова и устройство телематики драйва.
* В хорошем случае оследоваетльности сгенерированы от устройств на одной автомашине.

Необходимо определить случай, когда голова и устройство телематики ездят на разных машинах.

## Алгоритм

Общая идея:

* в разных потоках находим пары точки с близкими метками времени.
* для каждой пары вычисляем расстояние между точками
* на наборе этих расстояний считаем метрики.


### Поиск пар близких точек

* Бежим по последовательностям точек в порядке меток времени, запоминая, из какой последовательности была предыдущая точка
* Если текущая точка из другого потока, чем предыдущая и разница в метках времени меньше некоего порога,
  то это текущая и предыдущая точка образуют пару для оценки. Считаем расстояние между ними и сохраняем его в список.
* Если точка из того же потока, что и предыдущая, то пары нет. Переходим к следующей точке.

### Метрики

* 50-й перцентиль расстояния между парами: Для совпадающих треков он оказывается не более 150м,
  для несовпадающих - километры.

* Среднее значение - похуже, но считать проще.

Большие выбросы давалв "телепортация" в Шереметьево из центра Москвы. Для оценки совпадения треков точки
в районе Шереметьево не учитываются вообще. Это не даёт ошибку: треки хорошо совпдают на подъездах к аэропорту,
что даёт хорушую метрику совпадения.
