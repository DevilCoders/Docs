# EXPORT API

Для авторизации пользователя используется Tvm Service Ticket.
Про описание ошибок см. в описании основного API: https://a.yandex-team.ru/arc/trunk/arcadia/maps/goods/api_server/docs/api.md#api
В отличие от основного API у всех путей присутствует префикс `export`.

## GET /export/goods/1.x/company/{company-permalink}/pricelist
Получение списка опубликованных товаров организации.
Аналог в основном API: `GET /goods/1.x/company/{company-permalink}/pricelist`

**Параметры**:
| **Название** | **тип** | **описание** |
| ------------ | ------- | ------------ |
| is_popular | bool | показать только популярные |
| availability_status | string | показать только товары в выбранном статусе: Available или OutOfStock |
| is_hidden | bool | показать только скрытые |
| with_photos | bool | показать только товары с фотографиями |
| min_price | float | показать товары с ценой не меньше заданной (товары с типом цены, отличным от ExactNumber, исключаются из выборки) |
| max_price | float | показать товары с ценой не больше заданной (товары с типом цены, отличным от ExactNumber, исключаются из выборки) |
| is_chain | bool | показать только сетевые/только филиальные |
| query | string | текстовый поиск по названиям/ценам товаров |
| sort_by | string | порядок сортировки: `id` (по умолчанию) либо `photo_presence` (по наличию фото) |
| limit | uint | вернуть не более заданного числа товаров (не более 10000) |
| offset | uint | вернуть товары, начиная с заданного смещения |
| group_name | string | названия категорий, товары которых нужно вернуть в ответе. Например: `?group_name=Манипуляторы&group_name=Камеры` (urlEncoded)|
| group_id | uint | идентификаторы категорий, товары которых нужно вернуть в ответе. Например: `?group_id=1&group_id=2` |
| exclude_groups | bool | вернуть товары всех категорий, кроме тех, что перечислены в group_name (ВНИМАНИЕ: меняет поведение фильтра group_name!) |
| source | string | показывать товары выбранного фида (см. документацию на API фидов) **ВНИМАНИЕ:** обязательный параметр!|
| get_used_feed | bool | если не передан параметр source, вернуть товары из используемого фида, а не из личного кабинета |


**Ответ**:
```json
{
    "pager": {
        "offset": 0,
        "limit": 0,
        "total": 0
    },
    "items": [
        {
            "id": "535344", // пермалинк товара
            "external_info": {
                "item_id": "qe123ad", // некий внешний иденитификатор в системе партнера
                "source": "YANDEX_EDA" // источник данных
            },
            "group": {
                "id": "3454570", // идентификатор категории товара
                "name": "Стрижки"
            },
            "title": "Мужская стрижка",
            "description": "Стрижем ножницами и машинкой",
            "price": {
                "type": "ExactNumber", // Одно из значений: ExactNumber, Other
                "value": 123.20, // Число в случае ExactNumber и строка, если type=Other
                "currency": "RUB"
            },
            "volume": {
                "unit": "Kilogram", // единицы измерения
                "value": 1.5 // тип value зависит от значения поля unit. Строка для типа Other и число для всех остальных
            },
            "photos": [
                {
                    "id": "123", // внутренний ID фотографии
                    // Поля template_url и size могут отсутствовать, если еще не успели переложить фото в аватарницу.
                    // В таком случае нужно использовать source_url.
                    "template_url": "https://avatars.mdst.yandex.net/get-sprav-products/12346/2a00000177bf43c13a169643f371e206d7b3/%s",
                    "sizes": [
                        "small",
                        "medium",
                        "orig"
                    ],
                    // оригинальная ссылка на изображение. Указывается, если фото было загруженно через URL.
                    "source_url": "https://some.site.ru/image.png"
                },
            ],
            "is_popular": true,
            "availability": {
                "status": "OutOfStock" // Available - товар доступен, OutOfStock - закончился
            },
            "is_hidden": false
        },
        ...
    ]
}
```


----
## GET /export/goods/1.x/company/{company-permalink}/groups
Получение списка названий групп данной организации. В случае неверно заданных параметров возвращает пустой список.

**Параметры**:
| **Название** | **тип** | **описание** |
| ------------ | ------- | ------------ |
| limit | uint | ограничение на кол-во групп в ответе (default=100, не более 10000) |
| offset | uint | вернуть группы, начиная с заданного смещения |
| with_photos | bool | показать только те группы, у товаров которых есть фотографии |
| source | string | показывать группы выбранного фида (см. документацию на API фидов) **ВНИМАНИЕ:** обязательный параметр!|

**Ответ**:
```json
{
    "pager": {
        "limit": 100,
        "offset": 0,
        "total": 10,
    },
    "groups": [
        {
            "name": "Стрижки"
        },
    ...
    ]
}
```

**Коды ответов:**
 - 200 - успешно


----
## GET /export/goods/1.x/company/{company-permalink}/prices
Получение опубликованных товаров организации по их id.
Аналог в основном API: `GET /goods/1.x/company/{company-permalink}/prices`

**Параметры**:
| **Название** | **тип** | **описание** |
| ------------ | ------- | ------------ |
| id | uint | идентификаторы товаров, которые нужно вернуть в ответе. Например: `?id=1&id=2` |
| source | string | показывать товары выбранного фида (см. документацию на API фидов) **ВНИМАНИЕ:** обязательный параметр!|

**Ответ**:

Объект items, аналогичный возвращаемому методом EXPORT API `GET /export/goods/1.x/company/$/pricelist`

**Коды ответов:**
 - 200 - успешно
 - 204 - передан пустой список параметров
 - 422 - невалидный формат параметров или указанные товары не найдены. Подробности в описании ошибки.
