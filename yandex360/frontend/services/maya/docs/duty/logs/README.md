# Логирование в Календаре

В данный момент существуют такие логи:
- События доступа к nginx (`/var/log/nginx/access_log.tskv`). Туда попадают все http-запросы:
    - За индексной страницей
    - За моделями
    - В `/monitoring` (логирование событий с клиентов)
- Лог приложения
    - Лог логики приложения (`/var/log/duffman/duffman-access.tskv`)
    - Лог http-клиента (`/var/log/duffman/duffman-http.tskv`)
    - Служебный лог приложения (`/var/log/duffman/duffman-master.tskv`)
- Служебные логи всевозможных вспомогательных инструментов на машинках с приложением

## NGINX
Здесь оседают все входящие запросы.
Из полезного здесь - логирование [клиентских событий](client.md#monitoring), старый интерфейс и проблемы с походами в воркеры приложения.

### Запросы в воркеры
Кратко, 502 код в этом логе - очень плохой признак, означающий, что ретраи внутри контейнера с приложением не спасли, а, значит, лежит несколько воркеров.

## DUFFMAN
Собственно само приложение, большая часть полезной информации из логов черпается именно отсюда. По большей части всё стандартно для duffman, почитать про логирование можно [тут](https://github.yandex-team.ru/Daria/Duffman/wiki/Логирование)

### duffman-access
Здесь оседает всё логирование моделей и то, что логируется отдельно из кода при помощи `core.console`. [Подробнее](https://github.yandex-team.ru/Daria/Duffman/wiki/Логирование#access-log)

### duffman-http
Лог http-клиента приложения. В нём оседает то, что связано с походами по сети в бекенды. [Подробнее](https://github.yandex-team.ru/Daria/Duffman/wiki/Логирование#http-log)

### duffman-master
Лог мастер-процесса duffman, ошибки в нём суперкритичны. [Подробнее](https://github.yandex-team.ru/Daria/Duffman/wiki/Логирование#master-log)

### duffman-client
Лог, который мы пишем сами на какие-то клиентские события, предназначен для построения продуктовой аналитики. Писать туда можно, дёргая [вот это](../server/lib/client-logger.js)
на сервере или отправляя http-запросы на роут `/journal` при помощи фичи `logging` с клиента.
