# Локализация

Общий процесс такой:

1. Заводим ключи в [Танкере](https://tanker-beta.yandex-team.ru/project/mail-liza?branch=master)
2. Подтягиваем ключи без переводов в проект
3. Отдаём задачу в ревью/тестирование, указав, что ожидаем переводов
4. Заказываем переводы
5. Подтягиваем переводы в проект

## Как заказать переводы

1. Заводим ключи в [Танкере](https://tanker-beta.yandex-team.ru/project/mail-liza?branch=master) в проекте `mail-liza` в нужном кейсете. _Сейчас много ключей именуется в kebab-case или snake_case, но для совместимости с `@ps-int/ps-tanker` все новые ключи требуется заводить в **camelCase**_.
   Для каждого ключа отписываем контекст использования, вставляем **скриншот** с релевантным куском интерфейса (например вставить jing ссылку (лучше полную, а не короткую, чтобы была превью картинки) или через nda папку на yandex disk).
   В большинстве случаев тексты на русском языке сразу выставляются подтверждёнными. **Неподтверждённые** тексты не выйдет использовать в проекте. Если исходный текст не находится в статусе "Подтвержден", то переводчики не начнут делать переводы.
2. Заводим тикет на перевод созданных ключей с помощью [формы](https://st.yandex-team.ru/createTicket?queue=TRANSLATE&_form=13067):
    * ABC-сервис _Фронтенд Почты_
    * Дедлайн обычно 2-3 дня, если нет форс-мажора
    * Языки:
        * Английский/English US (en-US)
        * Турецкий/Turkish (tr-TR)
        * Белорусский/Belarusian (be-BY)
        * Казахский (кириллица)/Kazakh (kk-KZ)
        * Узбекский (латиница)/Uzbek (uz-UZ)

      Да, в соседних ключах может быть больше языков, но для новых заводим только на вышеперечисленные 5.
3. Ждём, пока на почту придёт отбивка о создании тикетов, не верьте сообщению про 15 минут, обычно приходится ждать до дня.
4. Линкуем тикеты к своей задаче и ждём, пока тексты переведут

## Как подтянуть ключи и переводы в проект

В Почте используется 2 подхода к локализации:
1. Старый — через глобальную функцию `i18n()`, раньше работал через сабмодуль, но с переездом в Аркадию код мигрировал просто в директорию `locales/loc`
2. Более свежий через [`@ps-int/react-tanker`](../../../packages/react-tanker)

Старый подход допустимо применять только в случае небольших доработок в старом же коде. В остальном всегда и везде следует применять локализацию через `@ps-int/react-tanker`.

Каждый из этих подходов работает со своим списком keyset'ов. Какие для кого кейсеты используются можно посмотреть
* Для старого подхода [тут](../locales/loc/.gittanker)
* Для `@ps-int/react-tanker` [здесь](../.tanker.json)

### Как обновить ключи для старой локализации через сабмодули

1. Переходим в директорию `services/liza/locales/loc`
2. Запускаем там `git tanker get`
3. Получаем в текущей ветке коммит с обновлёнными локалями

### Как обновить ключи для локализации через `@ps-int/react-tanker`

1. Запускаем в корневом проекте `services/liza` `npm run update-locales`
2. Коммитим сгенерированные js-файлы с ключами отдельным коммитом в рамках разработки своей фичи

Стоит учитывать, что вместе с нашими ключами из танкера могут приехать изменения в ключах, которые кто-то вносит для других фич. Обычно, если добавляются новые ключи, то это безопасные изменения, если же какие-то уже использованные в проекте ключи меняются, то надо внимательно посмотреть на изменения, поскольку есть риск выкатить какие-то нежелательные или преждевременные изменения.

Полезные ресурсы:
- [Локализация с помощью Танкера / Синтаксис файлов локализации](https://doc.yandex-team.ru/Mail/dev-interface-guide/concepts/localization.html#loc-syntax)
- [Как работать в Танкере / 3. Добавить плюральные формы](https://wiki.yandex-team.ru/doc-and-loc/doc/business-support-home/distant-author/editorship-lead/toloka-editorial/tanker-workflow-for-writers/#3.dobavitpljuralnyeformy)
