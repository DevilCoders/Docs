# Политика защиты от подбора паролей

Черный ящик следует политике защиты от подбора паролей.

- Каждая неудачная попытка проверить пару логин/пароль нагревает некоторый набор счетчиков, связанных с логином, паролем, IP, authtype и их различными комбинациями.
    
- Перед проверкой логина и пароля Черный ящик также проверяет, не превышен ли лимит неудачных аутентификаций для данного набора: логин, пароль, IP, authtype.
    
- Значения счетчиков обычно остывают в течение часа, однако их могут нагревать другие пользователи, приходящие с тем же паролем или IP.

В частности, отсюда следует, что в параметре `userip` должен передаваться настоящий IP пользователя, при передаче какого-то фиксированного адреса он может начать попадать в блокировку по IP.

Если по какому-то из счетчиков превышен лимит неудачных аутентификаций, Черный ящик следует одному из двух вариантов поведения:
1. вернуть ответ о неверной паре логин/пароль;
1. вернуть признак превышения лимита неудачных аутентификаций.

Первый вариант (версия 1 метода `login`) предназначен для клиентов, которые не могут полноценно обработать ситуацию блокировки и показать пользователю какой-то челлендж, такие как smtp-сервер.
Если выбран первый вариант, сервис не сможет отличить ситуацию ввода неправильного логина/пароля от превышения лимита неудачных аутентификаций.

Если сервису необходимо различать данные ситуации, следует выбрать второй вариант, передав параметр `ver=2`.
Подробнее об этом можно почитать в описании [метода login](../methods/login.md#ver2)
