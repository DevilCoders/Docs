# Список экспериментальных флагов

Директория с флагами экспериментов. Один флаг — один файл.

**пример:**

Имя флага: `disable-promo-logo`

Имя файла: `disable-promo-logo.json`

В имени флага разделитель `-` (Нужно чтобы tslint не ругался на `dot-notation`)

Содержимое файла:

```json
{
  "date": "19.11.2015",
  "description": "SERP-32658: Праздничный логотип на серпе",
  "manager": "vtenity",
  "dataDependent": false,
  "system": true,
  "values": {
      "Включить функциональность": 1
  },
  "service": "web",
  "handlers": ["WEB"],
  "projects": [
      "web",
      "images",
      "video"
  ],
  "platforms": [
    "desktop",
    "touch-pad",
    "touch-phone"
  ],
  "validation_type": "json"
}
```

Структура файла создана в соответствии с https://github.yandex-team.ru/search-interfaces/ci/blob/master/packages/expflags-cli/docs/flag.md

Поле `dataDependent` показывает, является ли функциональность под флагом зависимой от данных, которые так же включаются флагом. Поле может отсутствовать.

Поле `system` показывает, что флаг системный и не участвует в экспериментах, а используется как системная настройка. Поле может отсутствовать.

Поле `client` показывает, используется ли флаг на клиенте или на сервере. Поле может отсутствовать.

Поле `projects` содержит список проектов, в которых используется флаг. Поле может отсутствовать.

Поле `service` определяет сервис, для которого будут созданы эксперименты.

Отнеситесь серьезно к заполнению поля `validation_type`. Ошибка может привести к инциденту [SEARCHPRODINCIDENTS-3213](https://st.yandex-team.ru/SEARCHPRODINCIDENTS-3213#1519643483000)

**Возможные значения**

| validation_type | пример       |
| ----------------|:-------------|
| json            | `"json_attr": "some json value"`
| str             | `"string_attr": "строка"`
| int             | `"int_attr": 42`
| float           | `"float_attr": 3.14`
| bool            | `"boolean_attr": true`
| 01              | `"01_attr": 1`
| list_of_str     | `"list_of_str_attr": ["value1", "value2", "value3"]`

## Тулза для создания новых флагов

Файлы можно создавать через консольную утилиту, где в интерактивном режиме можно задать все необходимые поля. Запускается из корня проекта:

```bash
node tools/expflags
```

 После создания файла с флагом, чтобы не перезапускать сборку проекта для локального тестирования можно использовать команду

 ```bash
make expflags
 ```
