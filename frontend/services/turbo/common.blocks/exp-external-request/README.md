## Блок динамических данных

Блок позволяет подгружать json из заданного источника и отражает данные на странице в динамических полях.

Есть несколько типов динамических полей, которые совершают разные действия на странице:
1. [Вставить текст](#type-text) 
1. [Задать класс DOM-элементу](#type-class)
1. [Задать атрибут DOM-элементу](#type-attr)

Каждый тип поля имеет свою структуру преобразования из turbohtml в bemjson, а так же набор валидаторов.

### Как это работает 
1. При инициализации блока показывается заглушка размером по высоте указаной в блоке и шириной в доступное пространство.
1. Отправляется AJAX запрос за ресурсом.
1. Показываем результат:
    1. Если ответ вернулся с ошибкой, показываем вместо блока заглушку с ошибкой.
    1. Если ответ успешный заменяем данные внутри внутри блока на те что пришли в объекте

API блока см. [schema.json](schema/schema.json)

В `content` блока может быть произвольный набор блоков, каждый блок может быть динамическим полем - содержать параметр `dyn` вида  
`{type: '', key: '', payload: ''}`  
см. [блок **exp-data-bind**](../exp-data-bind/exp-data-bind.md)


### Примеры

#### <a name="type-text"></a>Вставить текст `type: value`
Позволяет заменять контент в текстовых блоках

Валидатор: строка

```js
@include('exp-external-request.examples/type-value.json', 'json', true)
```

По `url` ожидается json вида `{ "price": "750" }` 

При получении данных смотрит есть ли такое поле в объекте.  
Если поле есть, то берет значение из этого поля и через innerText, текущей domNode заменяет значение.  
Если поля нет, то проставляет текущей domNode стиль `visibility: hidden`

#### <a name="type-class"></a>Задать класс `type: class`
Позволяет динамически проставлять CSS класс.

Валидатор: `-?[_a-zA-Z]+[_a-zA-Z0-9-]*`

```js
@include('exp-external-request.examples/type-class.json', 'json', true)
```

По `url` ожидается json вида `{ "text_class": "typo_italic" }`

При получении данных смотрит есть ли такое поле в объекте.  
Если поле есть, то берет значение из этого поля и добавляет класс который пришел в ответе.  
Если поля нет, то ничего не делает 

#### <a name="type-attr"></a>Задать атрибут `type: attr`
Позволяет динамически менять атрибуты у ноды.

Валидатор: `string|boolean|number`

```js
@include('exp-external-request.examples/type-attr.json', 'json', true)
```

По `url` ожидается json вида `{ "buy_disable": "1", "sign_up_show": "" }` 

При получении данных смотрит есть ли такое поле в объекте.    
Если поле есть, то берет значение из этого поля и через innerText, текущей domNode заменяет значение.    
Если поля нет, то проставляет текущей domNode стиль `visibility: hidden`
