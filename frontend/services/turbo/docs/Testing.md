# Тестирование

## Тестирование в web4
Для тестирования разных версий турбо внутри web4, ипользуется специальный флаг:
```
?exp_flags=turbo-host={ЗНАЧЕНИЕ}
```

Возможные значения:

| Значение | Описание | Дополнительно |
|----------|----------|---------------|
| Число(123)   | Номер PR из турбо, можно посмотеть [тут](https://github.yandex-team.ru/serp/turbo/pulls) | `//renderer-turbo-pull-{PR}.hamster.yandex.{TLD}/turbo` |
| dev | `//renderer-turbo-dev.hamster.yandex.{TLD}/turbo` |   |
| priemka  | `//templates.priemka.yandex.{TLD}/turbo` |   |
| URL  | Произвольный урл | **Внимание**, если ваш урл находится на домене hamster, его надо обязательно экранировать вот так - `{hamster}` |


### Системы автоматического тестирования в турбо

#### Hermione
_Описание_: Тестирование пользовательских сценариев и тестирование скриншотами на подготовленных страницах.
_Данные_: целые страницы, подготавливаются фронтендом
_Использование_: блоки которые имеют интерактивность или внешний вид

#### Hermione e2e
_Описание_: Тестирование пользовательских сценариев в продакшене
_Данные_: используются реальные данные
_Использование_: более общие случаи в сравнении с Hermione

#### Unit серверные
_Описание_: Проверяются common-js модули написаные в core.
_Данные_: не требуются
_Использование_: в основном это код подготовки данных перед отправкой в шаблоны

#### Jest в платформы
_Описание_: Юнит-тесты на react-компоненты.
_Данные_: не требуются
_Использование_: компоненты средней сложности и выше

## Тестирование в ифрейме
В некоторых случаях может возникнуть необходимость протестировать турбо-страницу в ифрейме. Для этого у нас есть плагин для Темплара реализующий ручку `/iframe`, которая оборачивает переданный урл из cgi-параметра `&src` в iframe.

Пример использования:
```js
it('Должен отправиться postMessage при фолбэке на оригинальный урл', function() {
    return this.browser
        .url(`/iframe?src=${encodeURIComponent('/turbo?text=nodata')}`)
        .yaCheckPostMessage([
            { action: 'fallback' }
        ]);
});
```
