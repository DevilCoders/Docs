# Runtime конфиг фронтенда

Это json файл, хранящийся на s3 и участвующий в каждом запросе пользователя. 
Так же он упаковывается в шаблоны при сборке, дабы продолжать жить при упавшем s3. 

В нем можно переопределить флаги или указать версии.

Источник конфига находится в бункере: https://bunker.yandex-team.ru/messenger-versions/frontend-config 
В нем можно добавлять или удалять различные флаги и назначать их на определенные сборки, версии и сервисы.

Что бы внести изменения, необходимо поправить в форме, либо в режиме raw в бункере,
нажать **Сохранить** и **Опубликовать**. Версия увеличится сама. 

Перед сохранением конфиг проверится по json-схеме: https://bunker.yandex-team.ru/messenger-versions/.schema/frontend-config?view=raw
При добавлении новых сборок и сервисов, необходимо добавить их и в эту схему.

Что-бы выкатить свежую версию в prod, нужно выполнить команду 
```bash
npm run config:frontend:release
```

Во время работы этой команды произойдет:
1) скачивание последней опубликованной версии из бункера
2) валидация её о схему в репозитории (см. файл src/configs/frontend/config.scheme.json)
3) загрузка файла в s3 как https://messenger-test.s3.mds.yandex.net/config/frontend.json

В клиентском кода эти флаги доступы как обычные `window.flags`.

## Debug

Актуальную версию конфига всегда можно посмотреть в переменой `globalParams.frontendConfig`.
Так же версия уходит в ошибки на https://errors.yandex-team.ru в поле `additional.frontendConfig`. 

В режиме `?debug=*` (или любом указанном значение debug), в globalParams будут добавлено поле `globalParams.frontendConfigDebug`,
в котором будет оригинальное содержимое конфига, и его обработанные версии.
