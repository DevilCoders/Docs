# Сборка webpack

Любая сборка может быть собрана непосредственно вебпаком через команду:

```
NODE_ENV=development|production npx webpack --config path/to/config.webpack.js
```

Либо все

```
./node_modules/.bin/webpack --config config/webpack/webpack.config.js
```

Так же доступна "быстрая" сборка с помощью воркеров:

```
npm run build {build}
```

Можно указывать несколько билдов через пробел, можно не указывать никаких, что бы собрать все.

## Структура папки config/webpack

```
config/
	# Папка со всем, что относится к webpack
	webpack/

		# Базовый конфиг webpack, который должен использоваться как базовый для всех build-конфигов. В основном содержит настройки сжатия, sourcemap, оптимизаций
		common.js

		# Список сборок, которые могут собираться. Используется для GET параметра ?build= и селективных сборок (например `npm run build -- geo`)
		services.js

		plugins/
			# Функции с базовыми конфигами плагинов, которые используются в конфигах билдов
			{plugin}.js

		loaders/
			# Кастомные лоадеры
			{loader}.js

		rules/
			# Функции с базовыми правилами обработки различных файлов (css, js, ts)
			{rule}.js
```

## Выходная конфигурация папки build должны быть следующей:

```
# Основная структура папки build - _, server, static.
build/
	# Основная папка зафриженой статики, сюда сейчас складываются ассеты
	_/
		alice-welcome.795b16ef86149c3ecf6c282e9b05c2d1.svg
	# Папка сервера, в ней билд/main.js сервера. Когда нибудь их тут может быть несколько
	server/
		chat/
			index.html
	# Папка с собранной статикой, которая будет доступна по пути с указанием версии (как раньше), позже будет организован вынос js во фриз
	static/
		yamb/
            app.css
			app.js

	# Сюда разложены все build/{entry,chunks} для фиксированных путей, для проверки размеров файлов пульсом
	pulse/
		yamb/
			app.js
			config.js
			app.css

	# Временный костыль до изменения путей в конфиге пульса (так же есть 2 костыля об этом в коде)
	chat/
		static/
			main.js
			main.css
```
