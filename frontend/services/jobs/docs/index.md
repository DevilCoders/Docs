# Карьерный Портал

[ABC-сервис](https://abc.yandex-team.ru/services/vacancies), [код](https://a.yandex-team.ru/arc_vcs/frontend/services/jobs).

Карьерный портал (КП) — сервис для отображения и поиска публикаций как во внешнюю сеть, так и в интранете:

- внешняя винтрина https://yandex.ru/jobs представляет из себя лендинги и страницы для офисов, городов, сервисов, профессий, публикаций вакансий
- наполняется через админки [LPC](https://lpc.yandex-team.ru) и [Фемиды](https://femida.yandex-team.ru) силами контент-менеджеров и нанимающих менеджеров без участия разработчиков: тексты-описания сервисов и офисов, процессов найма, стажировок.

Этим обусловлена архитектура сервиса. Для того, чтобы контент-менеджеры могли править макеты без участия разработки, мы храним все макеты в конструкторе лендингов и скачиваем оттуда нужный макет на запрос пользователя.
Контент некоторых макетов недоступен контент-менеджерам для редактирования, т.к. они автоматически наполняются данными из Фемиды (в основном, то, что касается списков вакансий и самих вакансий).

### Используемые сервисы и технологии

- [AppHost](https://docs.yandex-team.ru/apphost/) (см. так же: https://wiki.yandex-team.ru/hr/site/dev/apphost/)
- [Констурктор лендингов](https://wiki.yandex-team.ru/lp-constructor/)
- [Турбо](https://wiki.yandex-team.ru/turbo/)

### Основные составные части Карьерного Портала

- Граф — организует все в единую цепь.
- Конструктор Лендингов — хранит базовый turbojson для всех наших страниц, позволяет контент-менеджерам вносить правки.
- Наши бэкенды, сейчас их пять:
  - аппхост-роутер - занимается роутингом и запросами данных из нужной ручки Фемиды и turbojson для нужного макета Конструктора
  - аппхост-мерж - занимается мержем полученных данных и формированием финального turbojson
  - и другие...
- Турбо — умеет рисовать финальную html по переданному turbojson.
- Фемида — апишка, отдающая списки вакансий, сами вакансии, сервисы и тд.

### Как все это работает?

1) Пользователь делает запрос на /jobs/.
2) Балансер направляет его в граф.
3) Граф направляет запрос пользователя в аппхостовое приложение, в шаблон аппхост-роутинг.
4) В зависимости от роута, по которому пришел пользователь, аппхост-роутинг "запрашивает" данные:
   - turbojson той или иной страницы конструктора лендингов
   - те или иные данные из Фемиды
5) Когда все данные собраны, граф направлят нас в шаблон аппхост-мерж. Этот шаблон мержит все полученные данные в финальный turbojson и отдает его на отрисовку turbo-подграфу.
6) turbo-подграф отдает пользователю финальную html-страницу.

[Схема работы сервиса](https://miro.com/app/board/o9J_lKGmgU4=/).

### Как работают контент-менеджеры?

1) Приходят в [раздел jobs конструктора лендингов](https://lpc.yandex-team.ru/finder/yandex.ru/jobs)
2) Открывают нужный лендинг, вносят правки в макет и тексты
3) Сохраняют, [проверяют что получилось](https://l7test.yandex.ru/jobs)
4) Нажимают "Опубликовать", правки попадают в [продакшн](https://yandex.ru/jobs)

### Как работает тестировщик?

[Сервис с набором различных девайсов «Колхоз»](https://kolhoz.yandex-team.ru/desktop?filters=on&action=&features=LOCAL_PROXY_ACCESS) для тестирования сервиса.
- Для того, чтобы открывались внутренние ссылки на iOS и Android необходимо выбирать в фильтре 'Особенности' значение PDAS и включать его на устройстве после бронирования (обязательно проверяйте подключился ли девайс к сети PDAS на устройстве)
- Для того чтобы открыть внутренние ресурсы на Desctop необходимо выбирать в фильтре 'Особенности' значение Local proxy/sniffer и после бронирования включить прокси на устройстве


### Как работают ассессоры?

Когда-нибудь же они будут у нас? Пока никак.

### Как работают разработчики?

Все зависит от того, что нужно сделать.
Если контент-менеджеру не хватает блоков для того, чтобы собрать контентную страницу, разработчику нужно сверстать новые блоки. Это происходит в репозиториях Турбо и КЛ (ссылочки?)
Если нужно внести правки в уже существующий блок, скорее всего хватит только изменений в репозитории Турбо.
Если нужно добавить новый роут / поменять взаимодействие с Фемидой, нужно править код аппхостового приложения (ссылочка?). В шаблоне роутинга говорим, какие данные этому роуту нужны, в шаблоне мержа - описываем правила мержа данных и формирования финального turbojson.
Если нужно сделать что-то глобальное (например, кроме Фемиды, появляется еще один бэкенд и нужно научиться туда ходить), нужно начинать с того, чтобы поменять сам граф, управляющий запросами.
