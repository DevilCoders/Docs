# Компоненты

В приоритете функциональные компоненты.
Если код классового компонента однозначно более читабельный, то использовать классовый.

Именованные экспорты приоритетнее дефолтных.

### Общая структура

```bash
├── Component/                                   — компонент
|   ├── tests/                                   — тесты
|   |   ├── screens/                             - скрины из hermione
|   |   |   └── ...
|   |   ├── Сomponent.story.tsx                  - storybook
|   |   ├── Сomponent.common.hermione.js         - hermione-тесты
|   |   ├── Сomponent.desktop.hermione.js        - hermione-тесты desktop-only
|   |   └── Сomponent.touch.hermione.js          - hermione-тесты touch-only
|   |
│   ├── index.ts                                 — файл ре-экспорта компонента. агрегирует версии для разных платформ
|   |
│   ├── Component@desktop.tsx                    - desktop-версия
│   ├── Component@touch.tsx                      - touch-версия
│   ├── Component.tsx                            - при совпадении реализаций в этом файле
|   |
│   ├── Component@desktop.scss                   - desktop-часть стилей
│   ├── Component@touch.scss                     - touch-часть стилей
│   ├── Component.scss                           - при совпадении реализаций в этом файле
|   |
│   ├── Component.typings.tsx?                   - при совпадении реализаций в этом файле
|   |
│   ├── hooks/                                   — хуки
|   |   ├── useAwesomeHook.tsx?                  - конкретный хук
|   |   └── ...
|   |
│   ├── utils/                                   — утилиты
|   |   ├── myUtil.tsx?                          - конкретный хелпер
|   |   └── ...
|   |
│   ├── Component.test.tsx                       - unit-тесты
│   ├── __snapshots__/                           - снапшоты
|   |   └─── ...
|   |
│   ├── assets/
│   │   ├─── icon.svg                            - иконка
|   |   └─── ...
```

svg-ассеты использовать так
```tsx
import Icon from './assets/icon.svg';
```

### Экспериментальный код

Хорошей реализации экспериментального уровня сейчас нет.
Прокидываем флаги из redux, менеджим внутри самого компонента.

### Loadable

Есть возможность вынести компонент специально в отдельный бандл.
Например, умную камеру хорошо бы загрузить асинхронно.

```tsx
const Component = loadable(() => import('../Component'));
```

### Типизация

Все типы собираем в файле `Component.typings.tsx`.

Именование:
интерфейсы - с префиксом `I`,
типы - с префиксом `T`,
enum - с префиксом `E`.

## Тестирование

Между снапшотным jest-тестом и hermione-тестом выбирать следует hermione.
Интересны вид компонента, и возможность потыкать его в Storybook.

Поэтому общая практика такова:
1. Создаем компонент, определяем интерфейс
2. Создаем некоторые stub-данные (прямо в файле стори или рядом)
3. Рендерим в Storybook, тестируем hermione.

Компонентные тесты должны лежать рядом с компонентом.

### Page objects

Хороших, на классах и с наследованием сейчас нет.
От SERP БЭМ-подобных селекторов отказываемся, потому что не несут в себе достаточной дополнительной ценности, но заставляют учить синтаксис "блок А является 3-им по счету сыном блока Б". CSS-селекторы проще.
Пишем селекторы прямо в тестах.

### Команды

Кастомные команды для hermione (если нужны), то добавляем в `tests/hermione/commands/yaCustomCommand.js`.
