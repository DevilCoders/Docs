# Drawer-support

Бэкенд для прокидывания данных из шторки обратной связи в Сансару.

## Оглавление
- [Drawer-support](#drawer-support)
  - [Оглавление](#оглавление)
  - [Порядок действий](#порядок-действий)
  - [Переменные окружения](#переменные-окружения)
  - [Команды для разработки](#команды-для-разработки)
  - [Стенды Deploy](#стенды-deploy)

## Порядок действий
1. Установить зависимости монорепы фронтенда: `npm ci` в корне монорепы (`/frontend` от точки монтирования arc)
2. Установить зависимости drawer-support: `npm ci` в корне проекта
3. Определить необходимые переменные окружения
4. Собрать проект `npm run build`
5. Запустить сервер: `npm run start`
6. Сервис будет доступен по урлу, указанному в конфиге (по дефолту http://localhost:3000)

## Переменные окружения
Конфигурация находится в файле `./config.ts`
- `PORT` - порт на котором запускается сервер.
- `QUEUE_ID` - id очереди в Сансаре куда будут создаваться тикеты
- `SAMSARA_URL` - URL до апи сансары
- `SHELEZYAKA_TOKEN` - токен робота для похода в Сансару
- `PROJECT_NAME` - название проекта
- `CSRF_EXPIRE_TIME` - время жизни `csrf` токена
- `CSRF_SECRET` - ключ для генерации `csrf` токенов

## Команды для разработки
* `npm ci` - Просто установить модули
* `npm run start` - запуск сервера
* `npm run watch` - запуск сервера с вотчером пересборщиком
* `npm run unit` - запустить unit тесты (jest)
* `npm run lint` - запустить линтеры по измененным файлам


## Стенды Deploy

* [Production](https://deploy.yandex-team.ru/stages/drawer-deploy)
* [Testing](https://deploy.yandex-team.ru/stages/drawer-testing)
