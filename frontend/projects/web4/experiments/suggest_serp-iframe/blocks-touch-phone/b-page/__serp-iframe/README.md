# СЕРП в Саджесте [wip][on hold]

Прототип открытия СЕРПа на Морде через iframe.

## Идея
Отключаем саджест на Морде. При клике в стрелку открывается сразу СЕРП(iframe) и серповый саджест.
Соответственно поиск осуществляется сразу на СЕРПе через ajax(live-search).

## Реализация
> Для работы пока требуются ajax флаги SPAS'a https://ab.yandex-team.ru/testid/547641

1. СЕРП передает на Морду всю свою историю, чтобы в стрелке браузера отображался корректный url. Все это происходит через monkeypatching `History API` + `MessageChannel`.
2. Морда выполняет команды, которые ей присылает СЕРП (раскрытие СЕРПа, закрытие, вызов History API)
3. Морда пересылает событие `popstate` на СЕРП.
4. Морда не дает перезаписывать свое начальное состояние `serpIframeInitial=true`, чтобы собственно можно было вернуться на Морду.
5. СЕРП записывает состояние своей "развернутости" на весь экран в `serpIframeOpened=true/false`, чтобы при навигации восстановить состояние.

## Ссылки
* "Вечная" бета https://morda-dev-v120d13.hamster.yandex.ru/
* Мордовая часть https://a.yandex-team.ru/review/2460237
