# CSS сетка

1. [Базовые понятия](#Базовые-понятия)
2. [Мотивация](#Мотивация)
3. [Использование](#Использование)
    1. [Модификаторы блока `grid`](#Модификаторы-блока-grid)
    2. [Supply](#supply)
    3. [Разметка](#Разметка)
4. [Тестирование](#Тестирование)
5. [Планы](#Планы)
6. [FAQ](#FAQ)
7. [Разработчику на заметку](#Разработчику-на-заметку)
8. [Вопросы, пожелания](#Вопросы-пожелания)

## Базовые понятия

Сетка на СЕРПе реализована в виде блока `grid`.

Блок имеет 2 модификатора:

`grid_mode_static` - статическая сетка, доступна на всех платформах. Имеет 12 колонок, ширина колонок и
расстояние между ними не меняется в зависимости от размера экрана. На `touch-phone` платформе является DEPRECATED и не рекомендуется к использованию.

`grid_mode_relative` - динамическая сетка, доступна для платформы `touch-phone`. Число колонок в сетке меняется от 12 до 16 в зависимости от доступной ширины экрана. Боковые отступы всегда статичные - `15px`. Ширина колонок и расстояние между ними рассчитываются динамически.

По умолчанию сетка занимает все пространство экрана, но на широких экранах и/или в landscape режиме – результаты поиска центрируются, контейнер имеет ограничение по ширине в `640px`.

**[Демо](https://renderer-web4-dev.hamster.yandex.ru/search/touch/?text=test&text=регион%2042&lr=213&lr=213&noredirect=1&noredirect=1&example_source=all&nl=1&flags=json_template_external%3Dby_name%3Bjson_template%3D1%3Bclck_host%3Dyandex.ru%2Fclck&redircnt=1519645953.2&foreverdata=3069322587)** `grid_mode_relative`

**[Код](https://forever.si.yandex-team.ru/demo/get?hash=3069322587)** с примерами в `foreverdata`

## Зачем нужна динамическая сетка, мотивация

1. Улучшение базового интерфейса СЕРПа.

    Делаем единые, согласованные и продуманные решения для серповых интерфейсов на всех платформах. СЕРП будет выглядить одинаково хорошо независимо от платформы и устройства.

2. Одно решение для адаптации верстки СЕРПа под большое количество устройств.

    Сокращаем "велосипеды" в стилях, время разработки на адаптацию блока под различные устройства и уменьшает вероятность, что блок будет плохо выглядеть на разных устройствах.

3. Упрощение коммуникаций между дизайнерами и разработчиками при верстке новой фичи.

    Уходим от "пикселей и марджинов 38px" в дизайнерских макетах к относительным понятиям и величинам в формате "блок в 3 колонки", "блок занимает половину ширины", "блок должен растягиваться на весь экран", а также к набору типовых интерфейсных решений на основе схемы-блоков от дизайнеров. Неправильно сверстать фичу становится сложнее.

## Использование

Есть несколько вариантов использования:

### через priv.js

Для упрощения создания сетки из разного количества колонок есть конструкторский блок `grid` в технологии `priv.js`, который позовляет построить разметку из контейнеров с необходимой шириной и передать внутрь весь необходимый контент, который будет разложен по сетке автоматически.

Пример использования:
```js
{
    block: 'grid',
    cols: [
        {
            mode: 'relative',
            width: 'half',
            content: {
                block: 'button-api',
                text: 'Половинка 1',
                size: 'l',
                width: 'max'
            }
        },
        {
            mode: 'relative',
            width: 'half',
            content: {
                block: 'button-api',
                text: 'Половинка 2',
                size: 'l',
                width: 'max'
            }
        }
    ]
}
```

![Результат выполнения кода выше](https://jing.yandex-team.ru/files/grape/2016-12-26_15-46-39.png__Yandeks.Disk_2016-12-26_15-48-03.png)

### через supply

Блок-помощник для обучения других блоков пониманию сетки. Добавляет дополнительный параметр к блоку для передачи параметров сетки.

Кто уже умеет:
- `thumb`
- `button-api`
- `select-api`
- `textarea-api`
- `scroller` и все производные от него блоки (showcase).

Пример использования `button-api`:
``` js
{
    block: 'button-api',
    text: 'Половинка',
    size: 'l',
    grid: {
        mode: 'relative',
        cols: 'half'
    }
}
```

В результате на DOM-ноду блока button-api будет примиксованы CSS классы `grid__col grid__col_mode_relative grid__col_width_half`.

Пример использования `supply__grid`:
``` js
blocks['my-block'](context, dataset) {
    var bemjson = { block: 'my-block', content: dataset.value };

    return blocks['supply__grid'](context, {
        grid: {
            mode: dataset.mode,
            width: dataset.cols
        }
    }, bemjson);
};
```

### через миксы и модификаторы

Часть сетки для удобства вынесена в модификаторы, которые можно миксовать к блоку.

1. [unmargin-x](#unmargin-x)
2. [pad-x](#pad-x)
2. [viewport](#viewport)

#### unmargin-x

Позволяет растянуть/выдвинуть блок на размер базовых внутренних отступов (от края до края). Заранее предполагается, что блок занимает 100% ширины контейнера.

Значения модификатора:
- `yes` - "съедаем" отступы слева и справа
- `left` - только слева
- `right` - только справа

Пример использования:
``` js
{
    block: 'b1',
    mix: { block: 'grid', mods: { 'unmargin-x': 'yes' } },
    // ...
}
```

#### pad-x

Добавляет внутренние отступы. Любой блок, находящийся внутри контейнера `.main` не требует добавления внутренних отступов отдельно. Однако, часто бывают случаи, когда блок, содержащий контент, растянут с помощью модификатора `unmargin-x`. Чтобы контент не "прилипал" к крям экрана и правильно выравнивался нужно добавить модификатор `pad-x`.

Значения модификатора:
- `yes` - оступы слева и справа
- `left` - только слева
- `right` - только справа

Пример использования:
``` js
{
    block: 'b1',
    mix: { block: 'grid', mods: { 'pad-x': 'yes' } },
    // ...
}
```

__Важно:__ визуальная схема работы модификаторов `unmargin-x` и `pad-x`

![Схема работы unmargin](https://jing.yandex-team.ru/files/tavria/grid-scheme-1.jpg)

#### viewport

Бывают случаи когда необходимо растянуть блок на всю ширину экрана вне зависимости от размера вьюпорта. Например карусель имеет светло-коричневую подложку, растянутую на весь экран. Толстые разделители так же хороший пример. В подобных ситуациях можно использовать модификатор `viewport` в единственном значении `full`.

Пример использования:
``` js
{
    block: 'b1',
    mix: { block: 'grid', mods: { viewport: 'full' } },
    // ...
}
```

### Модификаторы элемента `grid__col`

1. [mode](#mode)
2. [width](#width)

Элемент `col` блока `grid` может занимать определенное или относительное количество доступных колонок CSS-сетки.

#### width

Определяет количество занимаемых колонок.

Значения модификатора:
- `1..16` - числовое значение колонок, максимальное число ограничено в пределах от 12 до 16 для динамической сетки. Ограничения для конкретных разрешений можно посмотреть в блоке "grid"
- `half` - половина сетки/контейнера
- `third` - треть сетки/контейнера
- `all` - вся доступная ширина сетки/контейнера

__Важно:__ Относительные ширины `half` и `third` включают в себя отступы между колонками: половину и треть соответственно. Учитывайте это в верстке самостоятельно. Для генерации сетки из контейнеров с правильными отступами между друг другом [используйте](#Разметка) блок `grid` в технологии `priv.js`.

Пример использования:
``` js
// Половинка
{
    block: 'b1',
    mix: { block: 'grid', elem: 'col', elemMods: { mode: 'relative', width: 'half' } },
    // ...
},
// 4 колонки в процентном соотношении
{
    block: 'b1',
    mix: { block: 'grid', elem: 'col', elemMods: { mode: 'relative', width: 4 } },
    // ...
},
// 7 колонок в пикселях
{
    block: 'b1',
    mix: { block: 'grid', elem: 'col', elemMods: { mode: 'static', width: 7 } },
    // ...
},
```

## Тестирование динамической сетки

Существует возможность тестирования блоков на различных брейкпоинтах в hermione. Все блоки, использующие сетку, должны быть покрыты такими тестами в разумных пределах. Совсем необязательно тестировать все и на всех брейкпоинтах, если вы точно знаете, что там ничего не меняется. Стоит покрывать только действительно важные изменения блоков относительно ширины экрана. Текущий список ширин экранов для тестов выглядит так:

- 320
- 360
- 375
- 480
- 540
- 720 (на скриншоте будет видна `карточка`)

[Список ширин](https://a.yandex-team.ru/arc_vcs/frontend/projects/web4/browsers.js) экранов отличается от списка брейпоинтов самой сетки из-за соображений оптимизации и анализа аналитики используемых устройств. Текущий список ширин в купе с основными тестами позволяет покрыть все брейкпоинты сетки.

## Вопросы, пожелания

Если у вас возникли вопросы, идеи, предложения – приходите в [контур «Красота»](https://abc.yandex-team.ru/services/vteamkraso/).
