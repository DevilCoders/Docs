# Эксперименты

Система экспериментов позволяет:

- Внедрить новую, ранее не существовавшую фичу
- Изменить вид/поведение существующей фичи и/или компонентов внутри фичи
- Изменить вид/поведение компонентов внутри группы фичей («сквозной эксперимент»)

Все эксперименты связаны с экспериментальными флагами. Флаг активируется query-параметром `&exp_flags={имя флага}`.
Для работы с флагами есть cli-команды:

Создать флаг:
```shell
npm run flag:create
```

Удалить флаг:
```shell
npm run flag:remove {имя флага}
```

Для всех флагов в актуальном стеке написаны типы. Это значит, что без добавления декларации флага нельзя использовать его в коде.
Если вы добавляете или удаляете флаг через cli, то тайпинги пересобираются автоматически. Если вы добавили/удалили флаг вручную, то 
необходимо сгенерировать типы с помощью команды:

Собрать тайпинги для флагов
```shell
npm run flag:build
```

Все TypeScript/React-эксперименты находятся в папке `src/experiments/`. Каждая подпапка содержит реализацию одного эксперимента, имя папки — это имя флага, активирующего эксперимент. Код эксперимента регистрируется в реестрах экспериментов.

```diff
src/experiments/
  ├── .registry/  — реестры экспериментов
+ ├── exp_flag_name/ — название эксперимента (флага)
+ │   ├── components/ — компоненты из эксперимента
+ │   ├── components.entries/ — entry-файлы для экспериментов с компонентами
+ │   └── features/ — эксперимент над фичами
```

Эксперименты с кодом на priv/i-bem-стеке находятся в папке `experiments/`. Каждая подпапка содержит реализацию одного эксперимента, имя папки — это имя флага. В папке эксперимента может находиться конфиг-файл.

```diff
experiments/
+ ├── exp_flag_name/ — название эксперимента (флага)
+ │   ├── ... — priv/i-bem/scss-код эксперимента
+ │   └── .config.json — необязательные настройки эксперимента
```

Документация:

- [Эксперименты с адаптерами](./adapters.md) (TypeScript)
- [Эксперименты с React-компонентами](./components.md)
- [Эксперименты в Конструкторе](./construct.md)
