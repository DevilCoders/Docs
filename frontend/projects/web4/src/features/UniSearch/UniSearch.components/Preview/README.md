# Превью Универсального поиска

Базовый компонент для обработки клика по элементу тематического блока (ТБ). На данный момент находится в разработке, за прогрессом можно следить в [UNISEARCH-86](https://st.yandex-team.ru/UNISEARCH-86).

Разработка разбита на три стадии, каждая из которых будет вынесена за свой модификатор, чтобы не ломать уже написанную функциональность.

## Как работать с превью
От интегрирующего превью ТБ требуется уметь получать данные для шаблонизации и рендерить сам контент. Превью предоставляет метод `renderContent`, при вызове которого ожидает получить react-дерево.

Знание о том какой конкретно элемент нужно отрисовать приносится аргументом в `renderContent`. В качестве арумента ожидается интерфейс `IContentProps`, содержащий индекс элемента в галерее превью.

Для понимания границ и изначального элемента предусмотрены свойства `initialIndex` и `itemsCount`, которые интегрирующий ТБ обязуется предоставить. `initialIndex` говорит превью какой индекс отобразить сначала. Например, если пользователь кликнул на элемент и нужно сначала показать контент, соответствующий этому элементу. `itemsCount` же указывает на текущее количество элементов для отображения и позволяет понимать когда закончить отрисовывать элементы с правого края галереи превью.

## Типы превью
На момент разработки решено итеративно выпускать функциональность превью. Выделены три `type`: `single`, `multi-static`, `multi-dynamic`.

### type single
Это одиночное превью (без галереи), которое умеет отображать только один элемент единовременно. При этом реализует ровно такой же интерфейс, что и все остальные типы.

В метод `renderContent` будет проброшен `initialIndex`, всё остальное возможное взаимодействие с превью заключается в возможности его закрыть.

### type multi-static
Галерея превью с возможностью переключать текущий отображаемы элемет. Рисует сразу `itemsCount` элементов. В данном случае интегрирующий код может научится загружать элементы и использовать этот тип превью, но это может быть неоптимально, т.к. все элементы будут находится в `DOM`, что при бесконечном листании может вызывать проблемы с производительностью и потреблением памяти.

На текущий момент не реализованл. [SERP-140558](https://st.yandex-team.ru/SERP-140558)

### type multi-dynamic
Галерея превью с реализацией виртуализации бесконечных списков. В `DOM` всегда будет находится ограниченное количество элементов, которое будет определяться каким-то параметром. `renderContent` будет вызываться по мере горизонтальной прокрутки пользователем, а не сразу для всего списка как в случае с `multi-static`.

В идеале останется именно этот вид превью, если не найдётся продуктовой необходимости поддержать остальные.

На текущий момент не реализовано. [SERP-140559](https://st.yandex-team.ru/SERP-140559)

## Дополнительные компоненты
[PreviewLoader](../PreviewLoader) — отвечает за динамическую загрузку компонента. Т.к. это функциональность за кликом, то рекомендуется использовать по умолчанию именно его.
**Скелетон TBD** — отвечает за отображение состояния загрузки контента. Не реализован.

