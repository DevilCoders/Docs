# DEVEXP

Инструмент для сопровождения код-ревью на github.

Если вы хотите что-то исправить или добавить - добро пожаловать, PR принимаются,
инструкция [здесь](https://github.yandex-team.ru/devexp/devexp/blob/master/docs/get-started.md).

## Возможности
* Автоматически назначает ревьюверов для пулл реквеста, учитывая авторство и текущую загрузку.
* Отправляет уведомления о необходимости провести ревью по telegram/email/stack
* При назначении на ревью учитывает отсутствие на стаффе.
* Может менять статусы задач в трекере.
* Подключать к любому репозиторию простой установкой приложения https://github.yandex-team.ru/github-apps/codereview

## Оглавление
* [Как подключить к себе в Гитхабе](#Как-подключить-к-себе-в-Гитхабе)
* [Как подключить к себе в Аркануме](#Как-подключить-к-себе-в-Аркануме)
* [Как подключить к себе в Битбакете](#Как-подключить-к-себе-в-Битбакете)
* [Описание конфига](#Описание-конфига)
  * [approve_count](#approve_count)
  * [total_reviewers](#total_reviewers)
  * [notification](#notification)
  * [static_members](#static_members)
  * [github_members](#github_members)
  * [abc_members](#abc_members)
  * [abc_duty](#abc_duty)
  * [yandex_staff_members](#yandex_staff_members)
  * [ignore](#ignore)
  * [auto_assign](#auto_assign)
  * [auto_start](#auto_start)
  * [auto_correct](#auto_correct)
  * [update_badges](#update_badges)
  * [update_status](#update_status)
  * [update_labels](#update_labels)
  * [update_reviewers](#update_reviewers)
  * [update_assignees](#update_assignees)
  * [not_start_after_publish](#not_start_after_publish)
  * [achievement_unlock](#achievement_unlock)
  * [strict](#strict)
  * [startrek](#startrek)
  * [specialReviewers](#specialreviewers)
  * [commands](#commands)
* [Неочевидное о редактировании конфига](#Неочевидное-о-редактировании-конфига)
* [Конфиги разных сервисов](https://github.yandex-team.ru/search?l=JSON&q=approve_count&type=Code)
* [Поддерживаемые команды](#Поддерживаемые-команды)
  * [start](#start)
  * [singlestart](#singlestart)
  * [stop](#stop)
  * [ping](#ping)
  * [fixed](#fixed)
  * [restart](#restart)
  * [restart-force](#restart-force)
  * [change](#change-login1-login2)
  * [ok](#ok)
  * [!ok](#ok-1)
  * [busy](#busy)
  * [add login](#add-login)
  * [remove login](#remove-login)
  * [ready](#ready)
* [Уведомления](#Уведомления)
  * [Email](#email)
  * [Telegram](#telegram)
  * [Slack](#slack)
* [Как выбираются ревьюверы](#Как-выбираются-ревьюверы)

## Как подключить к себе в Гитхабе
1. Положить конфиг `.devexp.json` в репозиторий.
2. Дать админские права боту **robot-serp-bot** (чтобы менять описание пулл-реквеста)
3. Добавить вебхук в настройках вашего проекта на `https://codereview.in.yandex-team.ru/webhook/github` или подключить приложение https://github.yandex-team.ru/github-apps/codereview к репозиторию

__Content type__: application/json

![Настройки хука](https://jing.yandex-team.ru/files/klekh/seubr20170901140023.png)

## Как подключить к себе в Аркануме
1. Положить конфиг `.devexp.json` в нужную папку.
2. Дождаться когда [здесь](https://a.yandex-team.ru/search?search=,.devexp.json,,arcadia,,500) появиться файл с конфигом
3. PROFIT

## Как подключить к себе в Битбакете
1. Положить конфиг `.devexp.json` в нужную папку.
2. Добавить вебхук в настройках вашего проекта на `https://codereview.yandex-team.ru/webhook/bitbucket`
3. PROFIT

![Настройки хука](https://jing.yandex-team.ru/files/osiyuk/photo_2021-08-22%2021.41.24.jpeg)

## Описание конфига
Пример конфига:
```json
{
  "approve_count": 1,
  "total_reviewers": 1,
  "notification": "telegram",
  "static_members": ["xxxxxx", "jsus"]
}
```

**Система синхронизирует настройки раз в час.**

Состав команды образуется слиянием `static_members`, `github_members`, `yandex_staff_members`, `abc_members`. Можно указать что-то одно, или все сразу.

### approve_count
Пример: `"approve_count": 2`\
По умолчанию – `1`

Кол-во обязательных "ok" для прохождения ревью. Эта опция отвечает за количество апрувов от людей из списков
`static_members`, `github_members`, `yandex_staff_members`, `abc_members` (см.ниже).

### total_reviewers
Пример: `"total_reviewers": 4`\
По умолчанию – `1`

Кол-во призываемых людей на ревью. Эта опция отвечает за количество людей из списков `static_members`,
`github_members`, `yandex_staff_members`, `abc_members` (см.ниже).

### notification
Пример: `"notification": "telegram"`\
Возможные значения: `email`, `q`, `telegram`, `slack-<что-то>`.

_Нельзя указать массив значений!_

Транспорт, куда отправлять уведомления. Подробнее в разделе [Уведомления](#Уведомления).

### static_members
Пример: `"static_members": ["xxxxxx", "jsus"]`

Состав команды, список логинов людей, через запятую.

### github_members
Пример: `"github_members": { "org_name": "serp", "slug_name": "devs" }`

Состав команды, группа на гитхабе
`slug_name` указывать необязательно, тогда возьмется общий список людей в организации.
Для этой опции роботу **robot-serp-bota** необходимы админские права для чтения закрытых групп.

### yandex_staff_members
Пример: `"yandex_staff_members": { "group_id": [356] }`

Состав команды, группа на стаффе.
Можно указать несколько групп. `group_id` можно узнать через [staff-api](https://staff-api.yandex-team.ru/v3/persons?_pretty=1&_one=1&login=xxxxxx&_fields=department_group.id)

### abc_members
Примеры:

`"abc_members": ["ugc"]` - slug(ЧПУ), по факту то, что стоит в урле abc после services/<slug>, например для serp `https://abc.yandex-team.ru/services/serp` slug=serp <br />
`"abc_members": [303]` - id сервиса в abc <br />
`"abc_members": [{ "slug": "serp", "roles": ["frontend_developer", "functional_tester"] }, { "id": 54, "roles": ["developer"] }]` -
также можно помимо всего сервиса явно указать роли(`code` в abc API), на данный момент были созданы все необходимые `code`,
если у вашей роли отсутствует поле `code` напишите на tools@. Доступные роли: `frontend_developer, functional_tester, developer, product_head` [например](https://abc-back.yandex-team.ru/api/v4/services/members/?service__slug=tools-frontend-team)

В итоге можно позвать всех из команды serp, тестировщиков из команды MED и главного менеджера в сервисе с id=509:
`"abc_members": ["serp", { slug: 'MED', roles: ["functional_tester"] }, { id: 509, roles: ["product_head"] }]`

Используется [abc-api](https://wiki.yandex-team.ru/intranet/abc/api/)

### abc_duty
Примеры:

`"abc_duty": ["ugc"]` - slug(ЧПУ), по факту то, что стоит в урле abc после services/<slug>, например для serp `https://abc.yandex-team.ru/services/serp` slug=serp <br />
`"abc_duty": [303]` - id сервиса в abc <br />
`"abc_duty": [{ "slug": "serp", "roles": ["duty"] }, { "id": 54, "roles": ["duty"] }]` -
также можно помимо всего сервиса явно указать роли(`code` в abc API).

Список дежурных, указанных в ABC, которых не нужно призывать на ревью. Если не указана роль, по умолчанию стоит "duty".


### ignore
Пример: `"ignore": ["veged", "mishanga"]`

Список людей, которых не нужно призывать на ревью.

### auto_assign
Пример: `"auto_assign": true`\
По умолчанию – `false`

Назначать ревьювeров при создании пулл реквеста.

### auto_start
Пример: `"auto_start": true`\
По умолчанию – `false`

Стартовать ревью при создании пулл реквеста.

### auto_correct
Пример: `"auto_correct": true`\
По умолчанию – `true`

Ревьюшница назначает ревьюверов сама по [умным встроенным алгоритмам](#Как-выбираются-ревьюверы). Если передать
`false`, Ревьюшница перестанет корректировать список ревьюверов, предоставит автору PR возможность самостоятельно
решать, кого призывать в PR.

### update_badges
Пример: `"update_badges": false`\
По умолчанию – `true`

Добавляет шилдики в описание пулл-реквеста, показывает статус ревью и статус ревьюверов.

### update_status
Пример: `"update_status": false`\
По умолчанию – `false`

Добавляет статус ревью в список проверок пулл реквеста.

### update_status_approve_count
Пример: `"update_status_approve_count": 1`

Кол-во "ok", необходимых для успешного прохождения обязательной проверки. Только для Github

### not_count
Пример: `"not_count": ["robot-bot"]`
Список логинов, которые могут ставить свой ок, но не учавствуют в подсчете необходимых ок-ов в код-ревью

### update_status_success_for
Пример: `"update_status_success_for": ["robot-serp-bot"]`

Только для роботов! Список из логинов, для которых нужно автоматически выставлять успешной проверку

### update_labels
Пример: `"update_labels": false`\
По умолчанию – `false`

Добавляет лейблы к пулл реквесту со статусом ревью.

### update_reviewers
Пример: `"update_reviewers": false`\
По умолчанию – `false`

Назначает ревьюверов через интерфейс гитхаба.

### update_assignees
Пример: `"update_assignees": false`\
По умолчанию – `false`

Назначает ответственных через интерфейс гитхаба.

### achievement_unlock
Пример: `"achievement_unlock": true`\
По умолчанию – `true`

Выдаёт ачивки на стаффе за количествово просмотренных PR.

### not_start_after_publish
Пример: `"not_start_after_publish": true`\
По умолчанию – `false`

Не стартовать ревью после публикации ревью-реквеста в Аркануме.

### strict
Пример: `"strict": false`\
По умолчанию – `false`

Разрешает переводить PR в статус `completed` только после того, как заапрувил кто-нибудь из списков `static_members`,
`github_members` и `yandex_staff_members`.

### startrek
Пример:
```json
{
  "startrek": {
    "queues": ["SERP"],
    "status": { "inprogress": "inProgress" },
    "fields": { "reviewers": "reviewers" },
    "updates": ["status", "comment"]
  }
}
```
Настройки для трекера. Из тайтла пулл-реквеста извлекается номер тикета, для которого будет меняться статус.

* `queues` – массив из очередей трекера, для которых нужно менять статус.
* `status` – карта статусов, где ключ – статус ревью, значение – статус трекера.
    * У ревью 4 статуса: `notstarted`, `inprogress`, `changesneeded`, `complete`.
    * У трекера много статусов — зависит от проекта. Статусы проекта `SERP` можно подсмотреть в
    [startrek-api](https://st-api.yandex-team.ru/v2/queues/SERP/statuses) (статус – `key`).
    * Переключением статуса занимается [WALL-E Bot](https://staff.yandex-team.ru/robot-serptools). Для некоторых
    очередей в трекере боту нужно выдать дополнительные права.
    * Внимание! Бот переключает статус только прямым переходом, где нет обязательных полей для заполнения.
* `fields` — карта полей которые обновляются в задаче, где ключ — тип данных, значение — ключ поля в трекере.
    * `reviewers` — кого указывать в Стартреке в качестве ревьюверов пулл реквеста. По умолчанию равно `reviewers`.
    * `approved` — кого указывать в Стартреке в качестве "аппруверов" пулл реквеста. По умолчанию обновляет reviewCompletedBy.
    * `pending` - кого указывать в Стартреке в качестве сотрудников, от которых ожидается ревью. По умолчанию обновляет ReviewPendingFrom.
* `updates` — массив с полями, которые будут обновляться в Стартрек-таске.
    * по умолчанию — `["status", "comment", "reviewers"]`
    * `status` — меняет статус задачи в Стартреке.
    * `comment` — создаёт коментарий в задаче от имени [WALL-E Bot](https://staff.yandex-team.ru/robot-serptools).
    * **Важно!** Если не передано значение `status`, комментарий в таске тоже не создаётся. Комментировать-то не о
    чем.
    * `reviewers` — добавляет ревьюверов в задачу.
    * `approvers` — добавляет апруверов. Обновляет reviewCompletedBy, если в опции `startrek.fields.approved` не передано иное поле.
    * `pendingReviewers` - добавляет пользователей, от которых ожидается ревью. Обновляет ReviewPendingFrom, если в опции `startrek.fields.pending` не передано иное поле.

### specialReviewers
Пример:
```json
{
  "specialReviewers": [
    {
      "pattern": ["**/*.md"],
      "members": ["login", "login2", "login3"],
      "reviewers": 2,
      "abc_members": {},
      "github_members": {},
      "static_members": {},
      "yandex_staff_members": {}
    }
  ]
}
```

Возможность по маскам файлов назначать конкретных ревьюверов

* `pattern` – [minimatch](https://github.com/isaacs/minimatch)-маски по файлам пулл-реквеста, при которых применять данное правило
* `titlePattern` – RegExp-маски по заголовку пулл-реквеста, при которых применять данное правило
* `members` – список из логинов, для которых нужно добавить на ревью
* `reviewers` – кол-во людей, которых нужно позвать из списка `specialReviewers.members`, по умолчанию – `1`.
* `approveCount` - кол-во обязательных "ok" от группы, для прохождения ревью, по умолчанию равно `reviewers`.
* `isReviewerRequired` — самая непонятная и мозго-выносящая штука сейчас ;)
* `abc_members` - см. [abc_members](#abc_members)
* `github_members` - см. [github_members](#github_members)
* `static_members` - см. [static_members](#static_members)
* `yandex_staff_members` - см. [yandex_staff_members](#yandex_staff_members)

##### pattern vs titlePattern
Сейчас правила, для каторых указаны и `pattern` и `titlePattern` работают по схеме `ИЛИ`.
Если в одном пулл-реквесте сработает и `pattern` и `titlePattern`, правило сработает дважды на добавление ревьюверов.

##### `isReviewerRequired: false` (либо не указан)
Секция `specialReviewers` увеличивает _вероятность_, что логин из списка `specialReviewers.members` будет
добавлен как ревьювер. При этом опция `reviewers` указывает скольким людям из списка `members` нужно поднять
вероятность. Это можно описать такими словами:

_Вася рядовой разработчик, и ревьювит вместе с остальными, но лучше других разбирается в сборке проекта. Давайте
напишем правило, чтобы чаще звать Васю именно в пулл-реквесты про сборку._

##### `isReviewerRequired: true`
Правило добавляет _обязательного ревьювера_ из списка `specialReviewers.members`

И тогда общее количество ревьюверов высчитывается, как сумма `total_reviewers` (люди из списков `*_members`) и
`reviewers` (из `specialReviewers`).

**Важно!**\
При `isReviewerRequired: true` количество апрувов считается по-разному в зависимости от того, есть ли в конфиге опция
 `strict`

- `isReviewerRequired: true` и `strict: false` (либо не указан)\
Чтобы пройти ревью, нужно набрать аппрувов в количестве `approve_count`. Это можно описать такими словами:

   _У нас есть человек, который следить за документацией, давайте его всегда звать на ревью про документацию, но не
вместо кого-то, а новым ревьювером._

- `isReviewerRequired: true` и `strict: true`\
Чтобы пройти ревью, нужно набрать аппрувы по каждой группе (количество `approve_count` из `*_members` и `reviewers`
 из `specialReviewers`). Это можно описать такими словами:

   _Есть команда Картинок и команда Видео, в пулл-реквестах в общий код нужен обязательный ревьювер из каждой
   команды, и ревью не пройдет, пока обе команды не заапрувят. Даже если придут 10 разработчиков Картинок и
   заапрувят пулл-реквест._


### commands
Возможность сконфигурировать параметры специальных команд.\
Пример:
```json
{
  "commands": {
    "ready": {
      "startrek_status": "readyForTest"
    }
  }
}
```

Сейчас существует только одна такая команда [`/ready`](#ready).

## Неочевидное о редактировании конфига

1. Система синхронизирует настройки автоматически с периодичностью раз в час.

   Это означает, что если вы только что исправили конфиг в своём репозитории, эти изменения применятся в течение часа.
   Чтобы синхронизировать "прямо сейчас" — нужно в браузере дёрнуть ручку
   `https://codereview.si.yandex-team.ru/team-manager/sync?name=<your-repo>`

   Например, если хотим синхронизировать конфиг в репозитории `https://github.yandex-team.ru/serp/web4`, дергаем
`https://codereview.si.yandex-team.ru/team-manager/sync?name=serp/web4`

2. Конфиг синхронизируется из дефолтной ветки репозитория.

   Это означает, что если вы исправили конфиг, его нужно выложить в дефолтную ветку вашего репозитория. А если
   исправления запушены в фиче-ветку, система их увидеть не сможет, синхронизация не произойдёт.

   Например, у `serp/web4` дефолтная ветка — `dev`. Значит отредактированный конфиг нужно закоммитить в `dev`, а только
потом дергать ручку синхронизации.

Для редактирования и отладки конфига правильная последовательность действий следующая:
1. Правим конфиг
2. Пушим его в дефолтную ветку вашего репозитория
3. Дергаем ручку `https://codereview.si.yandex-team.ru/team-manager/sync?name=<your-repo>`
4. После этого проверяем изменения в конфиге (создаем новый PR или в существующем делаем `/restart-force`)

## Конфиги разных сервисов
https://github.yandex-team.ru/search?l=JSON&q=approve_count&type=Code

## Поддерживаемые команды
Ревьюшница разбирает команды начинающиеся со `/` в любом месте комментария.\
_Команда без `/` должна быть единственной строкой в комментарии._

**Важно!**\
Ревьюшница разбирает команды только в комментариях к пулл-реквесту.

### /start
Отдает пулл-реквест на ревью. После запуска команды отсылает выбранным ревьюверам сообщения и начинает отсчёт времени
 в статистике. Обычно пишется только автором.

### /singlestart
То же, что и `/start`, но оставит только одного ревьювера. Актуально для небольших правок, где не требуется полноценное ревью.

### /stop
Команда переводит ревью в статус `not started`.

### /ping
Отправляет сообщение ревьюверам, что они должны посмотреть пулл-реквест.\
[Полный список синонимов](src/services/command-issue/command-ping/index.js#L2)

* `/ping` — отправляет уведомление в зависимости от статуса ревью:
  * если PR в статусе `inprogress` — уведомление отправляется всем ревьюверам.
  * если PR в статусе `changesneeded` — отправляется только автору пулл-реквеста
* `/ping login` — отправляет уведомление одному конкретному пользователю.
  * Статус PR во внимание не принимается.
  * Используется, чтобы призывать конкретного человека и не отвлекать всех ревюверов без необходимости.

### /fixed
Переводит ревью из статуса `changes needed` в статус `in progress`.\
Отправляет сообщение ревьюверам, что они должны посмотреть пулл-реквест.

* `/fixed` — отправляет уведомление всем ревьюверам.
* `/fixed login` — отправляет одному конкретному пользователю.

### /restart
Перезапускает процесс ревью, сбрасывает все ок'и, повторно отсылает уведомления.\
Синоним — `/reset`

### /restart-force
Тоже, что и `/restart`, но может выбрать других ревьюверов.

### /change login1 login2
Заменяет одного ревьювера на другого. Новому ревьюверу высылается сообщение.\
Синоним — `/replace login1 login2`

### /ok
Поставить `ok`. После двух `ok` у пуллреквеста меняется статус на `complete`.
Если `ok` ставит не ревьювер - то он автоматически добавится в список ревьюверов.\
[Полный список синонимов](src/services/command-issue/command-ok/index.js#L1)

### /!ok
Команда переводит ревью в статус `changes needed`.\
[Полный список синонимов](src/services/command-issue/command-not-ok/index.js#L1)

### /busy
Используется одним из ревьюверов. Заменяет ревьювера на другого, выбранного алгоритмом

### /add login
Добавить ревьювера.

### /remove login
Убрать ревьювера. Нельзя убрать ревьювера, если их станет меньше чем `approve_count`

### /ready
Переводит прилинкованную Стартрек-задачу в статус, который указан в конфиге [commands](#commands).\

## Уведомления
Канал уведомлений определяется опцией [notification](#notification).

### Email
Для фильтрации  в почтовых клиентах письма приходят с заголовками:
1. `X-From: devexp`
2. `X-Event: <имя события>`, где `<имя события>` — одно из:
   * `review:transition:start` — возникает при команде `/start`
   * `review:transition:reset` — возникает при командах `/reset`, `/restart`
   * `review:transition:restart` — при `/restart-force`
   * `review:transition:complete` — когда набрали нужное количество `/ok`
   * `review:transition:changesneeded` — при `/!ok` и синонимах
   * `review:transition:fix` — при `/fixed` после `review:transition:changesneeded`
   * `review:update:change` — при `/change`, `/replace`, `/busy`
   * `review:update:add` — при `/add`
   * `review:ping` — при `/ping`, `/up`

### Telegram
Обязательно: ваш **telegram должен быть указан на стаффе как рабочий**. На личные контакты уведомления не рассылаются.

Чтобы получать уведомления в telegram, необходимо добавить бота `@codereview_bot` в свой список telegram-контактов  и активировать его telegram-командой `/start`. Проверить что все заработало можно отправив боту команду `/pending`. Если не работает, проверьте на стаффе правильность.
Это не общий канал. В него будут приходить уведомления, адресованные только вам.

### Slack
Slack подключается по требованию вручную.
Для подключения `slack` сначала добавьте бота в свою команду, как [написано в документации](https://api.slack.com/bot-users#creating-bot-user).
Потом, полученный bot-token надо прислать [отдельным письмом](mailto:jsus@yandex-team.ru).
В ответном письме будет указано, что необходимо записать в поле [`notification`](#notification), для получений уведомлений в slack.

### Yandex Slack Workspaces
Если вы хотите получать уведомления в любой воркспейс, входящий в https://yandex.enterprise.slack.com, необходимо указать в поле [`notification`](#notification) `slack-yndx-all`. Если вы уже получаете уведомления в другой мессенджер, но хотите изменить на слак, найдите в слаке `@review-bot` и напишите любое рандомное слово. После этого уведомления будут приходить в слак.

### Яндекс.Чаты (aka Q)
Чтобы получать уведомления в Q для всего репозитория, укажите в конфиге `.devexp.json` `"notification": "q"` . Или вы можете переключиться на новый канал, если напишете боту [robot-devexp](https://q.yandex-team.ru/#/staff/robot-devexp). После этого новые уведомления будет приходить в Яндекс.Чаты.

### Неочевидное про уведомления
Опция `notification` действует:
1. Для всех новых людей, подключившихся к разработке проекта.
2. Для тех, кто не выбрал самостоятельно, куда должны приходить уведомления.

Эту опцию можно персонально переопределить.

#### Персональные telegram-уведомления
Каждый разработчик может самостоятельно подключить _для себя_ уведомления в telegram , несмотря на то, что в конфиге проекта опция `notification=email`.
Для этого достаточно в свой список telegram-контактов добавить бота `@codereview_bot` и активировать его telegram-командой `/start`.

Бота из списка контактов можно удалить, но после удаления в PR-ах будут появляться ошибки
```
ETELEGRAM: 403 Forbidden: bot was blocked by the user
```
Починить можно двумя путями
1. Если уведомления всё ещё нужны, верните бота в список своих telegram-контактов и активируйте.
2. Если уведомления получать не хотите, сбросьте свои персональные настройки нотификаций GET
-запросом, в котором укажите свой логин.
```
https://codereview.si.yandex-team.ru/notification/clear?login=<your_login>
```

#### Групповые telegram-уведомления
Есть возможность получать уведомления от телеграм-бота в групповой чат.
Для этого нужно в чат добавить `@codereview_bot`, после чего бот запомнит `id` этого чата и будет готов слать туда уведомления для каждого, кто в этом групповом чате выполнит команду `/pending @codereview_bot`.
Если, к примеру, в каком-то PR-е есть два ревьювера, которые оба состоят в этом чате, то для каждого из них бот пришлет отдельное уведомление, и в чат прилетят два одинаковых.

Бота из чата можно удалить, но после удаления в PR-ах будут появляться ошибки
```
ETELEGRAM: 403 Forbidden: bot is not a member of the supergroup chat
```

Связано с тем, что в базе данных Ревьюшницы хранится `id` вашего чата, из которого удалили бота. И бот будет продолжать пытаться послать сообщение в чат.
Если бота снова добавить в чат, ошибки в PR исчезнут.
Если необходимо переместить бота в другой чат, достаточно в одном его удалить, в другой добавить. Но сделать это должен тот разработчик, кто первым добавил бота в предыдущий чат.

## Как выбираются ревьюверы
**TODO**

Ревьюверы выбираются на основе:
1. Список ответственных;
2. Знакомые с данным кодом;
3. Текущая загруженность ревьюверов;
4. С учетом людей, указаных в описании пула;
5. С учетом конфига сервиса;
6. С использованием небольшого рандома.
