# tv-focus-border

Блок анимированной рамки.

## Механика работы

1. Рамка создаётся в глобальном контексте (в самом конце `body`) и подписывается на событие фокуса от `tv-focus-controller`.
1. По событию ищет в сфокусированном элементе прототип для рамки (`tv-focus-border-proto`) и копирует свойства его
`:before`-псевдоэлемента.
1. Анимация выполняется с помощью свойства `transition` (с естественной деградацией на Tizen 2.3).
1. После анимации блок `tv-focus-border` скрывается и показывается прототип рамки (модификатором `visible`). Это
сделано для того, чтобы не делать лишних синхронизаций рамки с прототипом при изменении интерфейса (скролле, анимациях интерфейса).

## Другие варианты работы

1. Если в сфокусированном элементе нет прототипа рамки (элемент без рамки) - рамка выключается с помощью модификатора
`disabled` у блока `tv-focus-border`.
1. Если рамка была скрыта и в сфокусированном элементе есть прототип рамки, то она просто отображается поверх этого
прототипа без анимации.

## Известные проблемы и их решения

1. _Фокусируемый элемент имеет анимацию, изменяющую внешний вид рамки при получении фокуса._ Если нет надёжного способа
вычислить свойства рамки после анимации, то проблема нерешаема. Лучше избегать анимации на элементах принимающих фокус
(они и так выделяются рамкой).
1. _Фокусируемый элемент скроллится во время анимации рамки._ Нужно вычислить абсолютные координаты элемента после окончания
скроллинга и передать их вторым объектом в метод `_focus` (см. обработчик `_onCarouselItemFocus`).
1. _После получения элементом фокуса проходит какая-то анимация (на данном элементе или родительском),
которая сдвигает прототип относительно самой рамки._ Нужно к анимируемому элементу примиксовать
`tv-focus-border-proto_sync-before-animation` и рамка перед перемещением будет синхронизироваться с
текущим прототипом.
