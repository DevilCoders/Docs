# Ресурсы для ТВ-приложения Яндекс
Проект для сборки основной логики ТВ-приложения Яндекс.

Основное назначение - подготовка платформонезависимого API для WebView с основной версткой и
открытие WebView в iframe после завершения всех приготовлений. 

Само ТВ-приложение, которое загружает собираемые в этом проекте ресурсы,
разрабатывается [тут](https://github.yandex-team.ru/desktop/tv-app).

## Разработка
- Сборка проекта
```
npm run build
```
Соберутся одновременно минифицированная и неминифицированная версии скриптов,
а также тестовое WebView для проверки работоспособности API.

- Сборка проекта для отладки (добавляется watch-режим)
```
npm run dev
```

- Запуск http-сервера для отладки скриптов на телевизоре
```
npm run serve
```

- Запуск тестов
```
npm run test
```

## Тестирование
Для тестирования нужно использовать [TV App Launcher](http://myt3-f52ba0bc9d3f.qloud-c.yandex.net/),
подставляя туда кастомные урлы для `main.js` и верстки. Пример:
 ```json
 {
  "js": "https://tv-app-test.s3.yandex.net/pr/tvremote-350/main.js",
  "css": "",
  "content": "https://yandex.ru/video/tvapp/?test-id=83746",
  "showLog": true
 }
```

* main.js пока автоматически не собирается (см [TVREMOTE-395](https://st.yandex-team.ru/TVREMOTE-395)).
Поэтому пока можно выложить вручную на тестовый s3 по пути такого формата: `https://tv-app-test.s3.yandex.net/pr/tvremote-350/main.js`.

* Верстка собирается автоматически после создания пул-реквеста в fiji. Сформировать урл можно двумя способами:
   * По параметру `test-id`, который можно найти внутри пул-реквеста. Пример: `https://yandex.ru/video/tvapp/?test-id=83746`.
   * По параметру `srcrwr`, который можно найти кликнув по ссылке "конфигурация test-id" внутри пул-реквеста.
   Пример: `https://yandex.ru/video/tvapp/?srcrwr=TEMPLATES:fiji-pull-7724.si.yandex-team.ru:80:5000`.

Test-id со временем протухает, srcrwr тоже (но живет дольше). Если обе ссылки протухли можно пересоздать пулреквест.

## Релиз
См. [RELEASE.md](/contribs/tv-app/RELEASE.md).