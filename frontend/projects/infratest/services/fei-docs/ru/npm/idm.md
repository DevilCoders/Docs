# Управление правами на npm-пакеты череp IDM

Наш внутренний npm интегрирован с IDM, это позволяет управлять правами на пакеты из
привычного интерфейса IDM. Так же, через IDM можно выдавать права на скоупы.

Важные моменты:

- Овнеров можно добавлять как через `npm owner`, так и через IDM;
- Конфликты всегда разрешаются в пользу npm.

## Права на пакеты

Чтобы запросить права на пакет через IDM, нужно:

1. Пойти вот [сюда](https://idm.yandex-team.ru/system/npm/roles#rf=1,rf-role=Z5S0DaHh#npm/packages(fields:),f-status=all,f-role=npm,sort-by=-updated,rf-expanded=Z5S0DaHh);
2. В первом поле из выпадающего списка выбрать скоуп пакета
(если пакет не в скоупе, то выбрать `-`);
3. Выбрать пакет;
4. Во втором поле выбрать пользователя или группу;
5. Нажать жёлтую на кнопку "Запросить";

![Пример запроса прав на пакет](https://jing.yandex-team.ru/files/frimuchkov/Screenshot%20from%202020-11-27%2014-48-39.png)

Несмотря на то, что управлениями овнерами доступно и через %%npm owner%%,
рекомендуется использовать IDM.
Так же, ещё раз напомнить, что хорошей практикой является добавлять в овнеров пакета
не конкретных пользователей, а группы.

## Права на скоупы

Есть 2 типа прав на скоуп:

1. Владелец. Не может публиковать пакеты, но может выдавать права.
2. Разработчик. Не может выдавать права, но может публиковать пакеты.

Да, владелец не может публиковать пакеты, это сделано осознанно, чтобы разделить роли.

Чтобы не искать владельцев скоупов в ручном режиме мы призываем руководителей самим
запросить права на желаемые скоупу через IDM. Сделать это можно следующим образом:
1. Открыть [форму запроса роли на скоуп в IDM](https://idm.yandex-team.ru/system/npm/roles#rf=1,rf-role=G27h46Qn#npm/scopes(),f-status=all,f-role=npm,sort-by=-updated,rf-expanded=G27h46Qn);
2. Выбрать скоуп;
3. Выбрать право "Владелец";
5. Нажать жёлтую на кнопку "Запросить";

![Пример запроса прав на скоуп](https://jing.yandex-team.ru/files/frimuchkov/Screenshot%20from%202020-11-27%2014-49-04.png)

Для больших скоупов рекомендуется выдать права "Разработчик" роботам,
которые осуществляют публикации.
Для небольших скоупов можно выдать права группам разработчиков,
которые работают над пакетами в скоупе.

Так же, важно помнить, что доступ к скоупу не ограничивает
публикацию новых пакетов в скоупы, он расширяет доступ к каждому существующему пакету из скоупа.
