# Карантин

Внутренний npm синхронизируется с внешним "на лету" – метаданные пакетов и тарболы выкачиваются по мере необходимости. Но из соображений безопасности новые версии пакетов из внешнего npm становятся доступны только после периода "карантина". Сейчас это 7 дней с момента публикации версии. Если за это время в пакете обнаружится уязвимость или зловредный код, то пакет попадет в бан до того, как кто-либо мог его использовать.

Как это работает:

1. При каждой синхронизации метаданных пакета мы удаляем информацию о версиях, которые должны попасть в карантин.
2. При чтении метаданных из внутреннего npm происходит проверка – если есть версии, для которых период карантина завершился, то мы принудительно синхронизируем метаданные для пакета. Что возвращает нас в п.1, но в данном случае исходные версии удалены не будут (но могут быть удалены более новые).

## FAQ

### Что делать, если у меня есть пакет на внешнем npm и я хочу его использовать без карантина?

Пакеты, хостящиеся на внешнем npm, но разрабатываемые сотрудниками Яндекса, могут быть добавлены в исключения – напишите нам через [форму поддержки](https://wiki.yandex-team.ru/npm/support) имя вашего пакета или скоупа. Но следует учитывать, что это исключение накладывает ограничение на обновление зависимостей пакета, так как они по прежнему будут проходить карантин.

### Как проверить, какие версии находятся в карантине?

При попадании версии пакета в карантин в метаданные пакета добавляется специальное поле `quarantine`:

```bash
npm show --registry=https://npm.yandex-team.ru your-package quarantine
```

Поле содержит дату начала карантина и затронутые версии:

```json
{
  "quarantineStartedAt": "2022-05-12T08:01:54.327Z",
  "quarantinedVersions": ["0.0.4"]
}
```
