# Беты шаблонов на report-renderer

В контексте документации беток достаточно знать, что report-renderer - это apphost-совместимый сервис, позволяющий по [специально подготовленным шаблонам](https://wiki.yandex-team.ru/search-interfaces/infra/report-renderer/templates-api/) для каждого запроса генерировать некоторый ответ, чаще всего - html.

Беты report-renderer - сервис для подмены стабильной версии шаблонов для report-renderer на их бета-версию в преимущественно тестовых окружениях, таких как [hamster](https://wiki.yandex-team.ru/jandekspoisk/sepe/hamster/). Сервис поднимает бекенды report-renderer с некоторой указанной бета-версией шаблонов, а также заводит в [stoker](https://wiki.yandex-team.ru/jandekspoisk/sepe/stoker/) вируальный домен, предназначенный для этой беты, при обращении по которому производится прозрачная подмена бекендов report-renderer со стабильной версией шаблонов на бекенды с бета-версией.

Например, [renderer-web4-dev.hamster.yandex.ru](https://stoker.z.yandex-team.ru/TAGGED/renderer-web4-dev/json) - запись для беты с последними шаблонами из dev-ветки web4. Если сходить по [такому урлу](https://renderer-web4-dev.hamster.yandex.ru/search/?lr=2&text=test) и достать reqid из заголовков ответа на исходный запрос, то в [setrace](https://setrace.yandex-team.ru/web/search) можно будет увидеть, что бекенды для вершин с renderer подменились на соответствующие указанные в [стокерной записи](https://stoker.z.yandex-team.ru/TAGGED/renderer-web4-dev/rewrite) (спрятано за карандашиком), а остальные источники остались те же, как и при [сходном запросе на hamster.yandex.ru](https://hamster.yandex.ru/search/?lr=2&text=test)).

renderer-беты основаны на [yappy](https://wiki.yandex-team.ru/yappy/), поэтому полезно будет предварительно ознакомиться с [терминологией yappy](https://wiki.yandex-team.ru/JandeksPoisk/Sepe/yappy/terms/), который занимается подъемом бекендов с изменениями для беты, и, дополнительно, [документацией stoker](https://wiki.yandex-team.ru/jandekspoisk/sepe/stoker/), записями о бетах в котором управляет yappy.

## Как используются

Обычно беты поднимают для проверки изменений разработчиком, прогона e2e-тестов на них, в пулл-реквестах или в master/dev, а также могут использоваться для тестирования на асессорах.

## Гарантии

Сервису renderer-бет присвоен [тир надежности C](https://wiki.yandex-team.ru/9999/tiry-nadezhnosti/), что подразумевает удовлетворение таким требованиям, как, например, умение незаметно для потребителей переживать потерю одного из ДЦ, и в целом высокие показатели стабильности и поддержки сервиса.

При этом по умолчанию на каждую бету поднимается по 2 [реплики](./quotas.md#replikatsiia-bet), и в таком сетапе какие-либо скачки, съём серпов и так далее, беты переживают только если эти процессы ограничиваются по RPS. В конфигурациях по умолчанию рекомендуется не давать нагрузку выше 4–8 RPS.

Если бета не обновлялась, то её время жизни (TTL) по умолчанию — 7 дней.

## Как начать поднимать беты renderer

Описано на [соседней страничке](./start.md).
