# release-revert-issue-or-pr

Пакет для отрывания коммитов из релизной ветки по указанным пулл-реквестам или тикетам.

## Входные параметры

* **commitIdentifiers** — список номеров пулл-реквестов или ключей тикетов.
* **owner** — owner репозитория на GitHub.
* **repo** — название репозитория на GitHub.
* **branch** — релизная ветка в которой нужно оторвать коммиты.
* **updateIssue** — обновлять ли описание релизного тикета и статусы оторванных тикетов. По умолчанию выключено.
* **nextStatus** — статус в который надо перевести тикеты, к которым привязаны коммиты.

## Поиск комитов по пулл-реквестам

По указанным номерам пулл-реквестов ищутся их merge-commit'ы в релизной ветке.
После чего найденные merge-commit'ы отрываются.
Если включено обновление тикетов, то список тикетов извлекается из тела merge-commit'a, которое содержит заголовок пулл-реквеста, который в свою очередь содержит в самом начале номер тикета. Если у пулл-реквеста в заголовке несколько тикетов указано через запятую, то обновлены будут они все.

## Поиск комитов по тикетам

По указанным ключам тикетов ищутся коммиты в релизной ветке у которых в теле в самом начале первым указан искомый ключ тикета.
После чего найденные коммиты отрываются.
Если включено обновление тикетов, то обновляются тикеты, по которым искали коммиты.

## Обновление тикетов

Данная опция выключена по умолчанию.
Если опция включена происходит следующее:

1. В релизном тикете в описание из списка удаляются оторванные тикеты.
1. Всем оторванным тикетам, а также их саб-тикетам, меняется статус на указанный в **nextStatus**.

## Дополнительно

* Если включено обновление тикетов и будет найдено больше одного релизного тикета, то будет брошено исключение.
* Релизный тикет ищется по названию репозитория и номеру версии в очереди SEAREL.

## CLI

```bash
Отрывание пулл-реквестов или задач в релизной ветке

Options:
  --help, -h            Show help                                      [boolean]
  --version, -v         Show version number                            [boolean]
  --owner               владелец репозитория на GitHub                [required]
  --repo                название репозитория                          [required]
  --branch              откуда отрывать коммиты по задаче             [required]
  --commit-identifiers  номера нужных задач или пулл-реквестов, разделённые
                        запятыми                             [string] [required]
  --next-status         статус в который необходимо перевести тикет
  --update-issue        обновить описание релизной задачи и перевести все тикеты
                        в указанный статус            [boolean] [default: false]

```
