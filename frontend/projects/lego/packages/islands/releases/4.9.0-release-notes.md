# islands 4.9.0

<!-- ЧЕЛОВЕЧЕСКОЕ ВСТУПЛЕНИЕ -->

Изменения, вошедшие в релиз islands 4.9.0, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков;
* [дополнительно](#Дополнительно) — задачи, не касающиеся кода блоков (документация, инфраструктура и т.д.).

Все важные изменения подробно описаны [ниже](#Пояснения).

## Минорные изменения

| Заголовок                                                 | Задача     | PR      |
| :-------------------------------------------------------- | :--------- | :------ |
| [footer: Отказаться от использования i-global](#ISL-2518) | [ISL-2518] | [#1144] |
| [search2: Доработать поисковую стрелку](#ISL-2554)        | [ISL-2554] | [#1140] |

## Исправлено и улучшено

| Заголовок                                                                           | Задача     | PR               |
| :---------------------------------------------------------------------------------- | :--------- | :--------------- |
| [country-flag: Исправить флаги Сербии и Сербии и Черногории](#ISL-2494)             | [ISL-2494] | [#1120]          |
| select: При прокрутке на мобильных устройствах раскрываются опции                   | [ISL-2386] | [#1085]          |
| [user_menu_multiauth: Убрать ограничение количества аккаунтов с клиента](#ISL-2331) | [ISL-2331] | [#1150]          |
| [Изменить стили для кнопок с темой clear](#ISL-2541)                                | [ISL-2541] | [#1124]          |
| [Привести шаблоны в совместимый с bem-xjst@1-6 вид](#ISL-2527)                      | [ISL-2527] | [#1129], [#1147] |

## Дополнительно

| Заголовок                                                   | Задача     | PR      |
| :---------------------------------------------------------- | :--------- | :------ |
| tabs-menu: Реализовать theme_search-head для уровня desktop | [ISL-2548] | [#1131] |
| [Добавить модификатор size_head для кнопок](#ISL-2550)      | [ISL-2550] | [#1133] |

## Пояснения


<a name="ISL-2494"></a>
### [country-flag: Исправить флаги Сербии и Сербии и Черногории][ISL-2494]

Исправлены изображения флагов государств «Республика Сербия» (код `rs`)
и «Государственный Союз Сербии и Черногории» (бывший код `cs`).

<a name="ISL-2518"></a>
### [footer: Отказаться от использования i-global][ISL-2518]

Содержимое блока `footer` по умолчанию различается для доменов КУБР и Турции.

Ранее домен определялся параметром `tld` блока `i-global`.

Теперь зависимость от `i-global` считается устаревший и `tld` необходимо передавать через поле блока `footer`.

Было:

```js
[{
    block: 'i-global',
    params: {
        tld: 'com.tr'
    }
},
{
    block: 'footer'
}]
```

Стало:

```js
{
    block: 'footer',
    tld: 'com.tr' // ru, ua, by, kz, com
}
```

<a name="ISL-2554"></a>
### [search2: Доработать поисковую стрелку][ISL-2554]

Блок `search2` — это раскладка для поисковой формы. У самого блока почти нет стилей, внешний вид определяется стилями поля ввода и кнопки.
Чтобы реализовать желтую поисковую стрелку, поместите внутрь блока поле ввода и кнопку с модификаторами `theme_websearch`.
Изменения в этой задаче относятся к стилям поисковой стрелки и почти не затрагивают другие поисковые формы.

### search2_theme_websearch

Раньше в стилях блока `search2` содержалась максимальная ширина поисковой стрелки — `638px`.
Теперь ширина блока (а в будущем, возможно, и другие стили относящиеся к стрелке) переехала в `theme_websearch`.
Ширина стрелки теперь определяется шириной поля поиска — она должна совпадать с шириной поисковой выдачи (`550px`).

Сейчас этот модификатор добавляется в шаблонах автоматически, если в поле `input` или `button` передается блок
с модификатором `theme_websearch`. В islands 5.0 больше не будет добавляться автоматически, установите его вручную.

### button_theme_websearch

Высота кнопки, и размер шрифта и отступы теперь определяются модификатором `size_ws-head`, модификатор `size_m`
использовать не нужно. Для `button_theme_websearch` добавлены шаблоны, автоматически заменяющие `size_m` на `size_ws-head`.
В islands 5.0 этих шаблонов не будет, поменяйте модификатор вручную.

Также у кнопки изменился цвет состояния `pressed_yes` и появился для состояния `hovered_yes`.

### input_theme_websearch

Для поля ввода, по аналогии с кнопкой, размеры и отступы теперь определяются модификатором `size_ws-head`.
Для `input_theme_websearch` добавлены шаблоны, автоматически заменяющие `size_m` на `size_ws-head`.
В islands 5.0 этих шаблонов не будет, поменяйте модификатор вручную.

Элемент `hint` объявлен устаревшим. Он не используется в поисковой стрелке и в islands 5.0 будет удален.

Изменилось изображение крестика очистки поля.

### button2_theme_websearch

Теперь в качестве желтой кнопки поиска можно использовать `button2`:
```javascript
{
    block: 'search2',
    // ...
    button: {
        block: 'button2',
        mods: {
            type: 'submit',
            size: 'ws-head',
            theme: 'websearch'
        },
        attrs: {tabindex: -1},
        text: 'Найти'
    }
}
```

### search2_template_websearch

В этом модификаторе содержатся шаблоны, позволяющие быстро собрать «пример» поисковой стрелки с содержимым по умолчанию.
Модификатор теперь добавляет модификатор `search2_theme_websearch` и устанавливает модификатор `size_ws-head` вместо
`size_m` для блоков `input` и `button`. В islands 5.0 блок `button` будет заменен на `button2`.

<a name="ISL-2331"></a>
### [user_menu_multiauth: Убрать ограничение количества аккаунтов с клиента][ISL-2331]

Ранее, в меню пользователя с мультиавторизацией (`user_menu_multiauth`) была возможность на клиенте ограничить
количество отображаемых аккаунтов в меню. Ограничение по умолчанию равнялось 5 аккаунтам. Существовала возможность
изменить количество через JS-параметр `maxAccounts`.

По согласованию с Я.Паспортом было решено, что клиент не должен ограничивать количество аккаунтов в меню.
Логика про ограничение и JS-параметр `maxAccounts` были удалены.

<a name="ISL-2550"></a>
### [Добавить модификатор size_head для кнопок][ISL-2550]

Для блоков `button2`, `button`, `check-button` и `radio-button` добавлен специальный размер для использования в шапке:
`size_head`. Он отличается нестандартной высотой (`36px`) и размером шрифта (`13px`). Модификатор пока реализован
только для уровня `desktop`, и считается нестабильным. Модификатор будет дорабатываться после проведения экспериментов
на поисковых сервисах.

<a name="ISL-2541"></a>
### [Изменить стили для кнопок с темой clear][ISL-2541]

Немного изменились стили кнопок с модификатором `_theme_clear`: `button`, `button2`, `check-button`.
- Исчезли стили для состояния `_pressed_yes` (серый фон по нажатию).
- Время анимации `opacity` по наведению курсора теперь `0.2s` вместо `0.1s`.
- Желтая рамка фокуса теперь появляется без анимации.

Изменения согласованы с портальными дизайнерами, стили для clear-кнопок на [`guide.yandex-team.ru`](https://guide.yandex-team.ru/wiki/libs/controls/button/#type)
должны в скором времени обновиться.

<a name="ISL-2527"></a>
### [Привести шаблоны в совместимый с bem-xjst@1-6 вид][ISL-2527]

Добавлена поддержка bem-xjst версий 5.x и 6.x.



[ISL-2494]: https://st.yandex-team.ru/ISL-2494
[#1120]: https://github.yandex-team.ru/lego/islands/pull/1120
[ISL-2518]: https://st.yandex-team.ru/ISL-2518
[#1144]: https://github.yandex-team.ru/lego/islands/pull/1144
[ISL-2554]: https://st.yandex-team.ru/ISL-2554
[#1140]: https://github.yandex-team.ru/lego/islands/pull/1140
[ISL-2386]: https://st.yandex-team.ru/ISL-2386
[#1085]: https://github.yandex-team.ru/lego/islands/pull/1085
[ISL-2548]: https://st.yandex-team.ru/ISL-2548
[#1131]: https://github.yandex-team.ru/lego/islands/pull/1131
[ISL-2331]: https://st.yandex-team.ru/ISL-2331
[#1150]: https://github.yandex-team.ru/lego/islands/pull/1150
[ISL-2550]: https://st.yandex-team.ru/ISL-2550
[#1133]: https://github.yandex-team.ru/lego/islands/pull/1133
[ISL-2541]: https://st.yandex-team.ru/ISL-2541
[#1124]: https://github.yandex-team.ru/lego/islands/pull/1124
[ISL-2527]: https://st.yandex-team.ru/ISL-2527
[#1129]: https://github.yandex-team.ru/lego/islands/pull/1129
[#1147]: https://github.yandex-team.ru/lego/islands/pull/1147
