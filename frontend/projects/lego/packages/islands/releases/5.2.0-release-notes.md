# islands 5.2.0

Изменения, вошедшие в релиз islands 5.2.0, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков.

Все важные изменения подробно описаны [ниже](#Пояснения).

## Минорные изменения

| Заголовок                                                                                | Задача     | PR      |
| :--------------------------------------------------------------------------------------- | :--------- | :------ |
| [button2: Сделать вариант с круглыми краями](#ISL-3099)                                  | [ISL-3099] | [#1845] |
| [button2__control: Разработать элемент](#ISL-3084)                                       | [ISL-3084] | [#1853] |
| [i-bem: Портировать возможность передачи аргумента в unbindFrom* из bem-core](#ISL-2938) | [ISL-2938] | [#1983] |
| [i-bem__dom: Портировать возможность использования простых модификаторов](#ISL-3304)     | [ISL-3304] | [#2024] |
| [Перенести bem-history в islands](#ISL-3001)                                             | [ISL-3001] | [#1946] |

## Исправлено и улучшено

| Заголовок                                           | Задача     | PR      |
| :-------------------------------------------------- | :--------- | :------ |
| [b-page: Удалить Helvetica Neue](#ISL-3200)         | [ISL-3200] | [#2000] |
| m-phone-button: Добавить переводы                   | [ISL-3341] | [#2027] |
| m-phone-button_touch_yes: BH-шаблон не работает     | [ISL-3339] | [#2022] |
| suggest2: Сделать пример нового пословного саджеста | [ISL-3292] | [#1986] |

## Пояснения

<a name="ISL-3200"></a>
### [b-page: Удалить Helvetica Neue][ISL-3200]

В блоке `b-page` было удалено выставление по умолчанию шрифта `Helvetica Neue` для страницы.
Шрифт увеличивает интерлиньяж на `1px` при использовании полужирного начертания.

Если вас по каким-то причинам не устраивает новое поведение, то скопируйте на свой проектный уровень правила:

```css
/* common.blocks/b-page/b-page.css */
font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;

/* touch.blocks/b-page/b-page.css */
font: 12px 'Helvetica Neue', Helvetica, Arial, sans-serif;
```

<a name="ISL-3099"></a>
### [button2: Сделать вариант с круглыми краями][ISL-3099]

В блоке `button2` для модификатора `pin` добавлены значения вида `circle-*` и `*-circle`, позволяющие создавать различные виды кнопок с круглыми краями.

![](https://jing.yandex-team.ru/files/koreil/Gemini_2016-10-11_12-30-22.png)

```javascript
{
    block: 'button2',
    mods: {theme: 'normal', size: 'l', pin: 'circle-circle'},
    icon: {mods: {type: 'location'}}
}
```

<a name="ISL-3084"></a>
### [button2__control: Разработать элемент][ISL-3084]

Блоку `button2` добавлен модификатор `has-control`. При наличии этого модификатора кнопке на уровне шаблонизатора добавляется вспомогательный скрытый элемент `control`. Это нативный `<input>` с соответствующим типом (по умолчанию `radio` для кнопок с типом `radio`, в остальных случаях - по умолчанию `checkbox`), который позволяет хранить состояния  «включено/выключено».

Атрибуты элемента `control` можно выставить явно.

```js
{
        block: 'button2',
        id: 'the-button',
        title: 'the-title',
        name: 'the-name',
        val: 'the-val',
        mods: {type: 'check', 'has-control': 'yes'},
        text: 'params + _type_check',
        control: {attrs: {name: 'custom-control-name', value: 'some-value'}}
}
```

<a name="ISL-2938"></a>
### [i-bem: Портировать возможность передачи аргумента в unbindFrom* из bem-core][ISL-2938]

В `i-bem` методах для отписки от `DOM`-событий появился необязательный параметр — `fn`:

* unbindFromDomElem(elem, 'eventName', fn)
* unbindFromDoc('eventName', fn)
* unbindFromWin('eventName', fn)
* unbindFrom(elem, 'eventName', fn)

Если параметру `fn` в качестве значения передать функцию обратного вызова,
то отписка произойдет только для этой функции.

<a name="ISL-3304"></a>
### [i-bem__dom: Портировать возможность использования простых модификаторов][ISL-3304]

В `i-bem` добавлена возможность использования простых модификаторов. Теперь `block.setMod('mod', true)` добавит класс `.block_mod`. В методах `.setMod('modName', 'modVal') и .elem('elem', 'modName', 'modVal')` аргумент `modVal` теперь по умолчанию `true`.

<a name="ISL-3001"></a>
### [Перенести bem-history в islands][ISL-3001]

Портирована библиотека [`bem-history` 2-ой версии (тег v1)](https://github.com/bem/bem-history/tree/v1)

**NB** Учитывайте, что `location#change` работает асинхронно,
чтобы гарантированно продолжить выполнение после изменения адреса подписывайтесь на БЭМ-событие `history#statechange`.

[ISL-3200]: https://st.yandex-team.ru/ISL-3200
[#2000]: https://github.yandex-team.ru/lego/islands/pull/2000
[ISL-3099]: https://st.yandex-team.ru/ISL-3099
[#1845]: https://github.yandex-team.ru/lego/islands/pull/1845
[ISL-3084]: https://st.yandex-team.ru/ISL-3084
[#1853]: https://github.yandex-team.ru/lego/islands/pull/1853
[ISL-2938]: https://st.yandex-team.ru/ISL-2938
[#1983]: https://github.yandex-team.ru/lego/islands/pull/1983
[ISL-3304]: https://st.yandex-team.ru/ISL-3304
[#2024]: https://github.yandex-team.ru/lego/islands/pull/2024
[ISL-3341]: https://st.yandex-team.ru/ISL-3341
[#2027]: https://github.yandex-team.ru/lego/islands/pull/2027
[ISL-3339]: https://st.yandex-team.ru/ISL-3339
[#2022]: https://github.yandex-team.ru/lego/islands/pull/2022
[ISL-3292]: https://st.yandex-team.ru/ISL-3292
[#1986]: https://github.yandex-team.ru/lego/islands/pull/1986
[ISL-3001]: https://st.yandex-team.ru/ISL-3001
[#1946]: https://github.yandex-team.ru/lego/islands/pull/1946
