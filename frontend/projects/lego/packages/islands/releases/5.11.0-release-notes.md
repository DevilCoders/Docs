# islands 5.11.0

Изменения, вошедшие в релиз islands 5.11.0, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков;

Все важные изменения подробно описаны [ниже](#Пояснения).

## Минорные изменения

| Заголовок                                                          | Задача     | PR                        |
| :----------------------------------------------------------------- | :--------- | :------------------------ |
| [b-page__css: Добавить возможность задавать контент](#ISL-3988)    | [ISL-3988] | [#2457]                   |
| [button2: Реализовать модификатор _progress_yes](#ISL-4026)        | [ISL-4026] | [#2569]                   |
| [i-font: Добавить шрифт YS](#ISL-4173)                             | [ISL-4173] | [#2599]                   |
| [m-suggest: Добавить обработку типов b2b (_type_b2b-*)](#ISL-4122) | [ISL-4122] | [#2553], [#2575], [#2579] |
| [popup2.react: Добавить возможность выбрать scope](#ISL-4011)      | [ISL-4011] | [#2562]                   |

## Исправлено и улучшено

| Заголовок                                                                        | Задача     | PR      |
| :------------------------------------------------------------------------------- | :--------- | :------ |
| button2.react: Каждый элемент содержимого оборачивается в элемент text           | [ISL-4012] | [#2557] |
| lang-switcher: Перевести на использование dropdown2 и menu                       | [ISL-4140] | [#2586] |
| lego-on-react: Перейти на prop-types                                             | [ISL-4160] | [#2580] |
| m-speller: Пробрасывать value в check-button                                     | [ISL-4161] | [#2584] |
| modal.react: По нажатию на клавишу Esc модалы/попапы закрываются некорректно     | [ISL-4034] | [#2549] |
| popup2.react: Попап autoclosable считает клик не по anchor и не по себе внешним… | [ISL-4212] | [#2605] |
| popup2: react: обращение к DOM ломает серверный рендеринг                        | [ISL-4218] | [#2609] |
| react textarea, textinput: controlAttrs добавляются и обёртке и контролу         | [ISL-4090] | [#2568] |
| react: Перестать использовать React.DOM.noscript                                 | [ISL-4151] | [#2581] |
| user2.react: Unknown DOM property accesskey                                      | [ISL-4220] | [#2611] |
| [user2.react: добавить опцию avatarHost](#ISL-4222)                              | [ISL-4222] | [#2612] |
| user2: Некорректно формируется URL на Паспорт                                    | [ISL-4195] | [#2628] |
| [Отказаться от массивов в elem c mods в депсах](#ISL-4184)                       | [ISL-4184] | [#2593] |

## Пояснения

<a name="ISL-3988"></a>
### [b-page__css: Добавить возможность задавать контент][ISL-3988]

Добавлена возможность передачи в `b-page__css` в поле `content` инлайновых стилей.

<a name="ISL-4026"></a>
### [button2: Реализовать модификатор _progress_yes][ISL-4026]

Добавлен модификатор `progress` для старого дизайна в стиле нового.

<a name="ISL-4173"></a>
### [i-font: Добавить шрифт YS][ISL-4173]

Добавили новый шрифт: YS

Шрифт доступен через подключение модификаторов блока `i-font`:

  * `i-font_face_ys-display-thin`
  * `i-font_face_ys-display-light`
  * `i-font_face_ys-display-regular`
  * `i-font_face_ys-display-medium`
  * `i-font_face_ys-display-bold`
  * `i-font_face_ys-display-heavy`
  * `i-font_face_ys-text-light`
  * `i-font_face_ys-text-light-italic`
  * `i-font_face_ys-text-regular`
  * `i-font_face_ys-text-regular-italic`
  * `i-font_face_ys-text-medium`
  * `i-font_face_ys-text-medium-italic`
  * `i-font_face_ys-text-bold`
  * `i-font_face_ys-text-bold-italic`

<a name="ISL-4122"></a>
### [m-suggest: Добавить обработку типов b2b (_type_b2b-*)][ISL-4122]

Добавлен `m-suggest_type_b2b` для сервисов Коннекта с новым дизайном.

Может искать по сущностям people, departments, groups.
<a href="https://wiki.yandex-team.ru/IntranetPoisk/Suggest/api/" target="_blank" title="Описание API">

<a name="ISL-4011"></a>
### [popup2.react: Добавить возможность выбрать scope][ISL-4011]

Для `react`-реализации `popup2` была добавлена возможность выбора места вынесения окошка. По умолчанию окошко выносится в конец `<body>`.
В качестве `scope` ожидается `DOM`-элемент с `position: relative`.

```js
    <Popup
        scope={this.state.scope}
        theme='normal'
        hasTail
        visible={this.state.visible}
        anchor={this._b13}>
        popup with scope
    </Popup>
```

Окошко выносится в момент показа. Если окошко уже было вынесено в конец `<body>` или в конец другого элемента, его нужно скрыть и показать заново.

<a name="ISL-4222"></a>
### [user2.react: добавить опцию avatarHost][ISL-4222]

user2.react: добавлена опция `avatarHost`

Теперь можно переопределить хост аватарницы по умолчанию.
Пример для тестового стенда:
```
<User2 avatarHost="https://avatars.mdst.yandex.net" />
```

<a name="ISL-4184"></a>
### [Отказаться от массивов в elem c mods в депсах][ISL-4184]

Варианты написания `{elem: ['elem-name'], mod: 'mod-name'}`
и `{elem: ['elem-name'], mods: {'mod-name': 'val'}}`
некорректно обрабатывается технологией `deps` в `enb-bem-techs`.
Все вхождения в `deps.js`-файлах исправлены на `{elem: 'elem-name', mod: 'mod-name'}` и
`{elem: 'elem-name', mods: {'mod-name': 'val'}}` соответственно.

[ISL-3988]: https://st.yandex-team.ru/ISL-3988
[#2457]: https://github.yandex-team.ru/lego/islands/pull/2457
[ISL-4012]: https://st.yandex-team.ru/ISL-4012
[#2557]: https://github.yandex-team.ru/lego/islands/pull/2557
[ISL-4026]: https://st.yandex-team.ru/ISL-4026
[#2569]: https://github.yandex-team.ru/lego/islands/pull/2569
[ISL-3942]: https://st.yandex-team.ru/ISL-3942
[#2630]: https://github.yandex-team.ru/lego/islands/pull/2630
[ISL-4173]: https://st.yandex-team.ru/ISL-4173
[#2599]: https://github.yandex-team.ru/lego/islands/pull/2599
[ISL-4140]: https://st.yandex-team.ru/ISL-4140
[#2586]: https://github.yandex-team.ru/lego/islands/pull/2586
[ISL-4160]: https://st.yandex-team.ru/ISL-4160
[#2580]: https://github.yandex-team.ru/lego/islands/pull/2580
[ISL-4161]: https://st.yandex-team.ru/ISL-4161
[#2584]: https://github.yandex-team.ru/lego/islands/pull/2584
[ISL-4122]: https://st.yandex-team.ru/ISL-4122
[#2553]: https://github.yandex-team.ru/lego/islands/pull/2553
[#2575]: https://github.yandex-team.ru/lego/islands/pull/2575
[#2579]: https://github.yandex-team.ru/lego/islands/pull/2579
[ISL-4034]: https://st.yandex-team.ru/ISL-4034
[#2549]: https://github.yandex-team.ru/lego/islands/pull/2549
[ISL-4011]: https://st.yandex-team.ru/ISL-4011
[#2562]: https://github.yandex-team.ru/lego/islands/pull/2562
[ISL-4212]: https://st.yandex-team.ru/ISL-4212
[#2605]: https://github.yandex-team.ru/lego/islands/pull/2605
[ISL-4218]: https://st.yandex-team.ru/ISL-4218
[#2609]: https://github.yandex-team.ru/lego/islands/pull/2609
[ISL-4090]: https://st.yandex-team.ru/ISL-4090
[#2568]: https://github.yandex-team.ru/lego/islands/pull/2568
[ISL-4151]: https://st.yandex-team.ru/ISL-4151
[#2581]: https://github.yandex-team.ru/lego/islands/pull/2581
[ISL-4220]: https://st.yandex-team.ru/ISL-4220
[#2611]: https://github.yandex-team.ru/lego/islands/pull/2611
[ISL-4222]: https://st.yandex-team.ru/ISL-4222
[#2612]: https://github.yandex-team.ru/lego/islands/pull/2612
[ISL-4195]: https://st.yandex-team.ru/ISL-4195
[#2628]: https://github.yandex-team.ru/lego/islands/pull/2628
[ISL-4184]: https://st.yandex-team.ru/ISL-4184
[#2593]: https://github.yandex-team.ru/lego/islands/pull/2593
