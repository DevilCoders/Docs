# islands 4.14.1

<!-- ЧЕЛОВЕЧЕСКОЕ ВСТУПЛЕНИЕ -->

Изменения, вошедшие в релиз islands 4.14.1, разделены на группы:

* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков;
* [дополнительно](#Дополнительно) — задачи, не касающиеся кода блоков (документация, инфраструктура и т.д.).

Все важные изменения подробно описаны [ниже](#Пояснения).

## Исправлено и улучшено

| Заголовок                                                                 | Задача     | PR      |
| :------------------------------------------------------------------------ | :--------- | :------ |
| [b-slider: При тапе в слайдер отключается вертикальный скролл](#ISL-2687) | [ISL-2687] | [#1531] |
| i-bem: Method getMods always returns empty hash                           | [ISL-2432] | [#1534] |
| i-font: Добавить woff2 варианты шрифтов                                   | [ISL-1295] | [#1558] |
| suggest-item: XSS через поле content при шаблонизации через BEMHTML       | [ISL-2808] | [#1557] |

## Дополнительно

| Заголовок                                        | Задача     | PR      |
| :----------------------------------------------- | :--------- | :------ |
| [i-ua: svg расставить всё по полочкам](#ISL-2586) | [ISL-2586] | [#1528] |

## Пояснения


<a name="ISL-2687"></a>
### [b-slider: При тапе в слайдер отключается вертикальный скролл][ISL-2687]

В блоке `b-slider` была проблема связанная с тем, что в обработчике `pointermove` вызывался `preventDefault()`,
который предотвращал скролл. Это было сделано для предотвращения прокрутки страницы во время
взаимодействия с `b-slider`. Но это имело и негативный эффект: если пользователь хотел пролистать страницу вниз и
начинал жест с блока `b-slider`, то скроллинг предотвращался и страница не двигалась.

Чтобы это исправить, пришлось отказаться от вызова `preventDefault()`, а для определения назначения жеста мы
воспользовались механикой [css-свойства `touch-action`](https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action).
Это свойство поддерживается далеко не всеми браузерами, поэтому в библиотеке `pointerevents` мы сделали полифилл.
Теперь, чтобы указать в каких направлениях должен производиться нативный скроллинг, а в каких будет
производиться js-обработка событий нужно использовать атрибут `touch-action`, например:

```html
<div class="b-slider" touch-action="pan-y">
    Если пользователь тапнул в этом блоке начал движение пальцем в вертикальном направлении,
    то сработает нативный скролл, а события pointermove вызываться не будут. Если же пользователь
     начнет движение в горизонтальном направлении, то страница пролистываться не будет, но pointermove будут
     вызываться и слайдер будет двигаться.
</div>

<div class="b-slider" touch-action="pan-x">
    А тут наоборот. Вертикально - события pointermove, горизонтально - нативный скролл.
</div>

```

Необходимо указывать именно HTML-атрибут touch-action, т.к. его можно прочитать с помощью JavaScript, в отличии от
css-свойств, в случае, если их не поддерживает браузер.

<a name="ISL-2586"></a>
### [i-ua: svg расставить всё по полочкам][ISL-2586]

В рамках задачи была исправлена и дополнена документация блока `i-ua`. `i-ua_inlinesvg_` использовался ранее для поддержки старых браузеров, поэтому в CSS-стилях `islands` `i-ua_inlinesvg_` был заменён на `i-ua_svg_`.



[ISL-2687]: https://st.yandex-team.ru/ISL-2687
[#1531]: https://github.yandex-team.ru/lego/islands/pull/1531
[ISL-2432]: https://st.yandex-team.ru/ISL-2432
[#1534]: https://github.yandex-team.ru/lego/islands/pull/1534
[ISL-1295]: https://st.yandex-team.ru/ISL-1295
[#1558]: https://github.yandex-team.ru/lego/islands/pull/1558
[ISL-2586]: https://st.yandex-team.ru/ISL-2586
[#1528]: https://github.yandex-team.ru/lego/islands/pull/1528
[ISL-2808]: https://st.yandex-team.ru/ISL-2808
[#1557]: https://github.yandex-team.ru/lego/islands/pull/1557
