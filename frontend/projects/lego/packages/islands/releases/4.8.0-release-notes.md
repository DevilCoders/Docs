# islands 4.8.0

<!-- ЧЕЛОВЕЧЕСКОЕ ВСТУПЛЕНИЕ -->

Изменения, вошедшие в релиз islands 4.8.0, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков.

Все важные изменения подробно описаны [ниже](#Пояснения).

## Минорные изменения

| Заголовок                                                                                | Задача     | PR     |
| :--------------------------------------------------------------------------------------- | :--------- | :----- |
| [popup: Добавить отмену закрытия из пользовательского кода через bem-событие](#ISL-2338) | [ISL-2338] | [#973] |

## Исправлено и улучшено

| Заголовок                                                                        | Задача     | PR      |
| :------------------------------------------------------------------------------- | :--------- | :------ |
| bemhint: Добавить проверки на использование бэм-сущностей в клиентском js и ш... | [ISL-2373] | [#1065] |
| input: Показывать крестик на touch-{phone,pad}                                   | [ISL-2473] | [#1096] |
| input_type_touchsearch: Поправить шрифт в мобильной шапке                        | [ISL-2497] | [#1105] |
| radiobox: Добавить зависимость от элемента radio                                 | [ISL-2472] | [#1095] |

## Пояснения


<a name="ISL-2338"></a>
### [popup: Добавить отмену закрытия из пользовательского кода через bem-событие][ISL-2338]

В блок `popup` добавлено новое событие `before-hide`, вызываемое непосредственно
при вызове метода `hide()`, если блок способен закрыться (т.е. он открыт и не скрывается
в данный момент). Подписка на это событие даёт возможность отменить
закрытие (через `event.preventDefault()`) и оставить блок видимым.

Дополнительно для события `before-hide` можно передать параметры посредством
передачи их методу `hide()`, а также `toggle()`:
```js
popup.hide({source: 'from-far-away'})
popup.toggle(owner, {source: 'from-far-away'})
popup.toggle(null, {source: 'from-far-away'})
```

Событие `before-hide` генерируется блоком с явным указанием `source` в следующих случаях:

* при нажатии ESCAPE (дополнительный параметр события `{source: 'esc-key'}`);
* при клике на крестик (дополнительный параметр события `{source: 'close-click'}`);
* при клике за пределами попапа или на парандже (дополнительный параметры события `{source: 'outside-click'}`).

Ненужными становится событие `outside-click` (в пользу `before-hide` с параметром `{source: 'outside-click'}`).
Поэтому он объявляется **устаревшим** и будет удалён в следующей мажорной версии.



[ISL-2338]: https://st.yandex-team.ru/ISL-2338
[#973]: https://github.yandex-team.ru/lego/islands/pull/973
[ISL-2373]: https://st.yandex-team.ru/ISL-2373
[#1065]: https://github.yandex-team.ru/lego/islands/pull/1065
[ISL-2473]: https://st.yandex-team.ru/ISL-2473
[#1096]: https://github.yandex-team.ru/lego/islands/pull/1096
[ISL-2497]: https://st.yandex-team.ru/ISL-2497
[#1105]: https://github.yandex-team.ru/lego/islands/pull/1105
[ISL-2472]: https://st.yandex-team.ru/ISL-2472
[#1095]: https://github.yandex-team.ru/lego/islands/pull/1095
