# islands 5.5.0

Изменения, вошедшие в релиз islands 5.5.0, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков;
* [дополнительно](#Дополнительно) — задачи, не касающиеся кода блоков (документация, инфраструктура и т.д.).

Все важные изменения подробно описаны [ниже](#Пояснения).


## Минорные изменения

| Заголовок                                                     | Задача     | PR      |
| :------------------------------------------------------------ | :--------- | :------ |
| [attach: Реализовать блок через button2](#ISL-1695)           | [ISL-1695] | [#2141] |

## Исправлено и улучшено

| Заголовок                                                          | Задача     | PR      |
| :----------------------------------------------------------------- | :--------- | :------ |
| i-bem: У &lt;svg/&gt; className не строка, а SVGAnimatedString     | [ISL-3571] | [#2254] |
| [m-footer: Добавить защиту от сломанных входных данных](#ISL-3482) | [ISL-3482] | [#2205] |
| m-head: В FF стрелочка съехала на пару пикселей вниз               | [ISL-3494] | [#2233] |
| m-head: Рефакторинг использования awesome-icon_icon_chevron-down   | [ISL-3573] | [#2234] |
| [paranja: Добавить единицы измерения у transition](#ISL-3526)      | [ISL-3526] | [#2201] |

## Дополнительно

| Заголовок                                                 | Задача     | PR      |
| :-------------------------------------------------------- | :--------- | :------ |
| [b-statcounter: Портировать на React](#ISL-3351)          | [ISL-3351] | [#2240] |
| [header2: Портировать на React](#ISL-2874)                | [ISL-2874] | [#2249] |
| [i-services: портировать на React](#ISL-3455)             | [ISL-3455] | [#2227] |
| [lego-on-react: Заменить tabindex на tabIndex](#ISL-3625) | [ISL-3625] | [#2264] |
| [pointerfocus: Портировать на React](#ISL-3353)           | [ISL-3353] | [#2219] |

## Пояснения

<a name="ISL-1695"></a>
### [attach: Реализовать блок через button2][ISL-1695]

В блоке `attach` произошли следующие изменения:

* Модификаторы `theme` и `size` не будут иметь значений по умолчанию в следующем релизе. Убедитесь, что данные модификаторы переданы явно.

* Переработано API блока:

  **Было:**

  ```js
  {
      block: 'attach',
      mods: { theme: 'normal', size: 'm' },
      content: [
          {
              block: 'button',
              mods: { theme: 'normal', size: 'm' },
              mix: { block: 'attach', elem: 'button' },
              id: 'file',
              content: 'Upload file'
          },
          {
              elem: 'holder',
              content: 'no file'
          }
      ]
  }
  ```

  **Стало:**

  ```js
  {
      block: 'attach',
      mods: { theme: 'normal', size: 'm' },
      id: 'file',
      text: 'Upload file',
      holder: 'no file'
  }
  ```

* Добавлена возможность использовать блок 'button2', вместо 'button'. Для этого необходимо определить модификатор `use`  со значением `'button2'`:

  ```js
  {
      block: 'attach',
      mods: { theme: 'normal', size: 'm', use: 'button2' },
      text: 'Upload file'
  }
  ```

  > **Примечание** Для обратной совместимости блок `button` также будет попадать в сборку даже при использовании модификатора `attach_use_button2`. Поэтому если важно, чтобы в сборку попадала только нужная реализация `button2`, необходимо отменить зависимости от блока `button` на текущем уровне переопределения:
  >
  > *Файл `attach.deps.js`*
  >
  > ```js
  >({
  >    block: 'attach',
  >    noDeps: [
  >        { block: 'button' },
  >        { block: 'button', elem: 'text' },
  >        { block: 'button', mods: { theme: 'normal', size: ['s', 'm'], disabled: 'yes'} }
  >    ]
  > })
  > ```
  >
  > В следующей мажорной версии библиотеки новое API блока `attach` станет обязательным. Блок `button2` будет использоваться по умолчанию без модификатора `attach_use_button2`.

<a name="ISL-3351"></a>
### [b-statcounter: Портировать на React][ISL-3351]

b-statcounter: Портирован на React

Блок содержит в себе API для реализации счетчиков gemius, metrika и tns. А так же их вариация – реализация с помощью клиентского js.

Пример:
``` js
   <BStatcounter
        metrika={{counter: '123456'}}
        tns={{id: 'yandex_lego', type: 'js'}} />
```

В данном случае счетчик `metrika` будет представлен посредством тега `<img>`, а счетчик tns будет реализован при помощи клиентского js,

<a name="ISL-2874"></a>
### [header2: Портировать на React][ISL-2874]

Блок `header2` портирован на React.

<a name="ISL-3455"></a>
### [i-services: портировать на React][ISL-3455]

На React портирован блок `i-services`.

Блок предоставляет статический метод `serviceUrl(serviceId, contentRegion)`,
возвращающий ссылку на сервис для некоторого региона. Регион по умолчанию — `ru`.

```
import IServices from 'lego-on-react';

IServices.serviceUrl('service-id', 'content-region');
```

<a name="ISL-3625"></a>
### [lego-on-react: заменить tabindex на tabIndex][ISL-3625]

В блоках `button2`, `link`, `logo`, `menu`, `search2`, `select2`, `textarea`, `user2` на `React` атрибут `tabIndex` переведен в `camelCase`.

<a name="ISL-3482"></a>
### [m-footer: Добавить защиту от сломанных входных данных][ISL-3482]

1. Добавлена защита от сломанных данных в m-footer:

Было:
``` js
{
    block: 'm-footer',
    additionalData: { // не сработает, обязательно нужно завернуть в массив.
        title: 'Еще одна ссылка в футере',
        url: 'https://yandex.ru'
    },
}

{
    block: 'm-footer',
    additionalData: [
        'Дополнительный текст в футере',
        null // ошибка
    ]
}
```

Теперь в поле additionalData не нужно всегда заворачивать данные в массив, и добавлена защита от некорректных данных.

2. Исправили баг с цветом ссылок(не для всех применялись стили), и вернули прокраску ссылок по наведению мыши.

<a name="ISL-3526"></a>
### [paranja: Добавить единицы измерения у transition][ISL-3526]

Добавлены единицы измерения у transition в блоке paranja.

<a name="ISL-3353"></a>
### [pointerfocus: Портировать на React][ISL-3353]

На React портирован блок `pointerfocus`.

[ISL-1695]: https://st.yandex-team.ru/ISL-1695
[#2141]: https://github.yandex-team.ru/lego/islands/pull/2141
[ISL-3351]: https://st.yandex-team.ru/ISL-3351
[#2240]: https://github.yandex-team.ru/lego/islands/pull/2240
[ISL-2874]: https://st.yandex-team.ru/ISL-2874
[#2249]: https://github.yandex-team.ru/lego/islands/pull/2249
[ISL-3571]: https://st.yandex-team.ru/ISL-3571
[#2254]: https://github.yandex-team.ru/lego/islands/pull/2254
[ISL-3455]: https://st.yandex-team.ru/ISL-3455
[#2227]: https://github.yandex-team.ru/lego/islands/pull/2227
[ISL-3625]: https://st.yandex-team.ru/ISL-3625
[#2264]: https://github.yandex-team.ru/lego/islands/pull/2264
[ISL-3482]: https://st.yandex-team.ru/ISL-3482
[#2205]: https://github.yandex-team.ru/lego/islands/pull/2205
[ISL-3494]: https://st.yandex-team.ru/ISL-3494
[#2233]: https://github.yandex-team.ru/lego/islands/pull/2233
[ISL-3573]: https://st.yandex-team.ru/ISL-3573
[#2234]: https://github.yandex-team.ru/lego/islands/pull/2234
[ISL-3526]: https://st.yandex-team.ru/ISL-3526
[#2201]: https://github.yandex-team.ru/lego/islands/pull/2201
[ISL-3353]: https://st.yandex-team.ru/ISL-3353
[#2219]: https://github.yandex-team.ru/lego/islands/pull/2219
