# islands 5.14.1


Изменения, вошедшие в релиз islands 5.14.1, разделены на группы:

* [минорные изменения](#Минорные-изменения) — задачи, в рамках которых произошло расширение API блоков;
* [исправлено и улучшено](#Исправлено-и-улучшено) — различные исправления, не затрагивающие API блоков;
* [дополнительно](#Дополнительно) — задачи, не касающиеся кода блоков (документация, инфраструктура и т.д.).

Все важные изменения подробно описаны [ниже](#Пояснения).

## Минорные изменения

| Заголовок                                                                             | Задача     | PR      |
| :------------------------------------------------------------------------------------ | :--------- | :------ |
| [b-page: Вынести meta в моду и дать возможность передавать свои meta теги](#ISL-4325) | [ISL-4325] | [#2728] |
| [Полное удаление ручек МДА из кода Лего](#ISL-4353)                                   | [ISL-4353] | [#2723] |
| [i-bem: extractParams убрать выполнение инлайн скрипта](#ISL-3417)                    | [ISL-3417] | [#2754] |

## Исправлено и улучшено

| Заголовок                                                | Задача     | PR      |
| :------------------------------------------------------- | :--------- | :------ |
| menu: Исправить ошибку в поиске подсвечиваемого элемента | [ISL-4389] | [#2748] |
| user: Отменить scroll страницы при вызове попапа пробелом| [ISL-4250] | [#2722] |
| checkbox, radiobox: Поставить правильные размеры         | [ISL-4401] | [#2755] |
| select2.react: Рендерится при передаче null вместо item  | [ISL-4420] | [#2764] |
| user2.react: Не передаётся avatarHost в список аккаунтов | [ISL-4475] | [#2809] |
| search2: Починить округление кнопки в Chrome 63+         | [ISL-4392] | [#2783] |

## Дополнительно

| Заголовок                                              | Задача     | PR      |
| :----------------------------------------------------- | :--------- | :------ |
| modal.react: Пример для modal не работает в IE10, IE11 | [ISL-3855] | [#2750] |
| dropdown2.react: Пример не работает под IE10, IE11     | [ISL-4233] | [#2752] |

## Пояснения

<a name="ISL-4325"></a>
### [b-page: Вынести meta в моду и дать возможность передавать свои meta теги][ISL-4325]

Добавлена возможность передавать в `bemjson` блока `b-page` поля `charset` и `viewport` для переопределения метатегов.
На `touch` уровне реализована возможность передавать доопределение метатегов через `bemjson`-поле `meta`, а также возможность с помощью поля `defaultMeta` в значении `false` отключить следующие метатеги по умолчанию:

```
{
    elem: 'meta',
    attrs: {
        name: 'viewport',
        content: viewport
    }
},
{
    elem: 'meta',
    attrs: {
        name: 'format-detection',
        content: 'telephone=no'
    }
},
{
    elem: 'meta',
    attrs: {
        name: 'apple-mobile-web-app-capable',
        content: 'yes'
    }
}
```

<a name="ISL-4353"></a>
### [Полное удаление ручек МДА из кода Лего][ISL-4353]

Из блоков `i-update-session` и `lang-switcher` была удалена поддержка MDA.

Ручки, отвечающие за MDA, отключены в задаче [ANSEARCH-615](https://st.yandex-team.ru/ANSEARCH-615).

<a name="ISL-3417"></a>
### [i-bem: extractParams убрать выполнение инлайн скрипта][ISL-3417]

Внутри `i-bem` происходит обращение к DOM-атрибутам `onclick` и `ondblclick` для считывания JS-параметров блока.
Хранить JS-параметры блока в этих атрибутах — это устаревший подход. Необходимо использовать атрибут `data-bem`.

Тем не менее, для совместимости, считывание из старых атрибутов всё ещё происходит. Обращение к этим атрибутам приводит
к срабатыванию запрещающей политике CSP, что блокирует выполнение JavaScript.

В `BEM.DOM` выключен способ обращения к атрибутам `onclick` и `ondblclick`. Если по каким-то причинам вы всё ещё не
используете `data-bem`, то вы можете вернуть обработку атрибутов обратно, определив при помощи [enb-define][] переменную
`ENABLEONCLICKCHECK` равную `1`.

```js
config.nodes('*.bundles/*', function(nodeConfig) {
    nodeConfig.addTechs([
        [require('enb-define/techs/define'), {
            …
            variables: {
                ENABLEONCLICKCHECK: 1
            }
        }]
    ]);
});
```

[ISL-3417]: https://st.yandex-team.ru/ISL-3417
[#2754]: https://github.yandex-team.ru/lego/islands/pull/2754
[enb-define]: https://github.com/tadatuta/enb-define
[ISL-4392]: https://st.yandex-team.ru/ISL-4392
[#2783]: https://github.yandex-team.ru/lego/islands/pull/2783
[ISL-4475]: https://st.yandex-team.ru/ISL-4475
[#2809]: https://github.yandex-team.ru/lego/islands/pull/2809
[ISL-4420]: https://st.yandex-team.ru/ISL-4420
[#2764]: https://github.yandex-team.ru/lego/islands/pull/2764
[ISL-4401]: https://st.yandex-team.ru/ISL-4401
[#2755]: https://github.yandex-team.ru/lego/islands/pull/2755
[DOC-3939]: https://st.yandex-team.ru/DOC-3939
[#2668]: https://github.yandex-team.ru/lego/islands/pull/2668
[ISL-4325]: https://st.yandex-team.ru/ISL-4325
[#2728]: https://github.yandex-team.ru/lego/islands/pull/2728
[ISL-4233]: https://st.yandex-team.ru/ISL-4233
[#2752]: https://github.yandex-team.ru/lego/islands/pull/2752
[ISL-4404]: https://st.yandex-team.ru/ISL-4404
[#2749]: https://github.yandex-team.ru/lego/islands/pull/2749
[ISL-4389]: https://st.yandex-team.ru/ISL-4389
[#2748]: https://github.yandex-team.ru/lego/islands/pull/2748
[ISL-3855]: https://st.yandex-team.ru/ISL-3855
[#2750]: https://github.yandex-team.ru/lego/islands/pull/2750
[ISL-4250]: https://st.yandex-team.ru/ISL-4250
[#2722]: https://github.yandex-team.ru/lego/islands/pull/2722
[ISL-4353]: https://st.yandex-team.ru/ISL-4353
[#2723]: https://github.yandex-team.ru/lego/islands/pull/2723
