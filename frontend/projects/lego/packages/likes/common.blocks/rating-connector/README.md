# rating-connector
Вспомогательный блок для эффективной синхронизации всех блоков про рейтинги на странице. Например пользователь ставит оценку в блоке `rating-dynamic` и результат должен отобразится в блоке `rating-user`. Или на странице 2 блока `rating-dynamic`: на постере фильма и в полной карточке - изменение рейтинга в первом блоке должен отразиться и на втором. Важно передавать тот же `value`, что и к подключаемым блокам, это позволяет `rating-connector` лишний раз не инициализировать подключенные блоки, т.о. сохранить их ленивыми до тех пор пока значение правда не изменится.

## Обзор

### Модификаторы блока

| Модификатор | Допустимые значения | Способы установки | Описание |
| ----------- | ------------------- | ----------------- | -------- |
| [type](#mods-type) (req) | `counter`, `dynamic`, `user` | `BEMJSON` | Стилевое оформление. |

req — обязательный модификатор.

### JS-параметры
| Поле | Тип | Описание |
| ---- | --- | -------- |
| [cid](#js-cid) | `String` | Уникальный идентификатор оцениваемого объекта. |
| [value](#js-value) | `Number` | Значение рейтинга (от 1 до 5). |

## Подробнее

### Модификаторы блока

<a name="mods-type"></a>
#### Модификатор `type`

Тип подключаемого блока.

Способы установки: `BEMJSON`.

| Допустимые значения | Описание |
| ------------------- | -------- |
| `counter` | Генерирует событие `change` на блоке при выставлении оценки или ее сброса. Полезен, если где-то на странице нужно нарисовать блок, в котором отображается количество оценок, выставленным пользователем. |
| `dynamic` | Подключает блок `rating-dynamic`. В js-параметрах нужно обязательно передать `cid`. |
| `user` | Подключает блок `rating-user`. В js-параметрах нужно обязательно передать `cid`. |

### JS-параметры

<a name="js-cid"></a>
#### Параметр `cid`

Уникальный идентификатор оцениваемого объекта, обязательный параметр для `type=dynamic|user`. Идентификатор позволяет связать разные блоки про рейтинг к одному объекту, который оценивает пользователь.

Тип: `String`.

<a name="js-value"></a>
#### Параметр `value`

Значение рейтинга (от 1 до 5). Имеет смысл для блоков со значением (`type=dynamic|user`). Не имеет смысла для (`type=counter`).

Тип: `Number`.

### Пример
```
[
    {
        block: 'rating-dynamic',
        mods: { theme: 'border', size: 'm' },
        mix: {
            block: 'rating-connector',
            mods: { type: 'dynamic' },
            js: {
                cid: 'some-id-123',
                value: 5
            }
        },
        value: 5
    },
    {
        block: 'rating-user',
        mix: {
            block: 'rating-connector',
            mods: { type: 'user' },
            js: {
                cid: 'some-id-123',
                value: 5
            },
            value: 5
        }
    },
    {
        block: 'page-likes-counter',
        mix: {
            block: 'rating-connector',
            mods: { type: 'counter' }
        }
    }
]
```
При смене оценки с 5 до 4 через блок звёзд `rating-dynamic` микс блока `rating-connector` получает новое значение и обновляет все остальные блоки. В частности `rating-user` получает новое значение благодаря совпадению `cid` (`cid: 'some-id-123'`). Таким образом `rating-connector` знает, что нужно обновлять, а что нет. В то время как `rating-connector_type_counter` работает иначе и получает изменения любых объектов (без привязки по `cid`) и сгенерирует событие на экземпляре блока, далее блок `page-likes-counter` может подписаться на событие и обработать его.
