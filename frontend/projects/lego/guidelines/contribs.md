# Контрибы в Лего

## Содержание
1. [Мотивация](#Мотивация)
1. [Инициализация контриба](#Инициализация-контриба)
1. [Документация](#Документация)
1. [Conventional Commits](#Conventional-Commits)
1. [Выпуск версий](#Выпуск-версий)
1. [В какой момент next становится latest?](#latest)
1. [Статика](#Статика)
1. [Разработка](#Разработка)
1. [Ревью](#Ревью)
1. [Переводы](#Переводы)
1. [Использование Design-System](#Использование-Design-System)
1. [Тестирование](#Тестирование)
1. [Список пакетов](#Список-пакетов)

## Мотивация
### Зачем это глобально в компании?

Скорее всего, ваша команда разрабатывает какой-то продукт (а не просто пишет код в конкретном репозитории на конкретных технологиях).

Для вашего продукта выгодно, чтобы он был интегрирован в максимальное количество сервисов Яндекса.

Например, если вы сервис Видео, вам выгодно, чтобы пользователь взаимодействовал с вашим сервисом на Серпе благодаря специальному колдунщику, фильмы можно было добавить в Коллекции через общий компонент Избранного, а уведомления о новых фильмах прилетали в [общепортальный нотификатор](https://abc.yandex-team.ru/services/gnc) и так далее.

Разумеется, каждый продукт, представленный на разных сервисах, все равно остается этим самым продуктом. В нашем примере с Видео, зачастую потребуется показывать название, превью, рейтинг и другие данные, связанные с фильмами независимо от того, в какой сервис будет интегрироваться Видео.

Для компании важно экономить время и деньги на разработке подобных элементов (которая зачастую требует множества экспериментов для того, чтобы выкристаллизовалось максимально удобное решение) на каждом из сервисов.

А для пользователей — взаимодействовать с продуктом единообразно и консистентно, без необходимости заново разбираться с интерфейсом, решая привычную задачу на новой площадке.

### Зачем это конкретному разработчику (команде)?

Например, вы разработчик Видео и вам нужен компонент Viewer. А одновременно он нужен в Эфире и в Объектом Ответе на Серпе.

Вы решаете, что будете экономить и повторно использовать этот код и в этот момент сталкиваетесь с тем, что вам необходимо решить ряд вопросов:
- где хранить
- как менять и проставлять версии
- как тестировать
- как доставлять на сервисы
- как одновременно разрабатываться
- и т.д.

В Лего мы решаем эту задачу успешно много лет и предлагаем вам воспользоваться нашей готовой инфраструктурой для решения этих проблем.

Вы получаете готовый инструментарий для работы со своим кодом, вам не надо задумываться о рутинных инфраструктурных задач и о «рельсам».

Разрабатывая контриб в Лего, вы получаете:
- публикацию пакетов с помощью роботов
- инструмент для автоматического тестирования и внедрения версии в сервисы
- автоматические релизы (не будет ситуации, что кто-то в следующей версии вовремя не сделает rebase и выпустит версию без вашего кода, это исключено) – [В разработке](https://st.yandex-team.ru/LEGO-2325)
- выгрузка статики на s3 при публикации пакета (yastatic)
- инфраструктуру для тестирования
- автоматический сбор changelog при публикации релиза
- «известность». Принято перед тем как что-то делать, посмотреть, а есть ли это в Лего, а значит, если вы написали код, его будут использовать и приносить полезные изменения и замечания, чтобы ваш код был еще лучше.

> Писать общие компоненты «дороже», чем сделать реализацию под конкретный проект, но с каждым новым проектом, где этот компонент понадобится – ваши усилия оправдываются в геометрической прогрессии.

## Инициализация контриба

### Подготовка к работе
Первый делом, не забудь установить все необходимые зависимости и хуки.

1. У нас используются  `npm 6.2.0` и `node 8.6.0`.
2. Мы пользуемся lerna. Она должна быть установлена глобально:
`npm i -g lerna@3.10.5`
1. У нас появились новые линтеры и другие скрипты и чтобы они заработали надо сделать:
`lerna exec npm ci -- --registry http://npm.yandex-team.ru/`

### Начало работы

Итак, вы решили принести свой код в Лего.
- Если это продуктовое решение, которая представляет собой какой-то общий компонент, или библиотеку общих компонентов – положите свой код в `contribs/<package-name>`.
- Если это какая-то утилита, которая не имеет визуального представления – `packages/<package-name>`.

0. Выбрать папку
0. Если пакет уже опубликован, то достаточно просто положить код в нужную папку.
    - Если пакета нет, `mkdir path/to/contrib && cd path/to/contrib && npm init`
    - Опубликуйте `0.0.0` версию пакета во внутренний npm, чтобы зарегистрировать его.
0. Из корня Islands запустите `npm run contribs:init` и следуйте инструкции.

- Теперь ваш код лежит в Islands
- Пользователи будут знать, куда идти за поддержкой
- Если кто-то захочет внести изменения в контриб – вас позовут на ревью.
- Наш робот добавлен в npm для публикации пакета.

## Документация

### Conventional Commits
> Мы используем линтер [conventional commits](https://conventionalcommits.org/en/v1.0.0-beta.3/)
> И опираемся на соглашения [Angular Conventional](https://gist.github.com/stephenparish/9941e89d80e2bc58a153)

Соответственно, коммит сообщения нужно писать в формате:
`type(scope): subject`, где
- **type**: Тип произведенных изменений
- **scope**: Затронутый контриб
- **subject**: Суть изменений

Например, `build(serp-header): Изменил сборку шапки для выгрузки на статику`
По такому сообщению мы понимаем, какие изменения были произведены и умеем формировать CHANGELOG и выпускать нужную версию вашего пакета.

#### Соотношение type и semver-версии, которая будет выпущена в npm
| type(scope)  | Для каких изменений                                                            | Какая будет выпущена версия |
|--------------|--------------------------------------------------------------------------------|-----------------------------|
| **build**    | Изменение сборки или внешних зависимостей                                      | `$.noop`                    |
| **chore**    | Выпуск новой версии, какая-то небольшая рутинная работа                        | `$.noop`                    |
| **ci**       | Изменения, связанные с CI                                                      | `$.noop`                    |
| **docs**     | Работа с документацией                                                         | `$.noop`                    |
| **feat**     | Новая функциональность                                                         | MINOR                       |
| **fix**      | Исправление багов                                                              | PATCH                       |
| **perf**     | Улучшение производительности                                                   | MINOR                       |
| **refactor** | Рефакторинг кода                                                               | PATCH                       |
| **revert**   | Откат предыдущих изменений                                                     | PATCH                       |
| **style**    | Изменения, которые не влияют на код. (Правки отступов, опечаток в jsdocs и тд) | `$.noop`                    |
| **test**     | Работа с тестами                                                               | `$.noop`                    |

#### Как выпустить мажор?
Необходимо в описание коммита добавить строку `BREAKING CHANGE`.
Например, это можно сделать вот так:
`git commit -m 'feat(serp-header): Переделали API' -m 'BREAKING CHANGE Изменилось API компонента'`

### CHANGELOG
Если по результату ваших изменений будет выпущена минорная или мажорная версия необходимо добавить примечания к релизу.
В папке контриба необходимо добавить (если нет) папку `releases`. В ней создать папку `notes` и положить файл `<>.md`, где описать то, что должно попасть в CHANGELOG.

Например, `ISL-6293.md`:

`В i-bem реализации блока textinput реализована возможность использовать модификатор _has-clear_yes одновременно с модификатором _type_number. В react-реализации блока исправлен порядок стилей для этих модификаторов.`

Если должна быть выпущена `patch` версия, то будет только заголовок задачи и PR.

Теперь при выпуске стабильной версии будет формироваться changelog с описанием, того, что изменилось.
Примеры можно посмотреть вот здесь: https://github.yandex-team.ru/lego/islands/tree/dev/releases/

### Описание работы с контрибом

Не забудьте описать работу с вашим пакетом.
Можете пользоваться любым инструментом, например Storybook.
В планах сделать общий Storybook на всех.

## Выпуск версий
- Убедитесь, что `lego-changelogger` может публиковать ваш пакет
- Если перед выпуском версии необходимо собрать проект или провести какие-то операции, опишите `prepublishOnly` в `package.json`
- Подробнее о работе c тестовыми и стабильными версиями написано на шаге [разработка](#Разработка)

<a name="latest"></a>

## В какой момент next становится latest?

После влития изменений пакета в мастер, мы выпускаем `next` версию в `npm`. Это осознанное решение, чтобы такие версии по умолчанию не приезжали при установке.

После успешного внедрения версии в сервис версию можно перевести в `latest`.

Переводит версию релиз-менеджер пакета.

Любой пакет (контриб) в праве выбрать для себя сервис, который является для него эталонным и там используется большая часть компонентов.

Например, `islands`, `@yandex-lego/components` становятся `latest` после того, как пакеты успешно внедрятся в `web4`, попадут в релиз и не будут из него возвращены из-за ошибок.

Перевести версию в latest можно следующей командой:

```
npm dist-tag add islands@6.16.3 latest
```

## Статика

Если вы хотите выгружать свой контриб на `yastatic`, можете воспользоваться инструкцией для выгрузки ресурсов в s3.
https://github.yandex-team.ru/lego/islands/blob/dev/DEPLOY-STATIC.md

## Разработка
Здесь описано, как тестировать `canary`-версии контрибов, публиковать стабильные версии и вливать их в сервисы.

### Локальная
Сделать \*hack-hack-hack\* в коде контриба.

Для удобства локальной разработки вы можете использовать `npm link`:
- Для этого в корне контриба надо сделать `npm link`, чтобы `npm` запомнил ссылку на текущий пакет.
- Перейти в собранный сервис и сделать `npm link @yandex-lego/contrib`.

Теперь в `node_modules` будет символическая ссылка на ваш контриб и вы можете разрабатываться в `Islands` и смотреть за результатом работы в сервисе.

### Перенос уже существующего кода

Если вы переносите уже существующий код из сервиса:

* Создайте pr с выделенными из сервиса компонентами и выпустите canary версию, следуя инструкции описанной ниже.
* Поставьте canary версию пакета в ваш сервис.
* Замените использование компонента на соответствующий из пакета.
* Проверьте что все тесты зеленые.
* Выпустите стабильную версию пакета и влейте её в сервис.
* Все необходимые изменения в код компонента вносите отдельными последующими пулл реквестами.

### Создание PR
В этом разделе в качестве сервиса, использующего наш контриб, рассматривается `web4`. На его месте может быть любой другой (любые другие).

* Открыть PR в `islands`.
* Скомандовать боту `/canary` в комментарии.
* Бот откроет PR с тем же именем, что и ваш PR.
* Если у вас есть fork сервиса: добавьте робота (lego-changelogger), чтобы он открывал PR из вашего репозитория

Бот открывает несколько PR в сервисах, где используется контриб.

* Дождаться открытия PR (бот напишет об этом комментарий).
* Перейти в PR в `web4`, там будет два коммита от нашего бота.
* Проверить, прикрепил ли бот к этому PR ссылку на PR в  `islands`, где ты командовал `/canary`. Можно дополнительно закинуть ссылку в комментарий к PR в `web4`: `«Изменения здесь: <ссылка>»`.

Теперь будем тестировать бету (`canary`-версию) контриба с нашим новым кодом в сервисах.

### Тестирование `canary`-версии контриба

⚠️ **Не вливайте canary версию в сервис!** ⚠️

⚠️ Статика (тестовый bucket s3) не доступна из внешней сети!⚠️

В зависимости от контриба и задачи может потребоваться проверить, как с контрибом работает несколько сервисов. В таком случае нужно выполнить действия этого раздела для каждого из сервисов.

* В описании PR в `web4` есть ссылки на бету, которую можно потрогать на разных платформах `(desktop | pad | phone)`. Нужно убедиться, что бета содержит наш новый код, и что он работает.
* Дождаться выполнения автотестов в PR.
* Стартовать и пройти код-ревью (`/start`).
* Отдать бету в тестирование, дождаться его окончания (можно отправить тестировщикам несколько ссылок все проверяемые сервисы). Дождаться окончания тестирования.


Если все выглядит хорошо, время выкатывать новую стабильную версию `islands`.

### Выпуск новой стабильной версии контриба

⚠️ **Не забывайте вливать стабильную версию в сервис!** ⚠️
Если в вашем пакете настроены автоматические релизы, достаточно дождаться выпуска версии после влития в dev.


Новую версию будем собирать и публиковать во внутреннем npm (`npm.yandex-team.ru`).
**Внимание!** На этом шаге перед публикацией пакета в npm нужно выполнить все необходимые операции для твоего контриба. В зависимости от контриба они могут отличаться от перечисленных здесь.

Для `notifier`:

* Перейти в папку **contribs/notifier/**.
* `git fetch && git rebase origin/dev`
* Сменить версию в **contribs/notifier/package.json**, (`npm version <_._._> [major|minor|patch]` или переписать вручную).
* Закоммитить и запушить обновленный **package.json**. Тип коммита (для сообщения) `chore(notifier):`.
* Опубликовать новую версию: `npm publish --registry=https://npm.yandex-team.ru` (по вопросам доступа обращаться в канал support https://lego-team.slack.com).

### Отдаем стабильную версию в сервисы
В каждом из PR, созданных ботом, указан номер `canary`-версии. Нужно изменить его на номер новой стабильной версии. Для этого повторяем шаги из этого раздела для каждого сервиса, куда хотим принести новую стабильную версию.

Для каждого сервиса это можно сделать либо вручную, либо с помощью `hedwig`.

* Вариант 1:
    * Проверить, что клонирован `web4` https://github.yandex-team.ru/lego-integrations/web4, и что прописан `remote`.
    * Перейти в папку **web4/**.
    * Подтянуть свежие изменения из `lego-integrations` (`git fetch lego-integrations`).
    * Перейти в ветку `lego-integrations/islands-canary-pulls-<####>`, где #### - номер PR в islands (`git checkout -b islands-canary-pulls-<####>`).
    * `git fetch origin && git rebase origin/dev`
    * `npm i -DE @yandex-lego/notifier --registry=https://npm.yandex-team.ru` (меняется **package.json** и **package-lock.json**).
    * Закоммитить изменения.
    * Собрать все коммиты в ветке в один (`git rebase -i`).
    * `git push lego-integrations +HEAD`

* Вариант 2:
    * Установить пакет `Hedwig` (`ynpm i -g @yandex-lego/hedwig`).
    * `DEBUG=hedwig:* ENV GITHUB_API_TOKEN=<GITHUB_TOKEN> hedwig open-pr --contrib @yandex-lego/notifier --v <version> --repo web4 --owner serp --fork lego-integrations --testBranch <branch>`, где вписать:
        * `<GITHUB_TOKEN>` — свой GitHub-токен (duh);
        * `<version>` — наша новая стабильная версия notifier;
        * `<branch>` — как правило, «islands-canary-pulls-####», где #### - номер PR в `islands`.

* Дождаться выполнения автотестов в `web4`.
* `/merge` PR в `web4`. Дождаться влития.
* `/merge` PR в `islands`.

В тех сервисах, в которые бот создал PR на шаге 1, и для которых ты **не** пройдешь шаги этого раздела, PR с `canary`-версиями контриба не будут влиты, и в них останется предыдущая стабильная версия.

### Готово

Итак, ты обновил код контриба, собрал его `canary`-версию, протестировал ее в сервисах, затем опубликовал во внутреннем npm новую стабильную версию контриба и принес ее в сервисы.

:sparkles: Ты восхитителен! :sparkles:

## Ревью

Если вы присылаете PR в contribs, то для прохождения ревью надо получить `/ok` от кого-то из команды пакета, который вы изменили и от кого-то из команды Лего.
Соответственно, если меняется в одном PR несколько пакетов, но нужны подтверждения от представителя каждого пакета и кого-то из Лего.
Если вы не хотите, чтобы в вашем контрибе работали такие правила, можно отключить их в файле `.devexp.json` (в корне):
- найти маску вашего пакета `"pattern": ["contribs/<your-contrib>/**" ]`,
- убрать `"isReviewerRequired": true`

Так как количество внешних PR выше наших возможностей, команда Лего просматривает только какие-то инфраструктурные изменения и мельком смотрим сам код. К сожалению, у нас нет возможность разбираться в устройстве каждого пакета и проводить полноценное ревью. Качество кода в пакете – ответственность и обязанность команды пакета.

Если у вас есть какие-то вопросы про общие решения, всегда можно придти в [#support](https://lego-team.slack.com/) и спросить, как лучше поступить и т.д.
Мы обязательно вам постараемся помочь.

Если команда вашего пакета растет, не забывайте [добавлять](https://github.yandex-team.ru/lego/islands/blob/dev/.devexp.json) новых разработчиков в нужную маску, чтобы они тоже приходили на ревью.

## Переводы

Для того, чтобы в вашем пакете работали переводы, вам необходимо настроить в нем tanker.
Используем пакет [tanker-fetch](https://github.yandex-team.ru/UFO/tanker-fetch)

**Последовательность шагов для того, чтобы переводы заработали в вашем пакете:**

1. Завести свой проект (https://wiki.yandex-team.ru/doc-and-loc/l10n/tools/tanker/#otpravitzajavkunasozdanieproektavtankere)
1. Добавить необходимые переводы
1. Добавить себе `tanker-fetch`:
	```
	npm i -DE tanker-fetch --registry=https://npm.yandex-team.ru
	```
1. Настроить `.tanker.json` и положить его в папку вашего npm-пакета.
	```
	{
	"project-id": "<Проект_в_танкере>",
	"outputDir": "<Куда_подтянуть_переводы>",
	"branch-id": "<Ветка_в_танкере>",
	"status": "<Статус_переводов(unapproved, например)>"
	}
	```
1. Настраиваете package.json удобным вам образом, например, можно сделать команду `i18n`:
	```
	...
	"scripts": {
		"i18n": "tanker-fetch",
	}
	...
	```

1. Подключаете в проект [react-tanker](https://github.yandex-team.ru/UFO/react-tanker):
	```
	npm i -PE react-tanker --registry=https://npm.yandex-team.ru
	```

1. Права на переводы и прочие вещи вы должны администрировать самостоятельно, как и проверять актуальность переводов.

Примеры с `.tanker.json` и работой с переводами можете посмотреть в пакете `global-notifications`: https://github.yandex-team.ru/lego/islands/tree/dev/contribs/global-notifications

## Использование Design-System

#### Ценность Design-System
Наибольшую ценность в общих компонентах представляет возможность использовать их на разных сервисах с сохранением функциональной консистентности.
Следующая по значимости ценность – возможность использовать общие стилистические единицы, такие как цвет, типографика, атомарные assets (иконки, логотипы, промографика) – эту ценность в Lego contribs и другие сервисы призван приносить проект [Design System](https://github.yandex-team.ru/serp-design/design-system). Это ценность визуальной консистентности между модулями (репозиториями) компонент и разными сервисами, это часть ДНК общего портального графического стиля и единообразия.

#### Flow работы с design-system в Lego-contribs

1. Добавить в зависимости пакет ```@yandex-serp-design/common``` или пакет соответствующий продукту контриба, так, например, для serp-contribs нужно использовать ```@yandex-serp-design/search```.
1. Пакет предоставляет наружу набор css (scss) файлов с константами и директорий с файлами иконок. Важно явно импортировать в свои исходники нужные файлы и/или обращаться к assets из дизайн-системы. Например:
    ```$css
    /* SomeBlock@deskpad.css */

    @import "../../../node_modules/@yandex-serp-design/search/consts/styles/styles@deskpad.css";

    .SomeBlock {
        font-family: var(--font-regular);
        color: var(--color-link);
        border-radius: var(--size-border-radius-m);
        box-shadow: var(--shadow-m);
        font-size: var(--text-m);
        line-height: var(--texm-m-line-m);
        background-image: url(../../../node_modules/@yandex-serp-design/search/icons/Icon_12_red-hover.svg);
    }
    ```
    > Важно! Импортировать в каждом файле явно константы требуемого уровня `common, deskpad, desktop, touch, touch-pad, touch-phone`.
1. Настроить postcss плагины для корректной сборки стилей
    ```$javascript
    /* contribs/serp-components/.config/build.config.js */
    module.exports = {
        ...
        postcss: [
            require('postcss-url')([{
                filter: /\/node_modules\/.*\.(svg|jpg|png)/,
                url: 'rebase',
                assetsPath: './__internal__'
            }]),
            require('postcss-import'),
            require('postcss-css-variables')
        ],
    };
    /* ... */
    ```
    Разберем секцию postcss подробнее
    1. `postcss-url` – при сборке css и разборе путей к файлам по фильтру `'**/node_modules/**/*.svg'` будет применена стратегия rebase путей по новому основанию `./__internal__`, директория `__internal__` делается специально, чтобы спрятать от импорта из модуля приватных частей реализации.
    1. `postcss-import` – позволяет при сборке полностью включать содержимое импортируемых css файлов с константами.
    1. `postcss-css-variables` – при сборке заменяет выражения типа `var(--css-const)` на соответствующее значение из констант (интерполирует), объявленных локально или в импортируемых файлах. Также после интерполяции, удаляются все декларации значений констант. На выходе получается файл без `var(--css-const)`.

    > Важно! Аналогичную настройку postcss необходимо подключать в каждом сервисе, использующем design-system.
1. После сборки и публикации пакета модули с контрибами экспортируют наружу собранные компоненты, готовые к использованию в отрыве от дизайн-системы в любом сервисе и/или другом модуле компонент.


## Тестирование

### Unit

Тесты можете описать удобным для вас способом и с использованием вашего любимого инструмента.
Как правило, мы пользуемся `jest`, `mocha`. Если по каким-то объективным причинам вы не можете использовать рекомендуемые инструменты, обсудите это с нами. Это, как минимум, влияет на количество зависимостей, которые придется качать всем.

Unit-тесты оформляются в секции `unit` в package.json.
Убедитесь, что там нет `exit 1` - иначе ваш код не вольётся и будет падать обязательная проверка в CI.

```json
{
    "unit": "mocha ***"
}
```

### Hermione

> ?



## Список пакетов

1. [cookie-confirm](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/cookie-confirm)

	Отсутствует описание пакета

1. [edu-components 🎓](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/edu-components)


	[![code style: prettier](https://img.shields.io/badge/code_style-prettier-ff69b4.svg)](https://github.com/prettier/prettier)
	![npm version](https://badger.yandex-team.ru/npm/edu-components/version.svg)
	![npm owners](https://badger.yandex-team.ru/npm/edu-components/owner.svg)

	Общие компоненты образовательных сервисов.

	- [Состав пакета и roadmap](#Состав-пакета-и-roadmap)
	- [Установка пакета](#Установка-пакета)
	- [Использование в сервисе](#Использование-в-сервисе)
	- [Разработка](#Разработка)
	  - [Подготовка](#Подготовка)
	  - [Запуск](#Запуск)
	  - [Перед коммитом](#Перед-коммитом)
	  - [Формат коммит-сообщений](#Формат-коммит-сообщений)
	  - [API компонента](#API-компонента)
	  - [Структура компонента](#Структура-компонента)
	    - [Версии под платформы](#Версии-под-платформы)
	    - [Написание тестов](#Написание-тестов)
	    - [Документирование](#Документирование)
	  - [Запуск тестов](#Запуск-тестов)
	  - [Оформление PR](#Оформление-PR)
	  - [Выпуск релиза](#Выпуск-релиза)
	- [Обратная связь](#Обратная-связь)

1. [favorites](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/favorites)


	`favorites` — Набор компонентов для работы с API [коллекций](https://wiki.yandex-team.ru/collections/Ruchki-dlja-Edinogo-Izbrannogo/).

1. [yandex-notifications](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/global-notifications)


	Глобальный центр уведомлений. Виджет, в котором собраны уведомления для разных сервисов Яндекса, внутренних или внешних.

	ЦУ предназначен для сервисов яндекса, которые заинтересованы в интеграции на свою страницу колокольчика-нотификаций. Виджет можно будет установить на страницу, подключив к ней js script и указав в нем контейнеры для отрисовки кнопки-колокольчика и списка нотификаций.
1. [i-bem](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/i-bem)

	Отсутствует описание пакета

1. [islands-deprecated](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/islands-deprecated)


	Библиотека устаревших и малоиспользуемых блоков, удаленных из библиотеки `islands` в версии 6.0.
	**Не содержит** блоков в `react`-реализации.

1. [lang-detector](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/lang-detector)

	Скрипт, который выводит подсказку с рекомендуемым языком портала для данного пользователя. Нажатие по подсказке автоматически переключает язык на предложенный и выполняется переход на титульную страницу портала. При этом параметр `lang` будет исключен из `querystring`.


1. [lego-on-react@next](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/lego-components)


1. [light-popup](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/light-popup)

	Отсутствует описание пакета

1. [likes](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/likes)

	Набор блоков для сбора и отображения оценок пользователя.

1. [meccano](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/meccano)


	Библиотека блоков для внутренних сервисов.

	```sh
	npm install --save @yandex-lego/ui.meccano --registry=https://npm.yandex-team.ru
	```
1. [Блок `messenger`](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/messenger)

	Иконка Q в шапке со счётчиком непрочитанных сообщений. При клике по иконке отображается попап с мессенджером.

1. [notifier](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/notifier)


	`notifier` – обёртка над [Центром уведомлений](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/global-notifications).

1. [pusher](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/pusher)

	Отсутствует описание пакета

1. [Search Suggest (ранее Mini Suggest) & i-mini-bem #](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/search-suggest)


	В данном репозитории аж две библиотеки: search-suggest и i-mini-bem. search-suggest зависит от i-mini-bem, но требует только малую часть представленной функциональности.
	Данное readme - не документация, а, скорее, лёгкий обзор. Документацию (параметры, аргументы, примеры, события) лучше смотреть в коде.

1. [SERP Components](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/serp-components)


	Общедоступные компоненты Поиска на React.

1. [serp-header](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/serp-header)


	`serp-header` — та самая шапка со строкой поиска, которую вы видите, когда что-то ищете в Яндексе.

	![](example.png)

	Этот контриб используется как единая точка для изменений шапки в поисковых сервисах Яндекса. Весь код, касающийся шапки, должен находиться здесь.

	* [Быстрый старт](#Быстрый-старт)
	* [API Reference](#api-reference)
	* [Структура пакета](#Структура-пакета)
	* [Порядок подключения уровней переопределения](#Порядок-подключения-уровней-переопределения)
	* [Как разрабатываться](#Как-разрабатываться)
	* [Подключение экспериментального кода](#Подключение-экспериментального-кода)
	* [Где используется](#Где-используется)

1. [Блок suggest2](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/suggest2)


	_Саджест — это поисковая подсказка._

	```sh
	npm install --save @yandex-lego/ui.suggest2 --registry=https://npm.yandex-team.ru
	```

	![suggest](https://jing.yandex-team.ru/files/tenorok/screen01_2014-03-27_20-30-25.png)

	**Статус блока**: [unstable](https://github.yandex-team.ru/lego/islands-guidelines/blob/master/blocks-stabilization.md) (API блока в разработке).

	Блок `suggest2` («саджест») используется для создания поисковых подсказок, которые всплывают в окне под поисковой строкой при вводе запроса. Список подсказок обновляется по мере набора новых букв или слов.

	Блок предоставляет следующие возможности:

	* изменять [стилевое оформление](#mods-theme) и [размер](#mods-size) саджеста;
	* [группировать поисковые подсказки](#mods-group);
	* [адаптировать ширину](#mods-adaptive) саджеста при изменении размеров страницы браузера;
	* отображать подсказки только определенных [типов](#mods-type) в результате запроса;
	* включать режим [пословного автодополнения](#mods-complete) для мобильных устройств;
	* подключать к саджесту блоки [input](сommon.blocks/suggest2-input/suggest2-input.ru.md) и [popup](сommon.blocks/suggest2-popup/suggest2-popup.ru.md) из различных библиотек (как собственных – `islands-*`, так и сервисов);
	* подключать [счетчик](сommon.blocks/suggest2-counter/suggest2-counter.ru.md) отправки запроса;
	* настраивать [параметры запроса](#js-params) к серверу саджеста.

1. [Video Components](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/video-components)


	Общедоступные компоненты сервиса Видео на React.

1. [yaplus](https://github.yandex-team.ru/lego/islands/tree/dev/contribs/yaplus)


	Промо-блок для Яндекс.Плюс.
	Представляет собой ссылку, которая, в зависимости от состояния аккаунта (подключен или не подключен Яндекс.Плюс) ведет соответственно либо в пользовательские настройки, либо на страницу Я.Плюс.

	Если Яндекс.Плюс не подключен (то есть при наличии модификатора `_available_yes`), блок дополняется промо-тултипом.

	<a name="mods"></a>