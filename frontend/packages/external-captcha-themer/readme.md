# –¢–µ–º–∏–∑–∏—Ç–æ—Ä –≤–Ω–µ—à–Ω–µ–π –∫–∞–ø—á–∏

–í–∏–¥–∂–µ—Ç —Ç–µ–º–∏–∑–∞—Ç–æ—Ä –¥–ª—è –≤–Ω–µ—à–Ω–µ–π –∫–∞–ø—á–∏.
–í–∏–¥–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è SPA-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–∏–¥–∂–µ—Ç–∞ - –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –µ–≥–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ iframe. –û–±—â–µ–Ω–∏–µ —Å iframe'–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ post-message.

## üîó –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

* [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
* [API](#api)
* [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```html
<script>
  function handleThemerReady(event) {
    if (event.data === 'themer-ready') {
      // –ó–Ω–∞–µ–º —á—Ç–æ themer —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–µ–ª–∞–µ–º —á—Ç–æ —Ö–æ—Ç–∏–º...
      // –ù–∞–ø—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
      event.source.postMessage({
        type: 'single',
        payload: {
          name: 'variable-name',
          value: 'new-variable-value'
          }
        });

      // –£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
      window.removeEventListener('message', handleThemerReady);
    }
  }

  window.addEventListener('message', handleThemerReady);
</script>

<iframe src="https://captcha-test.yandex-team.ru/themer.html"></iframe>
```

## API

–û–ø–∏—Å–∞–Ω–∏–µ API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–∂–µ—Ç–æ–º.

### –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

–î–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```js
// –ü–µ—Ä–µ–¥–∞—á–∞ –æ–¥–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
iframe.postMessage({
  type: 'single',

  payload: {
    name: 'variable',
    value: 'value'
  }
});

// –ü–µ—Ä–µ–¥–∞—á–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.
iframe.postMessage({
  type: 'multiple',

  payload: [
    {
      name: 'variable1',
      value: 'value1'
    },
    {
      name: 'variable2',
      value: 'value2'
    },
  ]
});

// –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ.
// –î–ª—è –∫–ª—é—á–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ —É–∫–∞–∑–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é.
iframe.postMessage({
  type: 'json',

  payload: {
    'variable1': 'value1',
    'variable2': 'value2',
  }
});

```

### –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–ø—á–∏.
–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ(—Å –≥–∞–ª–æ—á–∫–æ–π), –∑–∞–≥—Ä—É–∑–∫–∞(—Å–æ —Å–ø–∏–Ω–µ—Ä–æ–º), –æ—à–∏–±–∫–∞.

```js
iframe.postMessage({
  type: 'status',

  // –°–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: 'default', 'success', 'loading', 'error'
  payload: 'success',
});
```

### –ú–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –∫–∞–ø—á–µ. –ü–∞—Ä–∞–º–µ—Ç–µ—Ä –º–µ–Ω—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É.
–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –ø—Ä–æ—Å—Ç–æ–π, —Å—Ä–µ–¥–Ω–∏–π, —Å–ª–æ–∂–Ω—ã–π.

```js
iframe.postMessage({
  type: 'complexity',

  // –°–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: 'easy', 'medium', 'hard'
  payload: 'hard',
});
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm ci`.
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–≤-—Å–µ—Ä–≤–µ—Ä: `npm run start`.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤: `npm t`.

–ó–∞–ø—É—Å–∫ hermione-—Ç–µ—Å—Ç–æ–≤ –±–µ–∑ gui: `npm run hermione:build && npm run hermione:test`.

–ó–∞–ø—É—Å–∫ hermione-—Ç–µ—Å—Ç–æ–≤ —Å gui: `npm run hermione:build && npm run hermione:gui`.


### –ë–∏–ª–¥

–ë–∏–ª–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–º–∞–Ω–¥–æ–π: `npm run build`.

### –í—ã–∫–ª–∞–¥–∫–∞

–í—ã–∫–ª–∞–¥–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Ä—É—á–Ω—É—é. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ @tyamgin.
