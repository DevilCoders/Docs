# <%= projectName %>

- [Подготовка](#Подготовка)
- [Установка и запуск](#Установка-и-запуск)
- [Вопросы безопасности](#Вопросы-безопасности)
    - [Закрываем хэлсчеки от внешних пользователей](#Закрываем-хэлсчеки-от-внешних-пользователей)
    - [Делимся секретами для локальной разработки с командой](#Делимся-секретами-для-локальной-разработки-с-командой)<% if (shouldAddTanker) { %>
- [Интернационализация](#Интернационализация)
    - [Сборка](#Сборка)
    - [Ключи в Танкере](#Ключи-в-танкере)
    - [Как использовать](#Как-использовать)
        - [Как функция](#Как-функция)
        - [Как компонент](#Как-компонент)<% } %><% if (shouldComposeWithMonitorado) { %>
- [Мониторинги](#Мониторинги)<% } %>
- [Доступные команды](#Доступные-команды)
- [Документация](#Документация)

## Подготовка

Для работы потребуется Node.js 10.

Для начала [устанавливаем Brew](https://wiki.yandex-team.ru/spec/devops/kakustanovitbrew/). Затем:

```bash
# Устанавливаем NVM (не забываем выполнить инструкции от Brew в секции Caveats)
brew install nvm

# Устанавливаем Node.js 10 версии
nvm install 10
```

## Установка и запуск

```bash
# Устанавливаем зависимости
npm run deps

# Запускаем приложение (magicdev запросит ваш пароль, чтобы запустить его на 443 порту).
# По необходимости, вы может задать другой порт, не требующий sudo, в файле .magicdev.json.
npm run dev
```

Проект становится доступен по адресу:
https://localhost.msup.yandex.ru/

## Вопросы безопасности

### Закрываем хэлсчеки от внешних пользователей

Из коробки стаб предлагает хелсчеки для отслеживания состояния необходимых смежных сервисов (например, доступность чёрного ящика, геобазы и базы данных). Пути, за которыми они скрыты, могут быть использованы для создания HTTP juggler-проверок в Qloud.

> :warning: Для того, чтобы эти пути не стали доступны внешним пользователям на публичном домене, необходимо в Qloud создать путь `/healthchecks/` и направить его в компоненту типа _http-balancer_, в параметре _Servers_ указав `http://any.yandex.ru/`.

### Делимся секретами для локальной разработки с командой

В результате генерации создан не публичный файл _.tvm.json_, который хранит настройки утилиты для раздачи TVM тикетов.

> :warning: Ни в коем случае не публикуйте этот файл в репозиторий! Для того, чтобы поделиться им с командой [заведите хранилище](https://wiki.yandex-team.ru/security/secdist/#formanazavedeniezajavki) в Secdist и [разместите его](https://wiki.yandex-team.ru/security/secdist/#rabotasobychnymifajjlamiproektnajapapka) в нём.

<% if (shouldAddTanker) { %>
## Интернационализация

### Сборка

Для каждого языка собирается отдельный бандл.
Список языков для которых осуществляется сборка указан в файле *configs/defaults.ts*.

> :bulb: Для ускорения локальной разработки этот список можно сократить в файле *configs/local.ts*

### Ключи в Танкере

Параметры в теле ключа должны быть в формате `{param_name}`.
Для выбора правильного склонения **plural** ключа используется специальный параметр `count`.

### Как использовать

#### Как функция

```typescript jsx
import i18n from 'client/utils/i18n';

// Результат вызова этой функции - строка
// Эта функция особенно полезна в случае если нужно передать именно строку
// Например placeholder в <input />
const string = i18n.text({
    key: 'key_id',        // Идентификатор ключа в Танкере
    keyset: 'keyset_id',  // Идентификатор кейсета в Танкере
    params: {             // В качестве параметров могут быть только строки или числа
        param_1: 'value_1',
        param_2: 'value_2'
    }
});

// Результат вызова этой функции - ReactElement
// Полезно если в качестве параметров хочется использовать компоненты
// Или если необходимо вставить контент без экранирования
const reactElement = i18n.element({
    escape: true,          // Нужно ли экранировать содержимое ключа и параметров (По умолчанию `false`)
    key: 'key_id',
    keyset: 'keyset_id',
    params: {              // В качестве параметров может быть что угодно, что может отрендерить React
        param_1: 'value_1',
        param_2: <button>Click me</button>
    }
});
```

#### Как компонент

```typescript jsx
import I18N from 'client/components/i18n';

<I18N
    escape
    id="key_id" // Используется атрибут "id" т.к. "key" в React зарезервирован
    keyset="keyset_id"
    param={{
        param_1: 'value_1',
        param_2: <button>Click me</button>
    }}
/>
```
<% } %>
<% if (shouldComposeWithMonitorado) { %>
# Мониторинги

В файле [.monitorado.yml](./.monitorado.yml) находится конфиг с настройками для мониторингов.
Про формат конфига и утилиту Monitorado можно почитать в [документации](https://github.yandex-team.ru/toolbox/monitorado).

> :bulb: Если мониторинги срабатывают слишком часто, просто поменяйте граничные значения в конфиге и заново запустите настройку.

Команды для управления мониторингами перечислены ниже.

> :warning: Не забудьте получить все необходимые [токены](https://github.yandex-team.ru/toolbox/monitorado#Токены).

<% } %>

## Доступные команды

Команда | Действие
------------ | -------------
deps | Установка зависимостей
dev | Запуск tvmtool и приложения для локальной разработки
build | Запуск production сборки скриптов и стилей
lint | Проверка TypeScript и CSS кода на codestyle
test | Запуск тестов <% if (shouldComposeWithMonitorado) { %>
monitoring:diff | Показывает, что будет сделано при настройке мониторингов
monitoring:exec | Настраивает мониторинги согласно конфигу
<% } %>

## Документация

* [Гайды по использованию проектов на основе Project Stub](https://wiki.yandex-team.ru/toolbox/project-stub/)
