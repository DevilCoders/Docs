Страница с большим контентом
<--delimiter-->
Проверяем общую скорость работы, страницы содержит большое количество контента с различными элементами
<--delimiter-->
{{TOC to="h2"}}

==!!Правила наименования параметров!!
При именовании client_id следует использовать латинские буквы a-z, A-Z, цифры, нижнее подчеркивание _, тире, точку, и только их.
В название каждого параметра добавляем символ типа параметра (перечислены ниже), почёркивание и далее название параметра. Например, "params":{"a_parametr":"1"}.
**Кратко суть префиксов:**
a_ - считаются отправки всех вариантов значения параметра
с_ - считаются суммы значений параметров
без префикса - считаются отправки этого параметра

Типы параметров
  * событийные параметры: когда интересует произошло ли событие, стоит именовать a_parameter.
    Например %%client_id=instaserp2%%, параметры %%a_block_actions%%, %%a_block_types_shown%%
  * накопительные параметры: когда интересует сколько раз произошло событие (в лог приходит накопленное число), стоит именовать c_parameter. Их в результате хочется складывать. Пример %%client_id=tablo%%, параметр %%bc%%
Параметры вида a_ будут разворачиваться в ((https://stat.yandex-team.ru/Chromium/Adhoc/BrowserFeatures/client_id_country_ver отчете)), т.е. будут видны их значения: https://jing.yandex-team.ru/files/stasya/%D0%9F%D0%9E%20-%20%D0%91%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80%D1%8B%20-%20Chromium%20_%20%D0%A0%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%B5%20%D1%80%D0%B0%D1%81%D1%87%D0%B5%D1%82%D1%8B%20-%20%D0%94%D0%B0%D1%88%D0%B1%D0%BE%D1%80%D0%B4%20-%20%D0%9E%D0%B1%D1%89%D0%B8%D0%B9%20%D0%BE%D1%82%D1%87%D0%B5%D1%82%20%D0%BF%D0%BE%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D0%BC%20%D0%B1%D0%B0%D0%BD%D0%B4%D0%BB%D0%BE%D0%B2%20_%20Statface%20-%20%D0%9E%D1%82%D1%87%D0%B5%D1%82%D1%8B%20-%20Mozilla%20Firefox%202017-04-19%2020.00.38.png
Если параметр не имеет префиксов a_, c_, каждый раз когда он встречается, учитывается при обсчете 1 раз.
Такие параметры, как и c_, не разворачиваются в ((https://stat.yandex-team.ru/Chromium/Adhoc/BrowserFeatures/client_id_country_ver отчете)) https://jing.yandex-team.ru/files/stasya/%D0%9F%D0%9E%20-%20%D0%91%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80%D1%8B%20-%20Chromium%20_%20%D0%A0%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%B5%20%D1%80%D0%B0%D1%81%D1%87%D0%B5%D1%82%D1%8B%20-%20%D0%94%D0%B0%D1%88%D0%B1%D0%BE%D1%80%D0%B4%20-%20%D0%9E%D0%B1%D1%89%D0%B8%D0%B9%20%D0%BE%D1%82%D1%87%D0%B5%D1%82%20%D0%BF%D0%BE%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D0%BC%20%D0%B1%D0%B0%D0%BD%D0%B4%D0%BB%D0%BE%D0%B2%20_%20Statface%20-%20%D0%9E%D1%82%D1%87%D0%B5%D1%82%D1%8B%20-%20Mozilla%20Firefox%202017-04-19%2020.03.11.png

Как это выглядит в логе:
  * Параметры с числовыми значениями
%%
  {
    "client_id": "bookmarks",
    "params": {
        "all_q": 1,
        "bar_q": 1,
        "fldrs": 3,
        "sfldrs": 0,
        "tr_flrds": 1
    }
  }
  %%
  * Параметры-словари
<{ Пример %%client_id=PluginInfo%%, параметр %%plugins%%
%%
{
    "client_id": "PluginInfo",
    "params": {
        "plugins": [
            {
                "count": 2,
                "name": "Java(TM) Platform SE 7 U9",
                "path": "C:\\Program Files (x86)\\Java\\jre7\\bin\\plugin2\\npjp2.
dll",
                "version": "10.9.2.5"
            },
            {
                "count": 2,
                "name": "Yandex Media Plugin",
                "path": "C:\\Users\\boriay\\AppData\\Local\\Yandex\\YandexBrowserS
xS\\Application\\22.0.1102.167\\plugins\\npmedia_plugin.dll",
                "version": "220.1102.167"
            }
        ]
    }
}%%}>
  * Список (шлется все подряд, приходится привязываться к позиции в списке)
<{ Пример %%extension%% для %%client_id=instextens%%
    %%{
    "client_id": "instextens",
    "params": {
        "extension": [
            [
                "ahfgeienlihckogmohjhadlkjgocpleb",
                "0.2",
                "Магазин приложений",
                false,
                "oth"
            ],
            [
                "cegaacafklagkioanifdoaieklociapj",
                "1.0",
                "BookReader",
                false,
                "oth"
            ]
        ]
    }
}%%}>

Важно понимать, что в отчете по параметрам бандлов https://stat.yandex-team.ru/Chromium/Adhoc/BrowserFeatures/client_id_country_ver
разворачивание происходит только на 2 уровня максимум. Т.е. %%client_id -> имя_параметра -> значение_параметра%% (значение опционально)
Это означает, что для примера выше с плагинами имя плагина не будет подтягиваться в отчет.
При этом все названия параметров в отчет подтягиваться будут, потому не стоит логировать таким образом (без необходимости) технические данные. Отчет точно обвалится, если в название параметра записать значение. Например %%"params":{"5040":"1"}%%, название параметра 5040 - плохо.
<{ Старое описание
Типы параметры и соответствующие им символы:
  * (c) накопительные - их в результате хочется складывать (как с метриками табло)
  * (a) событийные - в них отправляется подтип события, в них нужно считать число присланных посылок для каждого подсобытия (таких очень много в статистике импорта, например)
  * (l) "листовые" - отправляется некий список чего-то, по ним как правило нужен топ (список тумб табло, популярных сайтов и тп)
  * (h) "листовые ужасные" - шлется списком вообще все подряд, тут нужно привязываться к позиции в списке, все плохо (как с омнибоксом)
  * (e) возможно, есть еще что-то непонятно что
}>

===Safe Browsing Q2
====Файлы ("client_id":"kavdetect")
=====Отправляемая статистика:
  *Срабатывания предупреждений о возможной зараженности файла ("showinf":"1")
  *Количество нажатий "сохранить" после детектирования ("presssave":"1").
=====Примеры посылок в бандле
"client_id":"kavdetect","params":{"presssave":"1"}
"client_id":"kavdetect","params":{"showinf":"1"}
=====Таски
BROWSER-1575
====Страницы ("client_id":"sburl")
=====Отправляемая статистика:
  *Урл страницы, на которой сработало предупреждение ("mainurl":"" )
  *Урл внешнего зараженного ресурса ("suburl":"") !! может отсутствовать, если в SB базах размечен сам "mainurl"
  *Пользователь нажал "игнорировать" ("a_ignore":"1")
  *Пользователь нажал "уйти со страницы" ("a_away":"1")
  *Пользователь перешел на страницу с подробностями о заражении ("a_moreinfo":"1")
  *Показ инфобара с предложением включить Сейфбраузинг («ib_show»:"1") (**начиная с версии 15.6**)
  *Включение Сейфбраузинга через инфобар («ib_on»:"1") (**начиная с версии 15.6**)
  *Параметр эксперимента с увеличением количества чанок при загрузке («sbd»:"1") (**начиная с версии 15.9**)
  Принимает значения: 0 - нет эксперимента (отправляется в 80% случаев), 1 - увеличеное количество (10%), 2 - контрольная группа (10%).
  *Сброс настройки ya.all_sb_chunks_downloaded_time при ошибке в базах («scd_time»:"1") (**отправляется начиная с 16.2**)
  *Тип предупреждения. Принимает значения от 1 до 4. («type»:"1") (**начиная с версии 16.2**)
    1 - смс-фрод
    2 - фишинг
    3 - малварь
    4 - обертки
    5 - мобильные подписки

=====Примеры посылок в бандле
"client_id":"sburl","params":{"mainurl":"http://asidorov.nm.ru/malware-script-upload.htm","suburl":"http://wmconvirus.narod.ru/test.js"}
"client_id":"sburl","params":{"mainurl":"http://wmconvirus.narod.ru/test.js"}

=====Таски
BROWSER-125
STATADHOC-6301

====**Начиная с версии 14.12 страницы вынесены на внешние урлы** ====
Статистика ведется в метрике:
https://metrika.yandex.ru/stat/dashboard/?counter_id=26110104
Доступна по подтвержденному менеджерскому логину типа yndx.***
https://jira.yandex-team.ru/browse/BROWSER-23567

=====ТЗ
http://wiki.yandex-team.ru/browser/manplanning/Safebrowsing


====Мобильные подписки ("client_id":"sbmobsubs")
=====Отправляемая статистика:
  *Показ страницы с предупреждением ("show":"1")
  *Пользователь нажал "Перейти и платить" ("ignore":"1")
  *Пользователь нажал "Уйти со страницы" ("away":"1")
=====Примеры посылок в бандле
"client_id":"sbmobsubs","params":{"ignore":"1"}
"client_id":"sbmobsubs","params":{"show":"1"}


===Проблемы с проигрыванием медиаконтента WIN ("client_id":"MediaFailed")
=====Отправляемая статистика
  *MU
Источник медиаконтента (URL).
  *PU
URL страницы
=====Пример посылок в бандле
%%
{"client_id":"MediaFailed","params":{"MU":"http://elisto03d.music.yandex.ru/get-mp3/fa129412b2020e9a5e35f704b46a6180/508907fc/14/data-0.1:76992070553:3465299?track-id=770968&from=service","PU":"http://music.yandex.ru/#!/top/tracks/genre/country"}}
%%
Таск
BROWSER-3452
===Использование плагинов в браузере ("client_id":"PluginInfo")
=====Отправляемая статистика
  *count
Количество использований плагина за последние 10 минут.
  *name
Название плагина
  *path
Путь до файла модуля плагина
  *version
Версия плагина
=====Пример посылок в бандле

%%
    {"client_id": "PluginInfo",
    "params": {
        "plugins": [
            {
                "count": 2,
                "name": "Java(TM) Platform SE 7 U9",
                "path": "C:\\Program Files (x86)\\Java\\jre7\\bin\\plugin2\\npjp2.dll",
                "version": "10.9.2.5"
            },
            {
                "count": 2,
                "name": "Yandex Media Plugin",
                "path": "C:\\Users\\boriay\\AppData\\Local\\Yandex\\YandexBrowser
                SxS\\Application\\22.0.1102.167\\plugins\\npmedia_plugin.dll",
                "version": "220.1102.167"
            },
            {
                "count": 7,
                "name": "Shockwave Flash",
                "path": "C:\\Users\\boriay\\AppData\\Local\\Yandex\\YandexBrowser
                SxS\\Application\\22.0.1102.67\\plugins\\npswf32_11_5_502_135.dll",
                "version": "11,5,502,135"
            }
        ]
    } }
%%

Обязательны посылки об использовании встроенных в браузер плагинов:
Win: Native Client, Yandex PDF Viewer, Yandex Media Plugin, Flash.
Mac: Native Client, Yandex PDF Viewer, Flash.

Таск
BROWSER-3472

===Просмотр файлов PDF ("client_id":"PDFView")
=====Отправляемая статистика
======Постоянные параметры бандла
  *URL
URL источника просматриваемого PDF файла. Если файл открывается локально, пишем "URL":"file://file_adress".
<{*PC (PageCounter) - не будет в Хромиумном PDF-плагине
Количество страниц открываемого документа.}>
  *T (Time)
Время в минутах с момента открытия документа    во вкладке до закрытия этой вкладки. Максимальное значение - 30 минут, после этого считать перестаем.
<{*SM - не сделали
  1 - если документ пришел от SoftMaker-а, 0 - иначе}>
======Дополнительные параметры бандла
  *IB (InfoBar)
Инфобар, который появляется при наличии заголовка  content-disposition со значением attachment. Параметр принимает различные значения, в зависимости от действий пользователя. Если пользователь ничего не сделал с инфобаром, то параметр принимает значение NA, при нажатии на крестик закрытия инфобара - CS, при нажатии на кнопку сохранить - SV.
  *P (Print)
Печать документа из правой панели браузера. Параметр отправляется при нажатии на кнопку печать, и принимает два значения - A (All) и D (Диапазон). //Отправляется в основной посылке после закрытия страницы с pdf//
  *S (Save)
Сохранение файла, значение параметра - количество сохранений (нажатия на кнопку). //Отправляется в основной посылке после закрытия страницы с pdf//
<{Статистика для АЗ (не сделали)
Добавляем параметр "AS". Параметр принимает значение в зависимости от первой причины, по который не сработала АЗ.
  *1
Использование асинхронной загрузки не имеет смысла, т.к. документ был загружен одним блоком. (Такое может быть если документ не линеаризован к примеру).
  *2
Сервер не возвращает заголовок Content-Length.
  *3
Сервер не возвращает заголовок Accept-Ranges: bytes.
  *4
Сервер сжимает данные (присутствует заголовок Content-Encoding со значение, отличным от identity.
  *5
Запрос был сделан методом POST.
  *6
Размер документа слишком маленький.
  *100
Другая причина.

Передаём цифровое значение в строковом формате, например, "AS":"1"}>

======Статистика документов, которые не удалось открыть (в разработке)
  *"E":"1" (Error)
Параметр со значением отправляется в случае, если документ не удалось открыть.

=====Пример посылок в бандле
%%
{"client_id":"PDFView",
"params":{"URL":"http://","PC":"24","T":"30","IB":"SV","P":"D", "S":"1"}}
%%

====Таски
BROWSER-5575
DISTRANALYTICS-437
===+Страница Feedback (!!не актуально!!)
====Отправка фидбека ("client_id":"FeedbackPage")
=====Отправляемая статистика
  *CLCK
Значение параметра формируется максимум из пяти цифр, которые обозначают последовательность открытия каждого из вопросов из топ5, например 12345, если пункты были открыты по порядку.
  *EMAIL
Параметр отправляется при заполнении поля EMAIL, значение - 1.
  *URL
Параметр URL отправляется всегда. При этом, если пользователь снял галочку – 0, не трогал – 1.
  *IMG
Параметр отправки скриншотов. Значения - U для пользовательского, D для дефолтного, обоих – UD.
  *STS
Статус отправки фидбека. Параметр появляется при нажатии на кнопки "Отмена" или "Отправить" со значениями CNCL и SND соответственно.

=====Пример посылок в бандле
%%
{"client_id":"FeedbackPage",
"params":{"CLCK":"12345","EMAIL":"1","URL":"1","IMG":"U","STS":"SND"}}
%%

=====Таски
BROWSER-6426
===Импорт настроек
====Автоматический импорт ("client_id":"ImportFirstRun")
=====Отправляемая статистика
  *VR
**Параметр имени Виталия Реброва VR** означает принятое решение, по какой схеме произошел импорт:
- IUA (Import from User-Agent's Browser)-  из браузера, откуда скачали
- IDB (Import from Default Browser) импорт из дефолтного браузера.
- IF (Import Failed) при отсутствии импорта
Если импорт из дефолтного браузера произошел по причине протухания даты (2 дня), то импорт происходит из дефолтного браузера и параметр имени Виталия Реброва (VR) принимает значение – "IDBOD" (import from default browser old data)
  *UA
Параметр UA определяет значение браузера согласно Юзер Агенту, с которым пришли на нашу страницу и скачали браузер. Параметры UA  и DB принимают значения из одного множества. Если UA определить и правильно передать в браузер не удалось – значение этого параметра NA. Аналогично с версией UAV, ставим параметр NA.

//для mac по причине не использования дистрибуционных данных пармаетр VR всегда будет равен IDB, а UA, UAV не будут принимтаь никакие значения//

  *UAV
Параметр UAV принимает значение версии из юзерагента в полном виде, а название браузера, из которого мы умеем делать импорт в параметре UA, будет отправляться согласно ((https://jira.yandex-team.ru/browse/BROWSER-4649 описанному и согласованному)) с кем:greyevil ((http://wiki.yandex-team.ru/users/vitreb/DefaultBrowser#podderzhivaemyebrauzeryiixjuzer-agenty формату)).
  *DB
По прежнему отправляем дефолтный браузер в системе параметром "DB". При этом, если дефолтный браузер  определить не удалось, то отправляем не DBIF, а ставим дефолтный браузер NA, по аналогии с юзерагентом. То есть, отправляется "DB":"NA"
  *EXT Extensions
Расширения. Параметр принимает значение <имя;версия> расширения, значения отправляются массивом. Значение "имя" имеет стандартный формат json-строки, то есть, например, может иметь вид
Client_id ImportFirstRun — параметр E
Client_id ImportManual — параметр E
Параметр E - Если он присутствует, то происходил импорт расширений, если его нет - то не было импорта расширений. Значение у параметра всегда единичка.

*VB Visual Bookmarks
Визуальные закладки. Принимает значение 1, если были импортированы визуальные закладки.

__**Ниже описаны --альтернативные(взаимоисключающие)-- параметры событий, значение которых всегда "-1"**__
  *IS
Параметр Import_Succeed
Успешный импорт без показа окна закрытия браузера.
  *IC
Параметр Import_Cancelled
Отмена успешного импорта, произошедшего без показа окна закрытия браузера.


=====Пример посылок в бандле
%%
{"client_id":"ImportFirstRun",
"params":{"VR":"IUA","UA":"Opera64","UAV":"12.0","DB":"Firefox", "IS":"-1, "EXT":["Gestures for Chrome(TM) Plus;1.12.1.5","Evernote Web Clipper;5.7"]}}
%%

=====Таски
BROWSER-5784
BROWSER-4528
BROWSER-3565
====Ручной импорт ("client_id":"ImportManual")
=====Отправляемая статистика
  *IB
Браузер, из которого сделан импорт
Значения параметра IB - “MSIE”, “Firefox”, “Firefox”, “Opera”, “Opera”, “GoogleChrome”, “YandexChrome”, “YandexInternet”, “YandexBrowser”, “MailruChrome”, “Amigo”, “Safari”.
======Импортируемые настройки:
1. История просмотров
  *H history
2. Закладки
  *F Favorites
3. Пароли
  *P Passwords
4. Поисковые системы
  *SE Search Engines
5. Cookies
  *C Cookies
6. Вкладки. Значение параметра "T" (tabs)определяет количество импортируемых табов из всех окон.
  *T Tabs
7. Окна. Значение параметра "W"(windows) означает количество окон по информации из сохраненной сессии.
  *W Windows
8. Закрытые окна
  *CW Closed Windows. Параметр "CW" определяет количество закрытых окон в случае, когда браузер, из которого производится импорт был открыт.
9. Другие настройки
  *OS Other Settings
10. Расширения. Параметр принимает значение <имя;версия> расширения
  *EXT Extensions
11. Визуальные закладки. Принимает значение 1, если были импортированы визуальные закладки.
  *VB Visual Bookmarks
12. Место совершения импорта. Принимает значения: A) "Infobar",  B) "Menu",  C) "BookmarksBar", D) "Settings" в зависимости от того, откуда был вызван импорт соответственно: A) Клик по кнопке инфобара предложения импорта B) Меню (бутерброд) > Закладки > Импортировать, C) Клик по пустой панели закладок, D) Со страницы настроек.
  *IL Import Launch

Значения остальных параметров всегда – "1"
=====Примеры посылок в бандле
При импорте  json  выглядит следующим образом:
%%
{"client_id":"ImportManual",
"params":{"IB":"Opera64","H":"1","F":"1","P":"1","SE":"1","C":"1","W":"2","CW":"5","T":"15","OS":"1","IL":"Menu","EXT":["Gestures for Chrome(TM) Plus;1.12.1.5","Evernote Web Clipper;5.7"]}}
%%
=====Таск
BROWSER-4036
BROWSER-3502
====При при клике в инфобар на ссылку ручного импорта при втором запуске браузера отдельно отправляется bundle ("client_id":"ImportSecondRun)
%%
{"client_id":"ImportSecondRun,"params":{"-1":"-1"}}
%%
((http://jing.yandex-team.ru/files/stikhomirov/2012-12-24_1416.png? Скриншот.))
====При клике на ссылку из пустой панели закладок отдельно отправляется bundle ("ImportFromPanel")
%%
{"client_id":"ImportFromPanel","params":{"-1":"-1"}}
%%

((http://jing.yandex-team.ru/files/stikhomirov/2012-12-19_2004-2.png? Скриншот))
====При смене источника импорта в активации отдельно отправлять бандл ("ImportSourceChanged")
В парамерт sourceInAutoimport записать браузер, который был автоматически выбран для импорта ранее, а в параметр SourceInActivation записать выбранный браузер при активации
%%
{"client_id":"params":{"SourceInAutoImport":"Opera", "SourceInActivation":"Firefox"}}
%%


===Переводчик на балунах  ("client_id":"trnsltbln")
https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#statistika

https://st.yandex-team.ru/BROWSER-74523

client_id : **trnsltbln**

**a_suggest** - статистика использования балуна с предложением перевода
* show - появление балуна с запросом на перевод (((https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#predlozhenieperevoda пример)))
* showwithper - появление балуна с запросом на перевод + галочка (((https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#predlozhenieperevoda пример)))
* close - нажатие на крест
* misclick - мисклик на бабл
* anolang - нажатие на "Перевести на другой язык"
* transl - нажатие на желтую кнопку "Перевести"
* no - нажатие на "Не сейчас"
* drop - нажатие на кнопку-стрелку, которая вызывает выпадающий список
* dropnvrlang - нажатие на "Никогда не переводить с $" в выпадающем меню, где $ это исходный язык страницы
* dropnvrsite - нажатие на "Никогда не переводить этот сайт" в выпадающем меню
* dropabout - нажатие на "о переводчике" в выпадающем меню
* checkalw - клик на чекбоск "Всегда переводить"

**a_manual** - статистика использования балуна с выбором исходного языка и финального языка для перевода
* show - появление балуна с ручным выбором языка с которого переводить и на который переводить (((https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#nastrojjki пример)))
* close - нажатие на крест
* misclick - мисклик на бабл
* transl - нажатие на желтую кнопку "Перевести"
* no - нажатие на "Не сейчас"
* drop - нажатие на кнопку-стрелку, которая вызывает выпадающий список
* dropnvrlang - нажатие на "Никогда не переводить с $" в выпадающем меню, где $ это исходный язык страницы
* dropnvrsite - нажатие на "Никогда не переводить этот сайт" в выпадающем меню
* dropabout - нажатие на "о переводчике" в выпадающем меню
* checkalw - клик на чекбоск "Всегда переводить"
* selfrom - выбор языка из списка SELECT "язык страницы"
* selto - выбор языка из списка SELECT "перевести на"

**a_prog** - статистика использования балуна с прогрессом
* show - появление progress балуна (((https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#processperevoda пример)))
* close - нажатие на крест
* misclick - мисклик на бабл

**a_succ** - статистика использования балуна success
* show - появление балуна с результатом (((https://wiki.yandex-team.ru/browser/tz/translate_bubbles/#rezultat пример)))
* close - нажатие на крест
* misclick - мисклик на бабл
* drop - нажатие на кнопку-стрелку, которая вызывает выпадающий список
* dropalwlang - нажатие на "Всегда переводить с $$" в выпадающем меню, где $$ это исходный язык страницы
* dropnvrlang - нажатие на "Никогда не переводить с $" в выпадающем меню, где $ это исходный язык страницы
* dropnvrsite - нажатие на "Никогда не переводить этот сайт" в выпадающем меню
* dropabout - нажатие на "о переводчике" в выпадающем меню
* origin - нажатие на "показать оригинал"
* anolang - нажатие на "Перевести на другой язык"

**a_err** - статистика использования балуна error
* show - появление балуна с ошибкой
* close - нажатие на крест
* misclick - мисклик на балун
* tryagain - нажатие на "повторить попытку"

**a_turnoffat** - статистика использования балуна отключения автоперевода
* show - появление балуна
* close - нажатие на крест
* misclick - мисклик на бабл
* yes - клик на кнопку с согласием (желтую)
* no - клик на кнопку с отказом (серую)

**a_turnoffsug** - статистика использования балуна отключения предложения на перевод
* show - появление балуна
* close - нажатие на крест
* misclick - мисклик на бабл
* yes - клик на кнопку с согласием (желтую)
* no - клик на кнопку с отказом (серую)

**url** - ссылка на которой произошел перевод
**mlangfrom** -  с какого языка вручную переводили
**mlangto** - на какой язык вручную переводили
**alangfrom** - с какого языка автоперевелось
**alangto** -  на какой язык автоперевелось
**omniclck** - клик на омнибокс
**omnishow** - 1, по факту появления иконки в омнибоксе (с 18.4.0)

===Постраничный переводчик ("client_id":"pagetranslate")
=====Отправляемая статистика:
  * показ инфобара с предложением перевести (так же отсылается автоматически определённый язык): {shows:["1","en"]}
  * нажатие кнопки "Перевести": ключ trans. В ключе trans, кроме количества нажатий на кнопку, отправляются данные о том, с какого языка, на какой был выполнен перевод, а также наименование языка, если его выставил пользователь самостоятельно. Например, при нажатии кнопки "Перевести" с английского на русский - { "client_id": "pagetranslate", "params": { "trans": [ "1", "en", "ru", "de" ], "url":["1","http://de.wikipedia.org/wiki/Fernsehen"] }
  * автоматический перевод: ключи transanext (после перехода внутри домена с переведённой страницы) и transalang (после открытия страницы, определённый язык которой добавлен в белый список). В этих ключах, кроме количества переводов, отправляются данные о том, с какого языка, на какой был выполнен перевод. Например, автоперевод с немецкого - { "client_id": "pagetranslate", "params": { "transalang": [ "1", "de", "ru"], "url":["1","http://de.wikipedia.org/wiki/Fernsehen"] }
  * нажатие кнопки "Нет" или крестика закрытия именно инфобара с предложением перевода - nope, в ключе так же добавляются языки, с которых и на которые должен быть перевод. Например, {nope: ["1", "en", "ru"]}
  * Контролы из меню "Настройки":
    * нажатие "Всегда переводить lang на lang" - alwaystrans, например {alwaystrans: ["1", "de", "uk"]}
    * нажатие "Никогда не переводить lang" - nevertrans, например {nevertrans: ["1", "fr"]}
    * нажатие "Никогда не переводить этот сайт" - nevertranssite
  * Из меню настроек браузера:
    * снятие/установка флажка "Предлагать перевод страниц..." - turnoff, для снятия передаем значение 1, для установки - 0. Например {turnoff: "1"}
  * Из контекстного меню:
    * нажатие кнопки "Перевести на lang" - transcont. Например, {transcont: "1", "en", "ru"}, по аналогии с trans.

**В параметре url в случае нажатия на контролы: «Перевести», «Нет», контрол из меню «Настройки» и из контекстного меню — пишется урл страницы, на которой был нажат контрол.**
**То есть этот параметр всегда отправляется вместе с: trans, transanext, transalang, nope, alwaystrans, nevertrans, nevertranssite, transcont.**
**Не отправляется с: shows и turnoff (при показе инфобара и отключении).**

=====Примеры посылок в бандле:
%%{"client_id":"pagetranslate","params":{"trans":["1","de","ru"],"url":["1","http://de.wikipedia.org/wiki/Fernsehen"]}}
"client_id":"pagetranslate","params":{"turnoff":1}
%%

=====Таски:
  * BROWSER-2331
  * BROWSER-3484
  * BROWSER-9485
  * BROWSER-20338
=====ТЗ
http://wiki.yandex-team.ru/browser/manplanning/Pagetranslator

https://st.yandex-team.ru/BROWSER-104916
a_detectionlog
* cld
* cld_is_reliable
* html
* cl
* api
* adopted_language
* url
* request_id - хеш (id пользователя + таймстемп + случайное число)


===Пословный/пофразовый переводчик ("client_id":"translate")
<{Актуально до Chromium 44
=====Отправляемая статистика:

  * смена языка — %%(json){"change_language_from": 1, "language": value}%%
  * переход на сервис — %%(json){"open-service": 1, "type": type}%%, где type = word | phrase
  * свершившийся акт перевода —
%%(json)
{
  "from": from,
  "to": to,
  "page": this.pageLanguage,
  "context": this.state.context,
  "time": parameters.time,
  "url": window.location.href.substr(0, 2048),
  "status": status
}
где:
  * from - с языка;
  * to - на язык;
  * page - язык страницы, на которой осуществляется перевод (aka statLang);
  * context - selection | word = перевод по выделению | перевод по shift;
  * time - время выполнения запроса к серверу, в мс;
  * status - ok | not-found | network-error = ок | слово не найдено | ошибка доступ к серверу.
%%
  * выделение текста — %%(json){"selected": 1}%%
  * показ «пипки» контекстного помощника — %%(json){"button": 1}%%
  * клик по пункту контекстного помощника «Скопировать в буфер» — %%(json){"copy-to-clipboard": 1}%%
  * клик по пункту контекстного помощника «Искать в Яндексе» — %%(json){"search": 1}%%
  * --открытие настроек {"settings": 1};-- (оторвали в дизайне)
  * показ бабла (может быть пустым без перевода) - %%(json){"bubble": 1}%%

====Примеры посылок в бандле:
%%
<[{"context":"selection","from":"en","page":"ru","status":"ok","time":"198","to":"ru","url":"http://www.ostrovlubvi.com/sms-lubov/pozdravleniya-s-novym-godom-na-anglijskom.html"}},{"client_id":"pagetranslate","params":{"shows":["1","en"]}}]

[{"client_id":"translate","params":{"context":"word","from":"en","page":"ru","status":"ok","time":"466","to":"ru","url":"chrome://welcome-page/"}}
%%
====Таски:
https://jira.yandex-team.ru/browse/CHROME-346
https://jira.yandex-team.ru/browse/CHROME-444
SBROWSER-1618

С версии 15.2 та же статистика должна отправляться }>

===Нативный пословный/пофразовый переводчик ("client_id":"yatranslator2")
<{Актуально до Chromium 61
=====Отправляемая статистика:

  * смена языка — %%(json){"change_language_from": 1, "language": value}%%
  * переход на сервис — %%(json){"open-service": 1, "type": type}%%, где type = word | phrase
  * свершившийся акт перевода —
%%(json)
{
  "from": from,
  "to": to,
  "page": this.pageLanguage,
  "context": this.state.context,
  "time": parameters.time,
  "url": window.location.href.substr(0, 2048),
  "status": status
}
где:
  * from - с языка;
  * to - на язык;
  * page - язык страницы, на которой осуществляется перевод (aka statLang);
  * context - selection | word = перевод по выделению | перевод по shift;
  * time - время выполнения запроса к серверу, в мс;
  * status - ok | not-found | network-error = ок | слово не найдено | ошибка доступ к серверу.
%%
  * выделение текста — %%(json){"selected": 1}%%
  * показ «пипки» контекстного помощника — %%(json){"button": 1}%%
  * клик по пункту контекстного помощника «Скопировать в буфер» — %%(json){"copy-to-clipboard": 1}%%
  * клик по пункту контекстного помощника «Искать в Яндексе» — %%(json){"search": 1}%%
  * показ бабла (может быть пустым без перевода) - %%(json){"bubble": 1}%%}>

===Попап оригинального текста ("client_id":"translate_origin")
* show : показ балуна
* close : закрытие балуна
* click_close : клик на крестик
* yandex : клик на "Яндекс переводчик"
* suggest : клик на предложить перевод
* sendtrnslt : отправка варианта перевода
* startSessionSeconds : таймстемп появления попапа (отправляется в момент закрытия попапа, когда мы можем зафиксировать закрытие)
* endSessionSeconds : таймстемп закрытия попапа (отправляется в момент закрытия попапа, когда мы можем зафиксировать закрытие)
* popupoff : отключению отображения попапа из самого попапа

Так как скрипт переводчика инжектится на страницу, то мы не можем из него понять если таб или браузер были закрыты, поэтому мы это не фиксируем как закрытие.


===Витальные сайтлинки (aka быстрые ссылки) ("client_id":"YandexSitelinksShowStats", "YandexSitelinksNavigateStats")
=====Отправляемая статистика:
  * навигация по сайтлинку;
  * факт показа сайтлинков.

=====Навигация
Передается:
  * домен;
  * индекс сайтлинки (0,1,2);
  * флажок о том, был ли это переход с морды сайта или нет;
  * время перехода.

(морда - это когда path/query отсутствуют с точностью до хештега
site.com - морда
site.com#anchor - морда
site.com?smth=asd - не морда
site.com/path?smth=asd - не морда)

client_id = YandexSitelinksNavigateStats
json = {"domain":"www.eldorado.ru","index":1,"morda":true,"time":1354286226179.183}

=====Показ
Отрабатывает когда мы перешли на страницу и для которой есть сайтлинки

Передается:
  * домен;
  * флажок о том, морда или нет;
  * время перехода.

client_id = YandexSitelinksShowStats
json = {"domain":"www.eldorado.ru","morda":true,"time":1354286226179.183}


=====Параметры в запросах:
  * domain - домен урла, для которого был показпереход
  * morda - переход с главной страницы или нет, по описанному алгоритму
  * index - индекс сайтлинки, так как она приходит с сервера
  * time - время события показаперехода, вычисляется как текущее время пользователя, приведенное к - UTC, в формате JS time

=====Вычисление времени UTC:
%%
<[  base::Time GetUTCNow() {
    base::Time now = base::Time::Now();
    base::Time::Exploded exploded = {0};
    now.UTCExplode(&exploded);

    return base::Time::FromUTCExploded(exploded);
  }]>
%%
Затем делается time.ToJsTime() при формировании JSON

=====Примеры посылки в бандле
%%
[{"client_id":"YandexSitelinksShowStats","params":{"domain":"vktaxi.ru","morda":true,"time":1355319622621.0}},{"client_id":"YandexSitelinksShowStats","params":{"domain":"www.vktaxi.ru","morda":true,"time":1355319622861.0}}]

[{"client_id":"YandexSitelinksNavigateStats","params":{"domain":"www.vktaxi.ru","index":1,"morda":true,"time":1355319648060.0}},{"client_id":"YandexSitelinksShowStats","params":{"domain":"www.vktaxi.ru","morda":false,"time":1355319648061.0}}]
%%

=====Таски:
https://jira.yandex-team.ru/browse/BROWSER-4461 - Разработка статистики
https://jira.yandex-team.ru/browse/BROWSER-4768 - Тестирование статистики

===Кнопка "Я" ("client_id":"yabut")

=====Отправляемая статистика:
  * Каждое нажатие кнопки clck (дергается при каждом нажатии)

=====Пример посылки в бандл:
%%
{"client_id":"yabut","params":{"clck":"1"}}]
%%
=====Таски:
https://jira.yandex-team.ru/browse/BROWSER-2057

===Омнибокс("client_id":"YandexOmniboxStats")
Отправляется в классике (до 17.1.0) - осталось у небольшой части пользователей.
Отсылалось в сишной шапке до версии 18.3.0!

=====Отправляемая статистика:
======1. **Общие параметры сессии работы с Омнибоксом**
Сессия работы с Омнибоксом - это снятие фокуса из Омнибокса любым способом.
Успешная сессия - переход по урлу/на СЕРП (по саджесту, по Enter etc.).
Неуспешная сессия - снятие фокуса без перехода (клик вне Смартбокса, клик в тайтл etc.) или переход не через Смартбокс (Табло, etc)
"suc_ses" отправляется в случае успешного завершения сессии работы с Омнибоксом (при этом не важно, дозагрузилась ли страница).
"suc_ses": [
  # параметры успешной сессии.
  [0] destination_url, # string - url перехода. Делать %%encode('utf8')%%
  [1] chosen_match_position, # integer - номер позиции саджеста, по которой перешли
  [2] was_wizard_adjunct # boolean, optional (==true if present) - пользователь перешел по поисковому саджесту и в паре с этим саджестом был колдунщик
],
--!!Инфа устарела, len(suc_ses)=2, то есть was_wizard_adjunct не пишут!!--
Если was_wizard_adjunct == true, то len(suc_ses)=3, иначе len(suc_ses)=2, о чём и написано в документации.

Особенность реализации: если destination_url содержит имя пользователя и/или пароль, то никакая статистика не отсылается.

======2. **Копирование текста из Омнибокса**
Отдельно передается информация о копировании (ctrl+c, ctrl+X/Shift+del, ctrl+ins, "копировать"/"вырезать" в контекстном меню) в буфер из омнибокса.
Передается непосредственно в момент копирования/вырезания (нажатия хоткея, клика по пункту контекстного меню).
И признак, что было скопировано в зависимости от того, весь он или его кусок.
1. Выделяешь кусок запроса. Копируется текстом кусок запроса
2. Выделяешь весь запрос. Копируется текстом запрос + копируется урл (UniformResourceLocatorW, msSourceUrl) + копируется кусок верстки %%<a href="url">текст запроса</a>%% (HTML + RTF)
{
"copied" : crc32 # string - crc от скопированного/вырезанного текста.
}

======3. **Параметры редактирования Омнибокса**
Массив "m" отправляется при завершении сессии работы с Омнибоксом (не важно, успешной или нет), если при этом произошло событие редактирования Омнибокса (ввод/удаление хотя бы одного символа).
Исключение: если пользователь открыл новый таб, и сразу закрыл его, "m" отправляется несмотря на отсутствие редактирования. Также если на открытой вкладке кликнуть в омнибокс, убрать фокус из омнибокса (кликнуть в тело страницы).
В КМ омнибокса и смартбокса есть пукнт меню "вставить и найти/вставить и перейти", который в свою очередь, логгируется. Если пользователь ничего не вводил, а только воспользовался Paste&Go, то в user_input должно быть пусто, в этом случае в user_input должен быть ввод пользователя (не то, что он вставил).

<{!!(зел)Для версий младше 1.7 HF (25.0.1364.15751) и около того турецких/украинских и тп отправляется массив "main":!!

"main": [
  # общие параметры
  [0] session_duration, # integer - продолжительность сессии (в секундах)
  [1] time_from_last_popup_update, # integer - время между последним показом саджеста и окончанием сессии
  [2] edits_count, # integer - количество исправлений
  [3] user_input_crc, # integer - crc32(последней маски) - того, что вводил пользователь
  [4] current_url, # string - текущий url
  [5] suggest_type, # list - типы позиций в саджесте
  [6] was_paste # boolean, optional (== true if present) - признак того, что пользователь что-то вставлял из буфера обмена !!проверить - тестированию!!
]
}}>

<{!!(зел)Для 1.7 HF и далее "main" заменен на "md", а также вместо crc32 ввода в омнибокс передается реальный текст ввода!!
"md": [
# общие параметры
[0] session_duration, # integer - продолжительность сессии,
[1] time_from_last_popup_update, # integer - время между последним показом саджеста и окончанием сессии
[2] edits_count, # integer - количество исправлений
[3] user_input, # string - последнее, что вводил пользователь. Делать
encode('utf8')
[4] current_url, # string - текущий url
[5] suggest_type, # list - типы позиций в саджесте
[6] was_paste # boolean, optional (== true if present) - признак того, что пользователь что-то вставлял из буфера обмена А есть ли это?
]

}>

!!(зел)Для версий 14.2 и старше "md" заменен на массив "m", version = 1 (далее не меняем имя массива, а меняем параметр version  в массиве для обозначения изменений в статистике Омнибокса).!!

"m": [
  # общие параметры
  [0] version, # integer - версия посылки (для контроля изменений в отправляемых данных)
  [1] session_duration, # integer - продолжительность сессии работы с Омнибоксом (в миллисекундах)
  [2] time_from_last_popup_update, # integer - время между последним показом саджеста и завершением сессии работы с Омнибоксом !!(testing)!!
  [3] edits_count, # integer - количество исправлений (при этом не учитываются исправления справа, только исправления в начале и внутри запроса) !!(testing)!!
  [4] user_input, # string - последний текст, который пользователь вводил в Омнибокс в любом табе. Делать %%encode('utf8')%% - ограничение в 100 символов !!(testing)!!
  [5] current_url, # string --текущий url (для текущего таба - url просматриваемой страницы; для нового таба - url страницы, которую пользователь просматривал до открытия нового таба)-- начиная с версии 14.8 отправляем пустой параметр, без значения
  [6] suggest_type, # list - типы позиций в саджесте
  [7] was_paste, # boolean (true|false) - признак того, что пользователь что-то вставлял из буфера обмена. !!(testing)!!
  [8] host, # string - хост поисковости, которая была включена в начале сессии работы с Омнибоксом (дальнейшие изменения поисковости должны учитываться в статистике Омнибокса ((https://st.yandex-team.ru/BROWSER-47719#1461080334000 таск)) начиная с версии 16.7)
  [9] activated, # boolean (ntba|clcka): clcka - открытие в текущем табе, ntba - открытие в новом табе, пустой activated - для режима дна
  !!в разработке!! [10] suggest_search, #list - список подсказок для всех позиций в саджесте (используется для подсчета статистики поиском), параметр version меняем на 2
],

======4. **Кнопка "Сделать Яндекс поиском по умолчанию" в саджесте**
Нажатие кнопки "Сделать Яндекс поисковиком в омнибоксе" (client_id "Omnibox")
{"client_id":"Omnibox","params":"ose":"%%old_search_engine%%"}


======**6. Гистограммы**

!!(зел)1. **По edit_counts**!!

Изменяем требования к параметру edits_count: считаем события редактирования текста в Омнибоксе за время сессии работы с Омнибоксом.
За одно событие редактирования принимаем нажатие __любой__ кнопки на клавиатуре в любой части строки (начало/середина/конец).
Начинаем считать редактирования не с момента начала ввода, а с моментов: изменения позиции курсора/удаления символа/выделения всей строки. Если пользователь выделил запрос и полностью удалил, а затем начал ввод снова, все равно все эти действия считаем редактированием.

Требуется **2 гистограммы** по результатам:
1. Для успешной сессии работы с Омнибоксом
2. Для неуспешной сессии работы с Омнибоксом

(1)
min — 0
max — 1000
name — Omni_edit_success

(2)
min — 0
max — 1000
name — Omni_edit_refuse

Для обеих гистограмм **значение последнего бакета** считаем 1000 + бесконечность (если возможно).
У параметра m меняем version на 2.

=====**Примеры посылок в бандле**
Неуспешная сессия
{"params":{"m":[0,3,1,10,"da",,["search-what-you-typed","history-title","search-suggest","search-suggest","search-suggest","search-suggest","search-suggest","history-title"],false,http://yandex.ua,clcka],"client_id":"YandexOmniboxStats"}

Успешная сессия
{"params":{"m":[0,3,1,10,"da",,["search-what-you-typed","history-title","search-suggest","search-suggest","search-suggest","search-suggest","search-suggest","history-title"],false,http://yandex.ua,clcka],"suc_ses":["http://yandex.ua/yandsearch?text=%D0%95%D0%A7&clid=",0,false]},"client_id":"YandexOmniboxStats"}


=====**Разновидности типов перехода по саджесту**=====
//*В настоящее время, если поиск происходил в недефолтном поисковике, первая посылка в бандле маркируется как search-other-engine, при этом тип саджеста search-suggest не изменяется. На принадлежность поиска в недефолтном поиксовике указывает именно маркировка search-other-engine.//
#|
|| extension-app	 | An Extension App with a title/url that contains // the input Сейчас в браузере не используется||
|| history-body	 | A past page whose body contains the input||
|| history-keyword	 | A past page whose keyword contains the input||
|| history-title	 | A past page whose title contains the input||
|| history-url	 | A past page whose URL contains the input||
|| navsuggest	 | A suggested URL||
|| search-history	 | A past search (with the default engine) // containing the input||
|| search-other-engine	 | A search with a non-default engine||
|| search-suggest	 | A suggested search (with the default engine)||
|| search-what-you-typed	| The input as a search query (with the default // engine)||
||url-what-you-typed| ||
||yandex-wizard| ||
|#

<{типы в коде
%%
 enum Type {
    URL_WHAT_YOU_TYPED    = 0,  // The input as a URL.
    HISTORY_URL           = 1,  // A past page whose URL contains the input.
    HISTORY_TITLE         = 2,  // A past page whose title contains the input.
    HISTORY_BODY          = 3,  // A past page whose body contains the input.
    HISTORY_KEYWORD       = 4,  // A past page whose keyword contains the
                                // input.
    NAVSUGGEST            = 5,  // A suggested URL.
    SEARCH_WHAT_YOU_TYPED = 6,  // The input as a search query (with the
                                // default engine).
    SEARCH_HISTORY        = 7,  // A past search (with the default engine)
                                // containing the input.
    SEARCH_SUGGEST        = 8,  // A suggested search (with the default engine)
                                // query that doesn't fall into one of the more
                                // specific suggestion categories below.
    SEARCH_SUGGEST_ENTITY = 9,  // A suggested search for an entity.
    SEARCH_SUGGEST_TAIL   = 10,  // A suggested search to complete the
                                 // tail of the query.
    SEARCH_SUGGEST_PERSONALIZED = 11,  // A personalized suggested search.
    SEARCH_SUGGEST_PROFILE      = 12,  // A personalized suggested search for a
                                       // Google+ profile.
    SEARCH_OTHER_ENGINE    = 13,  // A search with a non-default engine.
    SOCIAL_FRIEND_DEPRECATED = 14,  // A friend from social network: Facebook,
                                    // etc.
    EXTENSION_APP          = 15,  // An Extension App with a title/url that
                                  // contains the input (deprecated).
    CONTACT_DEPRECATED     = 16,  // One of the user's contacts (deprecated).
    BOOKMARK_TITLE         = 17,  // A bookmark whose title contains the input.
    YANDEX_WIZARD          = 18,  // Match, containing additional info.
    NAVSUGGEST_PERSONALIZED     = 19,  // A personalized suggestion URL.
    CALCULATOR                  = 20,  // A calculator result
    CLIPBOARD                   = 21,  // A URL based on the clipboard.
    VOICE_SUGGEST               = 22,  // An Android-specific type which
                                       // indicates a search from voice
                                       // recognizer.
    NUM_TYPES,
  };
%%
}>

=====**Таски**
https://jira.yandex-team.ru/browse/BROWSER-825
https://st.yandex-team.ru/BROWSER-42817 (решили, что не баг, так и должно работать в Калипсо)
https://st.yandex-team.ru/BROWSER-45088 (классика)


===**Омнибокс в сишной шапке ("client_id":"SupernovaOmnibox")**
Отправляется в Supernova aka сишная шапка с 18.3.0
=====Отправляемая статистика:
======1. **Общие параметры сессии работы с Омнибоксом**
Сессия работы с Омнибоксом - это снятие фокуса из Омнибокса любым способом.
Успешная сессия - переход по урлу/на СЕРП (по саджесту, по Enter etc.).
Неуспешная сессия - снятие фокуса без перехода (клик вне Смартбокса, клик в тайтл etc.) или переход не через Смартбокс (Табло, etc)
"suc_ses" отправляется в случае успешного завершения сессии работы с Омнибоксом (при этом не важно, дозагрузилась ли страница).
"suc_ses": [
  # параметры успешной сессии.
  [0] destination_url, # string - url перехода. Делать %%encode('utf8')%%
  [1] chosen_match_position, # integer - номер позиции саджеста, по которой перешли
  [2] was_wizard_adjunct # boolean, optional (==true if present) - пользователь перешел по поисковому саджесту и в паре с этим саджестом был колдунщик
],
Если was_wizard_adjunct == true, то len(suc_ses)=3, иначе len(suc_ses)=2, о чём и написано в документации.
Особенность реализации: если destination_url содержит имя пользователя и/или пароль, то никакая статистика не отсылается (пока что на это баг!).

======2. **Копирование текста из Омнибокса**
Отдельно передается информация о копировании (ctrl+c, ctrl+X/Shift+del, ctrl+ins, "копировать"/"вырезать" в контекстном меню) в буфер из омнибокса.
Передается непосредственно в момент копирования/вырезания (нажатия хоткея, клика по пункту контекстного меню).
И признак, что было скопировано в зависимости от того, весь он или его кусок.
1. Выделяешь кусок запроса. Копируется текстом кусок запроса
2. Выделяешь весь запрос. Копируется текстом запрос + копируется урл (UniformResourceLocatorW, msSourceUrl) + копируется кусок верстки %%<a href="url">текст запроса</a>%% (HTML + RTF)
{
"copied" : crc32 # string - crc от скопированного/вырезанного текста.
"copiedall" : boolean - 1 - если скопировано все (т.е. урл целиком,  0 - если скопирована часть запроса)   - готово, появилось в сишной шапке
}

======3. **Параметры редактирования Омнибокса**
Массив "m" отправляется при завершении сессии работы с Омнибоксом (не важно, успешной или нет), если при этом произошло событие редактирования Омнибокса (ввод/удаление хотя бы одного символа).
Исключение: если пользователь открыл новый таб, и сразу закрыл его, "m" отправляется несмотря на отсутствие редактирования. Также если на открытой вкладке кликнуть в омнибокс, убрать фокус из омнибокса (кликнуть в тело страницы).
В КМ омнибокса и смартбокса есть пукнт меню "вставить и найти/вставить и перейти", который в свою очередь, логгируется. Если пользователь ничего не вводил, а только воспользовался Paste&Go, то в user_input должно быть пусто, в этом случае в user_input должен быть ввод пользователя (не то, что он вставил).

"m": [
  # общие параметры
  [0] version, # integer - версия посылки (для контроля изменений в отправляемых данных)
  [1] session_duration, # integer - продолжительность сессии работы с Омнибоксом (в миллисекундах)
  [2] time_from_last_popup_update, # integer - время между последним показом саджеста и завершением сессии работы с Омнибоксом !!(testing)!!
  [3] edits_count, # integer - количество исправлений (при этом не учитываются исправления справа, только исправления в начале и внутри запроса) !!(testing)!!
  [4] user_input, # string - последний текст, который пользователь вводил в Омнибокс в любом табе. Делать %%encode('utf8')%% - ограничение в 100 символов !!(testing)!!
  [5] current_url, # string --текущий url (для текущего таба - url просматриваемой страницы; для нового таба - url страницы, которую пользователь просматривал до открытия нового таба)-- начиная с версии 14.8 отправляем пустой параметр, без значения
  [6] suggest_type, # list - типы позиций в саджесте
  [7] was_paste, # boolean (true|false) - признак того, что пользователь что-то вставлял из буфера обмена. !!(testing)!!
  [8] host, # string - хост поисковости, которая была включена в начале сессии работы с Омнибоксом (дальнейшие изменения поисковости должны учитываться в статистике Омнибокса ((https://st.yandex-team.ru/BROWSER-47719#1461080334000 таск)) начиная с версии 16.7)
  [9] activated, # boolean (ntba|clcka): clcka - открытие в текущем табе, ntba - открытие в новом табе, пустой activated - для режима дна
  !!в разработке!! [10] suggest_match_was_deleted, (было ли действие удаление мачта, если не было - пустой) - это **массив**, каждый элемент которого вектор
  **номер удаленной позиции - тип удаленного саджеста - способ удаления**
    Номер - число от 0..9
    тип удаленного саджеста - одно из значений( search-history или history-title или histoty-url)
    Способ удаления - одно из значений (hotkey, cross, context_menu)

],

=====**Факт активации смартбокса в NTP кликом с 18.10.0**
{
"ntp_smtr_click":1
}
{"client_id":"SupernovaOmnibox","params":{"ntp_smrt_click":1}

=====**Факт показа исторических запросов и трендов по клику в омнибокс на NTP с 19.1.1**
%%{
"ntp_empty_suggest_shown": 1
}
{"client_id":"SupernovaOmnibox","params":{"ntp_empty_suggest_shown":1}
%%
=====**Приглашалка аутентификации в саджесте с 19.6.0**
https://st.yandex-team.ru/SBRO-201
* клик %%(json){"client_id":"SupernovaOmnibox","params":{"auth_invitation_click":1}%%
* показ %%(json){"client_id":"SupernovaOmnibox","params":{"auth_invitation_shown":1}%%

=====**Автоподставление запроса**
https://st.yandex-team.ru/SBRO-369
* показ %%(json){"client_id":"SupernovaOmnibox","params":{"input_prediction_shown":1}%%
* подставление %%(json){"client_id":"SupernovaOmnibox","params":{"input_prediction_append":1}%%

=====**Реклама в саджесте**
https://st.yandex-team.ru/SBRO-465
* показ {"client_id":"SupernovaOmnibox","params":{"suggest_ad_shown":1}
* клик {"client_id":"SupernovaOmnibox","params":{"suggest_ad_click":1}

=====**Примеры посылок в бандле**
Неуспешная сессия
{"params":{"m":[0,3,1,10,"da",,["search-what-you-typed","history-title","search-suggest","search-suggest","search-suggest","search-suggest","search-suggest","history-title"],false,http://yandex.ua,clcka],"client_id":"SupernovaOmnibox"}

Успешная сессия
{"params":{"m":[0,3,1,10,"da",,["search-what-you-typed","history-title","search-suggest","search-suggest","search-suggest","search-suggest","search-suggest","history-title"],false,http://yandex.ua,clcka],"suc_ses":["http://yandex.ua/yandsearch?text=%D0%95%D0%A7&clid=",0,false]},"client_id":"SupernovaOmnibox"}


=====**Разновидности типов перехода по саджесту**=====
//*В настоящее время, если поиск происходил в недефолтном поисковике, первая посылка в бандле маркируется как search-other-engine, при этом тип саджеста search-suggest не изменяется. На принадлежность поиска в недефолтном поиксовике указывает именно маркировка search-other-engine.//
#|
|| extension-app	 | An Extension App with a title/url that contains // the input Сейчас в браузере не используется||
|| history-body	 | A past page whose body contains the input||
|| history-keyword	 | A past page whose keyword contains the input||
|| history-title	 | A past page whose title contains the input||
|| history-url	 | A past page whose URL contains the input||
|| navsuggest	 | A suggested URL||
|| search-history	 | A past search (with the default engine) // containing the input||
|| search-other-engine	 | A search with a non-default engine||
|| search-suggest	 | A suggested search (with the default engine)||
|| search-what-you-typed	| The input as a search query (with the default // engine)||
||url-what-you-typed| ||
||yandex-wizard| ||
|#

<{типы в коде
%%
 enum Type {
    URL_WHAT_YOU_TYPED    = 0,  // The input as a URL.
    HISTORY_URL           = 1,  // A past page whose URL contains the input.
    HISTORY_TITLE         = 2,  // A past page whose title contains the input.
    HISTORY_BODY          = 3,  // A past page whose body contains the input.
    HISTORY_KEYWORD       = 4,  // A past page whose keyword contains the
                                // input.
    NAVSUGGEST            = 5,  // A suggested URL.
    SEARCH_WHAT_YOU_TYPED = 6,  // The input as a search query (with the
                                // default engine).
    SEARCH_HISTORY        = 7,  // A past search (with the default engine)
                                // containing the input.
    SEARCH_SUGGEST        = 8,  // A suggested search (with the default engine)
                                // query that doesn't fall into one of the more
                                // specific suggestion categories below.
    SEARCH_SUGGEST_ENTITY = 9,  // A suggested search for an entity.
    SEARCH_SUGGEST_TAIL   = 10,  // A suggested search to complete the
                                 // tail of the query.
    SEARCH_SUGGEST_PERSONALIZED = 11,  // A personalized suggested search.
    SEARCH_SUGGEST_PROFILE      = 12,  // A personalized suggested search for a
                                       // Google+ profile.
    SEARCH_OTHER_ENGINE    = 13,  // A search with a non-default engine.
    SOCIAL_FRIEND_DEPRECATED = 14,  // A friend from social network: Facebook,
                                    // etc.
    EXTENSION_APP          = 15,  // An Extension App with a title/url that
                                  // contains the input (deprecated).
    CONTACT_DEPRECATED     = 16,  // One of the user's contacts (deprecated).
    BOOKMARK_TITLE         = 17,  // A bookmark whose title contains the input.
    YANDEX_WIZARD          = 18,  // Match, containing additional info.
    NAVSUGGEST_PERSONALIZED     = 19,  // A personalized suggestion URL.
    CALCULATOR                  = 20,  // A calculator result
    CLIPBOARD                   = 21,  // A URL based on the clipboard.
    VOICE_SUGGEST               = 22,  // An Android-specific type which
                                       // indicates a search from voice
                                       // recognizer.
    NUM_TYPES,
  };
%%
}>



===Табло("client_id":"tablo")
<{Актуальна для версий браузера раньше 15.2. Для более новых см. client_id = ctablo
=====Отправляемая статистика:

{{include page="/users/olegavd/tablostat" notoc notitle nomark}}
=====Примеры посылок в бандле
Навигационная статистика: {"client_id":"tablo","params":{"dt":"0.09","i":"1","p":"0","ui":"28B6037E-9186-6D58-FB75-61248ADEE2BC","url":"http://vk.com/","v":"1.1.0.589"}}

Статусная статистика: {"client_id":"tablo","params":{"e":"1","nunt":"1","ont":"1","pl":"http://maps.yandex.ru/*,http://pozdravit-vsex.ru/*,http://46.165.193.168/*,http://help.yandex.ru/*,http://mail.yandex.ru,http://lenta.ru,http://music.yandex.ru,http://market.yandex.ru","pn":"10000001","tl":"http://www.yandex.ru/*,http://vk.com/*,https://www.amway.ru/*,https://e.mail.ru/*,http://youtube.com,http://ucrazy.ru,http://book2.me,http://mail.ru","ui":"D32F322E-A7CA-95BA-52B0-F169168E1148","v":"1.1.0.589","w":"2"}}
}>

===Меню Табло 14.2+ ("client_id": "tableauMenu") Q2
Статистика кликов по пунктам экранам в Табло (Табло, недавно закрытые, загрузки, улучшения, приложения)
====Описание
<{14.2 - 16.4
{"client_id":"tableauMenu","params":{"%param%":"1"}}
Вместо %param% подставляется одно из значений в зависимости от пункта меню, на который был совершен клик
Табло - "t"
Недавно закрытые - "h"
Улучшения - "e"
Загрузки - "d"
Приложения - "a"
Другие устройства - "u"

Факт клика/перехода внутри "Других устройств":
Планшет - "a_p":"n"
Телефон - "a_t":"n"
Десктоп - "a_d":"n"
где n номер устройства для данного человека. Если устройство одно, будет "a_p":"1". Если устройств данного типа нет, не пишем ничего.
Точно устройство сможем идентифицировать исходя из передаваемого yasoft.

}>
**С версии 16.6**
{"client_id":"tableauMenu","params":{"%param%":"1"}}
Вместо %param% подставляется одно из значений в зависимости от экрана табло, на который был совершен клик
Табло - "t"
Недавно закрытые - "h"
Улучшения - "e"
Загрузки - "d"
Приложения - "a"
Другие устройства - "u"

"client_id": = "tableauOtherDevices"
Факт клика/перехода внутри "Других устройств":
Планшет (tablet) - "u_t":"n"
Телефон (phone) - "u_p":"n"
Десктоп (desktop) - "u_d":"n"
де n номер устройства для данного человека. Если устройство одно, будет "a_p":"1".


===(settingsclientidsettingsq2)Меню бутерброда и настройки Settings
Исторически статистика меню бутерброда в client_id=settings (сам факт клика по меню бутерброда - i0).
Параметры, говорящие о нажатиях на пункты меню (меню бутерброда).

#|
 ||**Нажатие на меню бутерброда** | **i0**||
 ||**[Виджет обновления]** | опционален IDC_UPGRADE_DIALOG  ||
 ||**Виджет синхронизации** | описан тут - https://wiki.yandex-team.ru/browser/stat/bundle/#sync18.7.0||
 || Масштаб и плюс-минус| IDC_ZOOM_PLUS, IDC_ZOOM_NORMAL,IDC_ZOOM_MINUS||
 || Иконка фуллскрина | IDC_FULLSCREEN||
 || Турбо| клик на включить IDC_WRENCH_MENU_TURN_TURBO_ON, клик на выключить IDC_WRENCH_MENU_TURN_TURBO_OFF ||
 || Инкогнито| IDC_NEW_INCOGNITO_WINDOW ||
 || Блокировщик рекламы| !!TBD!!||
 || Настройки | IDC_OPTIONS||
 || **История** |IDC_SHOW_HISTORY||
 ||     Недавно закрытые | IDC_HISTORY_SUBMENU||
 ||     История с других устройств, сначала десктопы| ||
 ||     История с других устройств, далее мобильные| ||
 ||Загрузки | IDC_SHOW_DOWNLOADS||
 ||**Закладки** | IDC_BOOKMARKS_MENU||
 ||     Создать закладку | !!TBD!!||
 ||     Закладки для открытых страниц | IDC_BOOKMARK_ALL_TABS||
 ||  Скрыть/Показать панель закладок | IDC_SHOW_BOOKMARK_BAR||
 ||  Диспетчер закладок | IDC_SHOW_BOOKMARK_MANAGER||
 ||  Импортировать закладки| IDC_IMPORT_SETTINGS ||
 ||   Список закладок | IDC_BOOKMARK_PAGE||
 ||Коллекции| !!TBD!!||
 ||Менеджер паролей| IDC_SHOW_PASSWORD_MANAGER_WRENCH_MENU||
 ||Синхронизация (если виджет синхронизации отключен в настройках) | IDC_SHOW_SYNC_SETUP||
 ||Дополнения | IDC_MANAGE_EXTENSIONS ||
 ||**Дополнительно** | IDC_ADVANCED_WRENCH_SUBMENU||
 ||    Новая вкладка | IDC_NEW_TAB||
 ||    Новое окно | IDC_NEW_WINDOW||
 ||    Очистить историю | IDC_CLEAR_BROWSING_DATA||
 ||    **Сохранить**  | IDC_SAVE_PAGE_WRENCH_SUBMENU||
 ||         На компьютер |IDC_SAVE_PAGE||
 ||         На Яндекс.Диск | IDC_SAVE_PAGE_TO_YA_DISK||
 ||     Печать| IDC_PRINT||
 ||     Перевести на русский | IDC_TRANSLATE_PAGE||
 ||     Найти | IDC_FIND ||
 ||     **Изменить** |IDC_EDIT_WRENCH_SUBMENU||
 ||             Копировать | IDC_COPY||
 ||             Вырезать | IDC_CUT ||
 ||             Вставить |IDC_PASTE||
 ||      **Дополнительные инструменты** | IDC_TOOLS_WRENCH_SUBMENU||
 ||             Создать ярлык | IDC_CREATE_SHORTCUTS||
 ||             Диспетчер задач | IDC_TASK_MANAGER||
 ||             Посмотреть код страницы | IDC_VIEW_SOURCE||
 ||             Инструменты разработчика| IDC_DEV_TOOLS||
 ||            Консоль JavaScript |IDC_DEV_TOOLS_CONSOLE||
 ||            **Кодировка** | IDC_CHANGE_ENCODING||
 ||            Перечисление кодировок| ||
 ||       Помощь | IDC_HELP_PAGE_VIA_MENU||
 ||       Сообщить о проблеме | IDC_FEEDBACK||
 ||       О браузере | IDC_ABOUT||
 ||       Закрыть браузер | IDC_EXIT ||
|#

Непонятное, не смогла найти в документации и по тикетам
IDC_WRENCH_MENU_UPGRADE_MENU_ITEM ???
IDC_WRENCH_MENU_ENABLE_SUBRESOURCE_FILTER ???
IDC_WRENCH_MENU_ENABLE_DEGRADATION_MODE
IDC_WRENCH_MENU_ENABLE_CONTENT_FILTER ???
IDC_WRENCH_MENU_DISABLE_DEGRADATION_MODE
IDC_VIEW_BACKGROUND_PAGES
IDC_SHOW_ENHANCEMENTS

**Устарело, но было раньше**
IDC_CUSTOMIZE_TABLO - удалено тут https://st.yandex-team.ru/BROWSER-58591
IDC_VIEW_BACKGROUND_PAGES устарело, Посмотреть фоновые страницы
IDS_BOOKMARKS_MENU, бесполезный параметр, отправляется по правому клику https://st.yandex-team.ru/BROWSER-60438#1482834690000
IDC_INT_SWITCH_NEW Перезапустить в новом интерфейсе Калипсо
IDC_INT_SWITCH_CLASSIC  Перезапустить в классическом интерфейсе
IDC_ZOOM_PERCENT_DISPLAY **есть в списках команд, но не вызывается**
IDC_ZOOM_NORMAL **не знаю, есть в списках команд, но не вызывается**


===Настройки - Client_ID = settings
Необходимо также обвесить счетчиками страницы (складываем в хранилище при каждом действии):
  *История
    *удалить выбранные элементы "client_id":"settings","params":{"history":"delel"}
    *очистить историю "client_id":"settings","params":{"history":"clear"}
    *искать в истории "client_id":"settings","params":{"history":"search"}
  *Загрузки
    *Открыть папку загрузок "client_id":"settings","params":{"downloads":"openf"}
    *Удалить все "client_id":"settings","params":{"downloads":"clear"}
    *Поиск по загрузкам "client_id":"settings","params":{"downloads":"search"}
  *Закладки
    *--Поиск по закладкам {"client_id":"settings","params":{"bookmarks":"q"}} ("client_id":"settings","params":{"bookmarks":"search"} — в версии 1.7)--
    *--При нажатии на подпапке будет присылаться (С 1.7HF1)  {"client_id":"settings","params":{"bookmarks":"sub"}}--
    Статистика по закладкам живет в отдельном client_id - описание ((https://wiki.yandex-team.ru/browser/stat/bundle#zakladkiclientidbookmarks тут)).


При запуске браузера отправляется состояние настройки показывать панель закладок:
{"client_id":"settings","params":{"bmkbar":"1"}}" }

0 - не показывать
1 - показывать всегда
2 - показывать только в табло

Тоже самое посылается при смене настройки показывать панель закладок.

====Пример
"client_id":"settings", "params":{"IDC_NEW_TAB":"1"}


====New2 (после редизайна)
Новые настройки страниц - тоже **client_id=settings**

ТЗ: https://wiki.yandex-team.ru/browser/custo/tz/novye-nastrojjki-stranic/

#|
|| **Параметр**| **Значение**| **Событие**||
|| a_MainMenuClk| | Переход по главному меню||
|| | bookmarks| клик по пункту "Закладки"||
|| | downloads| клик по пункту "Загрузки"||
|| | history| клик по пункту "История"||
|| | extensions| клик по пункту "Дополнения"||
|| | devices| клик по пункту "Устройства"||
|| | passman| клик по пункту "Пароли"||
|| | protect| клик по пункту "Protect"||
|| | settings| клик по пункту "Настройки"||
|| a_Bookmarks| | Взаимодействие со страницей "Закладки"||
|| | enter| количество входов на страницу||
|| | LeftMenu| количество кликов по левому меню||
|| | Page_add| добавление страницы в закладки через диспетчер закладок||
|| | Page_delete| удаление страницы из закладок через диспетчер закладок||ст
|| | Folder_add| добавление папки в закладках через диспетчер закладок||
|| | Folder_delete| удаление папки в закладках через диспетчер закладок||
|| | Folder_move| перемещение папки с закладками через диспетчер закладок||
|| | Folder_copy| копирование папки с закладками через диспетчер закладок||
|| | Folder_open_newtab| открыть все закладки папки в новых табах||
|| | Folder_open_newwindow| открыть все закладки папки в новом окне||
|| | Folder_open_incognito| открыть все закладки папки в режиме инкогнито||
|| | Page_move| перемещение закладки через диспетчер закладок||
|| | Page_edit| редактирование закладки через диспетчер закладок||
|| | Page_copy| копирование закладки через диспетчер закладок||
|| | Page_open_newtab| открытие закладки из настроек в новом табе||
|| | Page_open_newwindow| открытие закладки из настроек в новом окне||
|| | Page_open_incognito| открыть закладку в режиме инкогнито||
|| | Search| поиск в менеджере закладок||
|| | СM_kebab| открытие КМ через меню кебаба||
|| | CM_hover| Открытие КМ по нажатию кнопки Еще, появляющейся по ховеру||
|| | CM_right| Открытие КМ по ПКМ||
|| a_Downloads| | Взаимодействие со страницей "Загрузки"||
|| | enter| количество входов на страницу||
|| | LeftMenu_move| количество кликов по левому меню||
|| | Folder_open| открытие папки с загрузками через настройки||
|| | CleanHistory_open| Открытие формы очистки истории загрузок||
|| | Show_in_Folder| показать скаченный файл в папке||
|| | Delete_file| удаление загруженного файла (одного) через настройки||
|| | Delete_mass| массовое удаление загруженных файлов через настройки||
|| | Delete_file_cancel| отмена удаления файла через настройки||
|| | Delete_mass_cancel| отмена массового удаления файлов через настройки||
|| | Download_again| скачивание файла заново через настройки||
|| | Pause| постановка скачивания файла на паузу через настройку||
|| | Stop| остановка скачивания файла через настройки||
|| | Resume| продолжение скачивания файла после паузы через настройки||
|| | Repeat_check| повторение неудавшейся проверки файла через настройки||
|| | More_actions| вызов меню "Еще" для файла через настройки||
|| a_History| | Взаимодействие со страницей "История"||
|| | enter| количество входов на страницу||
|| | LeftMenu_move| количество кликов по левому меню||
|| | CleanHistory_open| открытие формы очистки истории через страницу История настроек||
|| | Delete| удаление строки из истории||
|| | Delete_mass| удаление нескольких строк из истории||
|| | More| вызов меню по кнопке "Еще" для троки истории||
|| a_Devices| | Взаимодействие со страницей "Устройства"||
|| | enter| количество входов на страницу||
|| | Left_Phone_move| количество кликов по пункту Phone в левом меню||
|| | Left_Computer_move| количество кликов по пункту Computer в левом меню||
|| | Tabs_open| переход на закладку "Открытые вкладки"||
|| | Tablo_open| переход на закладку "Табло"||
|| a_Extensions| | Взаимодействие со страницей "Дополнения"||
|| | enter| количество входов на страницу||
|| | Left_Tools_move| количество кликов по пункту Инструменты в левом меню||
|| | Left_DataMng_move| количество кликов по пункту Управление данными в левом меню||
|| | Left_Purchase_move| количество кликов по пункту Покупки в левом меню||
|| | Left_Services_move| количество кликов по пункту Сервисы в левом меню||
|| | Left_Security_move| количество кликов по пункту Безопасность в левом меню||
|| | Left_Opera_move| количество кликов по пункту Из каталога Opera в левом меню||
|| | Left_Other_move| количество кликов по пункту Из других источников в левом меню||
|| | LightShot_on| включение LightShot||
|| | LightShot_off| выключение LightShot||
|| | LightShot_more| просмотр детальной информации по LightShot||
|| | LightShot_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для LightShot||
|| | LightShot_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для LightShot||
|| | LightShot_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для LightShot||
|| | LightShot_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для LightShot||
|| | TurnLights_on| включение Turn Off the Lights||
|| | TurnLights_off| выключение Turn Off the Lights||
|| | TurnLights_more| просмотр детальной информации по Turn Off the Lights||
|| | TurnLights_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Turn Off the Lights||
|| | TurnLights_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Turn Off the Lights||
|| | TurnLights_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для Turn Off the Lights||
|| | TurnLights_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для Turn Off the Lights||
|| | TurnLights_settings| открытие настроек для дополнения Turn Off the Lights||
|| | Turbo_on| включение Turbo||
|| | Turbo_off| выключение Turbo||
|| | Turbo_auto| перевод Turbo в положение Auto||
|| | Turbo_more| просмотр детальной информации по Turbo||
|| | Evernote_on| включение Evernote||
|| | Evernote_off| выключение Evernote||
|| | Evernote_more| просмотр детальной информации по Evernote||
|| | Evernote_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Evernote||
|| | Evernote_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Evernote||
|| | Evernote_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для Evernote||
|| | Evernote_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для Evernote||
|| | Evernote_settings| открытие настроек для дополнения Evernote||
|| | LastPass_on| включение LastPass||
|| | LastPass_off| выключение LastPass||
|| | LastPass_more| просмотр детальной информации по LastPass||
|| | LastPass_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для LastPass||
|| | LastPass_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для LastPass||
|| | LastPass_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для LastPass||
|| | LastPass_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для LastPass||
|| | LastPass_settings| открытие настроек для дополнения LastPass||
|| | Sync_on| включение Sync||
|| | Sync_off| выключение Sync||
|| | Pocket_on| включение Pocket||
|| | Pocket_off| выключение Pocket||
|| | Pocket_more| просмотр детальной информации по Pocket||
|| | Pocket_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Pocket||
|| | Pocket_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Pocket||
|| | Pocket_settings| открытие настроек для дополнения Pocket||
|| | Adviser_on| включение Adviser||
|| | Adviser_off| выключение Adviser||
|| | Adviser_more| просмотр детальной информации по Adviser||
|| | Adviser_settings| открытие настроек для дополнения Adviser||
|| | LatyShops_on| включение LatyShops||
|| | LatyShops_off| выключение LatyShops||
|| | LatyShops_more| просмотр детальной информации по LatyShops||
|| | LatyShops_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для LatyShops||
|| | LatyShops_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для LatyShops||
|| | LatyShops_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для LatyShops||
|| | LatyShops_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для LatyShops||
|| | LatyShops_settings| открытие настроек для дополнения LatyShops||
|| | AliTools_on| включение AliTools||
|| | AliTools_off| выключение AliTools||
|| | AliTools_more| просмотр детальной информации по AliTools||
|| | AliTools_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для AliTools||
|| | AliTools_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для AliTools||
|| | AliTools_settings| открытие настроек для дополнения AliTools||
|| | WherePost_on| включение Где Посылка||
|| | WherePost_off| выключение Где Посылка||
|| | WherePost_more| просмотр детальной информации по Где Посылка||
|| | WherePost_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Где Посылка||
|| | WherePost_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Где Посылка||
|| | WherePost_settings| открытие настроек для дополнения Где Посылка||
|| | YaMusic_on| включение Яндекс.Музыка и Радио||
|| | YaMusic_off| выключение Яндекс.Музыка и Радио||
|| | YaMusic_more| просмотр детальной информации по Яндекс.Музыка и Радио||
|| | YaMusic_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Музыка и Радио||
|| | YaMusic_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Музыка и Радио||
|| | YaMusic_settings| открытие настроек для дополнения Яндекс.Музыка и Радио||
|| | YaWeather_on| включение Яндекс.Погода||
|| | YaWeather_off| выключение Яндекс.Погода||
|| | YaWeather_more| просмотр детальной информации по Яндекс.Погода||
|| | YaWeather_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Погода||
|| | YaWeather_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Погода||
|| | YaWeather_settings| открытие настроек для дополнения Яндекс.Погода||
|| | YaMail_on| включение Яндекс.Почта||
|| | YaMail_off| выключение Яндекс.Почта||
|| | YaMail_more| просмотр детальной информации по Яндекс.Почта||
|| | YaMail_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Почта||
|| | YaMail_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Почта||
|| | YaMail_settings| открытие настроек для дополнения Яндекс.Почта||
|| | YaTraffic_on| включение Яндекс.Пробки||
|| | YaTraffic_off| выключение Яндекс.Пробки||
|| | YaTraffic_more| просмотр детальной информации по Яндекс.Пробки||
|| | YaTraffic_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Пробки||
|| | YaTraffic_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Пробки||
|| | YaTraffic_settings| открытие настроек для дополнения Яндекс.Пробки||
|| | YaDisk_on| включение Яндекс.Диск||
|| | YaDisk_off| выключение Яндекс.Диск||
|| | YaDisk_more| просмотр детальной информации по Яндекс.Диск||
|| | YaDisk_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Диск||
|| | YaDisk_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Яндекс.Диск||
|| | YaDisk_settings| открытие настроек для дополнения Яндекс.Диск||
|| | YaInfo_on| включение Карточки||
|| | YaInfo_off| выключение Карточки||
|| | YaInfo_more| просмотр детальной информации по Карточке||
|| | YaInfo_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Карточки||
|| | YaInfo_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Карточки||
|| | YaInfo_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для Карточки||
|| | YaInfo_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для Карточки||
|| | YaInfo_settings| открытие настроек для дополнения Карточки||
|| | Antishock_on| включение Антишока||
|| | Antishock_off| выключение Антишока||
|| | Antishock_more| просмотр детальной информации по Антишока||
|| | Antishock_settings| открытие настроек для дополнения Антишока||
|| | DisturbAd_on| включение Мешающей рекламы||
|| | DisturbAd_off| выключение Мешающей рекламы||
|| | DisturbAd_more| просмотр детальной информации по Мешающей рекламе||
|| | DisturbAd_settings| открытие настроек для дополнения Мешающей рекламе||
|| | BlockFlash_on| включение Блокировки флеш-данных||
|| | BlockFlash_off| выключение Блокировки флеш-данных||
|| | BlockFlash_more| просмотр детальной информации по Блокировке флеш=данных||
|| | BlockFlash_settings| открытие настроек для Блокировки мешающей рекламы||
|| | AdGuard_on| включение AdGuard||
|| | AdGuard_off| выключение AdGuard||
|| | AdGuard_more| просмотр детальной информации по AdGuard||
|| | AdGuard_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для AdGuard||
|| | AdGuard_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для AdGuard||
|| | AdGuard_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для AdGuard||
|| | AdGuard_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для AdGuard||
|| | AdGuard_settings| открытие настроек для дополнения AdGuard||
|| | SaveFromNET_on| включение Save From .NET||
|| | SaveFromNET_off| выключение Save From .NET||
|| | SaveFromNET_more| просмотр детальной информации по Save From .NET||
|| | SaveFromNET_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для Save From .NET||
|| | SaveFromNET_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для Save From .NET||
|| | SaveFromNET_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для Save From .NET||
|| | SaveFromNET_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для Save From .NET||
|| | SaveFromNET_settings| открытие настроек для дополнения Save From .NET||
|| | FireShot_on| включение FireShot||
|| | FireShot_off| выключение FireShot||
|| | FireShot_more| просмотр детальной информации по FireShot||
|| | FireShot_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для FireShot||
|| | FireShot_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для FireShot||
|| | FireShot_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для FireShot||
|| | FireShot_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для FireShot||
|| | FireShot_settings| открытие настроек для дополнения FireShot||
|| | CryptoPro_on| включение КриптоПро ЭЦП||
|| | CryptoPro_off| выключение КриптоПро ЭЦП||
|| | CryptoPro_more| просмотр детальной информации по КриптоПро ЭЦП||
|| | CryptoPro_Incognito_on| включение настройки "Разрешить использование в режиме Инкогнито" для КриптоПро ЭЦП||
|| | CryptoPro_Incognito_off| выключение настройки "Разрешить использование в режиме Инкогнито" для КриптоПро ЭЦП||
|| | CryptoPro_Files_on| включение настройки "Разрешить открывать файлы по ссылкам" для КриптоПро ЭЦП||
|| | CryptoPro_Files_off| выключение настройки "Разрешить открывать файлы по ссылкам" для КриптоПро ЭЦП||
|| a_Protect| | Взаимодействие со страницей "Protect"||
|| | enter| количество входов на страницу||
|| | Left_ThreatPrt_move| количество кликов по пункту "Защита от угроз" в левом меню||
|| | Left_BroPrt_move| количество кликов по пункту "Защита браузера" в левом меню||
|| | CheckSitesFiles_off| отключение настройки "Проверять безопасность посещаемых сайтов и загружаемых сайтов"||
|| | CheckSitesFiles_on| включение настройки "Проверять безопасность посещаемых сайтов и загружаемых сайтов"||
|| | AFPswd_off| отключение настройки "Антифишинг паролей"||
|| | AFPswd_on| включение настройки "Антифишинг паролей"||
|| | AFPswdClean| очистка данных в "Антифишинге паролей" (считаем только ответы "Да")||
|| | AFCards_off| отключение настройки "Антифишинг банковских карт"||
|| | AFCards_on| включение настройки "Антифишинг банковских карт"||
|| | Shock_off| отключение настройки "Блокировка шокирующей рекламы"||
|| | Shock_on| включение настройки "Блокировка шокирующей рекламы"||
|| | Disturb_off| отключение настройки "Блокировка мешающей рекламы"||
|| | Disturb_on| включение настройки "Блокировка мешающей рекламы"||
|| | BadAd_set| открытие страницы настроек блокировщика рекламы||
|| | BadAd_add| добавление изображения в черный список рекламы через настройки||
|| | BadAd_delete| удаление изображения из черного списка рекламы через настройки||
|| | BadAd_white_add| добавление сайта в исключений блокировщика рекламы через настройки||
|| | BadAd_white_delete| удаление сайта из списка исключений блокировщика рекламы через настройки||
|| | SafeMode_off| отключение настройки "Открывать страницы онлайн-банков и платежных систем в защищенном режиме"||
|| | SafeMode_on| включение настройки "Открывать страницы онлайн-банков и платежных систем в защищенном режиме"||
|| | WiFi_off| отключение настройки "Шифровать данные при подключении к публичным сетям Wi_Fi"||
|| | WiFi_on| включение настройки "Шифровать данные при подключении к публичным сетям Wi_Fi"||
|| | DNS_off| отключение настройки "Использовать DNS-сервер для шифрования DNSCrypt"||
|| | DNS_on| включение настройки "Использовать DNS-сервер для шифрования DNSCrypt"||
|| | ChngDNS| изменение DNS-сервера||
|| | prt_reset| сброс настроек защиты браузера (подтверждение действия в диалоге после клика по ссылке "Сбросить настройки") ||
|| | help_prt| вызов справки со страницы Protect (клик по ссылке "Справка" раздела "Защита браузера от вредоносных приложений"||
|| | FnS_off| отключение настройки "Файлы и настройки Яндекс Браузера"||
|| | FnS_on| включение настройки "Файлы и настройки Яндекс Браузера"||
|| | Profiles_off| отключение настройки "Профили пользователей Яндекс Браузера"||
|| | Profiles_on| включение настройки "Профили пользователей Яндекс Браузера"||
|| | SnK_off| отключение настройки "Экран и клавиатура"||
|| | SnK_on| включение настройки "Экран и клавиатура"||
|| | OS_off| отключение настройки "Настройки операционной системы"||
|| | OS_on| включение настройки "Настройки операционной системы"||
|| | MnP_off| отключение настройки "Память и процессы Яндекс Браузера"||
|| | MnP_on| включение настройки "Память и процессы Яндекс Браузера"||
|| | Notification_off| отключение настройки "Показывать уведомления о заблокированных действиях"||
|| | Notification_on| включение настройки "Показывать уведомления о заблокированных действиях"||
|| | Icon_off| отключение настройки "Всегда показывать иконку защиты на панели задач"||
|| | Icon_on| включение настройки "Всегда показывать иконку защиты на панели задач"||
|| | j_view| переход на вкладку "Журнал событий"||
|| | entrust_view| переход на вкладку "Доверенные приложения"||
|| | j_add_entrust| добавление приложения в доверенный список из журнала событий||
|| | J_delete| удаление записи из журнала событий||
|| | j_clear| очищение журнала событий по кнопке "Очистить журнал"||
|| | j_item_view| просмотр информации о записи в журнале||
|| | j_item_add_entrust| добавление приложения в доверенный список из просмотра информации о записи в журнале||
|| | j_item_notification| Включениеотключение уведомлений по приложению из просмотра информации о записи в журнале||
|| | entrust_add| добавление приложения в список||
|| | entrust_delete| удаление приложения из списка||
|| | prt_half_off| отключение защиты на 30 минут||
|| | prt_half_on| ручное включение защиты после отключения на 30 минут||
|| | prt_Reload_off| отключение защиты до перезагрузки||
|| | prt_reload_on| ручное включение защиты после отключения до перезагрузки||
|| | prt_manual_off| отключение защиты до ручного включения (навсегда)||
|| | prt_Manual_on| ручное включение защиты после отключения навсегда||
|| a_Com_Settings| | Взаимодействие со страницей "Настройки"||
|| | enter| количество входов на страницу||
|| | Left_ComSet_move| количество кликов по пункту "Общие настройки" в левом меню||
|| | Left_Interface_move| количество кликов по пункту "Интерфейс" в левом меню||
|| | Left_Tools_move| количество кликов по пункту "Инструменты" в левом меню||
|| | Left_Sites_move| количество кликов по пункту "Сайты" в левом меню||
|| | Left_System_move| количество кликов по пункту "Системные" в левом меню||
|| | Left_About_move| количество кликов по пункту "О браузере" в левом меню||
|| | User_Add| добавление пользователя||
|| | User_Delete| удаление пользователя||
|| | User_Edit| редактирование пользователя||
|| | Sync_open| Открытие формы настроек синхронизации||
|| | Sync_On| Включение синхронизации||
|| | Sync_Off| отключение синхронизации||
|| | Sync_Bkmrks_off| отключение синхронизации закладок||
|| | Sync_Bkmrks_on| включение синхронизации закладок||
|| | Sync_Tablo_off| отключение синхронизации табло||
|| | Sync_Tablo_on| включение синхронизации табло||
|| | Sync_Pass_off| отключение синхронизации паролей||
|| | Sync_Pass_on| включение синхронизации паролей||
|| | Sync_Ext_off| отключение синхронизации расширений||
|| | Sync_Ext_on| включение синхронизации расширений||
|| | Sync_History_off| отключение синхронизации истории||
|| | Sync_History_on| включение синхронизации истории||
|| | Sync_Apps_off| отключение синхронизации приложений||
|| | Sync_Apps_on| включение синхронизации приложений||
|| | Sync_AutoFill_off| отключение синхронизации данных автозаполнения||
|| | Sync_AutoFill_on| включение синхронизации данных автозаполнения||
|| | Sync_Settings_off| отключение синхронизации настроек||
|| | Sync_Settings_on| включение синхронизации настроек||
|| | Sync_OpenTabs_off| отключение синхронизации открытых вкладок||
|| | Sync_OpenTabs_on| включение синхронизации открытых вкладок||
|| | Import_Open| открытие формы импорта||
|| | Import_Source_Change| изменение источника импорта||
|| | Import_history_on| импорт истории||
|| | Import_history_off| импорт без истории||
|| | Import_bookmarks_on| импорт закладок||
|| | Import_bookmarks_off| импорт без закладок||
|| | Import_Pass_on| импорт паролей||
|| | Import_Pass_off| импорт без паролей||
|| | Import_Settings_on| импорт настроек||
|| | Import_Settings_off| импорт без настроек||
|| | ShowZEN_off| отключение настройки "Показывать в новой вкладке ленту рекомендаций"||
|| | ShowZEN_on| включение настройки "Показывать в новой вкладке ленту рекомендаций"||
|| | ImprRecAdv_off| отключение настройки "Улучшать качество рекомендаций и рекламы с помощью"||
|| | ImprRecAdv_on|  включение настройки "Улучшать качество рекомендаций и рекламы с помощью"||
|| | ShowSug_off| отключение настройки "Показывать подсказки при наборе адресов и паролей"||
|| | ShowSug_on| включение настройки "Показывать подсказки при наборе адресов и паролей"||
|| | ShowSearchRq_off| - отключение настройки "Показывать в Умной строке поисковые запросы при поиске на сайте"||
|| | ShowSearchRq_on| включение настройки "Показывать подсказки при наборе адресов и паролей"||
|| | SuggestCorr_off| отключение настройки "Предлагать исправления при опечатках в адресах сайтов"||
|| | SuggestCorr_on| включение настройки "Предлагать исправления при опечатках в адресах сайтов"||
|| | RequestPD_off| отключение настройки "Заранее запрашивать данные о страницах, чтобы быстрее их загружать"||
|| | RequestPD_on| включение настройки "Заранее запрашивать данные о страницах, чтобы быстрее их загружать"||
|| | SearchSys_Set_open| открытие настроек поисковой системы||
|| | SearchSys_Add| добавление поисковой системы||
|| | SearchSys_Delete| удаление поисковой системы||
|| | SearchSys_Recover| восстановление поисковой системы из удаленных||
|| | SearchSys_Change| изменение поисковой системы по умолчанию||
|| | ShowYandex_off| отключение настройки "Показывать кнопку Яндекс"||
|| | ShowYandex_on| включение настройки "Показывать кнопку Яндекс"||
|| | ShowButtons_off| отключение настройки "Показывать в Умной строке кнопки Копировать и поделиться"||
|| | ShowButtons_on| включение настройки "Показывать в Умной строке кнопки Копировать и поделиться"||
|| | EdHints_off| отключение настройки "Показывать обучающие подсказки"||
|| | EdHints_on| включение настройки "Показывать обучающие подсказки"||
|| | DisplayDnT_off| отключение настройки "Отображать адреса страниц в виде домен -> заголовок"||
|| | DisplayDnT_on| включение настройки "Отображать адреса страниц в виде домен -> заголовок"||
|| | OpenMPbyClk_off| отключение настройки "Открывать главную страницу сайту по клику на его домен в Умной строке"||
|| | OpenMPbyClk_on| включение настройки "Открывать главную страницу сайту по клику на его домен в Умной строке"||
|| | LowEn_off| отключение настройки "Отключать анимацию при низком заряде батареи"||
|| | LowEn_on| включение настройки "Отключать анимацию при низком заряде батареи"||
|| | ShowBmrks_off| отключение настройки "Показывать панель закладок"||
|| | ShowBmrks_on| включение настройки "Показывать панель закладок"||
|| | ShowBmrks_inNew_off| отключение настройки "Только в новой вкладке"||
|| | ShowBmrks_inNew_on| включение настройки "Только в новой вкладке"||
|| | ShowIcons_off| отключение настройки "Показывать иконки сайтов"||
|| | ShowIcons_on| включение настройки "Показывать иконки сайтов"||
|| | ShowTabs_Top_Bot| настройка Вкладки из "Отображать сверху" в "Отображать снизу"||
|| | ShowIcons_Bot_Top| настройка Вкладки из "Отображать снизу" в "Отображать сверху"||
|| | TabMinSize_off| отключение настройки "Ограничить минимальную ширину вкладки"||
|| | TabMinSize_on| включение настройки "Ограничить минимальную ширину вкладки"||
|| | HLActTab_off| отключение настройки "Выделять цветом активную вкладку"||
|| | HLActTab_on| включение настройки "Выделять цветом активную вкладку"||
|| | DntDuble_off| отключение настройки "Не дублировать вкладки при переходе из внешних приложений"||
|| | DntDuble_on| включение настройки "Не дублировать вкладки при переходе из внешних приложений"||
|| | GoToLastAct_off| отключение настройки "При закрытии вкладки переходить к последней активной вкладке"||
|| | GoToLastAct_on| включение настройки "При закрытии вкладки переходить к последней активной вкладке"||
|| | StartOpenTabs_off| отключение настройки "При запуске браузера открывать ранее открытые вкладки"||
|| | StartOpenTabs_on| включение настройки "При запуске браузера открывать ранее открытые вкладки"||
|| | StartYandex_0| отключение настройки "Открывать yandex.ru, если нет вкладок"||
|| | StartYandex_1| включение настройки "Открывать yandex.ru, если нет вкладок"||
|| | AutoFill_off| отключение настройки "Заполнять формы одним кликом"||
|| | AutoFill_on| включение настройки "Заполнять формы одним кликом"||
|| | AutoFill_Saved_open| открытие формы сохраненных данных для автозаполнения||
|| | Autofill_Adress_add| добавление адреса для автозаполнения||
|| | Autofill_Adress_delete| удаление адреса из списка для автозаполнения||
|| | Autofill_BC_add| добавление банковской карты в список для автозаполнения||
|| | Autofill_BC_delete| удаление банковской карты из списка для автозаполнения||
|| | UsePsm_off| отключение настройки "Использовать менеджер паролей"||
|| | UsePsm_on| включение настройки "Использовать менеджер паролей"||
|| | Goto_Psm_set| переход в настройки менеджера паролей со страницы настроек||
|| | Goto_Psm_saved| переход к сохраненным паролям со страницы настроек||
|| | QuickAnsw_off| отключение настройки "Показывать быстрые ответы Яндекса"||
|| | QuickAnsw_on| включение настройки "Показывать быстрые ответы Яндекса"||
|| | CompContMenu_off| отключение настройки "Показывать компактное меню"||
|| | CompContMenu_on| включение настройки "Показывать компактное меню"||
|| | SuggTransl_off| отключение настройки "Предлагать перевести станицы, если их язык отличается от языка интерфейса"||
|| | SuggTransl_on| включение настройки "Предлагать перевести станицы, если их язык отличается от языка интерфейса"||
|| | TranslHL_off| отключение настройки "Переводить слова и фразы при выделении"||
|| | TranslHL_on| включение настройки "Переводить слова и фразы при выделении"||
|| | TranslShift_off| отключение настройки "Переводить слова при наведении курсора и нажатии клавиши Shift"||
|| | TranslShift_on| включение настройки "Переводить слова при наведении курсора и нажатии клавиши Shift"||
|| | SpelCheck_add| добавление языка в список для проверки правописания||
|| | SpelCheck_delete| удаление языка из списка для проверки правописания||
|| | FindPhone_off| отключение настройки "Находить номера телефонов для вызова с мобильного"||
|| | FindPhone_on| включение настройки "Находить номера телефонов для вызова с мобильного"||
|| | UseMouse_off| отключение настройки "Использовать жесты мыши для навигации по страницам"||
|| | UseMouse_on| включение настройки "Использовать жесты мыши для навигации по страницам"||
|| | UseMouse_Set_Open| открытие формы "Настройки жестов"||
|| | UseMouse_Back_off| отключение настройки "(Движения мыши) Возврат к предыдущей странице"||
|| | UseMouse_Back_on| включение настройки "(Движения мыши) Возврат к предыдущей странице"||
|| | UseMouse_Next_off| отключение настройки "(Движения мыши) Переход к следующей странице"||
|| | UseMouse_Next_on| включение настройки "(Движения мыши) Переход к следующей странице"||
|| | UseMouse_Restore_off| отключение настройки "(Движения мыши) Восстановление последней закрытой вкладки"||
|| | UseMouse_Restore_on| включение настройки "(Движения мыши) Восстановление последней закрытой вкладки"||
|| | UseMouse_Close_off| отключение настройки "(Движения мыши) Закрытие вкладки"||
|| | UseMouse_Close_on| включение настройки "(Движения мыши) Закрытие вкладки"||
|| | UseMouse_Reload_off| отключение настройки "(Движения мыши) Перезагрузка страницы"||
|| | UseMouse_Reload_on| включение настройки "(Движения мыши) Перезагрузка страницы"||
|| | UseMouse_OpenTablo_off| отключение настройки "(Движения мыши) Открытие табло и установка курсора в Умную строку"||
|| | UseMouse_OpenTablo_on| включение настройки "(Движения мыши) Открытие табло и установка курсора в Умную строку"||
|| | UseMouse_Back_KB_off| отключение настройки "(Комбинации клавиш) Возврат к предыдущей странице"||
|| | UseMouse_Back_KB_on| включение настройки "(Комбинации клавиш) Возврат к предыдущей странице"||
|| | UseMouse_Next_KB_off| отключение настройки "(Комбинации клавиш) Переход к следующей странице"||
|| | UseMouse_Next_KB_on| настройки "(Комбинации клавиш) Переход к следующей странице"||
|| | Turbo_on| радио-баттон Турбо переключен в "Всегда включен"||
|| | Turbo_off| радио-баттон Турбо переключен в "Отключен"||
|| | Turbo_auto| радио-баттон Турбо переключен в "Автоматически включать при медленном соединении"||
|| | NotifChngSp_off| отключение настройки "Уведомлять об изменении скорости соединения"||
|| | NotifChngSp_on| включение настройки "Уведомлять об изменении скорости соединения"||
|| | CompressVideo_off| отключение настройки "Сжимать видео"||
|| | CompressVideo_on| включение настройки "Сжимать видео"||
|| | Dnlds_AskWhere_Save| радио-баттон Загрузки из "Всегда спрашивать, где сохранить файл" в "Сохранять файл"||
|| | Dnlds_SaveFileIn_Ask| радио-баттон Загрузки из "Сохранять файл" в "Всегда спрашивать, где сохранить файл"||
|| | OpenOfficeInBro_off| отключение настройка "Открывать файлы офисных форматов в браузере"||
|| | OpenOfficeInBro_on| включение настройки "Открывать файлы офисных форматов в браузере"||
|| | SendNotify_off| радио-баттон Отправка уведомлений переключен в "Запрещена"||
|| | SendNotify_ask| радио-баттон Отправка уведомлений переключен в "Запрашивать разрешение"||
|| | SendNotify_on| радио-баттон Отправка уведомлений переключен в "Разрешена"||
|| | Notify_off| отключение уведомлений на 3 часа (ручное)||
|| | Notify_on| ручное включение уведомлений||
|| | FontSize_change| изменение размера шрифта||
|| | Font_Settings| открытие формы настройки шрифтов||
|| | PageZoom_change| изменение масштаба страницы||
|| | Zoom_settings| открытие формы настройки сайтов||
|| | ExtSiteSet_open| Открытие формы расширенных настроек сайтов||
|| | AutoDnld_off| переключение радио-баттона Автоматическая загрузка файлов в "Запрещена"||
|| | AutoDnld_ask| переключение радио-баттона Автоматическая загрузка файлов "Запрашивать разрешение"||
|| | AutoDnld_on| переключение радио-баттона Автоматическая загрузка файлов в "Разрешена"||
|| | PopUp_off| переключение радио-баттона Всплывающие окна в "Запрещены"||
|| | PopUp_on| переключение радио-баттона Всплывающие окна в "Разрешены"||
|| | GenerateKey_off| переключение радио-баттона Генерация ключей в формах в "Запрещена"||
|| | GenerateKey_on| переключение радио-баттона Генерация ключей в формах в "Разрешена"||
|| | PlagInAccess_off| переключение радио-баттона Доступ плагинов к компьютеру в "Запрещен"||
|| | PlagInAccess_ask| переключение радио-баттона Доступ плагинов к компьютеру " в "Запрашивать разрешение"||
|| | PlagInAccess_on| переключение радио-баттона Доступ плагинов к компьютеру  в "Разрешен"||
|| | PlagInStart_Only_on| переключение радио-баттона Запуск плагинов в "Разрешен"||
|| | PlagInStart_Only_off| переключение радио-баттона Запуск плагинов в "Запрещен"||
|| | PlagInStart_on_only| переключение радио-баттона Запуск плагинов в "Разрешен только для важного содержимого страницы"||
|| | ProtectedCont_off| переключение радио-баттона Защищенное содержимое в "Запрещен"||
|| | ProtectedCont_on| переключение радио-баттона Защищенное содержимое в "Разрешен"||
|| | Camera_off_ask| радио-баттон Камера из "Запрещена" в "Запрашивать разрешение"||
|| | Camera_Ask_off| радио-баттон Камера из "Запрашивать разрешение" в "Запрещена"||
|| | Images_On_off| радио-баттон Картинки из "Разрешены" в "Запрещены"||
|| | Images_off_on| радио-баттон Картинки из "Запрещены" в "Разрешены"||
|| | Location_off| переключение радио-баттона Местоположение в "Запрещено"||
|| | Location_ask| переключение радио-баттона Местоположение в "Запрашивать разрешение"||
|| | Location_on| переключение радио-баттона Местоположение в "Разрешено"||
|| | Microphone_ask| переключение радио-баттона Микрофон в "Запрашивать разрешение"||
|| | Microphone_off| переключение радио-баттона Микрофон в "Запрещен"||
|| | Handler_off| переключение радио-баттона Обработка протоколов в "Запрещена"||
|| | Handler_on| переключение радио-баттона Обработка протоколов в "Разрешена"||
|| | BckgrSync_off| переключение радио-баттона Фоновая синхронизация в "Запрещена"||
|| | BckgrSync_on| переключение радио-баттона Фоновая синхронизация в "Разрешена"||
|| | Cookies_off| переключение радио-баттона Cookie файлы в "Запрещены"||
|| | Cookies_ask| переключение радио-баттона Cookie файлы в "Запрашивать разрешение"||
|| | Cookies_on| переключение радио-баттона Cookie файлы в "Разрешены"||
|| | Cookies_BlockFnD_off| отключение настройки "(Cookie файлы) Блокировать данные и файлы сторонних сайтов"||
|| | Cookies_BlockFnD_on| включение настройки "(Cookie файлы) Блокировать данные и файлы сторонних сайтов"||
|| | JS_off| переключение радио-баттона JavaScript в "Запрещен"||
|| | JS_on| переключение радио-баттона JavaScript в "Разрешен"||
|| | MIDI_off| переключение радио-баттона MIDI-устройства в "Запрещены"||
|| | MIDI_ask| переключение радио-баттона MIDI-устройства в "Запрашивать разрешение"||
|| | MIDI_on| переключение радио-баттона MIDI-устройства в "Разрешены"||
|| | Proxy_Set_open| открытие формы настройки прокси-сервера||
|| | Certf_Mng_open| открытие форма управления сертификатами||
|| | Interface_lng_chng| изменение языка интерфейса||
|| | Pages_lng_chng| изменение языка отображения страниц||
|| | BckgrMode_off| отключение настройки "Разрешать приложениям работать в фоновом режиме после закрытия браузера"||
|| | BckgrMode_on| включение настройки "Разрешать приложениям работать в фоновом режиме после закрытия браузера"||
|| | UseHdwrAcc_off| отключение настройки "Использовать аппаратное ускорение, если возможно"||
|| | UseHdwrAc_on| включение настройки "Использовать аппаратное ускорение, если возможно"||
|| | UpdIfClosed_off| отключение настройки "Обновлять браузер даже, даже если он не запущен"||
|| | UpdIfClosed_on| включение настройки "Обновлять браузер даже, даже если он не запущен"||
|| | SendStat_off| отключение настройки "Отправлять в Яндекс анонимную статистику использования Браузера"||
|| | SendStat_on| включение настройки "Отправлять в Яндекс анонимную статистику использования Браузера"||
|| | SendCrash_off| отключение настройки "Отправлять в Яндекс отчеты о сбоях"||
|| | SendCrash_on| включение настройки "Отправлять в Яндекс отчеты о сбоях||
|| | SendFilesSites_off| отключение настройки "Отправлять в Яндекс подозрительные файлы и информацию о небезопасных файлах"||
|| | SendFilesSite_on| включение настройки "Отправлять в Яндекс подозрительные файлы и информацию о небезопасных файлах||
|| | DontTrack_off| отключение настройки "Отправлять сайтам запрос Do Not Track"||
|| | DontTrack_on| включение настройки "Отправлять сайтам запрос Do Not Track"||
|| | DontTrack_help| вызов быстрой помощи настройки "Отправлять сайтам запрос Do Not Track"||
|| | CleanHistory_open| открытие формы очистки истории||
|| | CleanHistory| очистка истории||
|| | CleanHistory_h| очистка истории за прошедший час||
|| | CleanHistory_d| очистка истории за прошедший день||
|| | CleanHistory_w| очистка истории за прошедшую неделю||
|| | CleanHistory_4w| очистка истории за прошедшие 4 недели||
|| | CleanHistory_all| очистка истории за все время||
|| | CleanHistory_view| очистка истории просмотров||
|| | CleanHistory_dnld| очистка истории загрузок||
|| | CleanHistory_psw| очистка паролей||
|| | CleanHistory_autofill| очистка данных для автозаполнения||
|| | CleanHistory_f_cash| очистка файлов, сохраненных в кэше||
|| | CleanHistory_cookie| очистка cookie И других данных сайтов и модулей||
|| | CleanHistory_app| очистка данных приложений||
|| | CleanHistory_media| очистка медиалицензий||
|| | Reset_open| открытие окна сброса настроек||
|| | Reset| сброс настроек||
|| | Update| обновление браузера по кнопке "Обновить" из настроек||
|| | License_view| просмотр лицензионного соглашения из настроек||
|| | help| вызов справки из раздела "О браузере" настроек||
|| | report| открытие формы "Сообщить о проблеме" из настроек браузера||
|#

===Темная тема и форма табов - client_id: settings
Статусная статистика для темной темы в браузере и выбора формы табов в Настройках.
Делали тут:
https://st.yandex-team.ru/BROWSER-94847
Работает с релиза 18.10.1.
ТЗ: https://wiki.yandex-team.ru/browser/the-hat/tab-user-choice

Параметр **a_chosen_tabs** - выбор таба
    * no-feature: Фича NewTabDesign выключена
    * fieldtrial: Конфигурация переопределена через fieldtrial
    * {id}: Идентификатор конфигурации из серверного конфига.
    * missing: tbd
Параметр **a_dark_theme** - темная тема
    * no-feature: Фича NewTabDesign выключена
    * 0: Тёмная тема выключена
    * 1: Тёмная тема включена
    * 2: Включена тёмная тема В соответствии с темой ОС
    * 3: Включена светлая тема в соответствии с темой ОС
    * sys_dark - статус включенности темной темы в ОС
    *  show_b - показ балуна о переключении на тёмную тему в зависимости от темы OS
    *  close_b - закрытие балуна переключения на тёмную тему по крестику
    *  declline_b - отказ от тёмной темы в балуне
    *  accept_b - согласие с тёмной темой в балуне

===Цветные темы - client_id: settings
Статусная статистика для цветных тем
С 19.7.3

Параметр **a_color_theme**:
28 параметров, каждый параметр соответствует цветной теме и называется в формате <color>_<tint>, где color - цвет темы, tint оттенок:
<{Цвета и оттенки
https://jing.yandex-team.ru/files/nadya-glzv/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8%20%E2%80%94%20%D0%AF%D0%BD%D0%B4%D0%B5%D0%BA%D1%81.%D0%91%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80%202019-08-28%2012.13.42.png}>

===Конфигуратор шапки - client_id: uiconfig
Конфигурирование параметров отображения шапки через конфиг (наподобие css-файла).
Делали тут: https://st.yandex-team.ru/BROWSER-95641
Работает с релиза 18.11.0.
ТЗ: https://wiki.yandex-team.ru/browser/the-hat/

====Статусная
Отправляем с запуском браузера и дальше каждые 4 часа название конфигурации шапки и паков иконок у пользователя.
Период отправки можно перезадать через параметр tom фичи UIConfig. Он задается в минутах. Если задать значение меньше 10, то отправка по таймеру отменяется.
По этим данным в последствии строим графики распределения конфигураций по пользователям, чтобы следить за раскатками конфигураций и обновлением на новые.
<[Client_id: "uiconfig"
параметр a_status_config, раскладывается на названия конфигураций
параметр a_status_icons, раскладывается на названия паков иконок

Формат значений параметров a_status_config и a_status_icons аналогичен и соответствует следующему:
1. если конфигурация дефолтная значение равно "[Default]"
2. если конфигурация экспериментальная и подтянулась из дистра - "<имя_файла>"
3. если конфигурация экспериментальная и подтянулась из компоненты - "CRX <имя_файла>"
Эта схема соответствует тому, что используется при отправке этих данных в ФОС.
]>


====Событийная
1. Собираем способ изменения конфигурации (с сервера по эксперименту или зашита в сборку при апдейте, если это возможно)
2. Собираем время (timestamp) изменения
3. Собираем с старое и новое имя конфигурации
4. Номер изменения конфигурации (считаем который раз меняется конфигурация у пользователя)
По этим данным будем строить отчет изменений конфигураций.

**Для конфига ШАПКИ**:
<[Client_id: "uiconfig"
параметр a_change_config - как меняем конфиг шапки, раскладывается на:
  - distrib - зашита в сборку
  - server - изменена с сервера
  - else - другие способы (остальное)

параметр a_change_config_num - сколько раз у пользователя сменялся конфиг шапки, раскладывается на кол-во смен конфигураций у пользователя

параметр a_change_config_names - какая смена произошла (старое и новое имя конфига), раскладывается на:
  - <oldname>-<newname>
  ВАЖНО: если пользователь только попал в фичу и это его первый конфиг, то пишем только newname.

параметр change_config_time - записываем время изменения конфига шапки
]>

**Для паков иконок**:
<[Client_id: "uiconfig"
параметр a_change_icons - как меняем пак иконок, раскладывается на:
  - distrib - зашит в сборку
  - server - изменен с сервера
  - else - другие способы (остальное)

параметр a_change_icons_num - сколько раз у пользователя сменялся пак иконок, раскладывается на кол-во смен у пользователя

параметр a_change_icons_names - какая смена произошла (старое и новое имя пака), раскладывается на:
  - <oldname>-<newname>
  ВАЖНО: если пользователь только попал в фичу и это его первый пак, то пишем только newname.

параметр change_icons_time - записываем время изменения пака иконок
]>
===Старт Бразуера ("client_id":"browserstart") (начиная с 1.7 HF)
  * d — вкладки не восстанавливаем, стартуем в режиме дна по дефолту
  * с — режим дна после крэша
  * s — вкладки восстанавливаем, но был закрыт в режим дна
  * w — пользователь выбрал открыть новое окно браузера
  * i - выбрано новое окно, в режиме инкогнито
  * "atlnch": "1" — отправляется при запуске браузера с включенной настройкой "Запускать Браузер при включении компьютера"
Пример: {client_id":"browserstart","params":{"whitestart":"d"}}
====Задачи
  *BROWSER-5953
  *BROWSER-25744

===Статистика об установленных экстеншнах в Браузере ("client_id" : "instextens") Q2
Всегда отправляем на каждом старте и потом раз в 4 часа
В браузере всегда есть скрытые от пользователя расширения (Табло, например). По этому client_id можно считать количество профилей у пользователей.
<[ //{"client_id":"instextens","params":{"extension":[["ahfgeienlihckogmohjhadlkjgocpleb","0.1","Web Store",false],["bgeakjmfknncppbmgkkfbglnodccdecp","2.0.85","",false],["eemcgdkfndhakfknompkggombfjjjeno","0.1","Bookmark Manager",false],["emghafiiokbjdgphaofindndbcicinae","1.1.0.1528","",false],["ennkphjdgehloodpbhlhldgbnhmacadg","0.1","Settings",false]],"profile":"Default"}}//]>
1) Пишем идентификатор профиля (**"profile"**)
2) Информацию о расширениях в виде массива **"extension"**:
  *id экстеншна
  *версию
  *название
  *выключен (да/нет) (true для выключенных, и false для включенных)
  *Источник установки (Я.стор - "yast", Хром.Стор - "chst", другие - "oth" и тд). Появилось в NN версии.

====Пример
{
"client_id" : "instextens",
"params" : {
"profile" : "Profile 1",
"extension" : [
["dsjkhsfdkjghfkjghdfkjghfdgjdf", "1.12.1.5", "Visual Bookmarks", false, "yast"],
["dsfhdfskjghfdskjghfkjghsdfjkd", "5.7", "Yandex.Bar", true, "yast"]
]
}
}

====Задачи
  *BROWSER-5763

===СМС-Фрод ("client_id":"sbfrod") Q2
  *Срабатывания предупреждений о возможной опасности ("fraudurl":"url")
  *Нажатие на "подробнее" ("moreinfo":"1")
  *Нажатия на кнопку "Уйти со страницы" ("away":"1")
  *Закрытый крестиком таб на котором был показан инфобар, при условии, что не было сабмита формы с телефонным номером ("noactive":"1")
  *Нажатие кнопки "back" ("back":"1")
  *Навигейт через набранный в омнибоксе урл/запрос ("omni":"1")
  *Навигейт через табло, хлебные крошки, Я-кнопку, закладки ("tabloetc":"1")
  *Закрытие инфобара керстиком ("ignore":"1")
  *Переход по ссылке с зараженного сайта, не считая "подробнее на инфобаре" ("nexturl":"1")
  *Сабмит формы с телефонным номером на вкладке, где был показан инфобар ("keyb":"1")

Начиная с версии 14.2
  *Срабатывания предупреждений о возможной опасности ("fraudurl":"url")
  *Нажатие на "подробнее" ("moreinfo":"1")
  *Нажатия на кнопку "Уйти со страницы" ("away":"1")
  *Закрытие инфобара керстиком ("ignore":"1")

====Пример
[{"client_id":"sbfrod","params":{"away":"1"}}]
====Задачи
BROWSER-4701
====Отчеты
BROWSER-7383

===Опасные страницы (просят ввода номера) ("client_id":"numbtype")
Если мы знаем, что человек на странице ввел телефонный номер и нажал "сабмит", то в статистику необходимо отсылать данные об этом.
Номером мы считаем: последовательность символов длинной более 7, но менее 26 символов, из которых 7-12 это цифры, а остальные это символы +,-,),(
====Пример
{"client_id":"numbtype","params":{"url":"examople.com"}}
====Задачи
  *BROWSER-6160

=== интеграция с Диском ("client_id":"DiskIntegration")
=====Отправляемая статистика:=====
- число инсталлов+апдейтов
- число кликов на "сохранить в диск"
{"client_id":"DiskIntegration","params" {"save": 1 }} -- при сохранении из контекстного меню. Вызывается перед каждым сохранением.
{"client_id":"DiskIntegration","params":{"install":"new"}} — диска ранее не было, а теперь есть
{"client_id":"DiskIntegration","params":{"install":"update"}} — диск был, но старый, мы поставили новый
___(хотфикс)____
{"client_id":"DiskIntegration","params":{"login":"au"}} -- вызывается тогда, когда у пользователя был старый незалогиненный диск, мы его обновили и залогинились (after update)
{"client_id":"DiskIntegration","params":{"login":"e"}} -- вызывается тогда, когда у пользователя был новый (0.9.1?) диск, но он был незалогинен, а мы залогинились (existing)
{"client_id":"DiskIntegration","params":{"install":"fail"}} -- ошибка при инсталляции
Для новой инсталляции login не посылается, так как явно если идёт install:new, то будет ещё и логин.

===Поисковость  ("client_id":"Searchness")

=====Отправляемая статистика:=====
Везде фиксировать домен поисковой системы:
Способ, которым пользователь вошел в режим поисковости:
  * Пользователь поискал на морде поисковой системы и попал на SERP (по referer)
  * Пользователь вставил в адресную строку ссылку на SERP и перешел по ссылке (или перешел по ссылке из другой программы, или ввел урл вручную)
  * Пользователь ввел домен и нажал TAB
  * Пользователь ввел ключевое слово и нажал TAB или Пробел
  * Повторное использование режима поисковости
Пользователь вышел из режима поисковости и каким способом:
  * Пользователь нажал на крестик (и кликабельную область вокруг крестика) в поисковом маркере. Фиксировать домен поисковой системы (images.yandex.ru, google.com.ua и т.д.)
  * В режиме поисковости пользователь вышел по ESC. Фиксировать домен поисковой системы
  * Пользователь дважды кликнул по поисковому маркеру. Фиксировать домен поисковой системы.
  * Пользователь очистил адресную строку и нажал Backspace
  * Выход из режима поисковости по вставке из буфера обмена урла с поисковостью (с дальнейшим входом в новый режим поисковости)
  * Выход по нажатию на кнопку альтернативного поисковика в саджесте
  * По закрытию таба статистику отправлять не нужно
Клик в адресную строку и далее:
  * клик на "обновить" и "крестик".

**Имя список параметров - actions**
Параметры:
"sfmp" - поиск с МОРДЫ
"sdef" - пользователь перешел в поисковость с поиска по умолчанию
"sbpl" - Пользователь вставил в адресную строку ссылку на SERP и перешел по ссылке (или перешел по ссылке из другой программы, или ввел урл вручную)
  * начиная с 14.2 значение имеет вид массива из двух элементов, первый элемент содержит имя хоста, второй может быть строкой "ntb"
  * начиная с 14.12 ключ "sbpl" может принимать вид "sbpl_ntb", что означает то же, что ранее означал ключ "sbpl" с дополнительным значением "ntb" --- см. BROWSER-23390
"sbn" - Пользователь ввел домен и нажал TAB
"sbk" - Пользователь ввел ключевое слово и нажал TAB или Пробел
"sst" - Повторное использование режима поисковости
"hbcb" - Пользователь нажал на крестик (и кликабельную область вокруг крестика) в поисковом маркере. Фиксировать домен поисковой системы (images.yandex.ru, google.com.ua и т.д.)
"hbe" - В режиме поисковости пользователь вышел по ESC. Фиксировать домен поисковой системы
"hbdbl" - Пользователь дважды кликнул по поисковому маркеру. Фиксировать домен поисковой системы.
"hbb" - Пользователь очистил адресную строку и нажал Backspace
"hbp" - Выход из режима поисковости по вставке из буфера обмена урла с поисковостью (с дальнейшим входом в новый режим поисковости)
"hbas" - Выход по нажатию на кнопку альтернативного поисковика в саджесте
"hbtc" - По закрытию таба статистику отправлять не нужно
--"ur" - клик на "обновить" и "крестик".--  (до 14.2, см. BROWSER-12253)
"ur" - клик на "лупа" и "обновить" (c 14.2, см. BROWSER-12253)
"ux" - клик на "крестик"  (c 14.2, см. BROWSER-12253)
=====Примеры посылок в бандле

  * до 14.2%%(json){
    "client_id": "Searchness",
    "params": {
        "actions": [
            {
                "sfmp": "yandex.ru"
            },
            {
                "hbas": "video.yandex.ru"
            }
        ]
    }
}%%
  * начиная с 14.2 — у значений добавился уровень массива, но обычно массив состоит из одного элемента, --- см. BROWSER-11879%%(json){
    "client_id": "Searchness",
    "params": {
        "actions": [
            {
                "sfmp": [ "yandex.ru" ]
            },
            {
                "sbpl": [ "yandex.ru", "ntb" ]
            },
            {
                "sbpl": [ "yandex.ru" ]
            },
            {
                "hbas": [ "video.yandex.ru" ]
            }
        ]
    }
}%%
  * начиная с 14.12 — порядок событий не сохраняется, структура сообщения упрощена, --- см. BROWSER-23390%%(json){
    "client_id": "Searchness",
    "params": {
        "hbas": [
            "video.yandex.ru"
        ],
        "sbpl": [
            "yandex.ua"
        ],
        "sbpl_ntb": [
            "yandex.ru"
        ],
        "sfmp": [
            "yandex.ru",
            "yandex.ua"
        ]
    }
}%%

//Примечание: Статистика отправляется с ближайшим навигейтом и только после получения законченной цепочки действий, например: "зашли в режим поисковости с морды, поискали что-то и вышли из поисковости по крестику"//


===Синхронизация
====Инфобар
Фиксируем клик (в итоге интересует общее количество) на 1) "включить синхронизацию" 2) Поробнее 3) крестик закрытия
Файлы ("client_id":"syncbar")

Отправляемая статистика:
Клик на "Включить синхронизацию" ("switchon":"1")
Клик на "Подробнее" ("moreinfo":"1")
Клик на крестик закрытия ("Close":"1")

Пример: client_id":"syncbar","params":{"switchon":"1"}
https://jira.yandex-team.ru/browse/BROWSER-7097

====Страница авторизации
Надо фиксировать клик именно на странице аторизации
Файлы ("client_id":"sync")
Кликнули на логин успешно (то есть получен токен): ("syncpgon":"1")

BROWSER-7102

====Факт синхронизации
Фиксируем включение/выключение синхронизации
Файлы ("client_id":"sync")
Включилась синхронизация: можно получить суммой логинов со страницы и с инфобара {"client_id":"syncbar","params":{"switchon":"1"}} и  {"client_id":"sync","params":{"syncpgon":"1"}}. Отдельный параметр не нужен. !!Вообще можно включить еще через настройки, кнопка включения не логируется!!
Выключилась синхронизация на странице синхры: ("syncoff":"1")
Факт выключения синхронизации и последующего удаления профиля в течение суток (добавлено Томшинским)
Факт удаления профиля (без относительно синхронизации)  (добавлено Томшинским)
Факт повторного входа в синхронизацию под прежним логином (добавлено Томшинским)

Пример: client_id":"sync","params":{"syncoff":"1"}
https://jira.yandex-team.ru/browse/BROWSER-7098

====Статистика настроек
Фиксируем включение/выключение синхронизации
Файлы ("client_id":"syncset")
Включена синхра Табло: ("sTableau":"1")
Включена синхра истории: ("sHystory":"1")
Включена синхра расширений: ("sExtentions":"1")
Включена синхра приложений: ("sApps":"1")
Включена синхра настроек: ("sSett":"1")
Включена синхра автозаполенения: ("sAuto":"1")
Включена синхра пароли: ("sPass":"1")
Включена синхра закладки: ("sBkmrk":"1")

Пример: client_id":"syncset","params":{"sExtentions":"1","sApps":"1","sBkmrk":"1"}
BROWSER-7105

====Способ авторизации
Статистика по способу авторизации (процентная разбивка по кейсам) в соответствии с таблицей кейсов: http://wiki.yandex-team.ru/browser/sync#uproshhenievxodavsinxru

====Точки входа
Собирать статистику по точкам входа:
  1. Новый таб
  2. Шестеренка → Войти в браузер Яндекс
  3. Настройки
  4. Через иконку профиля %%*%%
  5. Через меню %%**%%
%%*%% После создания второго профиля
%%**%% После создания второго профиля на Mac

====Ошибки
1. Необходимость ввести пароль еще раз.
 Дописываем в статистику settings. Когда бутерброд становиться красным, появляется  надпись "Введите старый пароль" около меню Синхронизация в выпадающем меню по нажатию на бутерброд.
 Раз в 2 часа проверяем, есть ли ошибка. Если ошибка есть, отправляем в статистику.("a_syerr":"1")

Причины:
Ошибки входа (токен не подошел)- 1
Ошибка при шифровании- 2
Другая причина- 12

===Тотальная синхронизация
client_id:  %%sync%%
a_optout_old1
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optout_old2
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optout_new3
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optout_new4
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optin_old5
* show - показ балуна с оптином
* clk_later - клик по кнопке "не сейчас"
* clk_optin - клик по согласию на синхронизацию
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optout_old6
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)
a_optout_new7
* show - показ балуна с оптаутом
* clk_settings - клик на переход в настройки
* clk_deny - клик на отказаться
* clk_fine - закрыть балун по клику на "Понятно"
* clk_close - закрыть балун (не кнопками принять-отказаться)

client_id: %%signin%%
a_totalsync
* optout_old1 - соответствует срабатыванию условий для показа балуна из кейса #1
* optout_old2 - соответствует срабатыванию условий для показа балуна из кейса #2
* optout_new3 - соответствует срабатыванию условий для показа балуна из кейса #3
* optout_new4 - соответствует срабатыванию условий для показа балуна из кейса #4
* optin_old5 - соответствует срабатыванию условий для показа балуна из кейса #5
* optout_old6 - соответствует срабатыванию условий для показа балуна из кейса #6
* optout_new7 - соответствует срабатыванию условий для показа балуна из кейса #7

===Турбо
====Данные об автоматическом включении Турбо ("client_id":"turbo_turnon")
=====Отправляемая статистика
"turbo_turnon_auto" – автоматически или вручную было включено Турбо ("turbo_turnon_auto":"0" – включено было руками)
=====Пример посылок в бандле
%%
{"client_id":"turbo_turnon","params":{"turbo_turnon_auto":"1"}}
%%

balloon_show:1 при показе балуна
balloon_click:1 при клике на "Настроить"
====Данные об изменении скорости сети ("client_id":"tsnd")
 --"client_id":"turbo_slow_network_determined"--
=====Отправляемая статистика
Скорость за последний измеряемый участок (10 мин или менее если только недавно браузер запустился) в байтах в секунду ("md_sp":"2252","mn_sp":"780","mx_sp":"192")
"md_sp" --"median_speed"--
"mn_sp" --"min_speed"--
"mx_sp" --"max_speed"--

На основании скольких запросов, IP адресов, и объема данных принимали решение о включении турбо
("dec_req":"240869","dec_ips":"1","dec_byt":"13")
"dec_req" --"decision_requests"--
 "dec_ips" --"decision_ips"--
"dec_byt" --"decision_bytes"--

Было ли принятое решение «быстрым» или медленным (имеется в виду принятие решения за 2 минуты (значение в профиле совпадает с новым мнением о сети) или за 10 минут (предварительное мнение о сети не совпало со значением в профиле, собираем данные 10 минут для нового мнения о сети))
("ifd":"1" – быстрое решение)
"ifd" --"is_fast_decision"--

//Примечание: --старые названия параметров--//

=====Пример посылок в бандле
%%
{"client_id":"tsnd","params":{"dec_byt":"4232109","dec_ips":"30","dec_req":"138","ifd":"0","md_sp":"3706","mn_sp":"665","mx_sp":"13925000"}}
%%
====Таски
https://jira.yandex-team.ru/browse/BROWSER-4575
https://jira.yandex-team.ru/browse/BROWSER-5212
https://jira.yandex-team.ru/browse/BROWSER-6755
BROWSER-9911
http://wiki.yandex-team.ru/browser/dev/docs/turbo/auto/1.0

===Антисусанин !!(в разработке)!!
====Крэш таба chrome://crash/ ("client_id":"as_crash")
=====Отправляемая статистика
Статистику отправляем по факту закрытия страницы с ошибкой. Для каждого случая показа страницы ошибок возможен один из следующих исходов, приводящих к закрытию страницы:
  *Нажатие на кнопку обновления страницы ("pressreload":"1")
  *Переход по ссылке на help ("helplink":"1")
  *Любой другой способ покинуть страницу ("other":"1")
Таким образом вместе с "client_id":"as_crash" пишется один из трёх параметров.
=====Примеры посылок в бандле
{"client_id":"as_crash","params":{"pressreload":"1"}}
====Таски
BROWSER-7639

====Нехватка памяти chrome://kill/ ("client_id":"as_kill")
=====Отправляемая статистика
Статистику отправляем по факту закрытия страницы с ошибкой. Для каждого случая показа страницы ошибок возможен один из следующих исходов, приводящих к закрытию страницы:
  *Нажатие на кнопку обновления страницы ("pressreload":"1")
  *Переход по ссылке на help ("helplink":"1")
  *Любой другой способ покинуть страницу ("other":"1")
Таким образом вместе с "client_id":"as_kill" пишется один из трёх параметров.
=====Примеры посылок в бандле
{"client_id":"as_kill","params":{"pressreload":"1"}}
====Таски
BROWSER-7639

====Ошибки сети ("client_id":"as_errors")
=====Отправляемая статистика:
  * Код ошибки ("a_code":"106")
  * Название ошибки ("a_name":"net::ERR_INTERNET_DISCONNECTED")
"client_id":"as_errors" отправляется по каждому факту показа страницы ошибок.
=====Примеры посылок в бандле
{"client_id":"as_errors","params":{"a_code":"106","a_name":"net::ERR_INTERNET_DISCONNECTED"}}
====Таски
BROWSER-7706

===Смена браузера по умолчанию ("client_id":"changedefault")

Проверяем при каждом старте, изменилось ли состояние Браузера. И если изменилось, то отправляем состояние, на которое изменилось: например, если Браузер был не дефолтным, а стал дефолтным, то отправляем "client_id":"changedefault","params":{"status":"on"}.

Возможные значения:
  * "status":"afterinstall" — Браузер стал дефолтным после установки (только для Win, на Маке нет диалогов при установке)
  * "status":"on" — статус Браузера поменялся с недефолтного на дефолтный
  * "status":"off" — статус Браузера поменялся с дефолтного на недефолтный

====Пример
{"client_id":"changedefault","params":{"status":"off"}} — статус Браузера изменился, стал недофлтным
====Задачи
BROWSER-6165

=== Повторная дефолтность браузера для win10
====Отправляемая статистика:
client_id": "re-default",
"params": {"total":"n", "userchoice":"n"} — где total общее количество попыток установки браузера по умолчанию для тех версий win в которых браузер сразу не может стать дефолтным (сейчас только win10), userchoice количество повторных попыток сделать браузер дефолтным, где используется хак для повторной дефолтности без вызова системного окна настроек. n - цифра

Повторная попытка аналогично шагам описанным выше.

<{Пример
- что нужно считать повторной установкой дефолтности. Любую попытку сделать дефолтным, кроме первой?
то есть если мы поставились, сделали дефолтным, поставили дефолтным другой браузер, передумали и сновали решили наш поставить это считается повторной?

Stas Kapinus:
- да, т.к. в этом случае не будет открываться окно настроек дефолтности и используется этот хак
- да, любую кроме первой, т.к. хак используется только при второй дефолтности}>

====Пример
{"client_id":"re-default","params":{"total":"100", "userchoice":"5"}}
====Задачи
BROWSER-38374

===Гео-данные и языковые настройки ("client_id":"regionsettings")

  * "langss" — язык системы, возможные значения: ru, tr, uk, en-US.
  * "regss" — региональная настройка системы, возможные значения: UA, RU, TR. !!Не правда, их безумное количество!!

====Пример
{"client_id":"regionsettings","params":{"langss":"ru","regss":"UA"}}
====Задачи
BROWSER-5540
BROWSER-7218


===Закладки ("client_id":"bookmarks") Q2
Собираем данные об использовании закладок
====Параметры и значения
  * "b_bar_status" — статус панели закладок: on — показывать всегда, off — выключено, tbl — показывается только с Табло. (это параметр отображается как раскрывающийся, потому что stasya@ добавила его в словарик — https://st.yandex-team.ru/BROWSER-60438#1482835356000)
  * "bkmrk" — открытие диспетчера: значение 1 — диспетчер был открыт, отправляется по факту открытия диспечтера.
  * "bmssuc" — поиск из диспетчера закладок: значение 1 — был произведён поиск, закончившийся переходом по урлу, 0 — был произведён поиск без перехода по урлу. Параметр отправляется по факту первого перехода по урлу или закрытию диспетчера, если перехода не было.

(«произведён поиск» — введён хотя бы один символ в поле поиска)

Отправляется при переходе на закладку:
  * --"bm_url" — урл, по которому перешли из закладок--
  * "fl_cl" — из какой папки : b — панель закладок, r — недавно добавленные, o — другие закладки, u — пользовательские папки.
  * --"bm_src" — из какой сущности был сделан переход: l — меню закладок, m — диспетчер закладок,  b — панель закладок (интерфейсный элемент, а не папка).-- Переход из диспетчера добавить в csrc
//Похоже, Хромиум в какой-то из своих версий выпилил псевдопапку «недавно добавленные» — её нет в последних версиях Хрома, нет и у нас (ранее была и там, и там).//

Отправляется при запуске:
  * "fldrs" — общее количество папок: целое неотрицательное число
  * "tr_flrds" — общее количество непустых папок: целое неотрицательное число.
  * "sfldrs" — общее количество подпапок: целое неотрицательное число.
  * "bar_q" — общее количество закладок на панели закладок: целое неотрицательное число.
  * "all_q" — общее количество закладок: целое неотрицательное число.
  * "fi_mode" - состояние настройки показа фавиконок на панели закладок: 1 - вкл, 0 - выкл.

Отправляется при клике на звездочку (добавить в Избранное):
{"url": "%URL%", "result": "0|1|2|3"}
где :
  1. %URL% = "site.domain", если страница главная
  2. %URL% = "site.domain/*", если страница не главная
  3. result- результат взаимодействия с кнопкой "добавить в избранное":



* Кликнул на серую звезду, добавил закладку в попапе:
  %%{"client_id":"bookmarks","params":{"result":"1","url":"yandex.ru"}},%%

* Кликнул на желтую звезду, удалил ранее добавленную закзладку
  %%[{"client_id":"bookmarks","params":{"result":"2","url":"yandex.ru"}},%%

* Кликнул на серую звезду, НЕ добавил закладку в попапе:
  %%{"client_id":"bookmarks","params":{"result":"0","url":"yandex.ru"}},%%

* Кликнул на желтую звезду, НЕ удалил закладку в попапе:
  %%[{"client_id":"bookmarks","params":{"result":"3","url":"yandex.ru"}},%%



====Пример
{"client_id":"bookmarks","params":{"bkmrk":"o"}}
{"client_id":"bookmarks","params":{"fl_cl":"r"}}
{"client_id":"bookmarks","params":{"fldrs":"12","tr_flrds":"2","sfldrs":"1","bar_q":"5","all_q":"20"}}

====Задачи
BROWSER-9265


===Панель закладок в Табло ("client_id":"tblbmk") Q2

====Параметры и значения
<{В версиях до 15.2
При каждом вызове табла в ближайшем навигейте есть бандл от "tblbmk".

Если включено отображение закладок в табло:
{"client_id":"tblbmk","params":{"opn":"1"}}
Если отключены закладки в табло:
{"client_id":"tblbmk","params":{"opn":"0"}}

!!Начиная с февральского релиза:
Накапливаем статистику отправляем 1 раз в 2 часа, после чего обнуляем счётчики.
Формат следующий.

{
"client_id": "tblbmk",
"params":{"shws":[a,b]}
}

a — кол-во показов панели закладок из Табло в текущей вкладке, integer
b — кол-во показов панели закладок из Табло в новой вкладке, integer!!

====Пример

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-7463
https://jira.yandex-team.ru/browse/BROWSER-4863
BROWSER-10054
}>
При каждом вызове табла, если отображение панели закладок в нём включено, отправляем бандл "client_id":"tblbmk".
Параметры: %%sn%% - показ в новом табе, %%si%% - показ в изнанке.

===Инфобар загрузок ("client_id":"dnld_bar")

====Параметры и значения !!текущая версия!!

"client_id":"dnld_bar" отправляется при скрытии инфобара.
При каждом показе инфобара отправляется "dnldshw":1
Параметр "menu" принимает целое неотрицательное значение, равное количеству кликов на стрелку (вызова контекстного меню) за один показ инфобара.
"event" — массив, в который записываются элементы в соответствии с нажатыми элементами, действия с контролами могут быть следующие:
clck_show_all — клик по «Все загрузки»
clck_close — крестик
clck_item — клик по загруженному файлу
--clck_menu — вызов контекстного меню без выбора-- решено не делать BROWSER-11106
clck_open — открыть в контекстном меню
clck_files — клик по «Всегда открывать такие файлы»
clck_folder — клик по «Показать в папке»
clck_cancel — клик по «Отмена»

Порядок в event следующий: 1 - каким образом был закрыт инфобар, остальные действия - по порядку их нажатия.
Если одно и тоже действие было сделано несколько раз за один показ инфобара, то в event оно все равно будет указано 1 раз.

====Пример
{"client_id":"dnld_bar","params":{"event":"clck_open","menu":2}}

====Параметры и значения !!в разработке!!

Параметры и их возможные значения:

  * "dp_show_all":"n" — клик по «Все загрузки», n - int, число файлов в панели на момент клика (для оценки, насколько панель должна быть забита, чтобы пользователь пошел в список загрузок)
  * "dp_close":"1" — клик по крестику
  * "clck_item":[time, pos, n, type] — клик по загруженному файлу, time - время в секундах от начала загрузки файла до клика, pos - int, позиция файла в панели в момент клика, n - int, число файлов в панели в момент клика, type - тип загружаемого файла, [0-8] (см. dle ((http://wiki.yandex-team.ru/browser/manplanning/Stat тут)))
  * "cm_open":"1" — «Открыть» в контекстном меню
  * "cm_files":"1" — клик по «Всегда открывать такие файлы»
  * "cm_folder":"1" — клик по «Показать в папке»
  * "cm_cancel":"1" — клик по «Отмена»
  * "end_dld":[time, pos, n, type] - время от момента начала загрузки до окончания загрузки, time - время в секундах от начала загрузки файла до окончания загрузки, pos - int, позиция файла в панели в момент клика, n - int, число файлов в панели в момент окончания загрузки, type - тип загружаемого файла, [0-8] (см. dle ((http://wiki.yandex-team.ru/browser/manplanning/Stat тут)))
  * "st_dld":[pos, n, type] - факт начала загрузки файла, pos - int, позиция файла в панели на момент начала загрузки, n - int, число файлов в панели на момент начала загрузки, type - тип загружаемого файла, [0-8] (см. dle ((http://wiki.yandex-team.ru/browser/manplanning/Stat тут)))
  * "cm_clck":"n" - клик по контекстному меню файла, n - int, статус загрузки файла на момент клика (загружено, остановлено, вирус, в процессе загрузки, ошибка, ... ). Описание типов статусов - в процессе разработки.
  * "dld_proc":[time, pos, n, type] - клик по загружаемому файлу, time - время в секундах от начала загрузки файла до клика, pos - int, позиция файла в панели в момент клика, n - int, число файлов в панели в момент клика, type - тип загружаемого файла, [0-8] (см. dle ((http://wiki.yandex-team.ru/browser/manplanning/Stat тут)))
  * "alarm":"n" - показ предупреждения в процессе загрузки .exe и тп, n - [0-2], где 0 - "Отменить загрузку", 1 - "Загрузить", 2 - закрытие панели загрузок крестиком или закрытие браузера.
  * "vir_dld":"n" - показ предупреждения о возможной загрузки вируса, n - [0-2], где 0 - "Отменить загрузку", 1 - "Загрузить", 2 - закрытие панели загрузок крестиком или закрытие браузера.

Условия отправки: закрытие инфобара, закрытие браузера, открытие файла.
Если показ новая загрузка файла инициирует показ панели, на которой уже есть предыдущие загруженные файлы, то мы логируем только взаимодействие с последним файлом, синицировавшим загрузку, при этом, если был клик по «Все загрузки», параметр "dp_show_all":"n" отправит информацию о количестве всех файлов на панели, в том числе и ранее загруженных.

====Пример

====Задачи
BROWSER-8789
https://jira.yandex-team.ru/browse/BROWSER-9987


===Жесты

{"client_id":"MouseGestures","params":{"MouseGesturesOff":"1"}}
====Параметры
  * MouseGesturesOff - Выключение чекбокса жестов в настройках
  * MouseGesturesOn - Включение чекбокса жестов в настройках
  * RestoreLastTab - Восстановлено табов
  * Forward - вперед
  * Backward - назад
  * ReloadPage - перезагрузка страницы
  * OpenTablo - открыть табло
  * CloseTab - закрыть вкладку

Накапливать статистику жестов и отправлять раз в 10 минут.

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-7502

===Использование табов и окон ("client_id":"tabstat")
====Параметры и значения
Отправляем статистку о каждой вкладке в двух случаях
— через 7 дней, если вкладка открыта
— при закрытии вкладки

id пишется в виде timestamp времени открытия вкладки + "_" + random (три рандомных символа из множества букв латинского алфавита, строчные и заглавные считаем разными символами)), например 200510301045102
"lt":"234" (в секундах) — время жизни вкладки с момента открытия до её закрытия иди до момента сбора и отправки статистики, если вкладка на этот момент ещё открыта
"at":"124" (в секундах) — время нахождения вкладки в фокусе с момента открытия до её закрытия или до момента сбора и отправки статистики, если вкладка на этот момент ещё открыта
"cl":"1" — вкладка закрыта на момент отправки ("0" - открыта)
"n":"23" — количество переходов внутри вкладки за время её жизни (или до момента отправки статистики)
"pin": "1" — вкладка запинена ("0" — не запинена)
"idw":"YYYYMMDDhhmmssmmm" — идентификатор окна, в котором была **открыта** вкладка. Формат - timestamp времени **открытия** окна.

Время пишем в таймстампах по UTC.

====Пример
{"client_id":"tabstat","params":{"tabs":[{"id":"200510301045102","lt":"1232","at":"12","cl":"1","n":"2"},{"id":"10212","lt":"12392","at":"122","cl":"0","n":"2"}]}}

====Задачи
BROWSER-8820

===Закрытие Браузера ("client_id":"clsng") !!В разработке!!

====Параметры и значения

При запуске Браузера пишем и отправляем информацию о том, как он был закрыт последний раз.
Данные пишем в виде значения параметра "а_wincls" для Винды и "maccls" для Мака. Возможные значения ниже.
Win:
Крестик в окне и вкладка задач в диспетчере задач  — "cross"
Меню "Выход" — "exit"
Контекстное меню в Панели задач — "menu"
Креш — "crash"
Alt + F4 — "hotkey"
Принудительное закрытие (перезагрузка, выключение, установка ч-л) — "forc"

Mac:
Cmd+Q — "hotkey"
Меню "Закрыть Яндекс" — "exit"
Контекстное меню в Dock — "menu"
Мониторинг/Завершить принудительно — "mntr"
Принудительное закрытие (перезагрузка, выключение, установка ч-л) — "forc"
Креш — "crash"

====Пример
{"client_id":"clsng","params":{"wincls":"exit"}}

====Задачи
BROWSER-8821

===Обучение в браузере ("client_id":"educ")
Динамика изменения соотношения поисков с мордыпоисков из омнибокса для людей, которым показывались подсказки.
Браузер отсылает в бандле информацию о том,что подсказка показалась в первый и каждый последующий раз.
Нужно стандартно посылать информацию в связку с браузером и тем, подсказка для какой функции статистика послана.
Дополнительно отсылать статистику при клике на "крестик" в подсказке и отключение подсказок в настройках.

Отправляем по факту показа с ближайшим навигейтом.
====Параметры и значения
Пишем в формате "%место_показа%":"%способ_закрытия%"

Место показа:
eduomn - омнибокс
edusyn - синхронизация
edutur - турбо
edusto - улучшатор
edutrw - перевод слов
edutrp - первод страниц
edufrod - безопасность на фишинговых сайтах
edustl - сайтлинки
eduqsu - кнопка вверх (скролл вверх)
eduqsd - кнопка вверх (скролл вниз)
edubgd - фоны
edu_ntb - индикатор непросмотренной вкладки
a_newbgd - обновление фонов
eduskf - турбо (skyfire)
edunpintb - пин табов
edumtb - табы вниз
edumtt - табы вверх
edu_sm - смартбокс
edu_pb - протект
edu_rb - ридабилити
edu_cf - блокировщик рекламы
edu_sv - сплитвью
educpt - закрыть запиненный таб
eduadb - блокировщик плохой рекламы
eduwpsa - показ балуна первого знакомства с галереей
eduwpsp - показ промо балуна галереи
eduwpst - знакомство с галереей в режиме редактирования табло


Способ закрытия:
1 — Пользователь скрыл подсказку крестиком
0 — Все остальные способы скрытия подсказки

Для обучатора новым фонам, способы закрытия отличаются:
4 - Клик на превью фона
3 - Нажатие на "Изменить фон"
2 - Нажатие на "Больше не показывать"
1 - Нажатие на крестик
0 - Все остальные способы закрытия

====Пример
{"client_id":"educ","params":{"eduomn":1}}
{"client_id":"educ","params":{"edutur":"0"}}

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-9602

===Док (Панель вкладок)
**"client_id":"dock"**
1) Закрепленная вкладка
  Раз в сутки отправлять количество запиненых вкладок на каждое окно. Т.е., если открыто два окна, то должно отправляться две посылки с кол-вом закрепленных вкладок в них.
  В случае нескольких профилей, отправляем данные только по тому, что активен сейчас.
  Параметр: "a_pintab":"1" (например, в случае одной запиненой вкладки)
2) Скролл
  Раз в сутки отправляется наличие скролла в окне пользователя. Посылка отправляется на каждое окно.
  В случае нескольких профилей, отправляем данные только по тому, что активен сейчас.
  Параметр: "scroll":"1"
  Отдельным параметром логируется нажание кнопки скролла (стрелка). Логируется вне зависимости от направления проматывания.
  Сюда же считаются факты прокручивания с помощью свайпа или колеса мыши (разделяем две этих ситуации по a_).
  Параметр: "a_usescroll":
  button - если скролл был сделан с помощью кнопки
  wheel - если скролл был сделан колесиком мыши/тачпадом
3) Драг-н-дроп
  Отправляется каждый факт перемещения вкладки.
  Параметр: "dnd":"1"
((https://st.yandex-team.ru/BROWSER-62497 задача))
4) Положение вкладок
 Раз в сутки отправляется положение вкладок (должно быть одно во всех окнах и профилях).
Параметр: "position":
    a_top - док сверху
    a_bottom - док снизу

5) Минимальный размер вкладок
Раз в сутки отправляется минимальный размер вкладки установленный в настройках.
Параметр: "min_size":
    a_large - большой
    a_small - маленький

6) Превью табов
params: a_tabpreview:
* on - отправляется, если у пользователя включено превью табов (при загрузке браузера и далее - раз в 4 часа)
* off - Отправляется, если у пользователя выключено превью табов (при загрузке браузера и далее - раз в 4 часа)
* click - клик в превью таба
* show - факт показа

====Обучаторы в Калипсо

Пишем в формате "%место_показа%":"%способ_закрытия%"

edu_sm - Поиск в Омнибоксе
edutrp - Перевод страниц
edutrw - Перевод слов
a_newbgd - Новые фоны
eduqsu - Кнопка вверх (скролл вверх)
eduqsd -  Кнопка вверх (скролл вниз)
edusyn - Синхронизация
edubgd - Фоны
edpintb - Закрепление вкладок
edunpintb - Открепление вкладок
edumtb - Переключение вкладок вниз
edumtt - Переключение вкладок вверх
eduntb - Показ индикатора непросмотренной вкладки (new tab background)
edualtref - Выделение части ссылки с зажатым Alt


Для всех бескнопочных и безкартиночных балунов способ закрытия:
1 — Пользователь скрыл подсказку крестиком
0 — Все остальные способы скрытия подсказки

Для картиночных балунов:
4 — Клик на кнопку "Настроить табло и Фон"
3 — Клик на превью фона
2 — Нажатие на "Больше не предлагать"
1 — Пользователь скрыл подсказку крестиком
0 — Все остальные способы скрытия подсказки

Для кнопочных балунов:
4 — Нажатие на "Переместить вниз"
3 — Нажатие на "Закрепить"
2 — Нажатие на "Больше не предлагать"
1 — Пользователь скрыл подсказку крестиком
0 — Все остальные способы скрытия подсказки

Задача:
Примеры: так же, как для классики (см. выше).

===Поиск по странице ("client_id":"find_bar")

startsession - таймстемп открытия сессии работы с Findbar'ом
a_open - отправляем всегда при вызове findbar с одним из параметров ниже
emptyreq - если запрос изначально пустой
url - url на котором производились поисковые запросы (используем URL главного фрейма; если поиск производится в NTP, то передаем значение ntp)
a_search - факт не пустого ввода/был введён символ в поиск

====Задачи
https://st.yandex-team.ru/BROWSER-70466
https://st.yandex-team.ru/BROWSER-103208

===Морфология ("client_id":"morf")
Отправляем по факту изменения положения чекбокса с ближайшим навигейтом.
====Параметры и значения
Чекбокс "точное совпадение": "exact"
Значение 1 - чекбокс установлен, поиск точный
Значение 0 - чекбокс снят, поиск с морфой

====Пример
{"client_id":"morf","params":{"exact":1}}

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-9822

===Windows8 ("client_id":"Win8")
Количество (%) пользователей, использующих Браузер в Metro-режиме:
  * Переключения между режимам
  * Продолжительность пребывания Браузера в том или ином режиме
Частота использования панели Charms совместно с Яндекс.Браузером: Share, Settings, Search

====Параметры и значения
1) По факту переключения пишем режим, на который переключились + таймстэм переключения — {"client_id":"settings","params":{"IDS_WIN8_DESKTOP_RESTART":1}} или {"client_id":"settings","params":{"IDS_WIN8_METRO_RESTART":1}}

2) По факту использования виндусовских контролов — пишем соответствующую статистику
Использование системного Share с Яндекс.Браузером: "shre_8"
Использование системного Settings с Яндекс.Браузером:
 - использование настройки - "sett_8_opt"
 - использование о программе - "sett_8_ab"
 - использование помощи - "sett_8_h"
 - использование поиска - "srch_8"
Поиск работает, только если в поисковом чарме явно задать поиск в браузере
Использование системного Search с Яндекс.Браузером: "srch_8"

Юникс время: "ts"
--PinTab: "pintab_8"--

====Пример
 {"client_id":"settings","params":{"IDS_WIN8_METRO_RESTART":1}}
{"client_id":"win8","params":{"control":"srch_8"}}

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-9689

===--Поисковость_эксперимент_1 ("client_id":"Exp1")-- !!устарело!!
!!Как мы определяем человека? Экспериментов 2 плюс 1 контрольная сборка. Будем смотреть по yandexuid, потом по нему можно матчить ui в спайлоге!!
1. % тех, кто пользуется омнибоксом для ввода запроса и частота его использования по сравнению с контрольной выборкой.
Вопрос. Как мы сможем определить тех, кто пользуется омнбоксом в рамках эксперимента и за пределами эксперимента?
3. Отделить отключение поисковости от отключения хлебных крошек. И посчитать количество отключений.
Вопрос: при отключении поисковости отключается эксперимент?
4. Клики на кнопку "Яндекс" относительно клика на кнопку Я только на СЕРПЕ.
Вопрос: как сейчас сбирается статистика на кнопку Я? С урлом?
5. % запросов и % людей, использовавших кнопку "Найти" от всех, использующих омнибокс для поиска на выдаче.


====Параметры и значения
"but_find" - клик на кнопку "Найти"

====Пример
{"client_id":"exp1","params":{"but_find":1}}
====Задачи
https://jira.yandex-team.ru/browse/BROWSER-9942


===Проверка орфографии ("client_id":"orfo")

====Параметры и значения
При клике на подчёркнутое слово правой кнопкой мыши открывается контекстное меню, логируем его показ и некоторые действия:
параметр "or_c", значение в виде массива формата ["language_id",%дата%] (например, "or_c":["ru","06092013"]) — при каждом клике на подчёркнутое слово, присутствует всегда, дата (модификации текущего файла словаря) указывается в формате ддммгггг
параметр "or_r", значения: 1...N — если выбран N-ный вариант исправления
параметр "or_a", — в случае добавления слова в словарь, значение в виде формата "%word%" (например, "or_a":"малоко")
параметр "or_cn", - язык словаря и время его последней модификации

====Пример
{"client_id":"orfo","params":{"or_с":["ru","06092013"],"or_r":2}}
{"client_id":"orfo","params":{"or_c":["ru","06092013"],"or_a":"малоко"}}
====Задачи
DISTRANALYTICS-450
BROWSER-10276

===Локальная проверка орфографии ("client_id":"local_sc")  !!В разработке!!
load:1 - если для обработки запроса пришлось запустить сервис.
vars:1 - если для запроса были найдены варианты исправления.
fallb:1 - если во время обработки сервис упал.

===Облачная проверка орфографии ("client_id":"ys_optout ")
show: 1 - в момент показа блока
a_CLICK: (клики по)
* close - крестик
* 2 - ссылка "запретить"

===Поисковой пузырь ("client_id":"bubble")
=====Отправляемая статистика:
client_id: "bubble"
Если пользователь сменил поиск на яндекс отправляем "action": "0"
Если нажал крестик -- "action": "1"
Если нажал "Не сейчас" -- "action": "2"
Если кликнул вне балуна -- "action": "3"

=====Примеры посылок в бандле
"client_id":"bubble","params":{"action":"1"}
=====Таски
BROWSER-10108


===Завершенные по terminate процессы при обновлении ("client_id":"terminated_hung_browser_processes")
=====Отправляемая статистика:
client_id: "terminated_hung_browser_processes"

"all_browsers" - массив структур для всех завершаемых процессов
"terminated_browsers" - массив структур для процессов, которые были завершены по Terminate

Стуктуры:
"pid" - process-id для заверешнного процесс;
"cmd_line" - командная строка;
"parent_pid" - process-id родительского процесс;
"creation_time" - время создания процесса;
"is_ntp" - флаг ntp процесса


=====Примеры посылок в бандле
"client_id":"bubble","params":{"all_browsers":["pid":1,"cmd_line":"browser.exe","parend_pid":2,"creation_time":111111,"is_ntp":true]}

=====Таски
BROWSER-94370




===Умная кнопка "назад" (Smartback) ("client_id":"smartback")

====Параметры и значения
Необходимо собирать данные об использовании функции возврата во внешнее приложения (статистика по обычным нажатиям на back в учете данной фичи не нужна):

**"client_id": "smartback"**

* %%app%% "Original filename" ("Исходное имя файла") для Windows и "Bundle name" для Mac. Отправляется всегда, когда удалось определить имя приложения.
* %%hold%% **0**, переход по кнопке без предварительного удержания кнопки back. **1**, переход по кнопке с помощью предварительного удержания кнопки back
* %%open%% отправляется при переходе из внешнего приложения
* %%use%% клик по кнопки смартбек

=====Открытие из внешнего приложения
**"client_id": "externalapp"**
((https://st.yandex-team.ru/SBROWSER-1905 Задача))

%%{ "params": {
        "appname": "%appname%",
        "referer": "%appaddress%",
        "start": "true/false",
        "url": [
            "%appurl1%, %appurl2%"],
        "a_fullscreen": "0/1"
        }}
          %%

* %%appname%% здесь - **Original filename** ("Исходное имя файла") для Windows.
* %%referer%% - адрес до родительского приложения.
* %%url%% - урл или несколько урлов, с которым происходит переход из стороннего приложения.
* %%start%% - параметр говорящий о запуске браузера из стороннего приложения. **true** - если был запущен, **false** - если урл открывался в уже запущенном браузере.
* %%a_fullscreen%% - **0**, если в момент открытия браузера винда не была в фуллскрине. **1**, если в момент открытия был фуллскрин

Складывать статистику в bundle необходимо при каждом переходе из внешнего приложения.

С 18.1.1 статистика расширена https://wiki.yandex-team.ru/users/akazachkovsky/Polnojekrannyjj-rezhim.-Parametry-i-algoritm-detekta/#opisanieparametrov
Расширенная статистика включается фичей ExternalFullscreenStat


====Пример
%%
{
  "client_id" : "smartback",
  "params": { "a_apph0" : "Skype" }
}%%

=====ТЗ
https://wiki.yandex-team.ru/browser/tz/smartback/


<{Текущая реализация
====Параметры и значения
Необходимо собирать данные об использовании функции возврата во внешнее приложения (статистика по обычным нажатиям на back не нужна):
  * Факт использования "use":"1"
  * Куда идет возвращение (название программы) "app":"appname". "appname" здесь - "Original filename" ("Исходное имя файла") для Windows и "Bundle name" для Mac. В случае если название приложения определить не удалось то это поле не передается.
  * Флаг оповещающий о том, что переход был осуществлен с помощью предварительного удержания кнопки back "hold":1, если удержания не было (переход просто по кнопке), то "hold":0
Складывать статистику в bundle необходимо при каждом переходе во внешнее приложение.
При открытии ссылки из внешнего приложения (чтобы посчитать самые популярные приложения):
  * Факт открытия ссылки "open":"1"
  * Название приложения "app":"appname". "appname" здесь - "Original filename" ("Исходное имя файла") для Windows и "Bundle name" для Mac. В случае если название приложения определить не удалось то это поле не передается.

====Пример
%%
{
  "client_id" : "smartback",
  "params": {
    "use" : "1",
    "app" : "Skype",
    "hold" : 0
  }
}
{
  "client_id" : "smartback",
  "params" : {
    "use" : "1",
    "hold" : 0
  }
}
%%
%%"client_id" : "smartback",
  "params" : {
    "open" : "1",
    "app" : "Skype"
}%%
=====ТЗ
https://wiki.yandex-team.ru/browser/tz/smartback/
}>

====Пример посылки в бандл:

 {"client_id":"bkfrwd","params":{"bnt":"0", "scr": "0"}}]
Примечание. До версии 16.7.1 кнопки "Назад" и "Вперед" есть только в тайтлбаре. Т.е. scr для всех версий ранее - только 0.

Таски:
https://st.yandex-team.ru/BROWSER-46494
}>

===Статистика экспериментов ("client_id":"exper") !!Удалено с версии 14.4!!
BROWSER-17550
Новые параметр экспериментов описан здесь — https://wiki.yandex-team.ru/browser/stat/nav
--====Параметры и значения--
--С данным clientId должна отправляться информацию о всех включенных в браузере экспериментах (field tests).--
--Данная статистики должна отправляться при каждом запуске браузера.--
----
--Информация об одном эксперименте содержит:--
1) --название эксперимента--
2) --значение экперимента--
--Отправляться в статистику должен Dictionary каждая запись в котором имеет вид "name":"value"--
----
--BROWSER-11818--

===--Searchup ("client_id":"searchup")-- !!устарело!!

====Параметры и значения
* Numbers of shows - "params": {"shw" : "1"} При показе инфобара
* Numbers of button clicks - "params": {"srup:yandex.com.tr" : "1"} При нажатии на кнопку
* Number of work stoppages - "params": {"stp" : "1"} При выключении инфобара (после 3 нажатий на крестик)



====Пример
%%
{"client_id" : "searchup", "params": {"shw" : "1"}}
{"client_id" : "searchup", "params": {"srup:yandex.com.tr" : "1"}}
{"client_id" : "searchup", "params": {"srup:bing.com" : "1"}}
{"client_id" : "searchup", "params": {"srup:google.com" : "1"}}
{"client_id" : "searchup", "params": {"srup:yahoo.com" : "1"}}
%%


===Кнопка Вверх ("client_id":"qs")
Статистика отсылается по следующему тригеру: если пользователь попадает в самый верх после того, как отмотал вниз как минимум на одну страницу, посылается статистика о том, что он фичей не воспользовался

Нужна статистика использования кнопки - клика на таб и использования других способов быстрого скролла - выборка по 5% пользователей, у которых включен эксперимент:
- использование нашей кнопки для промотки вверх
- использование Shift+пробел,PageUp,Scroll,стрелка вверх или Home (CMD + UP для MacOS) или любым другим споспобом.
И статистика использования разных способов быстрого скролла - выборка по 5% пользователей, у которых НЕ включен эксперимент:
- использование Shift+пробел,PageUp,Scroll,стрелка вверх или Home (CMD + UP для MacOS) или любым другим споспобом.

*Изначально хотели включить эксперимент у 5% пользователей, но после беты решили сделать эксперимент для 100% пользователей в версии 13.12. Т.е. она у всех включена по-умолчанию*

====Параметры и значения

"fu":"1" - (feature used) нажатие на таб и использование нашей фичи чтоб поехать вверх
"ou":"1" - (other used) прокрутка вверх каким-то другим способом (мышкой, клавишами, скриптами на странице, чужими екстеншнами, слайсингом, и т.д.)

{"client_id":"qs","params":{"fu":"1"}}

О статусе эксперимента пишем в:
{"client_id":"exper","params":{"qs":"e2"}}

e1 - фича не включена, 5% от общего количества пользователей
е2 - фича включена, 5% от общего количества пользователей

====Пример

{"client_id":"qs","params":{"fu":"1"}}
{"client_id":"exper","params":{"qs":"e2"}}

====Задачи
BROWSER-12226 [  ]( hsilgos )






===Хост дефолтного поиска ("client_id":"defs")
====Параметры и значения
При запуске Браузера, не чаще раза в сутки отправляем

<[
"client_id": "defs",
  "params": {
    "cur_s": "yandex.ru"
}
]>


При смене поисковика на странице chrome://settings/ отправляем

<[
"client_id": "defs",
  "params": {
    "old_s": "google.ru",
    "new_s": "yandex.ru",
    }
]>

"cur_s" — хост текущего поиска по умолчанию
"old_s" — хост старого поиска по умолчанию
"new_s" — хост нового поиска по умоланию

!!Логируем факты смены только на странице настроек, отдельно в статистику Омнибокса пишутся факты смены поиска на Яндекс с помощью контрола Омнибокса
{"ose":"
old_search_engine
"}
!!

====Задачи
BROWSER-12375

===Кнопка «Сохранить» ("client_id":"svbt")
====Параметры и значения
Логируем показы контролов и клики по ним.
Показы (отправляется после каждого показа)
"client_id": "svbt",
"params": {"svb_s":"doc"}
значение параметра "svb_s" ("doc" в примере) — расширение файла, может отправляться некорректно, если расширение не указано тем, кто размещал книгу BROWSER-21984

Клики (отправляется после каждого клика)
"client_id": "svbt",
"params": {"svb_c":["pr","doc"]}
первое значение — контрол, по которому был совершён клик, может принимать такие значения:
— Печать — pr
— Cохранить — sv
— Сохранить на Яндекс.Диск — sd
— Сохранить как PDF — pd
— Создать закладку — cf
— Изменить закладку — ef
— Сделать фоном в браузере Yandex — mb

второе значение — расширение файла
====Задачи
BROWSER-13925

===Ридер книг ("client_id": "bkrdr")
====Параметры и значения
Логируем открытия ридера и клики по контролам.

Открытие ридера
"client_id": "bkrdr",
"params": {"a_ext":"%file_extention%"} — где %file_extention% - расширение открытого файла (на случай, если читалка научится читать еще)
На данный момент мы умеем открывать epub, fb2, fb2.zip

Клики (отправляется после каждого клика)
"client_id": "bkrdr",
"params": {"bk_%cntrl%":"1"}
Вместо %cntrl% — контрол, по которому был совершён клик, может принимать такие значения:
— раскрыть колбаску — show
— скрыть колбаску — hide
— плюс — minus
— минус — plus
— перейти в режим навигации — navi
— переключение режима чтения — read
— простановка закладки — fav
— снятие закладки — unf

====Задачи
BROWSER-33078

===Предлагашка мобильного браузера для владельцев десктопного ("client_id":"adv")
====Требования
По статистике хотим смотреть:
- кол-во показов в целом
- кол-во кликов в целом
- кол-во уникальных пользователей
- показы на пользователя в среднем

====Параметры и значения
факт показа окна, отправляем — "adv_sh":1
факт клика на "Скачать", отправляем — "adv_cl":1
факт клика крестик закрытия окна, не отправляем: считаем как Показы минус Клики.

====Примеры:
"client_id": "adv", "params": {"adv_sh":1}
"client_id": "adv", "params": {"adv_cl":1}

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-14523
https://jira.yandex-team.ru/browse/BROWSER-15471

===Уведомления от социальных сетей и почты ("client_id":"ntf") Q2
====Требования
По статистике хотим смотреть:
 0. Статистика ежедневно, в разрезе **каждой** соц. сети.
 1. Пользователи, у которых включены уведомления от соц. сети = X
 2. Уведомления, которые показаны = Y
 3. Клики по уведомлениям (переходы с них в соц. сеть) = Z
 4. Показы предлагашек (инфобар) к включению уведомлений от соц. сети = A
 4.1 Клики в инфобаре по "Вкл" = A1
 4.2 Клики в инфобаре по "Х" = A2
 4.3 Клики в инфобаре по "Нет" = A3

 5. Мини-фича "Продвижение в социальных сетях": !!В разработке!!
 5.1 Измеряем кол-во размещенных сообщений - делаем в браузере.
 5.2 Количество переходов по ссылке - смотрим заходы на страницу с маркером from=social_share, учитываем, что при открытии окна-поделяшки соц.сеть заходит по этой ссылке.
 5.3 Кол-во скачиваний - смотрим через статистику промо-страницы
 5.4 Хотим получить график по скачиваниям в день, по двум источникам Facebook и Вконтакте - смотрим через статистику промо-страницы.

 6. Почтовые уведомления: нужны посуточные данные о количестве:
 6.1 полученных уведомлениях
 6.2 показанных уведомлениях.
 6.3 клики по уведомлениям (переходы с них в почту яндекса).
 Используем в https://st.yandex-team.ru/DISTRANALYTICS-1018

====Параметры и значения
Так как все требуемые события не являются связанными действиями, лучше отправлять каждое событие отдельно. В таком случае данные будут автоматически считаться в уже готовом отчете.
1. Отправлять чаще, чем раз в сутки (каждый час, например), чтобы не потерять данные.
Для каждой соцсети - свой параметр:
"vk_u":"1"
"fb_u":"1"
"yamail":"1" (здесь и далее: префикс yamail_ используется для почтовых уведомлений)
2. Отсылать сумму за некий промежуток времени (почаще, скажем, полчаса):
"vk_sh":"5"
"fb_sh":"3"
"yamail_sh":"4"
3. Отсылать сумму за некий промежуток времени (почаще, скажем, полчаса):
"vk_cl":"7"
"fb_cl":"2"
"yamail_cl":"4"
4. Отсылать при каждом факте показа:
"vk_sh_inv":"1"
"fb_sh_inv":"1"
"yamail_sh_inv":"1"
4.1. Отсылать при каждом факте клика:
"vk_agr":"1"
"fb_agr":"1"
"yamail_agr":"1"
4.2. Отсылать при каждом факте клика:
"vk_decl":"1"
"fb_decl":"1"
"yamail_decl":"1"
4.3. Отсылать при каждом факте клика: !!В разработке!!
"vk_no":"1"
"fb_no":"1"
"yamail_no":"1"

5. Отсылаем при каждом факте открытия окна-поделяшки:
Оторвали в 16.01 BROWSER-41035
открытие окна: "vk_share_open":"1"
согласие пользователя разместить: "vk_share_agreed":"1"

 6. Отсылаем сумму за два часа: !!В разработке!!
 6.1 "c_ym_rcv":"5"
 6.2 "c_ym_sh":"3"
 6.3 "c_ym_cl":"2"

 7. Отсылаем при каждом наступлении соответствующего события: !!В разработке!!
 7.1 "yam_rcvd":"1" — при получении уведомления
 7.2 "yam_shwn":"1" — при показе уведомления
 7.3 "yam_clck":"1" — при клике на уведомлении
 7.4 "yam_infb":"1" — при показе инфобара
 7.5 "yam_infb_y":"1" — при клике «да» в инфобаре
 7.6 "yam_infb_n":"1" — при клике «нет» в инфобаре

====Задачи
https://st.yandex-team.ru/BROWSER-16350
https://st.yandex-team.ru/BROWSER-20659
https://st.yandex-team.ru/BROWSER-22070
https://st.yandex-team.ru/BROWSER-22920
https://st.yandex-team.ru/BROWSER-33919

===Новый загрузчик (таблоадер, иконка, кнопка) ("client_id":"dwnlds") Q2
====Требования
**Количество**
  * Количество загрузок/день
  * Процент успешных загрузок/день

**Качество**
  * Ошибки при скачивании (таблица: формат/количество)
  * Типы скачиваемых файлов (таблица: формат/количество)
  * Размеры файлов, распределение
  * Количество загрузок на человека, распределение
  * Средняя скорость при скачивании, распределение
  * Количество **одновременно** скачиваемых файлов, распределение.
    Интересны два вопроса:
      1. как часто (от всех скачиваний) пользователь качает более одного файла.
      2. Если качает более одного файла, то какое распределение по количеству.


**Логгирование взаимодействия**
  * Процент людей, у которых в настройках стоит флажок «Спрашивать перед загрузкой, куда сохранить файл»
  * Процент людей, у которых в настройках не дефолтный DownloadFolder.
  *
  * Процент загрузок, для которых скачанный файл открыт прямо с панели (вычесть случаи, когда скачивались несколько файлов).
  * Количество нажатий на кнопку «Загрузки» в день, распределение
  * Распределение кликов в открытом окне «Загрузки»
    * Уход на другие вкладки «Табло», «История», «Улучшения» — %
    * Открытие N файла — %
    * Вызов контекстного меню N файла — %
    * Переход на «Все загрузки» — %
  * Кликабельность пунктов в меню

**Безопасность**
  * URL загружаемого пользователем файла.
  * mime type файла.
  * Размер файла.
  * Hash файла.
  * Вердикт облака по проверке файла на вирусность.
  * Время обработки файла в облаке.
  * Ошибки от RatingProvider, поступившие в ответ.
  * Факт отправки всего тела файла для анализа на облаке.

**Нотификации об окончании загрузок** (с 18.9.0)
  * факты отправки пушей
  * факты переключения настроек отправки пушей
  * статусная статистика по настройкам пушей

====Параметры и значения
**"client_id":"dwnlds"**

При начале скачивания файла начинается формироваться JSON со статистикой (должно быть не более одного файла на один json).

Обязательными параметрами каждого json являются:
  * "ff":"doc" — расширение скачиваемого файла (обязательный параметр), если определить нельзя — ставим значение -1
  * "fs":24523 — размер файла в байтах (обязательный параметр), если определить нельзя — ставим значение -1

И хотя бы один из параметров состояния загрузки:
  * "std":1 — факт старта скачивания файла, **значение параметра (целое, положительное) — количество файлов, которые уже скачиваются на момент начала новой загрузки**. При этом начатая загрузка также учитывается как +1.
  * "dc":1 — факт отмены скачивания файла
  * "de":1 — факт получения ошибки при скачивании файла
  * "df_as":1343 — факт окончания загрузки файла, значение — средняя скорость загрузки в КБ/с, если определить нельзя — ставим значение -1

Если файл скачался/отменился/ошибся в течение n  минут (скажем, 5) после начала скачивания, client_id с имеющимися на тот момент параметрами отправляется в bundle.
Если через n минут (скажем, 5) после начала загрузки файл все еще не скачан, отправляем client_id в bundle с обязательными параметрами и параметром факта старта; когда этот файл загрузится/отменится/ошибётся, отправляем обязательные параметры и соответствующий параметр состояния без параметра факта старта загрузки.

При повторной загрузке того же файла, инициированной пользователем (КМ скачать заново), статистика не отправляется.

=====Анализируем возможность сократить "повторные закачки" файлов

**Внимание, не реализовано**
Необходимо добавит следующие обязательные параметры в json:

  * "fE":"10d32ab-5ba-567c2fe1" — HTTP ETag (часть HTTP ответа) скачиваемого файла (обязательный параметр), если не передан сервером — ставим значение -1
  * "fm":"Sat, 16 Jan 2016 21:16:42 GMT" — Last-Modified скачиваемого файла (обязательный параметр), если не передан сервером — ставим значение -1

https://st.yandex-team.ru/BROWSER-53402

=====Взаимодействие с контекстными меню
Что считаем:
1. распределение способов вызова контекстного меню (правым или левым кликом)
2. распределение кликов по пунктам меню с учётом способа его вызова

Гистограмма
**Downloads.ContextMenu.OpenedBy**
%%
0 ------------------- (50)
1 ------ (20)

При этом:
0 – вызов меню правой кнопкой мыши
1 – вызов меню левой кнопкой мыши
%%

**Downloads.ContextMenu.Action**

<{В версии до 15.12
%%
0 ------------------- (50)
1 ------ (20)
...
n ------- (22)

0 – скрытие меню без выбора действия
От 1 и далее выбор действия после клика:
1 – остановить загрузку
2 – отменить загрузку
3 – открыть файл
4 – открыть после загрузки
5 – показать в папке
6 – открыть/не открывать автоматически такие файлы
7 – копировать ссылку
8 – перейти к странице-источнику файла
9 – скачать заново
10 – удалить из списка
11 – возобновить загрузку
12 – возобновить опасную загрузку
13 – возобновить прерванную загрузку
14 – Disable view of document using plugins
15 – Open SafeBrowsing help page
%%}>
%%
0 ------------------- (50)
1 ------ (20)
...
n ------- (22)

0 – скрытие меню без выбора действия
От 1 и далее выбор действия после клика:
1 – остановить загрузку
2 – отменить загрузку (пункт для элемента в статуса malwareDangerousUrl)
3 – открыть файл
4 – открыть после загрузки
5 – показать в папке
6 – открыть/не открывать автоматически такие файлы (по расширению файла)
7 – копировать ссылку
8 – перейти к странице-источнику файла
9 – скачать заново
10 – удалить из списка
11 – возобновить загрузку
12 – возобновить опасную загрузку
13 – возобновить прерванную загрузку
14 – Отключит просмотр документов плагинами браузра
15 – Открыть страницу "Информация о защите файлов"
16 – Удалить опасный файл
17 – Открыть небезопасный файл
18 – Проверить безопасность
19 – Остановить проверку
20 – Удалить из списка (для файла в статуса malwareDanger). Пункт называется также как и 10 но ещё и удаляет файл с диска, вынес отдельно.
21 – Информация об ошибках
22 – Удалить файл с диска
%%

BROWSER-36351

<{Вариант отправки компонентной статистики, решили не делать
**"client_id":"dwnlds"**
При каждом клике в пункт контекстного меню должен отправляться параметр %%lcm%% (открытие контекстного меню по левой кнопке мыши - пипка) или %%rcm%% (открытие контекстного меню по правой кнопке мыши), возможные значения:
  * %%stp%% - остановить загрузку
  * %%opn%% - открыть после загрузки
  * %%shw%% - показать в папке
  * %%aop%% - открывать автоматически
  * %%cpl%% - копировать ссылку
  * %%src%% - перейти к источнику файла
  * %%rst%% - скачать заново
  * %%del%% - удалить из списка
}>


-----------------------------------------------
=====Антивирус
https://st.yandex-team.ru/SBROWSER-1894
**Безопасность**
"client_id":"dwnlds"
"url": будем писать урл.
"mtype": будем писать тип.
"fs": уже пишем размер в байтах
"hsh": будем писать хеш.
--"avrslt": будем писать вердикт проверки Ц.--
--"tavchk": будем писать время проверки файла через Ц.--
--"averrors": будем писать ошибку или несколько ошибок проверки Ц.--
"avfiledwnld": будем писать факт отправки тела файла на анализ в облако Ц.
"avfilecontext": будем писать факт отправки стат.характеристик файла на анализ в облако Ц.

https://st.yandex-team.ru/BROWSER-37053
"vtrslt": будем писать вердикт проверки VT.
--"tvtchk": будем писать время проверки файла через VT.--
"vterrors": будем писать ошибку или несколько ошибок проверки VT.

Добавлено для Agnitum SPA и сопутствующей логики (16.4):
"sparesult": вердикт локальной проверки SPA
"tspachk: время до получения ответа от SPA
"alistresult": вердикт по локальным чёрным/белым спискам
"talistchk": время до получения ответа по локальным спискам
"avresult": вердикт облачной ручки (раньше был для Ц)
"tavchk": время до получения ответа облачной ручки (раньше был для Ц)
"size": размер файла
"timeouted": true|false, уложилась ли проверка файла в таймаут
"case_type: описание категории файла - "простой" случай или "сложный"
"avsource": источник итогового вердикта, который был показан пользователю. Если вердикты всех ручек совпали, записывать первую
"averrors": ошибка облачной ручки (раньше был для Ц)
"spaerrors": ошибка локального анализатора
"sbresult": вердикт от ручки проверки файла по хешам

Добавлено для провязки статистики HIPS и браузера, с 16.9
"cryptoguid": HKEY_LOCAL_MACHINESOFTWAREMicrosoftCryptography:MachineGuid
-----------------------------------------------



-----------------------------------------------

**"client_id":"setstat"**
Отправляется раз в сутки или при старте браузера.
"askdnld":1 — состояние (1 — отмечен, 0 — не отмечен) чекбокса «Спрашивать перед загрузкой, куда сохранить файл»
"dnldflr":1 — является ли DownloadFolder дефолтной (0) или кастомной (1)

-----------------------------------------------
Для тулбара логируем:
- Клик по кнопке загрузчика. JSON - "client_id":"dwnlds", "params":{"opendwnldr":1}
- Открытие загрузки прямо с панели. JSON - "client_id":"dwnlds", "params":{"opendwnld":1}
- вызов контекстного меню для иконки в загрузчике. JSON - "client_id":"dwnlds", "params":{"opencntxt":1}


Для окна «Загрузки» мы уже логируем:
Открыть папку загрузок "client_id":"settings","params":{"downloads":"openf"}
Удалить все "client_id":"settings","params":{"downloads":"clear"}
Поиск по загрузкам "client_id":"settings","params":{"downloads":"search"}

**Статистика по работе с ((https://wiki.yandex-team.ru/browser/custo/tz/alldownloads/newrules/ диалогами опасных и подозрительных файлов))**
Дополняем бандл client_id: dwnlds
- при вызове диалога опасного файла параметр %%"dialog_dangerous": {"reaction": "del|can", "time": 3}%%
- при вызове диалога подозрительного файла параметр --%%"dialog_suspicious": {"reaction": "del|can", "time": 3}%%-- %%"dialog_malicious": {"reaction": "del|can", "time": 3}%%
- при вызове диалога недопроверенного файла параметр %%"dialog_recheck": {"reaction": "opn|chck|can", "time": 3}%%
где %%del%% - клик на кнопку Удалить, %%unbl%% - клик на кнопку Разблокировать, %%can%% - клик на кнопку Отмена либо закрытие диалога иным способом без принятия решения (Esc), %%opn%% - клик на кнопку Открыть, %%view%% - клик на кнопку Открыть в проводнике, %%time%% - время от показа диалога до скрытия диалога (время принятия решения)

=====Нотификации об окончании загрузки

client_id: dwnlds

Params:
- a_pushes:
  - long - факт отправки пуша длительной настройки
  - group - факт отправки пуша окончания группы загрузок
  - on - факт включения пуша на browser://settings
  - off - факт выключения пуша через бутерброд пуша

Статустная статистика (отправляется раз в 4 часа):
- a_pushes_status:
  - on - пуши загрузок включены
  - off - пуши загрузок выключены

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-15816

===Балун повторных загрузок ("client_id":"Redownload")

Балун повторной загрузки файлов : https://wiki.yandex-team.ru/browser/custo/TZ/prevent-re-download

Всю статистику по элементу Redownload собираем внутри сессии. Сессионной - мы будем считать статистику, которая собирается с момента открытия сессии с Redownload и до момента закрытия этой сессии. Данные в бандл на отправку мы складываем только после закрытия сессии, сразу после записи таймстемпа endsession.
Сессия открывается :
* в момент появления балуна на экране (любой тип балуна Redowload)
Сессия закрывается :
* в момент выбора осознаного выбора пользователем определенного действия (закрыть, скачать по новой, отрыть в папке...)
* в момент закрытия браузера
(так как Redownload является глобальным балуном и не относится к конкретной вкладке, то он не закрывается при мисклике, закрытии вкладки, переходе на другую вкладку...)
**Сбор параметров при открытии сессии**
* startsession - таймстемп открытия сессии Redownload
* timesincedwnl - время, прошедшее с момента запуска первого скачивания этого файла (таймстемп). собираем в момент всплывания любого типа окна из тех.задания.

**Сбор параметров внутри сессии**
* c_ctr_open - клик по кнопке Открыть
* c_ctr_show - клик по кнопке Показать в папке
* c_ctr_redwnld - клик по кнопке Скачать еще раз
* c_ctr_close - клик по кнопке Крестик
* c_ctr_openondone - клик по кнопке Открыть по завершении
* c_ctr_continue - клик по кнопке Возобновить
* c_ctr_deldangfile - клик по кнопке Удалить опасный файл
* c_ctr_delete - клик по кнопке Удалить

**Сбор параметров при закрытии сессии**
* browser_closed - был ли закрыт браузер при завершении сессии (1 - да)
* endsession - таймстемп закрытия сессии Redownload

===(downloads-buble)Балун загрузок
((https://wiki.yandex-team.ru/browser/custo/TZ/downloads-improve-UX16/ Ссылка на общее ТЗ))

"client_id":"dwnlds"

%%этап I%%
  1. Логгировать количество открытий балуна
  %%"openbuble":1%%
  2.#2 Логгировать для каждого открытия файла в балуне, записывать в одну посылку:
    1. факт открытия файла (клик по названию или иконке)
    %%"a_ev":"op"%%
    2.#2 порядковый номер в балуне (нумерация файлов сверху вниз, верхний файл = №1)
    %%"nmb":%номер файла в списке%%%
    3.#3 количество видимых файлов в балуне на момент открытия
    %%"cnt":%количество видимых файлов%%%
    4.#4 расширение / тип
    %%"ffop":"%расширение%"%% (обязательный параметр, если определить нельзя — ставим значение %%"ffop":-1%%)
    5.#5 размер файла, байты
    %%"fsop":%размер%%% (обязательный параметр, если определить нельзя — ставим значение %%"fsop":-1%%)
    Пример: %%{"client_id":"dwnlds","params":{"a_ev":"op", "nmb":1, "cnt":7, "ffop":"doc", "fsop":2847}}%%
  3. Логгировать для каждого клика по кнопке **Очистить**, записывать в одну посылку:
    1. факт клика по кнопке **Очистить**
    %%"a_ev":"clr"%%
    1.#2 количество видимых файлов в балуне на момент клика по кнопке **Очистить**
    %%"cnt":%номер файла в списке%%%
    Пример: %%{"client_id":"dwnlds","params":{"a_ev":"clr", "cnt":7}}%%
  4. Логгировать для каждого клика по кнопке **Все загрузки**:
    1. факт клика по кнопке **Все загрузки**
    %%"a_ev":"all"%%
    1.#2 количество видимых файлов в балуне на момент клика по кнопке **Все загрузки**
    %%"cnt":%номер файла в списке%%%
    Пример: %%{"client_id":"dwnlds","params":{"a_ev":"all", "cnt":7}}%%
  5. Логгировать для каждого клика по кнопке **Открыть папку** (с версии 18.6.0):
    1. Факт клика по кнопке **Открыть папку**
    %%"a_ev":"folder"%%

%%этап II%% (draft)
Нужно добавить в текущие бандлы (dwnlds) логирование следующих событий

**1. Открытие файла**
* opncs - открываемый файл был скачан при текущей сессии (да/нет)
* opnts - таймстемп момента открытия

**2. Дополнительная статистика при нажатии на Скрыть загруженные**
* clr1st - таймстемп загрузки первого файла (нумерация файлов сверху вниз, верхний файл = №1) в балуне загрузок
* clrlast - таймстемп загрузки последнего файла в балуне загрузок

**3. Drag-n-drop**
* dndorder - порядковый номер файла в балуне (нумерация файлов сверху вниз, верхний файл = №1)
* dndext - расширение перебрасываемого через drag-n-drop файла
* dndsize - размер перебрасываемого через drag-n-drop файла (в байтах)
* dndts - таймстемп момента, когда мы дропнули файл при drag-n-drop
* dndcs - был ли файл скачан при текущей сессии (да/нет)
* --dnddest - в какое приложение бросили файл через drag-n-drop (например: yabrowser/проводник/telegram/видео плеер...)--
* c_dnd - факт drag-n-drop, считаем только файлы, которые перетянули за рамки балуна загрузок
* с_dndsucc - факт успешного drag-n-drop, считаем только файлы, которые перетянули за рамки балуна загрузок в область где файл был подтянут приложением

**5. Контекстное меню**
Контекстное меню конкретной позиции в списке можно вызвать правым кликом на позиции или нажатием на троеточие.
* c_cm_action - произведенное действие (<{список действий
0 – скрытие меню без выбора действия
От 1 и далее выбор действия после клика:
1 – остановить загрузку
2 – отменить загрузку (пункт для элемента в статуса malwareDangerousUrl)
3 – открыть файл
4 – открыть после загрузки
5 – показать в папке
6 – открыть/не открывать автоматически такие файлы (по расширению файла)
7 – копировать ссылку
8 – перейти к странице-источнику файла
9 – скачать заново
10 – удалить из списка
11 – возобновить загрузку
12 – возобновить опасную загрузку
13 – возобновить прерванную загрузку
14 – Отключит просмотр документов плагинами браузра
15 – Открыть страницу "Информация о защите файлов"
16 – Удалить опасный файл
17 – Открыть небезопасный файл
18 – Проверить безопасность
19 – Остановить проверку
20 – Удалить из списка (для файла в статуса malwareDanger). Пункт называется также как и 10 но ещё и удаляет файл с диска, вынес отдельно.
21 – Информация об ошибках
22 – Удалить файл с диска
}>)
* cmorder - порядковый номер файла в балуне (нумерация файлов сверху вниз, верхний файл = №1)
* cmdext - расширение файла для которого открыто КМ
* cmsize - размер файла для которого открыто КМ
* cmts - таймстемп момента, когда мы открыли КМ файла
* cmcs - был ли файл скачан при текущей сессии (да/нет)

**6. Клики по синим кнопкам под названием, которые появляются по ховеру**
* c_ctr_x - удаление файла из списка по крестику
* c_ctr_open - нажатие на кнопку "открыть"
* c_ctr_folder - нажатие на кнопку "показать в папке"
* c_ctr_pause - нажатие на кнопку "пауза"
* c_ctr_resume - нажатие на кнопку "возобновить"
* c_ctr_cancel - нажатие на кнопку "отменить загрузку"
* c_ctr_stpcheck - нажатие на кнопку "остановить проверку"
* c_ctr_delete - нажатие на кнопку "удалить"
* c_ctr_rptcheck - нажатие на кнопку "повторить проверку"
* c_ctr_dwnld - нажатие на кнопку "загрузить"
* c_ctr_dwnldagain - нажатие на кнопку "скачать заново"
* numdwnlds - количество активных загрузок (не на паузе, не завершена, не прервана и т.п.). Собираем в момент открытия бабла

Параметры из #4 решено не собирать. Согласовано с staff:om1n

<{Исходная задача
1. Логгировать для каждого открытия файла в балуне:
  1. время с момента, когда закончилась проверка безопасности, в секундах
  2. файл был скачан во время текущей сессии, да / нет
2. Логгировать для каждого клика по кнопке **Очистить**:
  1. время с момента, когда закончилась проверка безопасности верхнего в балуне скачанного файла, в секундах
  2. время с момента, когда закончилась проверка безопасности нижнего в балуне скачанного файла, в секундах
3. Логгировать для каждого события drag-n-drop:
  1. порядковый номер файла в балуне (нумерация файлов сверху вниз, верхний файл = №1)
  2. расширение / тип
  3. размер
  4. время с момента, когда закончилась проверка безопасности перетащенного файла, в секундах
  5. файл был скачан во время текущей сессии, да / нет
  6. куда перетащен файл, если можно
4. Логгировать для каждого клика по кнопке **Все загрузки**:
  4. время с момента, когда закончилась проверка безопасности верхнего в балуне скачанного файла, в секундах
  4. время с момента, когда закончилась проверка безопасности нижнего в балуне скачанного файла, в секундах
  4. время с момента, когда закончилась проверка безопасности первого файла, которого нет в балуне, но который есть на browser://downloads, в секундах
  7. первый файл, которого нет в балуне, но который есть на browser://downloads, был скачан во время текущей сессии, да / нет
  8. число "непросмотренных" файлов ("просмотренным" считаем файл, который человек открыл (запустил) через балун; если человек открыл browser://downloads — то все файлы считаем "просмотренными")
5. Логгировать для каждого клика по пункту КМ файла:
  1. всё, что логгируется сейчас https://wiki.yandex-team.ru/browser/stat/bundle/#vzaimodejjstvieskontekstnymimenju
  2. порядковый номер файла в балуне (нумерация файлов сверху вниз, верхний файл = №1)
  3. расширение / тип
  4. размер
  5. время с момента, когда закончилась проверка безопасности, в секундах
  6. файл был скачан во время текущей сессии, да / нет}>

%%этап III%%
TBD


===Push-to-Call ("client_id":"ptcall")
====Параметры и значения
В "params" передаем:

1. При парсинге номера(ов) на странице:
"parse":["nc,nt,nn,N1", "nc,nt,nn, N2"],
 - nc - число цифр в коде страны (если нет - передает пустой символ),
 - nt - число цифр в коде города,
 - nn - число цифр в коде самого телефонного номера.
Cчитаем именно число цифр. Вспомогательные символы типа скобок, тире и пробелов не учитываем.
 - N1 - число номеров на странице с таким же форматом номера.

Различных форматов номеров на одной странице может быть несколько, поэтому в листе значения может быть несколько подобных наборов.

2. Показ попапа в большом браузере:
"pop":["nc,nt,nn,act,ed"],
 - nc - число цифр в коде страны (если нет - передает пустой символ),
 - nt - число цифр в коде города (если нет - передает пустой символ),
 - nn - число цифр в коде самого телефонного номера. Вспомогательные символы типа скобок, тире и пробелов не учитываем.
 - act:
  1 в случае клика на "Позвонить",
  0 в случае закрытия попапа, его исчезновения, игнорирования и т.п.
 - ed
  0 - не редактировали номер
  1 - редактировали код страны
  2 - редактировали код города
  3 - редактировали сам номер
====Что планируем считать
1. Количество запарсенных номеров день/неделя/месяц
2. Среднее количество номеров на страницу (только тогда, когда там есть хоть один номер)
3. Гистограмму по длине запарсеных номеров
3.1 Гистограмма кейсов: город, код+город, страна+код +город    (*тут было бы неплохо города в общей массе смотреть, не только идентифицированные по данным из поиска)
3.2 Процент случаев, когда нам поиск дал ответ по геолокации, и когда не дал
4. Аудитория
4.1. Абсолютное число браузеров/юзеров, у которых включился парсинг (т.е. P2C) *внимание, не подмешивать ручку им.Тиграна
4.2. Доля юзеров, которая хоть раз кликнула на запарсеный номер (открыла попап)
4.3. Сколько раз потребовалось запарсить номер перед тем как 80% юзеров, нажало на номер. *Хочу понять после какого раза нужно начать работать с диссидентами.
4.4. Процент аудитории, которая включила и пользуется P2C раз в три недели и чаще. *Лучше графиком: х -время, у - процент
4.5. Соотношение показов попапа к количеству парсингов  *смотрим конверсию
5.Попап
5.1. Процент кейсов, когда закрыли попап
5.2. Процент кейсов, когда отредактировали номер и закрыли
5.3. Процент кейсов, когда отредактировали номер и позвонили
5.4. Процент кейсов сразу позвонили. *думаю, стоит нарисовать пирог из 4 кусков

5.5. Процент кейсов, когда мы не угадали код страны *т.е. юзер его отредактировал
5.5. Процент кейсов, когда мы не угадали код города  *т.е. юзер его отредактировал
!!! Кажется, мы можем эту информацию как-то использовать, возвращая ее обратно в поиск?!!!

6. Пуш
6.1. Соотношение кликов "позвонить" к показу попапа
6.2. Процент кейсов, когда после нажатия "позвонить" мы показали ошибку
6.3. Соотношение полученных пушей к кликам "позвонить" *нам было бы очень полезно уметь считать в МБ факт его запуска по пушу и/или запуску "звонилки"

7.Показатель для Монитора Здоровья фичи:
7.1. Количество открытых попапов за прошлый день
7.2. Количество полученных пушей (или открытых звонилок)

8.Главный показатель полета фичи:
8.1. Процент аудитории, который хоть раз воспользовался P2C (делить не на всю аудиторию браузера, а на тех, кому физически доступен P2C)
8.2. Аналогично 4.4.


====Задачи
https://jira.yandex-team.ru/browse/BROWSER-14909


===Переход на новый хост ("client_id":"nhost") !!В разработке!!
====Параметры и значения
Если был переход на хост, который не встречается в истории за последний месяц, отправляем в ближайщем бандле:
%%{
"client_id": "nhost",
"params": {
"nav": 1
}
}%%

**Только для брендинга tb и партнеров на нем!**

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-12373

===Улучшатор ("client_id":"apps")
 * Процент аудитории, пользующихся расширениями.
  * Отчет (дневной, недельный, месячный) по посещения страницы Улучшений
    * В разбивке по способу перехода в наш Стор (из Табло, из Меню)
  * Количество установок/включений в день
    * Из нашего Стора
    * Из Chrome Web Store
    * Из других источников
  * Количество отключений/удалений в день
    * Из нашего Стора
    * Из Chrome Web Store
    * Из других источников
  * Аудитория расширений (таблица: расширение/количество)
    * Из нашего Стора
    * Из Chrome Web Store
    * Из других источников
Отправляем по факту показа с ближайшим навигейтом.

====Параметры и значения
Посещение страницы расширений (шлем при открытии улучшатора в табло или на отдельной странице. Сразу или лучше ждем 5 мин и шлем вместе и данными про вкл/выкл экстеншнов)
 "apvis":"ta" — из табло
 "apvis":"me" — из меню
 "apvis":"omn" - напрямую ввести ссылку в омнибокс: chrome://tune
(14.4) На самом деле, теперь  "apvis":"omn"  будет отправляться ВСЕГДА при открытии страницы browser://tune. А при открытии меню или из табло будут отсылаться дополнительно параметры ta и me. Таким образом ,чтобы вычислить количество ссылок, введенных напрямую, нужно будет вычесть из общего кол-ва клики в меню и табло.
https://jira.yandex-team.ru/browse/BROWSER-18332
https://jira.yandex-team.ru/browse/BROWSER-18770

По переходу из табла, при клике по любой сущности (кроме настроек)
{"client_id":"apps","params":{"apvis":"ta"}} (аналогично для меню и для ссылки из контекстного меню)

При включении, установке  и при выключении,удалении
мы во-первых, различаем, сторовский это extension (yast) или third-party (chst)
{"client_id":"apps","params":{"apoff": [%id%, %from%]}}
(желательно балково)


Установка/включение
 "apon":["%id%", "%from%"]

 Отключение:
 "apoff":["%id%", "%from%"]
 Удаление:
 "adel":["%id%", "%from%"]

--Использование (шлем раз в сутки)--
 --"apuse":["%id%", "%from%"] , где:--
 --%id% — уникальный id расширения--
 --%from% — одно из трёх значений, характеризующее источник: yast, chst, oth--
Использование не шлем, а используем стандартную статистику экстеншнов
https://jira.yandex-team.ru/browse/BROWSER-17581

====Пример
 {"client_id":"apps","params":{"apvis":"ta","apon":["%id%", "%from%"]}}
 {"client_id":"apps","params":{"apuse":[ ["%id%", "%from%"],["%id%", "%from%"] ]}}
====Задачи
https://jira.yandex-team.ru/browse/BROWSER-17446

===Отправка крешей
client_id = crash

Параметры:
a_id = ID креша, например bp-43c77945-22fe-4493-bc19-a467a2150810
a_ts = timestamp креша (время в UNIX формате)
с_cr = counter, значение 1, нужен для того, чтобы потом в стандартном отчете на статфейсе увидеть общее количество крешей по версиям и по дням

Пример посылки:
{"client_id":"crash","params":{"a_id":"bp-43c77945-22fe-4493-bc19-a467a2150810","a_ts":"1439214905","c_cr":"1"}

Отправлять на каждый креш, не суммировать, не группировать.


===Крэши ("client_id":"crshs")

{"client_id":"crshs","params":{"p":"b","r":"Y","t":"c","pid":"5032"}}
{"client_id":"crshs","params":{"b":"bp-dcce8939-5bec-4c14-8424-971fb2131230","p":"b","pid":"5032","t":"r"}}


Вот такие сокращения (и доступные параметры):
key_map["is_real_crash"] = "r"; # бывает ещё N - когда создание дампа было вызвано программно
key_map["bp_id"] = "b";
key_map["LOG_FATAL"] = "F";
key_map["physical-memory"] = "m";
key_map["incorrect_event"] = "i"; # выключено - когда найден некорректный (пустой) файл события
key_map["exception_code"] = "c";
key_map["assertion_expression"] = "ae";
key_map["assertion_function"] = "af";
key_map["assertion_file"] = "af";
key_map["assertion_line"] = "al";
key_map["assertion_type"] = "at";
key_map["exception_type"] = "et";
key_map["exception_code"] = "ec";
key_map["exception_subcode"] = "es";

key_map["ptype"] = "p";
val_map["p"]["browser"] = "b";
val_map["p"]["gpu-process"] = "g";
val_map["p"]["renderer"] = "r";
val_map["p"]["service"] = "s";
val_map["p"]["ppapi"] = "a";
val_map["p"]["ppapi-broker"] = "b";
val_map["p"]["utility"] = "u";

key_map["type"] = "t";
val_map["t"]["crashed"] = "c";
val_map["t"]["reported"] = "r";
val_map["t"]["deleted"] = "d";

key_map["error"] = "e";
# Такая классификация на винде, на маке развёрнутые приходят откуда-то.
val_map["e"]["network issue"] = "n";
val_map["e"]["rejected"] = "r";
val_map["e"]["throttled"] = "t";
val_map["e"]["unknown"] = "u";

key_map["code"] = "ec";

Assertion - это такая конструкция в программе, которая заставляет её падать когда обнаруживается ситуация которой никак не может быть по мнению разработчика. Большая часть такого отключается в релизных сборках.

Throttled - это когда превышен лимит отправок краш-репортов. Тот что я видел был 999 в день, но возможно это дебажное значение.

Type - тип события статистики, одно из трёх. Ptype - тип процесса браузера, к которому событие относится (гланый процесс, рендерер, плагин и т.п.)

Physical memory - всего физической. Сколько занятно (точнее, свободно) наверно тоже интересно, но брейкпад такого не слал.
Что не сократилось будет как есть, список типов процессов может быть неполный.

Можно включить дополнительные параметры:
#define YANDEX_CRASH_STAT_EXTENDED_INFO 1

====Параметры и значения

====Пример

====Задачи
BROWSER-14661

===Ошибки апдейта !!в разработке!!

====Параметры и значения
{
"client_id": "manupdater",
"params": {
"%er_code%": "1"
}
}

Отправляется по факту получения ошибки.
"%er_code%" — это код ошибки, свой для каждой из ситуации ниже:
Возможные коды ошибок, это первое число после e

UPDATE_ERROR_SUCCESS = 0 The upgrade completed successfully (or hasn't been started yet).
UDPATE_ERROR_UNAVAILABLE = 1 can't download updater
UPDATE_ERROR_CONNECTION = 9 system_error_code is net::URLRequestStatus::Status
UPDATE_ERROR_SERVER = 17 Server error
UPDATE_ERROR_FETCHING = 33 Url fetcher failed
UPDATE_ERROR_TIMEOUT = 65 timeout
UPDATE_ERROR_LAUNCHING = 2 Lanch or Create updater process filed
UPDATE_ERROR_LAUNCHING_CANOT_CREATE_DIRECTORY = 10 can't create "install_checker" dir
UPDATE_ERROR_GET_VERSION_INFO_FAILED =18 A call to GetVersionInfo failed.
UPDATE_ERROR_VERIFICATION = 35 md5 or rsa_hash is not valid
UPDATE_ERROR_INTERRUPTED = 66 ProwserProcess is shutting down
UPDATE_ERROR_POLICY = 4 Updates can not be downloaded because the administrator has disabled them.
UPDATE_ERROR_UPDATING_DEPRECATE = 7, // historical

Второе число это код системной ошибки или http_result.
Например может прийти e17-404, если системная ошибка, то она зависит от ОС на которой работает браузер.

====Задача
https://jira.yandex-team.ru/browse/BROWSER-18376

===Панель Share ("client_id":"shrpnl")

====Требования
Хотим считать:
  * Количество показов панели Share.
  * Количество кликов по кнопкам панели (Копировать, Поделиться в: ВК, ФБ, Одноклассники, Твиттер).
  * Количество выключений панели в настройках браузера.

====Параметры и значения

"shw":"1" - Количество показов панели Share (отправляется после каждого показа)
"cpy":"1" - Клики по кнопке "Копировать" (отправляется после каждого клика)

Клики по разделам меню "Поделиться" (отправляется после каждого клика):
  * "vk":"1" - Вконтакте
  * "fb":"1" - Фейсбук
  * "od":"1" - Одноклассники
  * "tw":"1" - Twitter

"ds":"1" - Событие выключения панели Share через чекбокс в настройках браузера (событие отправляется после каждого снятия галочки в чекбоксе, установку галочек - то есть включение панели - не считаем).

Пример посылки:
%%{"client_id":"shrpnl","params":{"shw":"1"}
{"client_id":"shrpnl","params":{"vk":"1"}%%
====Задачи
https://jira.yandex-team.ru/browse/BROWSER-17288

===Предзагрузка страницы в новом табе ("client_id":"prndr")
====Требования
Хотим считать:
  * количество предзагрузкок страниц на СЕРПе
  * количество отказов от предзагрузок на СЕРПе
  * количество открытых пререндереных страниц на СЕРПе (факт использования страницы из предзагруженых)
Хотим видеть эту статистику на странице https://stat.yandex-team.ru/Chromium/Adhoc/BrowserFeatures/client_id

_____
В браузере добавляем информацию:
а) о факте предзагрузки страницы __на СЕРПе__
б) о факте использования страницы из предзагруженных (из тех, которые отдал СЕРП).
Логируем ТОЛЬКО предзагрузки по инициации СЕРПа (бывают еще предзагрузки из саджеста, по запросу сайта и т.д. - их не считаем).

в) факт отказа от предзагрузки (на СЕРПЕ)

На СЕРПе логируем такое:
а) все переходы с СЕРПа (весь поток и по Я.Браузеру).

BROWSER-18712

KPI
Отношение использованных к предзагруженным должно быть не менее 80%.
Для оценки влияния фичи на весь поток берем частоту использования пререндера: отношение переходов с серпа с пререндером ко всем переходам с серпа за сутки. Считаем по всему потоку и в срезе по Яндекс.Браузеру.
Сколько у нас дохлых машин, где пререндеринг не будет работать.
______

====Параметры и значения
Статистику отправляем каждый раз при наступлении события __на Серпе__ (факту отказа от предзагрузки, отказ от предзагрузки и т.д.).

Количество предзагрузкок страниц на СЕРПе (т.е. сколько всего СЕРП указал страниц для пререндеринга) - "prndr_pre"
Количество открытых пререндереных страниц на СЕРПе (факт использования страницы из предзагруженых) - "prndr_use"
Количество отказов (MEMORY_LIMIT_EXCEEDED)- "prndr_memlm"
--Количество отказов (JS_OUT_OF_MEMORY) - "prndr_jsmem"--
Количество отказов (TOO_MANY_PROCESSES) - "prndr_2mpr"
Количество отказов (RATE_LIMIT_EXCEEDED) - "prndr_rle"
Количество отказов (RENDERER_CRASHED) - "prndr_crsh"
Количество отказов (DEVTOOLS_ATTACHED) - "prndr_dvtl"
Количество отказов (SESSION_STORAGE_NAMESPACE_MISMATCH) - "prndr_ssnm"
Количество отказов (SYSTEM_MEMORY_LOW) - "prndr_sml"
Количество отказов (NAVIGATION_UNCOMMITTED) - "prndr_nu"
Количество всех других отказов от предзагрузок на СЕРПе - "prndr_esc"
Урл, созданный пререндерером, обращающимся к windows.opener - "opa" (состояния  used, pre (еще пререндерился), live и dead)

====Параметры и значения (дополнительные значения параметров отказов с версии 14.7)
TIMED_OUT            -               prndr_time
MANAGER_SHUTDOWN      -             prndr_msdn
CREATE_NEW_WINDOW      -             prndr_bp_nwnd
PROFILE_DESTROYED       -            prndr_prdt
APP_TERMINATING         -            prndr_appt
JAVASCRIPT_ALERT        -            prndr_bp_jsal
AUTH_NEEDED             -            prndr_bp_auth
DOWNLOAD                -           prndr_bp_dnl
UNSUPPORTED_SCHEME      -           prndr_bp_usch
INVALID_HTTP_METHOD     -           prndr_bp_meth
WINDOW_PRINT            -           prndr_bp_prnt
RECENTLY_VISITED        -           prndr_rcnt
WINDOW_OPENER           -           prndr_opnr
SAFE_BROWSING           -           prndr_bp_sb
SSL_CLIENT_CERTIFICATE_REQUESTED -  prndr_bp_cert
CACHE_OR_HISTORY_CLEARED    -       prndr_clear
CANCELLED            -              prndr_cncl
SSL_ERROR             -             prndr_bp_ssle
CROSS_SITE_NAVIGATION_PENDING  -    prndr_csnp
DUPLICATE             -             prndr_dup
OPEN_URL               -            prndr_ourl
WOULD_HAVE_BEEN_USED    -           prndr_err_whbu - теоретически не должен приходить, заводим  для контроля
REGISTER_PROTOCOL_HANDLER -        prndr_bp_rph
CREATING_AUDIO_STREAM      -        prndr_bp_aus
PAGE_BEING_CAPTURED        -        prndr_capt
BAD_DEFERRED_REDIRECT      -        prndr_bp_bdr
NEW_NAVIGATION_ENTRY       -        prndr_bp_nne

====Параметры и значения (дополнительные значения параметров отказов с версии 14.8)
CLOSE - prndr_cls

====Параметры и значение с версии 14.10
Отказ от предзагрузки на восстановленой вкладке - rcvr_tb
Отказ, потому что страница с предзагрузкой не последняя в истории - hist_nl

----
Сделать из opa 4 параметра, передающих только урл: opau (used), opap (pre), opal (live), opad (dead).
Например: {"client_id": "prndr", "params": { "opau": "http://url.com" } }

====Пример
  {"client_id": "prndr", "params": {"prndr_pre":"1","prndr_pre":"1","prndr_pre":"1"}}
  {"client_id": "prndr", "params": {"prndr_use":"1","prndr_use":"1"}}
  {"client_id": "prndr", "params": { "opa": [ "http://url.com", "used" ] } }
====Задачи
https://jira.yandex-team.ru/browse/BROWSER-18712
https://jira.yandex-team.ru/browse/BROWSER-22394

===Блокировщик рекламы
"client_id":"badad"

* **inject** - факт перехода на урл, для которого пользователь заблокировал рекламу
* **block** (только в режиме выделения) - факт применения локального списка блокировки
* **cancel** - факт нажатия кнопки отмены
* **send** - факт нажатия отправить в яндекс
* **menu_click_on** - факт клика в меню для блокировки
* **edit_mode_show** - факт инжекта скрипта/переход в режим выделения (должны быть равны, заодно и верифицируем)

**Аудитория фичи (Отравляем раз в 4 часа)**
* **isonadb** 1 - состояние настройки "Блокировать шокирующую рекламу" на странице настроек = включено, 0 - выключено
* **isonatntis** 1 - состояние настройки "Блокировать мешающую рекламу рекламу" на странице настроек = включено, 0 - выключено

**Клики в КМ**
* **clw** - отправляем url в случае клика в "Не блокировать рекламу на этом сайте" "params":{"clw":"url"}
* **clp** - отправляем 1 в случае клика в "пожаловаться на рекламу" "params":{"clp":"1"}

**ВКЛ/ВЫКЛ на странице настроек**
antontune: 1 - факт ВКЛючения Антишока на странице настроек
antofftune: 1 - факт ВЫКЛючения Антишока на странице настроек
adbontune: 1 - факт ВКЛючения Блокировщика на странице настроек
adbofftune: 1 - факт ВКЛючения Блокировщика на странице настроек
antonsettings: 1 - факт ВКЛючения Антишока на странице настроек
antoffsettings: 1 - факт ВЫКЛючения Антишока на странице настроек
adbonsettings: 1 - факт ВКЛючения Блокировщика на странице настроек
adboffsettings: 1 - факт ВЫКЛючения Блокировщика на странице настроек

<{Логирование урлов из client_id : yablocker
**Логирование урлов**
blocked: url — автоматически заблокировали что-то на странице (отправляется URL посещаемой страницы)
unblockedcntxtmn: url — на странице разблокирована реклама из контектсного меню
unblockedprotect: url — на странице разблокирована реклама из протекта
blockedcntxtmn: url — на странице заблокирована реклама из контекстного меню
showprotect: url — факто того, что пользователь кликнул в иконку в омнибоксе и ему был показан наш блок внутри меню протекта}>



===ФОНЫ и всё, что с ними связано
====!!"client_id":"vbgs"!! - видеофоны
Реализация в BROWSER-19472
#|
||Параметр|Частота отправки|Значение||
||wc |С каждым запросом|Слабое железо ||
||sc |С каждым запросом|Сильное железо ||
||scoff |1 раз в час|Сильное железо, фоны отключены вручную ||
||wcon |1 раз в час|Слабое железо, фоны включены вручную ||
||wcoffh |1 раз в час|Слабое железо, фоны отключены руками после того, как были включены ||
||wcoffa |1 раз в час|Слабое железо, фоны отключены автоматически режимом деградации ||
||bgid|1 раз в час|ID текущего выбранного фона, 'custom' если установлен кастомный фон (корректно с версии 19.10.0, до этого были странные значения вроде %%custom|default|mointains%%)||
|#

Параметры %%wc%% и %%sc%% должны уходить с каждым запросом, в котором отправляется любой другой параметр для этого client_id.
Параметры, отправляющиеся раз в час, должны отправляться, если в течение этого часа значение соответствующей настройки не было изменено - нужно логировать состояния, когда состояние настройки продержалось хотя бы 59 минут, чтобы отфильтровать случайные нажатия и клики для посмотреть со скорым возвратом к предыдущему состоянию.

**Отправка по событию, значение = 1**
#|
||Параметр|Значение||
||bch |Фон был изменён пользователем (кликнута превьюшка фона, отличного от текущего) ||
|#

**С версии ??? дополнено**
((https://wiki.yandex-team.ru/browser/custo/tz/backgrounds/#dorabotkiv16.9apidljaustanovkifonovssajjta Описание доработки))

Новые параметры в бандл client_id: vbgs
- %%customs%%, число: количество недефолтных фонов у пользователя
- %%apicustoms%%, число: количество фонов, установленных пользователю с помощью API
- %%hires%%, значение: %%"settings": "on|off", "state": "on|off"%% - settings отражает состояние настройки, state - фактическое использование (настройка может быть включена, но в режиме деградации видео заменено на статику и по факту хайрез не используется)

**Дополнено с версии 17.7.1 (запуск со стором фонов)**
1. Отправка раз в час вместе с существующей статусной статистикой.

Новые параметры:
* %%a_video%%, значения %%on|off|static%% - on|off видео играет или на паузе, static в качестве фона установлено не видео
* %%a_bgtype%% (!!deprecated с 19.10.* - используем a_bgchannel + a_video + a_autorotation для получения знания об источнике фона, включенности ротации и анимированности/статичности фона!!), значения %%local|store_static|store_video|store_rotation|default_rotation|default%% - тип текущего фона, выбран с локальной машины, одиночная статика из стора, одиночное видео из стора, ротация установленная из стора, дефолтная ротация, дефолтный фон(не был изменен пользователем)
* %%a_education%%, значения %%on|off%% - состояние настройки "Оповещать об обновлениях", т.е. включён или выключен показ балунов обучатора
* %%bgsource%%, значение - урл source, переданный из стора при установке фона. %%default%%, если фон не менялся с момента установки браузера (т.е. текущим является тот, который приехал в сборке). От URL нужно отрезать общее для всех фонов начало ссылки (протокол, домен и пр.), оставив только имя файла и путь

2. Отправка по событию:
* %%a_play%%, значения %%on|off%% - включение и выключение анимации видеофона
* %%a_customset%%, значение 1 - установка локального фона с компьютера пользователя
* %%a_storeset%%, значения %%rotation|single%% - установка ротации или одиночного фона из стора

**Дополнено с версии 19.10.0**

1. Отправка раз в час вместе с существующей статусной статистикой

Новые параметры:
* %%a_bgchannel%% со значениями %%default|store|local%%. %%default%% отправляется если пользователь ни разу не ставил обои из галереи, а лишь включал ежедневную ротацию или менял их стрелками в балуне на НТП. %%store%% отправляется если пользователь поставил обои в галерее. %%local%% отправляется если пользователь загрузил обои с компьютера.
* %%a_bgalbum%% co значениями %%<albumId>|all%%. %%<albumId>%% отправляется если у пользователя выставлен любой альбом кроме "Все фоны". %%all%% отправляется если выбран альбом "все фоны" или обои установлены с компьютера.
* %%a_autorotation%% co значениями %%on|off%%. %%on%% отправляется если у пользователя включена ежедневная ротация обоев.
* В статистике %%bgid%% теперь отправляется Id фона.

**С версии 17.10.1**
Отправка по событию
Новые параметры:
* lowbattery_baloon_shown, значение 1. Факт показа балуна после снижения заряда батареи ниже критического порога. Должно учитываться не каждое открытие ньютаба, а первый показ до момента заряда батареи (то есть по факту этот параметр про автостоп анимации, а не конкретно каждую отрисовку балуна)
* lowbattery_baloon_closed, значение 1. Факт скрытия балуна пользователем с помощью клика по крестику

**С версии 18.3.1** - !!Балун галереи на НТП!!
Для нового балуна используем "client_id":"vbgs"
  * факт открытия балуна по трем точкам (baloon_open)
  * количество нажатий на любую из стрелочек до закрытия балуна (switch_count)
  * факт клика в переключатель "Анимация фона" (a_play, значения on|off)
  * факт клика в переключатель "Оповещать о новых фонах" (a_newbg, значения on|off)
  * факт клика в переключатель "Чередовать каждый день" (a_rotation, значения on|off)
  * факт установки локального фона с компьютера пользователя (acustomset)
  * факт перехода в галерею по ссылке "Сменить альбом" (go_galery)

**С версии 18.4.1**
Новый параметр a_bch со значениями:
* manual - факт смены фона пользователем вручную
* rotation - факт смены фона при ротации

====!!**client_id: bg**!!
с 18.9.0
https://st.yandex-team.ru/BROWSER-90075
Показ промо-балуна - **а_ntp_promo_balloon_show**
  значения:
    0 - показ дефолтного варианта (с 4 картинками)
    1 - показ варианта с одной картинкой в эксперименте
    6 - показ варианта с 6 картинками в эксперименте

Закрытие промо-балуна - **a_ntp_promo_balloon_close**
  значения:
    0 - закрыть крестиком
    1 - клик по кнопке на балуне
    2 - клик по кнопке "галерея фонов" над балуном
    3 - клик по любой картинке на балуне

с 18.9.0
https://st.yandex-team.ru/BROWSER-89619
Параметры:
  * пользователь попал в эксперимент с авторотацией (мы должны менять ему фон) - **c_arot_on**
  * пользователь зашел на нтп после запуска логики с авторотацией - **c_arot_show_ntp**
  * время через, которое пользователь открыл ntp
  * промежуточное видео скачано - **c_arot_tmp_v_dnld**
  * промежуточное видео показано - **c_arot_tmp_v_show**
  * следующее видео скачано - **c_arot_next_v_dnld**
  * следующее видео показано - **c_arot_next_v_show**
  * балун показался - **a_arot_blln_show** (0 - не показался, 1, 2, 3 - для первого, второго или третьего показа балуна)
  * пользователь кликнул на "Хорошо" на балуне - **a_arot_blln_clck_ok** (значения 1, 2, 3 - для первого, второго или третьего показа балуна)
  * пользователь кликнул на "Отмена" на балуне - **a_arot_blln_clck_no** (значения 1, 2, 3 - для первого, второго или третьего показа балуна)
  * пользователь кликнул на крестик на балуне - **a_arot_blln_clck_x** (значения 1, 2, 3 - для первого, второго или третьего показа балуна)
  * пользователь кликнул на "Галерея фонов" при показанном балуне - **a_arot_blln_clck_gallery** (значения 1, 2, 3 - для первого, второго или третьего показа балуна)

с 18.9.1
https://st.yandex-team.ru/BROWSER-89792
Показ каунтера новых фонов на нтп -  **a_ntp_counter_show**
  значения:
    1 - показался каунтер 1
    2 - показался каунтер 2
    и т.д.

Переход в галерею при каунтере -  **a_ntp_counter_click**
  значения:
    1 - пользователь нажал на переход в галерею, когда показался каунтер 1
    2 - пользователь нажал на переход в галерею, когда показался каунтер 2
    и т.д.

с 19.1.0
Кнопка "Показать фон" - **a_show_wallpaper** - отправляется факт скрытия и последующего показа custopage:
* id_wallpaper - id показанного фона, 'custom' если установлен кастомный фон;
* time_watch - длительность просмотра фона;
* time_ntp - время, прошедшее с момента открытия ntp до скрытия custopage;

Пример:
{"client_id":"bg","params":{"a_show_wallpaper":{"id_wallpaper":<>,"time_watch":<>,"time_ntp":<>}}}

===Изнанка ("client_id":"ins") Q2
Реализация в BROWSER-19477 и BROWSER-27023

**Отправка по событию клика** (без накопления)
#|
||Параметр|Значение|Где||
||a |Клик на кнопку Добавить в Табло |!!JS!!||
||d |Клик на кнопку Удалить из Табло |!!JS!!||
||c |Клик на кнопку Скопировать ссылку |!!JS!!||
||sh |Клик на кнопку Поделиться |!!JS!!||
||vk |Клик на кнопку ВК |!!JS!!||
||fb |Клик на кнопку FB |!!JS!!||
||o |Клик на кнопку Одноклассники |!!JS!!||
||ml |Клик на кнопку Отправить по почте |!!JS!!||
||tw |Клик на кнопку Твиттер |!!JS!!||
||af |Клик на кнопку Добавить в Избранное |!!JS!!||
||df |Клик на кнопку Удалить из Избранного |!!JS!!||
||se |Клик на кнопку Найти на сайте |!!JS!!||
||p |Клик на кнопку Распечатать |!!JS!!||
||tsi |Открытие изнанки |!!JS!!||
||tst |Открытие NTP |!!JS!!||
||ictw |Изнанка закрыта вместе с табом кликом по крестику таба или вместе с окном |!!C++!!||
||ice |Изнанка закрыта нажатием Esc |!!C++!!||
||ica |Изнанка закрыта кликом в произвольную незанятую область или заголовок окна |!!JS!!||
||tctw |NTP закрыт вместе с табом или окном |!!C++!!||
||tce |NTP закрыт нажатием Esc |!!C++!!||
||ins_cls|Закрытие изнанки - детализацию см. ниже| ||
||bk | Клик на кнопку "Назад" в изнанке в текущем табе|!!JS!!||
||frw | Клик на кнопку "Вперед" в изнанке в текущем табе|!!JS!!||
||ya | Клик на кнопку "Я" |!!JS!!||
||dnl| Клик на иконку даунлоадера |!!JS!!||
|#

Для кнопок, скрытых под кнопкой Поделиться, количество показов будет равно количеству кликов на кнопку Поделиться (для расчет CTR)

**Отправка по событию закрытия Изнанки** (параметр ins_cls)

  1.  Ссылки, которые были показаны в списке контекстных (в порядке соответственно показу), и номер(а) кликнутой позиции - JSON вида "clsh": {"urls":[url1, url2, url3], "clck":[2], "hash":"abcd"}. Здесь "hash" - данные, которые при отдаче ссылок будет присылать ручка для контроля реакции пользователя на выдачу. Если кликов не было, будет отправлен "clsh": {"URLS":[url1, url2, url3], "clck":[], "hash":"abcd"}.
  2. Исходная страница открытия Изнанки - JSON вида "src":"<url>", URL полный без сокращений
  3. Идентификатор колдунщика и кликнутая ссылка в нем - JSON вида "wsh": {"wiz":"mrkt|maps", "clck":"url"}. Значение wiz приедет из api.browser.

**Отправка по событию падения Изнанка**
Параметр %%ins_crash%%, отправляется при каждом падении Изнанки в браузере

===Контекст (client_is: insbaloon) Q2
!!В разработке, к запуску в 16.9!!
((https://wiki.yandex-team.ru/browser/custo/tz/inside/#statistika ТЗ))
Данные отправляются при навигейте, аналогично другой компонентной статистике.
Примерно такие:
0. для каждого навигейта, если прокси прислала клиенту данные, будет уходить набор данных %%"client_id": "insbaloon"%%, включающий в себя следующие параметры
1. о пришедших данных и показе тизера %%"page_url": "URL", "data_type": "org|film|etc"%%
2. о показе балуна (собирается в момент скрытия балуна) %%"links_clicked": "URL", "scrolled": 1|0%%. Ссылок в links_clicked может быть несколько, если до скрытия балуна успели кликнуть по нескольким (открытием в фоновом табе, например)

Пример %%"client_id": "insbaloon", "params": {"page_url":"https://wiki.yandex-team.ru/browser/custo/tz/inside/", "teaser_shown": 1, "data_type":"org", "links_clicked":"https://wiki.yandex-team.ru/browser/custo/tz/hips/", "scrolled": 0, "time": 12}%%


===--Поисковая стрелка в новом табе ("client_id":"searcharrow")-- !!Устарело!!
Эксперимент только для Турции (20% stable, 100% бета)
====Параметры и значения
Необходимо при наборе в Поисковой стрелке в новом Табе (>=1 символа) отправлять в bundle статистику вида "params":{"fire":"1"}
При выключении/включении стрелки отправляем "params":{"on":"1"} "params":{"off":"1"}
====Пример
  {"client_id": "searcharrow", "params": {"fire":"1"}}
  {"client_id": "searcharrow", "params": {"on":"1"}}
  {"client_id": "searcharrow", "params": {"off":"1"}}

====Задачи
https://jira.yandex-team.ru/browse/BROWSER-18310

===Футбольный виджет Турции ("client_id":"tufoot") 14.8
Реализация в BROWSER-21174
#|
||Параметр|Действие|Значение||
||conair |Клик на виджет во время трансляции матча |1 ||
||canno |Клик на виджет во время анонса следующего матча |1 ||
||cend |Клик на виджет, когда матч закончен и отображается результат (либо матч отменен/перенесен)|1 ||
||cnom |Клик на виджет, когда у команды нет следующего матча |1 ||
||cdel |Удаление виджета из табло |1 ||
||insft |Установка виджета руками из табло|1 ||
|#

Параметры  должны отправляться по факту совершения описанного действия

===Поп-ап геолокализации ("client_id":"geop") Q2
Про фичу ((https://wiki.yandex-team.ru/browser/custo/tz/geopopup здесь))

#|
||Параметр|Действие||
||ps |факт показа поп-апа. Значение - домен страницы, запросившей геолокацию ||
||is |факт показа инфобара. Значение - домен страницы, запросившей геолокацию ||
||cy |клик по "Разрешить"||
||cn |клик по "Пропустить"||
||cf |клик по "Запретить" (в дропдауне)||
||cs |клик по "Настройки" (в дропдауне)||
||cx |клик по крестику||
||ci |клик по знаку вопроса - переход на хелп||
|#

Все параметры отправляются по факту действия, значение - 1, кроме ws.

===Табло ("client_id":"ctablo") Q2
Про фичу и метрики ((https://wiki.yandex-team.ru/users/tomshinsky/tablo-v-custo#metriki здесь))
BROWSER-19474 и BROWSER-27022

**Отправка по событию, значение = 1**
#|
||Параметр |Событие | Где||
||slt |Переход в настройки табло лонгтапом | !!JS!! ||
||scm |Переход в настройки табло через контекстное меню по правой кнопке мыши в табло | !!JS!! ||
||std |Переход в настройки табло после перетаскивания тумбы  | !!JS!! ||
||srcl |Переход в настройки табло кликом правой кнопки мыши по фону в ньютабе - через контекстное меню  | !!JS!! ||
||cbsc |Переход в настройки табло кликом правой кнопки мыши по фону в ньютабе - без КМ, сразу | !!JS!! ||
||sacm |Переход в настройки табло после добавления тумбы через контекстное меню веб-страницы |!!С++!! ||
||st |Переход в настройки табло через --контрол в шапке http://yadi.sk/d/kF2RDvRwM7aww-- пункт в сэндвиче |!!логируется в части client_id=settings, событие IDC_CUSTOMIZE_TABLO!! ||
||as |Переход в режим добавления тумбы кликом по кнопке + в режиме настроек табло | !!JS!! ||
||ad |Переход в режим добавления тумбы кликом по отдельной ссылке под табло (ньютаб) | !!JS!! ||
||sscl |Переход в настройки табло кликом по отдельной ссылке под табло (ньютаб)  | !!JS!! ||
||ps |Пин иконкой в режиме настроек табло | !!JS!! ||
||pcm |Пин через контекстное меню по правой кнопке мыши в табло | !!JS!! ||
||us |Анпин иконкой в режиме настроек табло | !!JS!! ||
||um |Анпин через контекстное меню по правой кнопке мыши в табло | !!JS!! ||
||pati |Пин после добавления тумбы кликом по кнопке + в верхнем блоке Изнанки | !!JS!! ||
||pas |Пин после добавления тумбы кликом по кнопке + в режиме настроек табло | !!JS!! ||
||pacm |Пин после добавления тумбы через контекстное меню веб-страницы |!!С++!! ||
||pd |Пин после перетаскивания | !!JS!! ||
||cr |Падение табло |!!С++!! ||
||top |Открытие табло в ньютабе или дне |!!С++!! ||
||iop |Открытие табло в изнанке |!!С++!! ||
||syn |Переход в настройки синхронизации кликом по отдельной ссылке под табло (ньютаб) | !!JS!! ||
||tdi| Удаление тумбы. Значение: {%url%, %статус запиненности%, %способ удаления (контекстное меню, кнопка в настройках, кнопка по ховеру)%| !!JS!!||
||ecll, eclr, eclm|Клик кнопкой мыши (левой, правой, средней) по любому элементу любого экрана, за исключением заголовков экранов. Значение:
  * %%tbl%%, если тумба в табло
  * %%hst%%, если последние закрытые вкладки
  * %%dwn%%, если загрузки
  * %%tun%%, если дополнения
  * %%dev%%, если другие устройства
  * %%app%%, если приложения
BROWSER-34556
| ||
|#

//добавление тумбы через контекстное меню страницы пока не реализовано, соответственно, параметры sacm и pacm тоже//
//с версии 17.9.1 для параметров ps, pcm, pati, pas, pacm, pd (все параметры про событие пина) значением слать не 1, а полный урл запиненной тумбы//

**Ротационные тумбы**
параметр %%rotation%% с возможными значениями:
- %%"from": "URL"%% - URL, с которого произведена смена адреса в ротационной тумбе
- %%"to": "URL"%% - URL, на который произведена смена адреса в ротационной тумбе
- %%"a_stopped": "click|edit|del|pin|double"%% - событие, обозначающее завершение ротации по одной из возможных причин: клик, редактирование, удаление тумбы, наличие в табло дубликатов для всех урлов в списке ротации

**Отправка с навигейтом**
#|
||Параметр |Значение ||
||i |Номер тумбы (в случае перехода из Табло) ||
||p |Запиненность тумбы (в случае перехода из Табло), 1-запинена, 0-не запинена ||
||dt |Время принятия решения - время от открытия Табло до первого действия ||
||url |Адрес перехода ||
||--nn --|--Состояние нотификаторов (1 – предусмотрены, но не включены 2 –предусмотрены и включены 0 – не предусмотрены)-- //!!по умолчанию включены и не отключаемы!!// ||
||a_s |Способ открытия:
ti - клик по тумбе табло в Изнанке
tt - клик по тумбе табло в новой вкладке
--f - клик по закладке (favorites) в панели закладок-- уходит в навстатистику как csrc=0401
e - другое (чисто для страховки, чтобы понять, если появятся другие массовые способы переходить на адрес)  ||
|#

**Статусная статистика табло, отправка 2-3 раза в сутки**
#|
||Параметр |Значение ||
||pl |список тумб Популярных в панели добавления ||
||pn |позиции запиненных тумб ||
||rtn |позиции ротационных тумб ||
||tl |список тумб в табло ||
||apil |список сайтов с виджетами или логотипами, добавленными через API||
|#

**Примеры посылок в бандле:**
Навигационная статистика: {"client_id":"ctablo","params":{"dt":"0.09","i":"1","ui":"28B6037E-9186-6D58-FB75-61248ADEE2BC","url":"http://vk.com/","v":"1.1.0.589"}}
Статусная статистика: {"client_id":"ctablo","params":{"pl":"http://maps.yandex.ru/*,http://pozdravit-vsex.ru/*,http://46.165.193.168/*,http://help.yandex.ru/*,http://mail.yandex.ru,http://lenta.ru,http://music.yandex.ru,http://market.yandex.ru","pn":"10000001","tl":"http://www.yandex.ru/*,http://vk.com/*,https://www.amway.ru/*,https://e.mail.ru/*,http://youtube.com,http://ucrazy.ru,http://book2.me,http://mail.ru","ui":"D32F322E-A7CA-95BA-52B0-F169168E1148","v":"1.1.0.589","w":"2"}}

**Принудительная отправка статистики в новом табло**
  * Закрыть браузер
  * Открыть файл Preferences в текстовом редакторе
  * Найти настройку tableau.last_send_statistics_time (это подключ last_send_statistics_time от ключа tableau) и удалить эту настройку
  * Теперь при запуске браузер отошлёт статистику

**Принудительная отправка статистики в старом табло**
Выполнить в консоли табло
%%require(['ntp/StatService'], function(StatService) {
StatService.getInstance().flush();
});%%

((https://st.yandex-team.ru/BROWSER-68051 Гистограмма сбросов табло))
%%DropUserData.Tablo.%ERROR% %%

===Антишок ("client_id":"antis") Q2
====Требования
Хотим считать:
  * Сколько экстеншнов включено
Откуда поставили:
  * количество кликов в "Блокировать" на инфобаре
  * количество показов промо-страницы (и уников в день тоже)
  * количество кликов на "Блокировать рекламу" на промо-странице
  * количество кликов на "включить" в сторе
Инфобар:
  * количество показов инфобара
  * количество закрытий инфобара крестиком
Контекстное меню:
  * количество кликов в вайтлист (с урлом)
  * количество кликов в пожаловаться
Настройки
  * количество переходов в настройки
  * количество кликов в "не блокировать порнорекламу"
Настройки
  * количество переходов в настройки
  * количество кликов в "не блокировать порнорекламу"

+ урлы, на которых сработали, количество срабатываний

Хотим видеть эту статистику на странице https://stat.yandex-team.ru/Chromium/Adhoc/BrowserFeatures/client_id

==== Параметры
**Количество включенных:**
Включен у пользователя. Отправляется ежедневно. - "params":{"on":"1"}
Включен кликом в "Блокировать" на инфобаре - "params":{"onbi":"1"}
Включен показом промо-страницы (и уников в день тоже) - "params":{"onsp":"1"}
Включен кликом на "Блокировать рекламу" на промо-странице - "params":{"onbp":"1"}
Включен кликом на "включить" в сторе - "params":{"onston":"1"}
При выключении экстеншна "params":{"off":"1"}
**Откуда поставили:**
Клик в "Блокировать" на инфобаре - "params":{"blinf":"1"}
Показ промо-страницы (и уников в день тоже) - "params":{"sprom":"1"}
Клик на "Блокировать рекламу" на промо-странице - "params":{"bprom":"1"}
Клик на "включить" в сторе - "params":{"ston":"1"}
**Инфобар**
Показ инфобара - - "params":{"sinf":"1"}
Клик в "крестик" на инфобаре - "params":{"clx":"1"}
**Контекстное меню:**
Клик в вайтлист (с урлом) - "params":{"clw":"url"}
Клик в "пожаловаться" - "params":{"clp":"1"}
**Настройки**
Открытие страницы настроек экстнешна - "params":{"clop":"1"}
Кликов в галку (переведение ее в состояние вкл) "не блокировать порнорекламу" - "params":{"pornon":"1"}
Снятие настройки "не блокировать порнорекламу" (переведение ее в состояние выкл) - "params":{"pornon":"0"}
___
====Параметры под экспериментом
https://jira.yandex-team.ru/browse/BROWSER-24887
Вот эту часть статистику нужно делать экспериментом, чтоб ымы могли ее отключить, если нас начнет заваливать.
Исследование вот тут: https://st.yandex-team.ru/SEARCHSPAM-6902

Урлы, на которых сработали, c привязкой к урлам той рекламы, которую мы заблокировали на этой странице
"params": {"uw": ["url","url","url","url"]}  - первый урл это всегда страничка, на которой мы сработали (например, rutracker), остальные 2..n - урлы рекламы на этой страничке, которые мы заблокировали.

====Пример
{"client_id": "antis", "params":{"on":"1"}}
{"client_id": "antis", "params":{"clp":"1"; "[url]"}}

===Данные антишока для отдела безопасного поиска ("client_id":"antis_us" и "client_id":"antis_as") !!В разработке!!
====Требования
Данные записываются по факту жалобы на рекламу.
{"client_id":"antis_us","params":[]} — данные от юзера
{"client_id":"antis_as","params":[]} — данные от ассесоров
Внутри массива собираем следующие данные (при отсутствии данных записываем пустой элемент, чтобы очередность элементов была всегда фиксированной):

Формат для асессорского плагина:
  * урл страницы
  * время захода(анг)
  * инфа про плагин (версия)
  * id асессора
  * id таска
  * оценка
  * урл блока
  * путь до блока x-path
  * урл родительского скрипта (всех родительских скриптов)
Формат для пользовательского плагина:
  * урл страницы
  * время захода(пользовательское)
  * инфа про плагин (версия)
  * id пользователя
  * урл блока
  * путь до блока x-path
  * урл родительского скрипта (всех родительских скриптов)
по каждому клику сохраняем одну запись
**Пример:**
JSON - формат
Ассесорский плагин:
%%  * http://lenta.ru/news/2014/04/20/zhirinovskiy/
  * 1398258021
  * asessors_plugin_1.0
  * jozh
  * 5746544
  * missed_yellow
  * http://content.adfox.ru/140324/adfox/360186/972932.swf
  * /html/body/div/div[2]/div/div/div[2]/div/div/object/embed
  * http://ads.adfox.ru/171817/prepareCode?p1=bluqt&p2=emhk&pct=c&pfc=a&pfb=a&pr=76532&pt=b&pd=23&pw=3&pv=17&prr=&puid1=&puid2=&puid3=xf8&puid4=zb0&puid5=&puid6=RUSSIA&puid7=&puid8=&puid9=&puid10=&puid11=&puid12=&puid13=&puid14=&puid15=NEWS&puid16=&puid17=&puid18=POLITIC&puid19=&puid20=&puid21=&puid22=ofk:fx5:zn0:ngs:1sw&puid23=&puid24=&puid25=&puid26=&puid27=&puid28=&puid29=&puid30=&puid31=&puid32=&puid33=realip:deposit:credit_users:sp_fit&puid34=&puid35=&pdw=1600&pdh=1200&dl=http%3A//lenta.ru/news/2014/04/20/zhirinovskiy/&pr1=866851 %%
Пользовательский плагин: %%
  * http://lenta.ru/news/2014/04/20/zhirinovskiy/
  * 1398258021
  * adblock_1.0
  * y5766463787907
  * http://content.adfox.ru/140324/adfox/360186/972932.swf
  * /html/body/div/div[2]/div/div/div[2]/div/div/object/embed
  * http://ads.adfox.ru/171817/prepareCode?p1=bluqt&p2=emhk&pct=c&pfc=a&pfb=a&pr=76532&pt=b&pd=23&pw=3&pv=17&prr=&puid1=&puid2=&puid3=xf8&puid4=zb0&puid5=&puid6=RUSSIA&puid7=&puid8=&puid9=&puid10=&puid11=&puid12=&puid13=&puid14=&puid15=NEWS&puid16=&puid17=&puid18=POLITIC&puid19=&puid20=&puid21=&puid22=ofk:fx5:zn0:ngs:1sw&puid23=&puid24=&puid25=&puid26=&puid27=&puid28=&puid29=&puid30=&puid31=&puid32=&puid33=realip:deposit:credit_users:sp_fit&puid34=&puid35=&pdw=1600&pdh=1200&dl=http%3A//lenta.ru/news/2014/04/20/zhirinovskiy/&pr1=866851 %%

===Дефолтность браузера("client_id":"brdef") !!В разработке!!
====Требования
client_id = brdef

параметры (отправляем каждые 2 часа)
df=1 — если дефолтный
nd=1 — если не дефолтный

Чтобы ничего не делать при загрузке браузера статистика отправляется минимум через минуту. То есть, если уже прошло два часа с прошлой отправки, при загрузке браузера статистика отправится не сразу при загрузке, а через минуту.

Для проверки может понадобиться ключ

ya-browser-default-statistics-sending-period-seconds=120

Переопределяет период отправки в секундах. Меньше минуты бессмысленно задавать.

BROWSER-21851


===Уведомление о протухании страницы и мгновенное обновление ("client_id":"rtb")
====Требования
Требования продакта:
Для принятия решения о реализации фичи, собираем статистику о факте перезагрузки страницы.

====Параметры и значения
Факт перезагрузки:
"f5":"1" - все остальные способы
"f5":"2" - обновление кнопкой "reload"
"f5":"3" - обновление горячими клавишами
Урл страницы, обновление которой происходит: "url":"http://url.ru"
*Если урл страницы менялся автоматически (скриптами, например), то отсылаем текущий урл.

Время с момента загрузки или прошлого обновления страницы (в минутах): "timе":"21"
*время считаем от момента последней перезагрузки совершенной любым способом.

====Задачи
Старая:
https://jira.yandex-team.ru/browse/BROWSER-20536

Новая:
https://st.yandex-team.ru/BROWSER-39303

===Защита от зловредов (экстеншны) ("client_id":"dfext")  (14.8)

====Требования

**Блокирование экстеншнов:**
* Ежедневный отчет
    * Количество блокировок (всего)
    * Количество блокировок (каждого расширения)
    * Тип блокировки (при попытке установить или блокирование уже работающего расширения, в какой момент заблокировали)

**Диалог отключения экстеншнов при проверка урла обновления:**
  * Процент аудитории, которая видит этот диалог (день).
  * Распределение частоты показа диалога на человека (день).
  * CTR кнопок "Включить", "OK"

====Параметры и значения

Блокирование экстеншна:

"params":{"blk":"ID","a_how":"aft","whn":"upd"} - факт блокировки экстеншна определенного ID после установки (aft), при проверке апдейт-урла
"params":{"blk":"ID","a_how":"aft","whn":"has"} - факт блокировки экстеншна определенного ID после установки (aft), при проверке хеширования
!!"params":{"blk":"ID","a_how":"aft","whn":"ups"} - если при попытке апдейта получаем однозначный ответ от сервера, что такого ID нет в сторе - отключаем экстеншн.
"params":{"blk":"ID","a_how":"aft","whn":"crx"} - если при апдейте получаем манифест, но не можем скачать CRX - отключаем экстеншн с возможностью включения на browser://extension!!
!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"hsm"} -  не совпадение хэша, вычисленного из поблочных хэшей ресурсов экстеншена с рут-хэшом из расширения. (фактической блокировки не происходит)!! c 15.12
!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"sim"} -  невалидная подпись рут хэшей (фактической блокировки не происходит)!! c 15.12

!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"sna"} -  Стор недоступен!!
!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"vcm"} -  verified_contens.json в _metadata не найден или невалиден!!
!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"vno"} -  невозможно обновить расширение до последнеей версии (требуется более новая версия браузера).!!
!!(зел)"params":{"blk":"ID","a_how":"aft","whn":"cff"} -  не удалось скачать crx или получить(распарсить) update-manifest!!

//**Замечание от QA:**// //случай {"blk":"ID","a_how":"aft","whn":"crx"} не проверяем в связи с трудностями моделирования ситуации.//

Диалог при проверке урла обновления:
"params":{"bldial":"1","blon":"1","blok":"1"} - показ диалога отключения экстеншнов при проверке урла обновления.
  * bldial - факт показа окна диалога
  * blon - клик на ссылку "включить"
  * blok - клик на кнопку ОК
  * bllm - кнопка Подробнее
Накапливать и отправлять в момент скрытия диалога.

!!Диалог при удалении экстеншнов при проверку хеширования: (добавлено после кодфриза 14.8, 7.08)
"params":{"blhs":"1","bhok":"1", "bhlm":"1"} - показ диалога отключения экстеншнов при проверке урла обновления.
  * blhs - факт показа окна диалога,
  * bhok - клик на кнопку ОК,
  * bhlm - кнопка Подробнее.
Накапливать и отправлять в момент скрытия диалога.!!

====Параметры и значения в 14.12
Вот этот больше НЕ актуален, статистику нужно удалить:
Диалог при удалении экстеншнов при проверку хеширования:
"params":{"blhs":"1","bhok":"1", "bhlm":"1"}

Вместо него фиксируем диалог предложения удаления экстеншнов при проверке хеширования:
"params":{"nlhs":"1","nhok":"1", "nhlm":"1", "nhld":"1"} - показ диалога удаления/переустановки экстеншнов при проверке урла обновления.
  * nlhs - факт показа окна диалога
  * nhok - клик на кнопку переустановить
  * nhlm - кнопка Подробнее
  * nhld - срабатывание кнопки удалить
Накапливать и отправлять в момент скрытия диалога.

====Диалог при попытке отключить расширения отключить другое(ие) 16.3

*  %%extatt%% - id расширения, которое пытается отключить другие (атакующий)
*  %%extvic%% - id расширения, которое пытаются отключить (жертва)
*  %%a_act%% - действие совершенное пользователем в бабле. 0 - клик по кнопке "Отменить", т.е. отмена выключения расширения-жертвы. 1 - клик по ссылке "подтвердить", т.е. выключение расширения-жертвы. 2 - клик по кнопке удалить, т.е. удаление атакующего расширения.

Пример: "params":{"extatt":"ID", "extvic":"ID",,"a_act":"0"}

====Примеры
%%{"client_id":"dfext",""params":{"blk":"ID","a_how":"ins","whn":"has"}}%%
====Таск
https://jira.yandex-team.ru/browse/BROWSER-23657

===Способы установки экстеншнов ("client_id":"dfins") (14.12)
====Требования
1. Попытки нелегальных устнановки (за день)
  * Название расширения > Способ установки
2. Легальных установки (за день)
  * Название расширения > Способ установки
3. Количестов показов диалога подтверждения (за день)
  * CTR кнопок в диалоге

====Параметры и значения
blk - ID экстеншна, который пытался поставиться указанным ниже способом
spi - способ установки экстеншна. Параметры:
  - auex - External install via autoupdate и external extensions с прописыванием урла обновления в json
  - iys - Установка из нашего министора.(Я.Стор)
  - imp - Импорт из Google Chrome
  - ost - Из интернет-магазина опера-стора
 -  cst - из хромстора
  - inli - Inline установка из хромстора
  - binl - Inline установка из бростора
  -  --inll - Inline installation на локальной машине-- вместо нее посылаем inli (https://st.yandex-team.ru/SBROWSER-1798)
  - drd - Перетаскиванием на стараницу browser://tune
  -  !!onli - Inline установка из Opera Стора!!
  -  !!bonl - Inline установка из Opera Стора со страницы browser://tune!!

Протектед преференсис, установка с использованием Group Policy - не фиксируем, потому что не можем.

Способ установки "экстернал экстеншн" и "установка с прописыванием в реестр".
Для этого способа фиксируем попытки установки (удачные и неудачные)
  - mex - экстернал экстеншнс (экстеншны, которые идут в сборке браузера)
  - rst - установка c прописыванием реестра
  - scs - успешность установки для способов rst и mex (1 - успешная установка (экстеншн включен), 0 - экстеншн выключен после установки)
"params":{"blk":"ID","spi":"mex","scs":"1"} - установка экстеншна способом экстернал, удачно.


Показ диалога подтверждения

"params":{"nlin":"1","nhrn":"1", "nhdl":"1"} - показ диалога удаления/установки экстеншнов при установке.
nlin - факт показа окна диалога
nhrn - клик на кнопку установить
nhdl - кнопка удалить

Накапливать и отправлять в момент скрытия диалога.

Показ диалога подтверждения (при установке((http://jing.yandex-team.ru/files/nix-skachko/2014-06-17_1714.png через стор)))

"params":{"swfs":"1","wsca":"1", "wscd":"1"} - показ диалога удаления/установки экстеншнов при установке.
swfs - факт показа окна диалога
wsca - клик на кнопку добавить
wscd - клик на кнопку отмена
====Примеры
"params":{"blk":"ID","spi":"mex","scs":"1"} - установка экстеншна способом экстернал, успешная
"params":{"blk":"ID","spi":"iys"} - установка экстеншна из стора
"params":{"nlin":"1","nhrn":"1", "nhdl":"1"} - показ диалога

====Таск
 https://jira.yandex-team.ru/browse/BROWSER-28000

===Защита от зловредов (URL-файлы) ("client_id":"dfext") !!В разработке!!(14.x)
====Требования
**Url-файлы:** по факту показа страницы передавать на сервер URL, по факту клика на ссылку передавать на сервер факт клика и URL. По факту отключения файлов .URL через инфобар передавать этот факт.

====Параметры и значения
URL-файлы:
"params":{"urls":"url"} - показ страницы, открытой через url-файл.
"params":{"urlo":"url"} — пользователь кликнул-таки по ссылке и открыл целевую страницу.
"params":{"urlс":"url"} - пользователь кликнул на "блокировать" в инфобаре.


===Смартбокс, саджест, богатый ответ, поисковость в Калипсо ("сlient_id":“smrtbx”)

Устарело, перехало в ##SupernovaOmnibox##

<{что было
====Требования
Хотим логгировать:
1. Событие перехода из Смартбокса
2. Событие копирования текста из Смартбокса
3. Событие редактирования Смартбокса
4. Событие показа rich result
5. + дополнительно весна 2017 года - факт клика в смартбокс, когда в нем плейсхолдер (факт явной активации пользователем смартбокса)

====Параметры

======1. **Общие параметры сессии работы со Смартбоксом**
Сессия работы со Смартбоксом - это снятие фокуса из Смартбокса любым способом.
Успешная сессия - переход по урлу/на СЕРП (клик по саджесту, по Enter etc.).
Неуспешная сессия - снятие фокуса без перехода (клик вне Смартбокса, клик в тайтл etc.) или переход не через Смартбокс (Табло, etc)
"suc_ses" отправляется в случае успешного завершения сессии работы со Смартбоксом (при этом не важно, дозагрузилась ли страница).

"suc_ses": [
  # параметры успешной сессии.
  [0] destination_url, # string - url перехода. Делать %%encode('utf8')%%
  [1] chosen_match_position, # integer - номер позиции саджеста, по которой перешли
],

Особенность реализации: если destination_url содержит имя пользователя и/или пароль, то никакая статистика не отсылается.

======2. **Копирование текста из Смартбокса**
Отдельно передается информация о копировании (ctrl+c, ctrl+X/Shift+del, ctrl+ins, "копировать"/"вырезать" в контекстном меню) в буфер из омнибокса.
Передается непосредственно в момент копирования/вырезания (нажатия хоткея, клика по пункту контекстного меню).
{
"copied" : crc32 # string - crc от скопированного текста.
}

======3. **Параметры редактирования Смартбокса и саджест**
Массив "m" отправляется при завершении сессии работы со Смартбоксом (не важно, успешной или нет), если при этом произошло событие редактирования Смартбокса (ввод/удаление хотя бы одного символа).
Исключение: если пользователь открыл новый таб, и сразу закрыл его, "m" отправляется несмотря на отсутствие редактирования. Также если на открытой вкладке кликнуть в омнибокс, убрать фокус из омнибокса (кликнуть в тело страницы).
version должен быть равен 0.

"m": [
  # общие параметры
  [0] version, # integer - версия посылки (для контроля изменений в отправляемых данных)
  [1] session_duration, # integer - продолжительность сессии работы со Смартбоксом (в миллисекундах)
  [2] time_from_last_popup_update, # integer - время между последним показом саджеста и завершением сессии работы со Смартбоксом
  [3] edits_count, # integer - количество исправлений, при этом исправлением считаем нажатие любой клавиши на клавиатуре, пока фокус в Смартбоксе
  [4] user_input, # string - текст, который отображается в омнибоксе на последнее действие редактирования. Делать %%encode('utf8')%%
  [5] suggest_type, # list - типы позиций в саджесте
  [6] was_paste, # boolean (true|false) - признак того, что пользователь что-то вставлял из буфера обмена. Также используется для пукнта контекстного меню "Вставить и найти/Вставить и перейти" (в этих случаях бывает нулевое количество матчей в саджесте)
  [7] host, # string - хост поисковости, которая была включена в начале сессии работы со Смартбоксом (дальнейшие изменения поисковости не учитываются в статистике Смартбокса)
  [8] activated, # boolean (ntba|clcka): clcka - открытие в текущем табе, ntba - открытие в новом табе
],

======4. **Богатый ответ**
Отправляется сразу по факту __окончания показа__ богатого ответа, вне зависимости от того, был ли совершен переход и как завершилась сессия работы со Смартбоксом.
Отправляем массив r со следующими параметрами:

"r":[
[0] "version", #integer - версия для совместимости (staff:baza Похоже что сейчас всегда отправляется 0)
[1] "position", #integer - номер позиции, для которой прилетел богатый ответ (отсчёт начинаем с 0)
[2] "type", #integer (0|1) где:
    0 - навигационный ответ (template_id=nav)
    1 - википедийный ответ (template_id=wiki)
[3] "thumb", #integer - (1) факт показа тумбы (если тумба не была показана, в том числе не успела отрисоваться, параметр не отправляем) - только для template_id=nav
[4] "image", #integer (0|1) где:
    0 - маленькая картинка (оба варианта маленькой картинки)
    1 - большая картинка
    Если ответ был не с типом wiki или в вики-ответе нет картинки, параметр не отправляем.
[5] "snippet", #integer - (1) факт показа сниппета (если сниппет не был показан, параметр не отправляем)
[7] "click", #integer (0|1|2|3|4|5|6) где:
    0 – клик в пустую область строки с богатым ответом
    1 – клик по картинке/тумбе (считаем как одно и то же)
    2 – клик по тайтлу
    3 – клик по URL
    4 – клик по сниппету
    5 – клик по сайтлинку (любому)
]

======5. **Тап на кнопку альтернативного поисковика**
Отправляем название ПС, по которой был совершен переход по клику на кнопку и единицу (для учета общего количества переходов сразу в дашборде).
{
"search_engine_name":1
}

{"client_id":"smrtbx","params":{"yandex.ru":1}
{"client_id":"smrtbx","params":{"google.com":1}

======6. **Факт активации смартбокса в NTP кликом** с 17.9.0
{
"ntp_smtr_click":1
}

{"client_id":"smrtbx","params":{"ntp_smrt_click":1}

====Примеры
{"params":{"m":[0,3,1,10,"da",["search-what-you-typed","history-title","search-suggest","search-suggest","search-suggest","search-suggest","search-suggest","history-title"],false,http://yandex.ua,clcka],"suc_ses":["http://yandex.ua/yandsearch?text=%D0%95%D0%A7&clid=",0]},"client_id":"smrtbx"}

{"params":{"r":[0,1,null,0,1,3,4,],"client_id":"smrtbx"}

{"client_id":"smrtbx","params":{"ru.wikipedia.org":1}}

====Статистика попапа "Окно заблокировано"
<["client_id": "popup"]>
Имеет 2 параметра:
* blocked: url_страницы_где_заблокирован_попап (по факту блокировки)
* unblocked: url_страницы_где_разблокирован_попап ( по факту разблокировки)


Примеры:
 {"client_id": "popup","params": {"blocked": "http://popuptest.com/popuptest5.html"}}
Задача https://st.yandex-team.ru/BROWSER-67758
}>

===Поисковость в Калипсо ("сlient_id":“srchnss”) !!В разработке 17.6.0!!
Реализовываем в Калипсо статистику поисковости из классического интерфейса.

====Требования
Везде фиксировать домен поисковой системы.
Способ, которым пользователь вошел в режим поисковости:
•	Пользователь поискал на морде поисковой системы и попал на SERP (по referer)
•	Пользователь вставил в адресную строку ссылку на SERP и перешел по ссылке (или перешел по ссылке из другой программы, или ввел урл вручную)
•	Пользователь ввел домен и нажал TAB
•	Пользователь ввел ключевое слово и нажал TAB или Пробел
•	Повторное использование режима поисковости

Пользователь вышел из режима поисковости и каким способом:
•	Пользователь нажал на крестик очистки поля ввода в Смартбоксе (независимо от наличия в нем текста). Фиксировать домен поисковой системы (images.yandex.ru, google.com.ua и т.д.)
•	Пользователь очистил адресную строку и нажал Backspace
•	Пользователь установил курсор после плашки поисковости и нажал Backspace
•	Выход из режима поисковости по вставке из буфера обмена урла с поисковостью (с дальнейшим входом в новый режим поисковости)
•       Выход из режима Поисковости по Show URL
•	По закрытию таба статистику отправлять не нужно

Тап на релоад в шапке – повторный вход в поисковость.

====Параметры
Имя список параметров - actions:

"sfmp" - Поиск с МОРДЫ
"sbpl" - Пользователь вставил в адресную строку ссылку на SERP и перешел по ссылке (или перешел по ссылке из другой программы, или ввел урл вручную)
"sbn" - Пользователь ввел домен и нажал TAB
"sbk" - Пользователь ввел ключевое слово и нажал TAB или Пробел
"sst" - Повторное использование режима поисковости
"hbcb" - Пользователь нажал на крестик очистки поля ввода в Смартбоксе (независимо от наличия в нем текста). Фиксировать домен поисковой системы (images.yandex.ru, google.com.ua и т.д.)
"hbb" - Пользователь очистил адресную строку и нажал Backspace
“hbd” - Пользователь установил курсор после плашки поисковости и нажал Backspace
"hbp" - Выход из режима поисковости по вставке из буфера обмена урла с поисковостью (с дальнейшим входом в новый режим поисковости)
"shrl" - Выход из режима Поисковости по Show URL (htk|kmn) - хоткей или контекстное меню
"hbtc" - По закрытию таба статистику отправлять не нужно

====Примеры
{"client_id":"srchnss","params":{"actions":[{"sbpl":"yandex.ru"},{"hbcb":"video.yandex.ru"}]}}
Примечание: Статистика отправляется с ближайшим навигейтом и только после получения законченной цепочки действий, например: "зашли в режим поисковости с морды, поискали что-то и вышли из поисковости по крестику очистки поля ввода"



===Кнопка перехода в Opera Store ("client_id":"opst") Q2
====Требования
Хотим считать переходы по кнопке

====Параметры
"params":{"clo":"1"}

====Таск
https://jira.yandex-team.ru/browse/BROWSER-23676



===Проверка изменений pak-файлов ("client_id":"pak") !!В разработке!!
==== Требования
После проверки хэша в случае, если он не совпадает с ожидаемым значением, мы репортим имя предположительно изменённого файла и полученный хэш от него.
====Параметры
"params":{"filename":"4234234abcd"}
вместо filename — имя файла
вместо 4234234abcd — хэш

Если изменённых файлов несколько — отправляем их все в статистику один за другим, по одной паре за раз в приведённом выше формате.
====Таск
BROWSER-20841


===Логирование контекстных меню ("client_id":"cntxmn")
====Требования
Необходимо логировать вызов каждого контекстного меню в браузере, а также выбор их пунктов.
====Параметры
При выбора пункта меню отправляем "params":{"a_%menu_id%":"%item_id%"}
Если меню было вызвано, но никакой из его пунктов не был выбран, пишем "params":{"%menu_name%":0}.
вместо %menu_id% — id вызванного меню
вместо %item_id% — id кликнутого пункта меню
Для всех id нужен словарь для автоматического составления отчётов. «a_» в названии параметра — для того, чтобы отчёт автоматически просчитывал все значения параметра.

Для контекстного меню страницы используется параметр "a_RenderView"
**!!Для пункта «Службы» на OS X используется отдельный параметр "a_RenderViewSer" — ещё не реализовано!!**

Примечания:
Закрытие контекстного меню без выбора пункта в нём пока не логируется.
Команды контекстного меню RenderView не разделяются по объектам (картинка, ссылка, текст и т.д).
Событие TogglePinned отправляется как по факту пина таба, так и при распинивании
Пункты меню закладок, которые появились в Кусто, не логируются.
Контекстное меню панели закладок в Кусто не логируется.
====Таск
SBROWSER-1783
BROWSER-34864
BROWSER-33877

===Логирование Инстасерпа("client_id":"instaserp2")

**>**  **%%a_block_actions%%**
    * %%block_shown%% - факт показа быстрого ответа, не включая перевод (сумма a_block_types_shown + перевод)
    * %%block_clicked%% - факт клика в быстрый ответ, не включая перевод (сумма a_block_types_clicked + перевод)
    * %%translator_shown%%  - если показали переводчик
    * %%translator_clicked%%  - если кликнули в переводчик
    * %%show_all_pressed%% - если %%show all%%  нажали на карточке
    * %%menu_pressed%% - Посылается, если нажали в обычный пункт КМ
    * %%miss_clicked%% - если пользователь кликнул за пределы КМ
    * %%escape_pressed%% - если пользователь жмякнул ESC

**>** **%%a_block_types_shown%%** - факт показа различных ответов, принимает значения:
    * %%wiki%% - ответ вики
    * %%navigation%% - навигационный ответ
    * %%imgages%% - ответ картинок
    * %%video%% - ответ видео
    * %%map%% - ответ карт
    * %%object%% - объектный ответ
    * %%money%% - валютный ответ
    * %%translator%% - переводчик
**>** **%%a_block_types_clicked%%** : имя блока богатого ответа, в который кликнули
    * %%wiki%% - ответ вики
    * %%navigation%% - навигационный ответ
    * %%imges%% - ответ картинок
    * %%video%% - ответ видео
    * %%map%% - ответ карт
    * %%object%% - объектный ответ
    * %%money%% - валютный ответ
    * %%translator%% - переводчик
**>** **%%a_blocks_count_shown%%**
    * %%0%% - посылается, если не было показано быстрого ответа(не касается переводчика)
    * %%1%% - посылается, если был показан 1 быстрый ответ
    * %%2%% - посылается, если было показан 2 быстрых ответа
    * %%3%% - посылается, если был показан 1 быстрый ответ и переводчик

%%source_url%% : URL с которого произошёл переход при клике в быстрый ответ
%%request_text%% : текст, на который производится запрос в облако

%%a_content_type%% принимает значения %%page%%, %%text%%, %%link%%, %%image%%, %%image-link%%
%%a_menu_type%% принимает значения %%full%%, %%short%%
%%a_creation_type%% принимает значения %%mark%% (КМ с пипкой), %%shift%% (КМ по шифту), %%rmb-selection%% (КМ по ПКМ + выделение), %%rmb-word%% (КМ по ПКМ, на слово без выделения)
%%a_quick_answer_position%% принимает значения %%bottom%% и %%top%% - ответ отрисовался вверх или вниз

%%"client_id":"cntxmn","params":{"a_%menu_id%":"%item_id%"} %%
%%menu_id%% — id вызванного меню
%%item_id%% — id кликнутого пункта меню
Если меню было вызвано, но никакой из его пунктов не был выбран, пишем %%"params":{"%menu_name%":0}%%

<{До 16.11.1
* %%a_creation-type%% принимает значения %%mark%% (КМ с пипкой), %%shift%% (КМ по шифту), %%rmb-selection%% (КМ по ПКМ + выделение), %%rmb-word%% (КМ по ПКМ, на слово без выделения)
* %%a_menu-type%% принимает значения %%full%%, %%short%%
* %%a_content-type%% принимает значения %%page%%, %%text%%, %%link%%, %%image%%, %%image-link%%
* %%item-pressed%% : %%1%% Посылается, если нажали в обычный пункт КМ
* %%a_instaserp%%:%%0%% - посылается, если не было показано быстрого ответа(не касается переводчика)
* %%a_instaserp%%:%%1%% - посылается, если был показан 1 быстрый ответ
* %%a_instaserp%%:%%2%% - посылается, если было показан 2 быстрых ответа
* * %%a_instaserp%%:%%3%% - посылается, если был показан 1 быстрый ответ и переводчик
* Показанные блоки отправляем следующим образом:
  %%instaserp-wiki%%:%%1%% - 1 был показан ответ вики, 0 не был
  %%instaserp-nav%%:%%0%% - 1 был показан ответ навигационный, 0 не был
  %%instaserp-img%%:%%1%% - 1 был показан ответ картинок, 0 не был
  %%instaserp-video%%:%%0%% - 1 был показан ответ видео, 0 не был
  %%instaserp-map%%:%%0%% - 1 был показан ответ карт, 0 не был
  %%instaserp-obj%%:%%0%% - 1 был показан ответ объектный, 0 не был
* %%translator%% - факт показа блока перевода
* %%source-url%% : URL с которого произошёл переход при клике в богатый ответ
* %%a_block-type%% : имя блока богатого ответа, в который кликнули
* %%block-pressed%% : %%1%%, если кликнули в богатый ответ
* %%miss-clicked%% : %%1%%, если пользователь кликнул за пределы КМ
* %%escape-pressed%% : %%1%%, если пользователь жмякнул ESC
* %%request-text%% : текст, на который производится запрос в облако
* Нажатие пунктов КМ должно отправляться также как и в классическом км и в тоже место.
%%"client_id":"cntxmn","params":{"a_%menu_id%":"%item_id%"} %%
%%menu_id%% — id вызванного меню
%%item_id%% — id кликнутого пункта меню
Если меню было вызвано, но никакой из его пунктов не был выбран, пишем %%"params":{"%menu_name%":0}%%}>

<{С версии 16.11.1 !!
**%%a_show%%** - факт показа различных ответов инстасерпа, принимает значения:
%%instaserp-wiki%% - ответ вики
%%instaserp-nav%% - навигационный ответ
%%instaserp-img%% - ответ картинок
%%instaserp-video%% - ответ видео
%%instaserp-map%% - ответ карт
%%instaserp-obj%% - объектный ответ
%%instaserp-money%% - валютный ответ
%%translator%% - переводчик
**%%a_click%%** - факт клика в различные ответы инстасерпа, принимает значения:
%%instaserp-wiki%% - ответ вики
%%instaserp-nav%% - навигационный ответ
%%instaserp-img%% - ответ картинок
%%instaserp-video%% - ответ видео
%%instaserp-map%% - ответ карт
%%instaserp-obj%% - объектный ответ
%%instaserp-money%% - валютный ответ
%%translator%% - переводчик
%%show_all%% - show all}>

===Отключение расширений с помощью blacklisting (""client_id":"blcklst") с [15.4]

blkinst - id расширения заблокированного при инсталле
blkupd - id расширения заблокированного после апдейта базы сф (расширение уже стоит у пользователя)
blkimp - id расширения прилетевшего в silent режиме (например импорт), поставленного  и выключенного без диалога

====Примеры
%%{"client_id":"blcklst",""params":{"blkinst":"ID }}%%
%%{"client_id":"blcklst",""params":{"blkupd":"ID }}%%
%%{"client_id":"blcklst",""params":{"blkimp":"ID }}%%
====Таск
SBROWSER-1841


===Режим восстановления ("client_id":"recoverymode") !!В разработке!! [15.7]
====Режим восстановления
"recmodecreate":"1" — факт создания нового профиля «Режима восстановления»
"recmodeopen":"1" — факт открытия браузера в профиле «Режима восстановления»
(при первом запуске в данном профиле отправляются оба параметра, для каждого последующего открытия в этом профиле до его перезатирания — только факт открытия)
====Автоматическое восстановление вкладок при единичном крэше
"reshow":"1" - показ инфобара «Восстановить вкладки»
"react":"1" - факт восстановления вкладок с помощью инфобара
"autor":"1" - факт восстановления вкладок автоматически, без показа инфобара. Исключает посылку параметров reshow и react
====Примеры
{"client_id":"recoverymode","params":{"recmodecreate":"1"}}
====Таск
BROWSER-34255
BROWSER-50203






===Статистика защиты паролей от фишинга ("client_id":"secupass")

match (url -урл сайта , imp_url урл важного сайта, с которым совпало, decis - решение пользователя [1 - доверяет сайту,--2 - отменил вход-- !!не используется с 17.7.1!!, 3 — вход произошёл, после чего вкладка закрыта из-за недоверия !!с 17.7.1!!], 4 - закрыл балун по кретику, 5 - нажал мимо балона, балон закрылся/ закрыл вкладку, балон закрылся / перешёл на другую вкладку, балон закрылся, 6 - нажал на "?", открылся Help)
opt_in инфобара и настроек (1-да, 2-нет, 0-крестик, 3-вкл из настроек)
opt_out из диалога и настроек (--1-из диалога-- !!не используется с 17.7.1!!, 2-из настроек)
--При нажатии на кнопку отключить защиту в диалоге отправляем только то, что она отключена. Факт захода на сайт отправлять не нужно, так как фича теперь отключена.--  !!Неактуально с 17.7.1!!
showib показ инфобара пользователю с предложением включить фичу.

====Примеры
%%{"client_id":"secupass","params":{"match": {"url" : "http://malwareportal.io/authorize", "imp_url" : "*.yandex.ru", "decis" : "1" } }}%%
%%{"client_id":"secupass","params":{"opt_in":"1"}}%%
%%{"client_id":"secupass","params":{"opt_out":"1"}}%%
====Таск
https://st.yandex-team.ru/BROWSER-34653


===Статистика безопасного WiFi ("client_id":"secwifi")  [15.9]
https://st.yandex-team.ru/BROWSER-36357

При включении/выключении проксирования через иконку меню и вкл/выкл фичи в настройках необходимо посылать 2 параметра

"swf_prev": - значение параметра secure_wifi.state в преференсес до изменения
"swf_curr": - значение параметра secure_wifi.state в преференсес  после изменения

Параметр secure_wifi.state может иметь 3 значения - 0 / 1 / 2

====Примеры
%%{"client_id":"secwifi","params":{"swf_prev":"2", "swf_curr":"1" }}%% - фича из включенной переведена в режим мониторинга через меню
%%{"client_id":"secwifi","params":{"swf_prev":"2", "swf_curr":"0" }}%% - фича  выключена через настройки
%%{"client_id":"secwifi","params":{"swf_prev":"1", "swf_curr":"2" }}%% - фича из режима мониторинга переведена в активный режим.


====15.12
BROWSER-40011

Необходимо слать следующую статистику (с тем же client_id):

1. Раз в сутки любой активный клиент должен слать параметр %%a_swd: 1%%, если Secure WiFi выключен в настройках ( securewifi.state == 0 в Permanent States)


2. При первом http навигейте И при опасном подлкючении (open WiFi, wep WiFi):
 - слать параметр %%a_swa: 1%%, если Secure WiFi включен в активном режиме  ( securewifi.state == 2 в Permanent States)
 - слать параметр %%a_swm: 1%%, если Secure WiFi включен в режиме мониторинга без проксирования  ( securewifi.state == 1 в Permanent States)

 a_swa и a_swm шлем 1 раз в рамках одной сессии, следующий раз шлем либо при следующей сессии, либо при смене сети с одной опасной на другую, либо на следующие сутки, даже если сеть и сессия остались прежними.


===Статистика featured store ("client_id": "fts") [15.12.1]  Q2

Хочется иметь отчет по дням с числом показов объявлений, числом кликов на кнопки в объявлениях и числом закрытий объявлений. В сумме по всем пользователям за сутки.



====Параметры
ad - id объявления
ctb - "-1", если был клик на крестик (закрытие действием пользователя), "-2", если объявление было показано (шлется на каждый показ, если было какое-то действие с объявлением - шлем дополнительно -1, 0, 1, 2 и т.д.) . "0", "1", "2", "3" и т.д. - клик по целевой кнопке в объявлении. Значение 0, 1, 2 и т.д. соот-т порядковому номеру кнопки в описании объявления. Накопительная



====Примеры
%%{"client_id":"fts","params":{"ad":"ad777", "ctb":"1"}}%% - пользователь кликнул по второй кнопке объявления ad777
%%{"client_id":"fts","params":{"ad":"ad777", "ctb":"-2"}}%% - объявление ad777 было показано
%%{"client_id":"fts","params":{"ad":"ad777", "ctb":"0"}}%% - пользователь кликнул по первой кнопке объявления ad777
%%{"client_id":"fts","params":{"ad":"ad777", "ctb":"-1"}}%% - пользователь закрыл объявление крестиком  объявление ad777


===Советник ("client_id":"sovetnik") Q2
Отправляемая статистика:
* Факт инжекта Советника в страницу ("inurl":"1")
* Аудитория Советника. Т.е. положение настройки в режиме "Вкл" ("svon":"1")

Примеры посылок в бандле
"client_id":"sovetnik","params":{"inurl":"1"}
"client_id":"sovetnik","params":{"svon":"1"}

===HIPS ("client_id": "hips") Q2

**Статусная статистика**
- %%status%%: значение %%on|off%% - соответственно пользовательской настройке в интерфейсе браузера
- %%av%%: список пар вида %%"av_name": "av_version"%%, где %%av_name%% - название антивирусного ПО, а %%av_version%% - номер версии (целиком)
- %%fw%%: список пар вида %%"fw_name": "fw_version"%%, где %%fw_name%% - название ПО, работающего фаерволлом, а %%fw_version%% - номер версии (целиком)
- %%asp%%: список пар вида %%"asp_name": "asp_version"%%, где %%asp_name%% - название антишпионского ПО, а %%asp_version%% - номер версии (целиком)
- %%services%%: список строк вида %%"service_name"%%, где %%service_name%% - название службы. Здесь должны учитываться все активные системные службы, кроме стандартных служб ОС
- %%os%%: список пар вида %%"os_name": "os_version", "x64": true|false, "is_admin": true|false, "uac": "on|off|none", "uptime": "101010101"%%, где %%os_name%% - название ОС (Windows), %%os_version%% - номер или название версии ОС (например, "8.1"), %%is_admin%% означает, входит ли пользователь в группу администраторов ОС, %%uac%% - включён ли UAC (%%none%% для систем, в которых UAC нет), %%uptime%% - длительность текущего сеанса беспрерывной работы системы

С версии 16.9 добавлены BROWSER-50238
- %%c_setopened%% количество открытий страницы browser://protect
- %%c_jopened%% количество открытий попапа с журналом событий
- %%c_exopened%% количество открытий попапа со списком исключений
- %%c_exadded%% количество событий добавления программы в исключения через настройки

===Защита от фишинга карт "client_id: cardsec" Q2
((https://wiki.yandex-team.ru/browser/custo/tz/cardphishing/ ТЗ))
%%client_id: cardsec%%
Параметры:
%%url%% - текстовое значение, полный урл страницы
%%type%% - текстовое значение, тип карты
%%https%% - числовое значение: **1**, если страница https и сертификат имеет признак EV; **0**, если страница https и сертификат не имеет признак EV; **не отправлять**, если страница не https
%%singinput%% - числовое значение **1**, если поле ввода одно
%%multinput%% - числовое значение **1**, если поле ввода разбито на части

Пример
%%{"client_id":"cardsec","params":{"url":"https://wiki.yandex-team.ru/browser/custo/tz/cardphishing/.edit?add=1&title=cardphishing", "type": "visa", "https": 1, "singinput": 1}}%%

====C версии 16.4
Параметр %%url%% переименован в %%top_url%%, добавлен %%form_url%% - URL, с которого была загружена форма с полем для карточки (будет отличаться от %%top_url%%, если форма в iframe)
%%action_url%% - URL, в который форма отправляет данные

====C версии 16.9
Новые параметры:
- **act**. Описание сценария, на который отреагировал интерфейс и взаимодействие пользователя с ним. Список: %%scen%% (значения: %%http_dialog%% для случая показа диалога на http форму, %%cert_err%% для случая показа диалога на невалидный/устаревший https-сертификат, %%url_dialog%% для случая показа диалога по диагнозу ручки, %%local_CA%% для случая показа красной иконки на локально выданный сертификат, %%icon%% для случая показа иконки), %%decision%% (значения: %%stop%% для кнопки Уйти на диалоге, %%cont%% для кнопки Продолжить на диалоге, не отправляется для %%scen: icon|local_CA%%), %%time%% (значение: время от момента показа диалога до момента клика по любой кнопке в секундах, не отправляется для %%scen: icon|local_CA%%)
- **iconclicks**. Количество кликов по иконке с момента последней отправки бандла, число

Отправка бандла, как и раньше, раз в сутки. Если за сутки произошло несколько срабатываний, в бандле будет несколько %%act%%.
Детали:
- после ухода с диалога на хелп, при возврате на таб с диалогом не должно быть повторного act, мы всё ещё ждём решения для первого act и отправляем decision для него
- если интерфейсная реакция фичи выключена настройкой (но включена отправка данных в статистику), то бандл cardsec продолжает отправляться с теми данными, которые можно собирать без действий пользователя (состояние Этап 1)

====C версии 17.1.0
Новые параметры:
- **referer** - реферер из заголовка header, обрезанный до протокола и хоста

====С версии 17.6.1
Новые параметры:
- %%bin%%, первые 6 цифр номера карты - BIN-код банка-эмитента

====С версии 18.7
Статистика не разворачивается во вложенные объекты, отправляясь в виде %%"act.time": "...", "act.*": ...%%
//Подробности ((https://st.yandex-team.ru/BROWSER-88191#1535962631000 тут)).//






===Статистика переключений интерфейса браузера с кнопки в настройках ("client_id":"calypsooldusers")
Отправляемая статистика:
Окно переключения с Классики в Калипсо, вызванное из серверной страницы ("a_stclp":[n])
* где n=0 - показали окно
* где n=1 - нажата кнопка "Включить"
* где n=2 - нажата кнопка "Отменить", закрыто окно крестиком, закрыто окно без нажатия кнопок (игнор, закрыт браузер и т.д.)

Окно переключения с Калипсо в Классику, вызванное из серверной страницы ("a_stclsc":[n])
* где n=0 - показали окно
* где n=1 - нажата кнопка "Включить"
* где n=2 - нажата кнопка "Отменить", закрыто окно крестиком, закрыто окно без нажатия кнопок (игнор, закрыт браузер и т.д.)

Окно переключения с Классики в Калипсо, вызванное из страницы настроек браузера ("a_btclp":[n])
* где n=0 - показали окно
* где n=1 - нажата кнопка "Включить"
* где n=2 - нажата кнопка "Отменить", закрыто окно крестиком, закрыто окно без нажатия кнопок (игнор, закрыт браузер и т.д.)

Окно переключения с Калипсо в Классику, вызванное из страницы настроек браузера ("a_btclsc:[n])
* где n=0 - показали окно
* где n=1 - нажата кнопка "Включить"
* где n=2 - нажата кнопка "Отменить", закрыто окно крестиком, закрыто окно без нажатия кнопок (игнор, закрыт браузер и т.д.)


====Примеры
"client_id":"calypsooldusers","params":{"a_btclsc":"2"}

====Таск
https://st.yandex-team.ru/BROWSER-42244


===Статистика режима Безопасный банкинг ("client_id":"banking")
Отправляемая статистика:
Переключили режим на странице настроек ("a_setsw":[n])
* где n=1 - поставлена галочка "Открывать страницы онлайн-банков и платёжные системы в режиме Protect"
* где n=2 - снята галочка "Открывать страницы онлайн-банков и платёжные системы в режиме Protect"

Переключили режим на баллуне Сведения о странице (клик на замочек https) ("a_sbln":[n])
* где n=1 - в пункте "Открывать в режиме Protect " выбрано "Включено"
* где n=2 - в пункте "Открывать в режиме Protect " выбрано "Выключено"

Диалог первого включения и диалог "Режим Protect" (клик на кнопку "Режим Protect" в омнибоксе) ("a_pdlg":[n])
* где n=1 - показали диалог "Режим Protect"
* где n=2 - в диалоге нажали "Отключить"
* где n=3 - показали диалог первого включения

Включение режима "Безопасной вкладки" («a_bkon»:"1")
Срабатывает один раз для вкладки, на которой были выполнены условия включения режима.
Погрешности:
* Один и тот же банк в разных вкладках будет считаться за два включения
* Вкладки, удовлетворяющие условиям, но так и не получившие фокуса будут считаться в статистике как включение режима

Страницы, где включен режим "Безопасной вкладки"
Урл страницы, на которой включили режим ("mainurl": )
Урл страницы, с которой перешли на страницу безопасного режима  ("refurl": )

====Примеры
"client_id":"banking","params":{"a_setsw":"2"}
"client_id":"banking","params":{"a_sbln":"1"}
"client_id":"banking","params":{"a_bkon":"1"}
"client_id":"banking","params":{"mainurl":"https://connect.raiffeisen.ru/rba/Login.do","refurl":"http://www.rbc.ru"}

====Таски
https://st.yandex-team.ru/BROWSER-43012
https://st.yandex-team.ru/BROWSER-43115
BROWSER-43216
BROWSER-43214
===Новая активация с Алисой
<{===Статистика
{{grid page="/browser/custo/TZ/1stimpression/activation/NewActivationStat/" width="100%"}}
}>
===Статистика мастера активации ("client_id":"actwizard")
<{**Старая**
- на каком шаге пользователь отвалился: "activation.welcome","activation.import.select","activation.import.complete","activation.background.select",
"activation.sync.auth", "activation.sync.settings", "activation.zen.preonboard", "activation.zen.onboard", "activation.complete","activation.new.tab"
   (шаги мастера синхронизации равны шагу "activation.sync.auth" мастера активации. "activation.complete" - дошел до последней страницы, "activation.new.tab" - нажал на кнопку начать пользоваться): "a_last_step" : "activation.zen.onboard"
 - отменял ли автоимпорт: autimp_cancel 1 - да, 2 - нет
 - нажал пропустить на странице ручного импорта autimp_cancel: 3
 - выполнял ли ручной  импорт: manimp_perf 1 - да, 2 - нет
 - менял ли фон: bg_ch 1 - да, 2 - нет
 - вариант тайтла кнопки (1 или 2) на Шаге 1: step1_btn: 1 - Настроить, 2 - Продолжить
 - факт перехода к онбордингу логируем отдельно: onboard: 1
 - ответы ручки Дзена о наличии Дзена: zen_info_yes: 1 - Ручка ответила, что Дзен есть (получили урл дзена), zen_info_no: 1 - ручка ответила, что Дзена нет и требуется онбординг (получили урл онбординга), zen_info: 1 - ручка ответила, Дзен недоступен.

====Примеры
{"client_id":"actwizard","params":{"a_last_step":"activation.complete.select", "autimp_cancel":"2", "step1_btn":"1", "zen_info_yes":"1", "preon_btn":"1", "onboard":"1"}}

====Таск
https://st.yandex-team.ru/BROWSER-44771
}>
**Новая:**
"client_id":"actwizard"

1. "a_last_step" Последний шаг - на каком шаге пользователь отвалился: "activation.welcome","activation.import.select","activation.import.complete","activation.background.select", "activation.sync.auth", "activation.sync.settings", "activation.zen.preonboard", "activation.zen.onboard", "activation.disk.proposal", "activation.disk.install", "activation.disk.enabled", "activation.disk.error", "activation.complete","activation.new.tab" (шаги мастера синхронизации равны шагу "activation.sync.auth" мастера активации. "activation.complete" - дошел до последней страницы, "activation.new.tab" - нажал на кнопку начать пользоваться)
2. a_act_wlcm - первый шаг
 - "a_setup": "1" событие нажатие на кнопку "настроить браузер"
3. "a_autimp" - шаг импорта:
    - "skip":"1" - отменил автоимпорт
    - "manual":"1" - выполнил ручной импорт из другого браузера
4. "a_bg_ch" - изменение фона
    - "yes":"1" - факт изменения фона
    - "yes":"0" - нажатие сохранить при выбранном дефолтном фоне
5. "a_sync" - страница входа в синхронизацию
    - "sync":"1" - факт входа в синхронизацию на этой странице
    - "sync":"0" - пропуск шага синхронизации
    - "skip": "1" - явное нажатие на пропустить
6. "a_onboard" - преонбординг и онбординг Дзена:
    - "try":"1" - согласие пройти онбординг Дзена
    - "try":"0" - пропуск онбординга Дзена
    - "complete":"1" - прохождение онбординга (выбор требуемого количесвта источников и нажатие кнопки далее)
7. "a_zen_info" - ответы ручки Дзена о наличии Дзена
    - "zen_yes":"1" - Ручка ответила, что Дзен есть (получили урл дзена)
    - "zen_onboard":"1" - ручка ответила, что Дзена нет и требуется онбординг (получили урл онбординга)
    - "zen_unknown":"1" - ручка ответила, что Дзен недоступен
8. "a_disk" - Диск в активации
    - "skip":"1" - нажатие на "Пропустить"
    - "install":"1" - нажатие на "Установить"
    - "start":"1" - нажатие на "Включить"
9. a_new_tab": - на последнем шаге активации
     -"start":"1"- при нажатии на "Начать пользоваться"

====Таск
https://st.yandex-team.ru/BROWSER-62737

===Статистика показа шагов Активации ("client_id":"actstep")
"a_show" - факт показа:
Отправляем следующие шаги, соответствующие текущим из бандла actwizard:  "activation.welcome", "activation.import.select", "activation.import.complete", "activation.background.select", "activation.sync.auth", "activation.sync.settings", "activation.zen.preonboard", "activation.zen.onboard", "activation.disk.proposal", "activation.disk.install", "activation.disk.enabled", "activation.disk.error", "activation.complete", "activation.new.tab"

====Примеры
{"client_id" : "actstep", "params" : {"a_show" : "activation.complete.select"}}

===Cтатистика мастера активации: закрытие браузера во время активации ("client_id": "actclosebro")
Эта статистика отправляется сразу же - без ожидания накопления бандла.

Появляется в 18.10.0
Задача https://st.yandex-team.ru/BROWSER-92536
Последний шаг - на каком шаге пользователь был в активации при закрытии браузера:
%%"activation.welcome" - стартовый
"activation.import.select" - выбор браузеров для импорта
"activation.import.complete" - выбор завершен
"activation.background.select" - выбор фона
"activation.sync.auth" - паспортный домик + реклама синхры
"activation.sync.settings" - настройки синхры
"activation.zen.preonboard - резерв на шаги дзена
"activation.zen.onboard"  - резерв на шаги дзена
"activation.disk.proposal" - предложение диска
"activation.disk.install"  - установка диска
"activation.disk.enabled"- диск установлен
"activation.disk.error" - ошибка при инсталляции диска
"activation.complete" - пользователь дошел до финального шага активации и закрыл страницу активации
"activation.new_tab" - пользователь дошел до финального шага активации и нажал "На стартовую"
%%

Примечание. При импорте с другого браузера мы предлагаем перезапуск браузера для завершения переноса данных. Это ожидаемое поведение.
В этом случае будет отправлена статистика:
%%{"client_id":"actclosebro","params":{"a_last_step":"activation.import.select"}%%
Точно такая же статистика отправится при ручном закрытии браузера с вкладкой активации с показанной страницей переноса данных.


===Статистика crp ("client_id": "crp") [16.6] Q2

Логируем показ страницы с предупреждением с указанием типа сертификата: антивирус/приложение/остальное
Логируем добавление исключения с указанием типа сертификата: антивирус/приложение/остальное
Логируем нажатие кнопки "Вернуться" с указанием типа сертификата: антивирус/приложение/остальное.
Логируем нажатие на ссылку с инструкцией по отключению.
Логируем "сколько времени пользователь пялился на эту страницу, прежде чем что-то сделал". Что-то сделал - это: нажал одну из кнопок или ссылку на хелп или закрыл таб


Параметры:
- %%shw%% (показ страницы), значение - 1. Если показа не было, не шлем.
- %%tCA%% (тип СА сертификата), значения - 1 антивирус/приложение, 0 - другое.
- %%a_add%% (клик в кнопку добавить СА в исключения), 1 - была нажата, если не была нажата - не шлем
- %%a_bck%% (клик в кнопку вернуться), 1 - была нажата, если не была нажата - не шлем
- %%a_hlp%% (клик по ссылке с инструкцией), 1 - была нажата, если не была нажата - не шлем
- %%a_cls%% (закрыли вкладку со страницей), 1 - была закрыта вкладка, миначе - не шлем
- %%reac%% (время в секундах от момента открытия страницы до любого действия), значения цифровые от 0 до бесконечности


Примеры
 {"client_id":"crp","params":{"shw":"1", "tCA":"0", "a_hlp":"1", %%a_cls%% , "reac":"27"}} - пользователю  показалась interstistial для этого СА, он открыл страницу хелпа в ньютабе, спустя 27 секунд он закрыл вкладку с interstitial страницей.
 {"client_id":"crp","params":{"shw":"1", "tCA":"0", "a_add":"1", "reac":"34"}} - пользователю  показалась interstistial для этого СА, спустя 34 секунды он добавил сертификат в доверенные.
 {"client_id":"crp","params":{"shw":"1", "tCA":"1", "a_bck":"1", "reac":"2"}} - пользователю  показалась interstistial для этого СА, спустя 2 секунды он ушел со странице по кнопке вернуться.

**!!Важно!!** a_hlp  отсылается только после того, как пользователь вернулся на interstitial страницу и провзаимодействовал с ней.



===Статистика использования и показа баблов !!согласуется!!
Статистика должна отображать, какие баблы демонстрируются чаще остальных, и каким образом пользователь
взаимодействует с ними.
client_id = bubbles (bubble уже есть для баллуна смены поиска по умолчанию)
Действия для баблов(баллунов) являются a_ параметрами.
**Действия для бабла:**
* a_show - показ бабла
* a_approve - нажатие на кнопку, принимающую действие, предложенное баблом
* a_block - нажатие на кнопку, запрещающую действие, предложенное баблом
* a_close - нажатие на крестик закрытия
* a_hide - скрылся не в результате взаимодействия с пользователем

**Примеры**
{"client_id":"bubbles", "params":{ "a_block" : "Geolocation"}}

===Статистика баблов запроса прав bubblerights ("client_id":"bubblerights")
В случае показа геопопапа отправляем статистику геопопапа и статистику нового бабла одновременно.
Бандл bubblerights:
1) a_type:
* Сохранение файлов - save_files
* Загрузка нескольких файлов - download_files
* Доступ к камере и микрофону -  mic_camera
* Доступ к камере - video
* Доступ к микрофону - audio
* Переход по ссылкам разрешение - protocol
* Переход по ссылкам смена сервиса - protocol_replacement
* Доступ к данным о местоположении - geolocation
* Показывать оповещения - notification
* Доступ к MIDI-устройствам - midi
* Получать пуш-уведомления - push
* Доступ к уникальному идентификатору устройства - protected
* Агрегированный бабл - multi- имеет только действия a_close (взаимодействие) или a_hide (другие случаи)
* Бабл с кривым ресурсами (пропустили при мердже) - unknown (не имеет действий)

2) Действия для бабла
* a_show показ 1/0
При показе так же отправляем параметр url (url таба, на котором показывается запрос)
//Пример//
{"client_id":"bubblerights","params":{"a_show":"notification","url":"https://ria.ru/world/20180223/1515194091.html"}}

* a_block нажатие на кнопку "блокировать" 1/0
* a_close нажатие на крестик 1/0
* a_approve нажатие на кнопку "разрешить" 1/0
* a_hide скрылся не в результате взаимодействия с пользователем 1/0
* a_failed_show технически не смогли показать бабл (по разным причинам)

====Примеры
{"client_id":"bubblerights", "params":{ "a_type" : "geolocation", "a_show": "1"}}
{"client_id":"bubblerights", "params":{ "a_type" : "multi", "a_close": "1"}}
{"client_id":"bubblerights", "params":{ "a_type" : "unknown"}}
{"client_id":"bubblerights", "params":{ "a_type" : "push", "a_failed_show": "1"}}

====Таск
https://st.yandex-team.ru/BROWSER-45536

===Статистика пуш уведомлений client_id : notification
1. **Используем имеющиеся данные балуна запроса разрешений:**

a_block:"<type>"
a_close:"<type>"
a_approve:"<type>" нажатие на кнопку "разрешить"
a_hide:"<type>"  скрылся не в результате взаимодействия с пользователем
a_failed_show:"<type>" технически не смогли показать бабл (по разным причинам)

При этом, передаем url вместе с каждым действием пользователя, а не только при показе балуна.


{"client_id":"bubblerights","params":{"a_show":"notification","url":"https://ria.ru/world/20180223/1515194091.html", "a_close":"notification"}}
или
{"client_id":"bubblerights","params":{"a_show":"notification","url":"https://ria.ru/world/20180223/1515194091.html", "a_approve":"notification"}}

2. **Делаем отдельный пакет для показанной нотификации вида:**

{"client_id":"notification","params":{"url":"URL", "url_result":"URL", "body":"Message", "icon":"Icon", "image":"Image", "action":"List of actions", "user_action":"close"}}

id: строковый идентификатор, формируемый браузером для идентификации сообщения.
origin_url - Сайт-инициатор нотификации
--url_result - Ссылка, на которую осуществляется переход при нажатии на пуш-- Этот параметр не получить, т.к. реакция на нажатие формируется js скриптом и в общем случае может быть любой. Поэтому с аналитиками договорились, что будем провязывать события с навигациями по timestamp (параметр t)
body - base64 encoded SHA256 текста сообщения из Notification.body
icon - ссылка на иконку нотификации из Notification.icon
image - ссылка на картинку нотификации из Notification.image
badge - ссылка из параметра Notification.badge
lang - язык (обычно пустая строка)

actions - список из Notification.action:
* type - 0 - кнопка/1 - текст
* action - название действия (любая строка)
* title - заголовок
* icon - ссылка на иконку
* placeholder - строка плейсхолдера для текстового ввода (опционально)
title - base64 encoded SHA256 от заколовка
t - timestamp события (регистрируется вместе с регистрацией user_action)
a_user_action - результат взаимодействия пользователя с нотификацией:
* show - показ пуша
* close - крестик
* block - блокировать нотификацию сайта
* settings - переход в настройки
* click - клик в нотификацию
* autoclose - закрылось само без участия пользователя (!!только win!!)
* --result_action - выбранный элемент списка Notification.action-- Сейчас нажатие на активный элемент регистрируется как user_action: "click". Обсудили с arpl@, на результаты анализа данных это никак не повлияет, но в будущей версии учтем это поле.

3. **Делаем пакет bubbleshow_state**

{"client_id":"notification_state","params":{"a_state":"1", "c_allowed":"number", "c_blocked":"number", "c_asked":"number", "raw":"List" }}
a_state - состояние опции показа уведомлений
    1 - Показывать уведомления
    2 - Не показывать
    3 - Показывать после разрешения
c_allowed - Количество сайтов со статусом Разрешить
c_blocked - Количество сайтов со статусом Блокировать
c_asked - Количество сайтов со статусом Спрашивать
raw - Список пользовательских сайтов со статусами
https://st.yandex-team.ru/BROWSER-92231

===(statistikavsexinfobarovbrauzerarazrabotka)Статистика всех инфобаров браузера ("client_id":"infobars") !!**Разработка**!!
Статистика должна отображать, какие инфобары демонстрируются чаще остальных, и каким образом пользователь взаимодействует с ними.
Таблица с полным перечнем инфобаров браузера тут: https://wiki.yandex-team.ru/browser/custo/transition/infobars/List/ .
Действия для инфобаров являются a_ параметрами.

  1. Действия для инфобара:
    * a_show - показ инфобара
    * a_approve - нажатие на кнопку, принимающую действие, предложенное инфобаром
    * a_block - нажатие на кнопку, запрещающую действие, предложенное инфобаром
    * a_close - нажатие на крестик закрытия
    * --a_hide - скрылся не в результате взаимодействия с пользователем--
    Для инфобара Перевода:
    "Перевести на %язык%" - кнопка, принимающее действие, ((https://jing.yandex-team.ru/files/stvor/2016-12-13_23.07.17.png скриншот))

2) Типы демонстрируемых инфобаров (значения для действий) требуется взять из таблицы https://wiki.yandex-team.ru/browser/custo/transition/infobars/List/ . Название инфобара должно соотвествовать делегату без "InfoBarDelegate" на конце (например, для AutofillCCInfoBarDelegate - AutofillCC). Учесть, что необходимо разбить на подтипы инфобары YandexApi и SimpleAlert. Также добавить инфобар PasscheckerInfoBarDelegate.

====Примеры
{"client_id":"infobars", "params":{ "a_block" : "Confirm"}}
{"client_id":"infobars", "params":{ "a_close" : "Translate"}}
{"client_id":"infobars", "params":{ "a_approve" : "RequestQuota"}}

В  отчете Статфейса у каждого действия должен быть выпадающий список с инфобарами:
https://jing.yandex-team.ru/files/stvor/2016-12-13_22.36.05.png

====Таск
https://st.yandex-team.ru/BROWSER-52366
https://st.yandex-team.ru/BROWSER-60758





===Корректировка статистики баблов запроса прав bubblerights ("client_id":"bubblerights")
В случае показа геопопапа отправляем статистику геопопапа и статистику нового бабла одновременно.
Бандл bubblerights:

1) Действия для бабла
* a_show - показ
* a_block - нажатие на кнопку "блокировать"
* a_close - нажатие на крестик
* a_approve - нажатие на кнопку "разрешить"
* a_hide - скрылся не в результате взаимодействия с пользователем
* a_failed_show - технически не смогли показать бабл (по разным причинам)

2) Значения действий, типы бабблов (type):
* Сохранение файлов - save_files
* Загрузка нескольких файлов - download_files
* Доступ к камере и микрофону -  mic_camera
* Доступ к камере - video
* Доступ к микрофону - audio
* Переход по ссылкам разрешение - protocol
* Переход по ссылкам смена сервиса - protocol_replacement
* Доступ к данным о местоположении - geolocation
* Показывать оповещения - notification
* Доступ к MIDI-устройствам - midi
* Получать пуш-уведомления - push
* Доступ к уникальному идентификатору устройства - protected
* Агрегированный бабл - multi- имеет только действия a_close (взаимодействие) или a_hide (другие случаи)
* Бабл с кривым ресурсами (пропустили при мердже) - unknown (не имеет действий)

На stat.yandex-team имеем вид типа:
-a_show:
--geolocation
--multi
--notification
--push
и т.д.
-a_close:
--geolocation
--multi
--notification
--push

====Примеры
{"client_id":"bubblerights", "params":{ "a_show" : "geolocation"}}
{"client_id":"bubblerights", "params":{ "a_close" : "multi"}}
{"client_id":"bubblerights", "params":{ "a_approve" : "protocol"}}

====Таск







===Увеличение аудитории, отправляющих статистику (client_id "mobb": make our browser better)

**Балун предложения включить отправку статистики (через 4 дня после обновления или инсталла браузера)**
https://st.yandex-team.ru/BROWSER-49305

Клик на "ОК"
%%{"client_id":"mobb",
"params": {"a_OK":"baloon" }}%%

**Балун восстановления сессии**
https://st.yandex-team.ru/BROWSER-49070

Установка галочки, клик на "ОК"
Установка галочки, клик на "Отмена"

%%{"client_id":"mobb",
"params": {"a_OK":"crash" }}%%


**Включение отправки статистики с велкама**
https://st.yandex-team.ru/BROWSER-49294

Ручка включила отправку статистики, и только после этого отправился бандл (ДО этого момента бессмысленно и нельзя):
%%{"client_id":"mobb",
"params": {"a_OK":"promo" }}%%



=== Дзен (нативный)
Версия 16.4.1
showntp - были показаны зубы в ньютабе
teaserclick - были кликнуты зубы в ньютабе
teaserscroll - с ньютаба в дзен перешли скроллом
teaserkey - с ньютаб в Дзен перешли нажатием кнопки "вниз"
JS
{"client_id":"zen",
"params": {"showntp":"1"}}
{"client_id":"zen",
"params": {"teaserclick":"1"}}
{"client_id":"zen",
"params": {"teaserscroll":"1"}}


2)show - в принципе каким бы то ни было образом открыл дзен (будет больше суммы teaserclick и teaserscroll) В любом виде открыть дзен
history - долистал до конца пачки, случился запрос в prev
more - кликнул на "ещё карточек"

{"client_id":"zen",
"params": {"show":"1"}}
{"client_id":"zen",
"params": {"history":"1"}}
{"client_id":"zen",
"params": {"more":"1"}}

3)click - кликнул на карточку, перешел на статью
like - кликнул на лайк
dislike - кликнул на дизлайк
advclick - кликнул на рекламу
ban - кликнул на "забанить источник"

{"client_id":"zen",
"params": {"click":"1"}}
{"client_id":"zen",
"params": {"like":"1"}}
{"client_id":"zen",
"params": {"dislike":"1"}}
{"client_id":"zen",
"params": {"advclick":"1"}}
{"client_id":"zen",
"params": {"ban":"1"}}

4)unshow — любым способом добился замены таба с дзеном на NTP (будет больше суммы topscroll и up)

{"client_id":"zen",
"params": {"unshow":1}}
5)disable — отключил дзен в настройках
{"client_id":"zen",
"params": {"disable":1}}
6)noshowntp - не были показаны зубы в ньютабе, хотя дзен enabled экспериментом и в настройках (это может быть, например, по следующим причинам: либо потому что этот человек попал в контрольную выборку дзена, либо потому что мало истории для его куки у дзена, либо не ответила ручка дзена).
{"client_id":"zen",
"params": {"noshowntp":1}}

Настройки
{"client_id":"zen",
"params": {"a_infset":"enable/disable"}}
Раз в 4 часов
{"client_id":"zen",
"params": {"a_changeset":"enable/disable"}}
При изменение галки во вклвыкл
Создание вкладки с дзеном
{"client_id":"zen",
"params": {"a_tab":"open/close"}}
Для веб дзена и external zen


Задача
https://st.yandex-team.ru/BROWSER-47572

===Бабблы предложения перехода с классики на калипсо
Версия 16.10.1
Бандл bubcal:

1) Действия для бабла
* a_show - показ
* a_accept - нажатие на кнопку принятия предложения бабла
* a_later - нажатие на кнопку "позже"
* a_never - нажатие на кнопку "больше не напоминать"
* a_сlose - нажатие на крестик

2) Значения действий, типы бабблов (type):
* Баббл предложения попробовать новый интерфейс - new_interface
* Баббл предложения попробовать браузер с защитой карт - cardsec
* Баббл предложения попробовать браузер с Дзеном -  Zen
* Баббл предложения попробовать браузер с защищенным режимом - protect
* Баббл предупреждение устаревшего интерфейса - old_interface
* ПБаббл предупреждение отказа от поддержки классического интерфейса - no_support

====Примеры
{"client_id":"bubcal", "params":{ "a_show" : "cardsec"}}
{"client_id":"bubcal", "params":{ "a_accept" : "Zen"}}
{"client_id":"bubcal", "params":{ "a_never" : "no_support"}}

===Protect
https://st.yandex-team.ru/BROWSER-62420

C 17.4.1:
%%Client_id: prt%%


**a_shw**
Вместо "1" шлем одно из значений показанного замочка:
- http - глобус
- gray - серый закрытый
- gray_opened - серый открытый
- gray_torn - серый с порванной подложкой
- green - зеленый закрытый
- green_opened - зеленый открытый
- red - красный
- red_torn - красный с порванной подложкой
- internal - внутренняя страница браузера
- file - file://


**url**
Урл, на котором был открыт балун Протекта



**a_fs (features state)**
При каждом открытии балуна, у каждого юзера должна отсылаться статистика о состоянии глобальных переключателей фич
- tubo_0 - Турбо
- turbo_1
- secwifi_0 - SecWiFi
- secwifi_1
- pass_0 - Антифишинг паролей
- pass_1
- cardsec_0 - Антифишинг карт
- cardsec_1
- shock_0 - Антишок
- shock_1
- vpn_0 - VPN
- vpn_1



**a_ft (features toggle)**
Факт переключения фич (0->1 / 1->0):
- tubo_01 - Турбо из OFF в ON
- turbo_10 - Турбо из ON в OFF
- secwifi_01 - SecWiFi из OFF в ON
- secwifi_10 - SecWiFi из ON в OFF
- pass_01 - Антифишинг паролей из OFF в ON
- pass_10 - Антифишинг паролей из ON в OFF
- cardsec_01 - Антифишинг карт из OFF в ON
- cardsec_10 - Антифишинг карт из ON в OFF
- shock_01 - Антишок из OFF в ON
- shock_10 - Антишок из ON в OFF
- vpn_01 - VPN из OFF в ON
- vpn_10 - VNP из ON в OFF



**a_ps (permissions state)**
При каждом открытии балуна протекта
- geo_0 - Местоположение
- geo_1
- cam_0 - Камера
- cam_1
- mic_0 - Микрофон
- mic_1
- push_0 - Нотификация
- push_1
- js_0 - JS
- js_1
- plug_0 - Плагины
- plug_1
- img_0 - Картинки
- img_1
- pop_0 - Поапап-окна
- pop_1
- sync_0 - Синхра
- sync_1
- down_0 - Автозагрузки
- down_1
- midi_0 - MIDI
- midi_1
- pass_0 - Защита паролей
- pass_1
- bank_0 - Банкинг
- bank_1

**a_pt (permissions toggle)**
При каждом открытии балуна протекта
- geo_01 - Местоположение из OFF в ON
- geo_10 - Местоположение из ON в OFF
- cam_01 - Камера из OFF в ON
- cam_10 - Камера из ON в OFF
- mic_01 - Микрофон из OFF в ON
- mic_10 - Микрофон из ON в OFF
- push_01 - Нотификация из OFF в ON
- push_10 - Нотификация из ON в OFF
- js_01 - JS из OFF в ON
- js_10 - JS из ON в OFF
- plug_01 - Плагины из OFF в ON
- plug_10 - Плагины из ON в OFF
- img_01 - Картинки из OFF в ON
- img_10 - Картинки из ON в OFF
- pop_01 - Поапап-окна из OFF в ON
- pop_10 - Поапап-окна из ON в OFF
- sync_01 - Синхра из OFF в ON
- sync_10 - Синхра из ON в OFF
- down_01 - Автозагрузки из OFF в ON
- down_10 - Автозагрузки из ON в OFF
- midi_01 - MIDI из OFF в ON
- midi_10 - MIDI из ON в OFF
- pass_01 - Защита паролей из OFF в ON
- pass_10 - Защита паролей из ON в OFF
- bank_01 - Банкинг из OFF в ON
- bank_10 - Банкинг из ON в OFF



**a_click**
- more
<{Клик на ссылку "Подробнее" на первом экране балуна
https://jing.yandex-team.ru/files/roman753/16-01-17_19-41.png}>




**a_cls**
Закрытие балуна Протекта
- out - клик вне области балуна
- lock - клик в замочек
- esc - нажатие на Escaper
- cls_2 - клик по "закрыть" на втором экране
- cert
<{Клик на ссылку "Данные сертификата"
https://jing.yandex-team.ru/files/roman753/16-01-17_19-43.png}>
- dev
<{Клик на ссылку "Подробнее" на втором экране балуна
https://jing.yandex-team.ru/files/roman753/16-01-17_20-06.png
}>
- help
<{Клик в иконку вопроса (?)
https://jing.yandex-team.ru/files/roman753/16-01-17_19-42.png}>


**a_time**
Время между открытием и закрытием балуна
- 10 - от 0 до 10 секунд
- 30 - от 10 до 30 секунд
- 60 - от 30 секунд до 1 минуты
- other - все, что больше 1 минуты




<{Неактуально, до 17.4.1
BROWSER-53359







client_id: prt
* a_shw:1 - открытие (показ балуна) после клика в кнопку. Если балун не показан не шлем.
Для турбо и secwifi дополнительно шелм статистику на каждое событие переключения фичи в контекстном блоке/виджете, передавая значение в которое переключили фичу (1 или 0):
* a_trb - турбо
* a_swi - secwifi
При первом открытии балуна, но не реже раза в сутки, у каждого юзера должна отсылаться статистика о состоянии глобальных переключателей фич (0 - выкл, 1 - вкл):
* a_app - Антифишинг паролей
* a_apc - Антифишинг карт
* a_shk- Антишок
}>

===Логирование работы пользователя с инсталлятором флэша (flashinst)
Версия 16.11.
Бандл flashinst:

1) Действия для UAC-диалога инсталлера системного флэша
* show - показ
* accept - согласие с установкой
* decline - отказ от установки в UAC
* success - успешная установка
* error - провал установки (содержит exit_code инсталлятора)

2) Причина запуска инсталлятора, a_reason
* baloon - из балуна
* cap - из заглушки
* another - другое

====Примеры
{"client_id":"flashinst", "params":{ "a_reason" : {"baloon" : 1} , "show" : "1" }
{"client_id":"flashinst", "params":{ "a_reason" : {"cap" : 1} , "accept" : "1" }
{"client_id":"flashinst", "params":{ "a_reason" : {"another" : 1} , "сlose" : "1" }

===Логирование балунов и заглушек предложения установить системный флэш (sysfl)
Версия 17.3.0
Бандл sysfl:

1) Действия для балуна или заглушки:
* a_show - показ
* a_accept - нажатие на кнопку принятия предложения балуна или заглушки
* a_сlose - нажатие на крестик

2) Значения действий, типы балунов и заглушек (type):
* Балун - baloon
* Заглушка - cap
* Балун про успешную установку - sbaloon

====Примеры
"client_id":"sysfl", "params":{ "a_show" : {"cap" : "1"}}
"client_id":"sysfl", "params":{ "a_accept" : {"baloon" : "1"}}

===Статистика механизма компонентного обновления (c_update)
Версия 17.3.1 (или выше) https://st.yandex-team.ru/BROWSER-62402
Бандл c_update:

1) Все компоненты являются a-параметрами и имеют вид a_id'компоненты, например:
* a_igomlkonjcmjlliglfnjfhkgmjpbeoel
* a_gecamdpfjnpmdkbpokgloiiecedjajdd
  и т.д. для
* изи листа блокировщика рекламы
* пресетов SPA
* клинапера

2) Значениями параметра являются возможные дейтвия:
* --response - ответ от сервера, 1 - обновление требуется, 0 - обновление не требуется-- в случаях, когда обновление не требуется, статистика не отправляется вообще. Отправлять параметр, который будет всегда равен 1, бессмысленно => параметр response не нужен. Случаи, когда клиент ходил к серверу, но сервер ничего не отдал, можно смотреть в серверной статистике ручки BOBR-2293
* success - 1 - скачивание и регистрация успешна, 0 - при скачивании или регистрации произошла ошибка

====Примеры
{"client_id" : "c_update", "params" : { "a_igomlkonjcmjlliglfnjfhkgmjpbeoel" : {"success" : "1"}}}

!!**DEPRECATED, с версии 19.6.0**!!

===Статистика полноэкранного режима (fullscreen)
https://st.yandex-team.ru/BROWSER-64981
https://st.yandex-team.ru/BROWSER-64982
Бандл fullscreen, отправляем счетчик.

1) novideo - переход в режим fullscreen не при просмотре видео (в фуллскрин разворачивают не видео, а браузер)
2) video - переход в режим fullscreen при просмотре видео (в фуллскрин разворачивают само видео)

====Примеры
{"client_id" : "fullscreen", "params" : "video"}
{"client_id" : "fullscreen", "params" : {"video" , "novideo"}

===Статистика нативного дзена (zen)
1)showntp - были показаны зубы в ньютабе
teaserclick - были кликнуты зубы в ньютабе
teaserscroll - с ньютаба в дзен перешли скроллом

**JS**
{"client_id":"zen",
"params": {"showntp":"1"}}
{"client_id":"zen",
"params": {"teaserclick":"1"}}
{"client_id":"zen",
"params": {"teaserscroll":"1"}}


2)show - в принципе каким бы то ни было образом открыл дзен (будет больше суммы teaserclick и teaserscroll) В любом виде открыть дзен
history - долистал до конца пачки, случился запрос в prev
more - кликнул на "ещё карточек"

{"client_id":"zen",
"params": {"show":"1"}}
{"client_id":"zen",
"params": {"history":"1"}}
{"client_id":"zen",
"params": {"more":"1"}}

3)click - кликнул на карточку, перешел на статью
like - кликнул на лайк
dislike - кликнул на дизлайк
advclick - кликнул на рекламу
ban - кликнул на "забанить источник"

{"client_id":"zen",
"params": {"click":"1"}}
{"client_id":"zen",
"params": {"like":"1"}}
{"client_id":"zen",
"params": {"dislike":"1"}}
{"client_id":"zen",
"params": {"advclick":"1"}}
{"client_id":"zen",
"params": {"ban":"1"}}

4)unshow — любым способом добился замены таба с дзеном на NTP (будет больше суммы topscroll и up)

{"client_id":"zen",
"params": {"unshow":1}}
5)disable — отключил дзен в настройках
{"client_id":"zen",
"params": {"disable":1}}
6)noshowntp - не были показаны зубы в ньютабе, хотя дзен enabled экспериментом и в настройках (это может быть, например, по следующим причинам: либо потому что этот человек попал в контрольную выборку дзена, либо потому что мало истории для его куки у дзена, либо не ответила ручка дзена).
{"client_id":"zen",
"params": {"noshowntp":1}}

https://st.yandex-team.ru/BROWSER-47572

====Примеры
{"client_id" : "zen", "params": {"ban":"1"}}

===Статистика выноса видео (videoout)
17.1.0.780 + win10

Компонентная статистика
1. Логируется домен
%%(json)
{
    "client_id": "videoout",
    "params": {
        "domain": "www.youtube.com"
    }
},%%

Гистограммы:
1. Размер окна
%%(json)
Histogram: OoWVideo.BringOutOriginalSize recorded 4 samples, mean = 437040.0 (flags = 0x1)
0       ...
378403  ------------------------------------------------------------------------O (4 = 100.0%) {0.0%}
525000  ... %%

Тип видео (2-flash, 1-html5, 0-unknown)
%%(json)
Histogram: OoWVideo.BringOutVideoType recorded 4 samples, mean = 1.0 (flags = 0x1)
0  O                                                                         (0 = 0.0%)
1  ------------------------------------------------------------------------O (4 = 100.0%) {0.0%}
2  O      %%
Время жизни окна
%%Histogram: OoWVideo.ExternalWindowLifetime recorded 1 samples, mean = 1080.0 (flags = 0x1)
0     ...
1013  ------------------------------------------------------------------------O (1 = 100.0%) {0.0%}
1169  ...
%%

{"client_id":"videoout","params":{"domain":"examople.com", "btn":"1-5","tme":"N sec","src":"N","drt":" N sec"}}
Все делаем в client_id = videoout
Отправляем для каждого автовыноса/выноса
1. Убираем параметр domain, добавляем параметр url страницы (в омнибоксе) и vsrc ссылка на урл ролика(в элементе видео)
2. Добавляем a_type = aout (авновынос) a_type=vout (ручной вынос)

стаусная статиситка отправляется независмо c client_id=videoout
1. Статусная статистика о фиче автовыноса a_aset=on(автовынос включен) a_aset=off(автовынос выключен). Отправлять принудительно раз в 4 часа
2. Статусная статистика о фиче выноса a_vset=on(вынос включен), a_vset=off(вынос выключен). Отправлять принудительно раз в 4 часа

btn - местоположение кнопки
tme - время проведенное в окне выноса видео
src - количество изменений src ролика
drt - длинна ролика на котором было вынесено видео (только для html5)
https://st.yandex-team.ru/BROWSER-63671

Статистика плеера
1. Клик в контрол переключения автовыноса a_click:on|a_click:off. Плюс timestamp:время
2. Клик в крестик закрытия окна a_click:close. Плюс timestamp:время
3. Клик в крестик диалога a_click:dclose. Плюс timestamp:время
4. Клик в кнопку "Понятно" a_click:yes. Плюс timestamp:время
5. Показ диалога show:1. Плюс timestamp:время
6. Клик в паузу a_click:pause. Плюс timestamp:время
7. Клик в плей a_click:play. Плюс timestamp:время

Настройка выключения-включения:
Данные отправляются вида
%%(json)
user_action_event {
  name_hash: 12426032810838168341
  time: 1228209
}%%
И я не знаю, как расшифровать хэш. Если кто подскажет - проверю
Некоторым проверкам мешает баг https://st.yandex-team.ru/BROWSER-59221

На каких доменах выключено вынос видео -{"client_id": "videoout","params": {"pipdomain": "www.youtube.com"}}
OoWVideo.DisabledByAttribute в штуках, каждый раз когда у видео появляется такой атрибут-значение.

====Примеры
{"client_id": "videoout","params": {"domain": "www.youtube.com"}}

===Статистика нового таба (client_id: ntp)

https://st.yandex-team.ru/BROWSER-65542

Новая бандловая статистика, %%"client_id": "ntp"%%.
Речь идёт только от новом табе/дне; открытие табло кликом в омнибокс в данном случае не учитывается.

Параметры:
  * ##a_open## — отправляется всегда при открытии NTP, ровно с двумя параметрами, time и одним другим из списка ниже
    * time (время, в которое случилось событие открытия NTP, с точностью до ms)
    * dno: 1, если открытие в режиме дна
    * hotkey: 1, если открытие по любому хоткею (ctrl/cmd + t/n как минимум)
    * mainmenu: 1, если открытие из пункта меню-бутерброда
    * plus: 1, если открытие по плюсику в табстрипе
    * zen: 1, если открытие выскролливанием любым способом из дзена (скролл, хоткей, кнопка "вверх" etc)
    * other: 1, если иное
  * ##a_close## — отправляется всегда при скрытии NTP, ровно с двумя параметрами, time и одним другим из списка ниже
    * time (время, в которое случилось событие скрытия NTP, с точностью до ms)
    * tabswitch: 1, если пользователь переключился на другую вкладку этого окна мышкой или хоткеем
    * plus: 1, если NTP закрыт кликом в крестик
    * closewindow: 1, если NTP закрыт вместе с окном
    * hotkey: 1, если NTP закрыт любым хоткеем (esc, ctrl/cmd+w etc; но не ctrl+tab/ctrl+1 и другие хоткеи переключения вкладок)
    * openurl: URL, если открылась новая вкладка из внешнего приложения или меню браузера
    * openurlfromomnibox: URL, если открылся URL/поиск из омнибокса в этом NTP
    * openurlfromtablo: URL, если открыт сайт из Табло
    * openurlfromtablobookmarkbar: URL, если открыт сайт из панели закладок на NTP
    * zen: 1, если зашли в дзен
    * clickenablezen: 1, если открыт онбординг дзена кликом по баннеру онбординга на NTP
    * clickyabuttonontablo: 1, если открыт Яндекс кликом по кнопке Яндекс на NTP
    * clicksyncbuttonontablo: 1, если открыта страница включения синхронизации по ссылке "включить синхру" на NTP
    * clickallbookmarksbuttonontablo: 1, если открыт диспетчер закладок по ссылке "все закладки" на NTP
    * clickbuttonontablo: URL, если совершен переход по любой ссылке на неглавных экранах (недавно закрытые, дополнения, другие устройства etc)
    * other: 1, если NTP был скрыт, но ни один из параметров выше не удалось поставить.

**Дополнительное требование:** при выходе из браузера надо отправлять накопившиеся бандлы с этой статистикой, формируя пустой навигейт.
===Статистика балуна Поиск/Копировать
Версия 16.11.1
Бандл copysearch:

Действия для контекстного меню
* show - событие показа балуна
* copy - событие нажатия на "копировать"
* search - событие нажатия на "искать"
* arrow - событие нажатия на стрелочку

====Примеры
{"client_id":"copysearch", "params":{ "show" : "1"}}
{"client_id":"copysearch", "params":{ "copy" : "1"}}
{"client_id":"copysearch", "params":{ "arrow" : "1"}}

===Статистика балуна Окончания поддержки XP
Делаем в 17.4.1
Делаем бандл xpsup статистику балуна (покаЗ балуна, нажатие [подробнее]):
a_show - показ балуна
a_accept - нажатие на кнопку [подробнее] балуна
a_сlose - нажатие на [позже]
====Примеры
"client_id":"xpsup", "params":{ "a_show" : "1"}
"client_id":"xpsup", "params":{ "a_accept" : "1"}
"client_id":"xpsup", "params":{ "a_сlose" : "1"}


=== Статистика потребления памяти
{ 123 : { m : 20000, d : [ yandex.ru, yandex.ru ] }, 456 : {...} }
Где 123, 456 это идентификаторы процессов. m память в килобайтах, d список доменов

https://st.yandex-team.ru/BROWSER-60565
====Примеры
[{"client_id":"rmemory","params":{"1648":{"d":["browser.yandex.ru"],"m":13576},"3592":{"d":["www.nat-geo.ru"],"m":31800},"4672":{"d":["www.tut.by"],"m":63748},"4676":{"d":["yandex.ru"],"m":34756}}}]


===GOST TLS
17.7.1 (?)
**client_id:** %%gost%%

**%%sn%%**: %url% - url страницы на которой была показана interstitial про ГОСТ соединение.
**%%a_show%%** - показ interstitial страницы
**%%a_clck%%** - клик по кнопке на interstitial, значения:
  *   **%%0%%** - кнопка продолжить
  *   **%%1%%** - кнопка уйти с сайта
  *   **%%2%%** - переход на browser://settings с interstitial
  *  **%%3%%** - добавить сайт в исключение и никогда не пытаться на нем соединиться по ГОСТу
**%%a_change%%** - переключение галочки в настройках:
  *   **%%0%%** - с **вкл**юченной галочки поддержка в ГОСТ на **выкл**
  *   **%%1%%** - с **выкл**юченной галочки поддержка в ГОСТ на **вкл**

===Попытка сериализации страницы ("client_id":"HibernateResult")
=====Описание
  * %%url%% -- урл страницы
  * %%a_success%% -- было ли сохранение успешным
  * %%a_failed_types%% - неподдерживаемые типы
  * %%a_failed_partial_interfaces%% - неподдерживаемые partial interface
  * %%a_errors%% - идентификатор сообщения об ошибках
  * %%a_fallback_reason%% - причина фоллбэка на прежний механизм
  * %%a_weight%% -- вес для рекомендатора (см. BROWSER-101873)
  На андроиде должна отправляться аналогичная статистика, но через Метрику.
=====Пример посылок в бандле
См. https://st.yandex-team.ru/BROWSER-88305#5ba1e6f9b8787d001c632145
=====Таски
https://st.yandex-team.ru/BROWSER-88305#5b86a43b7099d0001c7e2663
https://st.yandex-team.ru/ABRO-35604#5bb5aacc16df24001b73e093

===Логирование сайтов, где пользователи авторизуются
====17.3.1
top_url - URL страницы
form_url - URL фрейма, где лежит форма
action_url - action URL формы
target_url - URL, куда перекинуло пользователя после сабмита
 target_url может работать не всегда идеально, например, в случае ajax сабмита формы. Подробности в комменте чуть выше.
====18.1.1
Параметры, которые отправляются после отправки формы
%%a_form_submit%% - статус после отправки формы, имеет значения:
* %%fail%% - авторизации не произошло
* %%success%% - успешная авторизация

%%a_login_filled%% - способ, которым было заполнено поле, значения:
* %%auto%% - заполнено автоматически браузером (автозаполнение)
* %%select%% - выбор через выпадающее меню
* %%typed%% - пользовательский ввод в инпут
* %%mixed_auto%% - если поле было заполнено двумя и  более способов с момента загрузки формы до ее отправки, последнее действие select
* %%mixed_select%% - смешанно, последнее действие select
* %%mixed_type%% - смешанно, последнее действие type
* %%mixed_by_site%% - смешанно, последнее действие by_site
* %%by_site%% - если поле заполнено сайтом

%%a_password_filled%% - способ, которым было заполнено поле, значения:
* %%auto%% - заполнено автоматически браузером (автозаполнение)
* %%select%% - выбор через выпадающее меню
* %%typed%% - пользовательский ввод в инпут
* %%mixed_auto%% - если поле было заполнено двумя и  более способов с момента загрузки формы до ее отправки, последнее действие select
* %%mixed_select%% - смешанно, последнее действие select
* %%mixed_type%% - смешанно, последнее действие type
* %%mixed_by_site%% - смешанно, последнее действие by_site
* %%by_site%% - если поле заполнено сайтом

%%a_type%% - тип формы, значения:
* %%only_login%% - форма на которой есть только один инпут и это логин
* %%only_pass%% - форма на которой есть только один инпут и это пароль
* %%auth%% - форма с полями логин и пароль
* %%registration%% - форма с полем логин и двумя полями пароль
* %%two_pass%% - форма без поля логина и с двумя полями пароль
* %%change_pass%% - форма с треями полями пароль и без логина




=====Пример посылок в бандле
%%
Отправляется статистика вида
%%(json)
{
    "client_id": "auth",
    "params": {
        "action_url": "http://www.noob-club.ru/index.php",
        "form_url": "http://www.noob-club.ru/index.php",
        "target_url": "http://www.noob-club.ru/index.php",
        "top_url": "http://www.noob-club.ru/index.php"
    }
},%%
%%
=====Таск
https://st.yandex-team.ru/BROWSER-47596


===IEtab
17.7.1 (?)
**client_id:** %%ietab%%

**%%url%%**: %url% - url страницы, которая была открыта в IE
**%%a_opt%%** - действие, которое привело к открытию url  в IE, значения:
  *   **%%0%%** - по клику в кнопку расширения
  *   **%%1%%** - при переходе на url из списка сайтов в расширении
  *   **%%2%%** - при переходе на url из списка ГП

Раз в сутки каждый клиент с включенным расширением и не нулевым списком сайтов отправляет этот список:
"l_url":["url1","url2",..., "urln"]
Шлем при первой возможности, не чаще чем раз в сутки при работающем браузере.

====Пример:
{"client_id":"ietab", "params":{ "a_opt" : "1" , "url":"your.internal.site" } - открытие сайта your.internal.site, находящегося в списке расширения
{"client_id":"ietab", "params":{ "l_url":["your.internal.site","lk.internal.site","personal.site" ] } - посылка раз в сутки списка сайтов,для открытия в IE


===Readability
==== Показ иконки режима чтения в омнибоксе
%%
{"client_id":"readability",
"params": {"a_OMNI":"show" }}
%%

==== Клик на иконку режима чтения в омнибоксе, вход в режим
%%
{"client_id":"readability",
"params": {"a_OMNI":"click" }}
%%


==== Клик на пункт в КМ страницы, вход в режим
%%
{"client_id":"readability",
"params": {"a_CM":"click" }}
%%


==== Выход из режима
Любой из способов, описанных в https://wiki.yandex-team.ru/browser/ProductFeatures/ReaderMode/tz/#vyxodizrezhima
%%
{"client_id":"readability",
"params": {"a_CLOSE":"close", "a_CLOSE_SIZE":"$N","}}
%%
Где %%$N%% - это актуальный на момент выхода масштаб шрифта.



===Статистика окошка предложения выбора дефолтного браузера

("client_id":"dflt_brws")
#|
||Параметр|Действие||
||SHOW |факт показа тулбара/окна/балуна, распределяется по параметрам A, B, C, D  ||
||APPRV |клик по "Установаить"||
||DENY |клик по "Отмена"||
||CLOSE |клик по крестику закрытия"||
||DNTSHW |клик установки галочки в чекбоксе "больше не показывать" (только для варианта С)||
|#

Значение: С - пользователю показывается модальное окно


===Обновление в меню бутерброда
 client_id: me2
Нажали на "обновить", отправили бандл  a_MENCLICK: 1

- показали балун обычного обновления, отправили бандл %%a_BAL: 1%%
- показали балун критического обновления, отправили бандл %%a_BAL: 2%%
- Нажали на "обновить", отправили бандл %%a_BALCLICK: 1%%
- Нажали на "не сейчас", отправили бандл %%a_BALCLICK: 2%%

===Облачный просмотр документов
====Статистика
client_id: %%cloud_doc%%

**a_SHOW**
- proposal - показался интерфейс предложения передавать файл в облако
- upload - показался интерфейс индикации загрузки
- error - показалась ошибка

**a_CLICK**
- allow - клик по кнопке "передавать в облако"
- deny - клик по кнопке "не передавать в облако"
- close - закрытие интерфейса без принятия решения

**a_FILE**
- down_start - факт начала скачивания файла в локальное хранилище
- down_finish - факт конца скачивания файла в локальное хранилище
- up_start - факт начала загрузки файла в облако
- up_finish - факт конца загрузки файла в облако

**a_OPEN**
- loggedin - факт открытия страницы с логином
- not_loggedin - факт открытия страницы без логина

====JS диалоги
client_id: jsdialog
Параметры в бандле:
type - тип диалога ( alert, confirm, prompt, onbeforeunload, onbeforereload )
url - урл страницы, где был показан диалог
referer - урл таба, в который переключился юзер
count - число табов в процессе, в котором показался диалог

https://st.yandex-team.ru/BROWSER-61452

===Passman
{{include page="/browser/stat/bundle/Passman/" notoc notitle nomark}}
===Cardman
{{include page="/browser/stat/bundle/Cardman/" notoc notitle nomark}}
===Infoman
{{include page="/browser/stat/bundle/Infoman/" notoc notitle nomark}}

===Автонезагрузка табов
https://st.yandex-team.ru/BROWSER-42729
client_id:  %%mass_redir%%
факт срабатывания отмены редиректа (в параметр  %%a%% шлем  1 )
хост, на который мы заметили массовый редирект (шлем в параметр  %%host%% ) без префикса "a_" чтобы не порвало отчет


===Интерстишиалы плохих сертификатов
https://st.yandex-team.ru/BROWSER-70355

%%clientid:interst_cert%%

Для наших интерстишиалов, которые ругаются на сертификаты нужно залогировать:

- при показе  интерстишиала тип (в соответствии с interstitial.ssl_error_type для удобства) %%a_type%%:
%%CERT_COMMON_NAME_INVALID
CERT_WEAK_SIGNATURE_ALGORITHM
CERT_DATE_INVALID
CERT_WEAK_KEY
CERT_AUTHORITY_INVALID
CERT_PINNED_KEY_MISSING
CERT_REVOKED
CERT_INVALID
CERTIFICATE_TRANSPARENCY_REQUIRED
CERT_ISSUED_BY_UNKNOWN_ROOT
ERR_SSL_PROTOCOL_ERROR
%%

- %%cname%% сертификата
- %%fingerpint%% сертфиката
- клики %%a_click%%: back (клик по "вернуться"), more (клик по "подробности"), allow (клик по "сделать исключение")

===Логирование балуна предложения вернуть дефолтный поиск (def_srch_baloon)
Версия 18.3.0
Бандл def_srch_baloon:

1) Действия для балуна предложения вернуть дефолтный поиск
* show - показ
* accept - согласие с установкой
* decline - отказ
* close - закрытие по крестику

====Примеры
{"client_id":"def_srch_baloon", "params":{ "show" : "1" }
{"client_id":"def_srch_baloon", "params":{ "accept" : "1" }

===Логирование элементов UI режима деградации (degradation_UI)
Версия 18.3.1
Бандл degradation_UI:

1) Действия для элементов UI
* show_baloon - показ балуна
* ok - закрытие балуна кликом в "хорошо"
* close - закрытие балуна по крестику
* click - клик в пункт меню про режим деградации
* help - переход в help

====Примеры
{"client_id":"degradation_UI", "params":{ "show_baloon" : "1" }
{"client_id":"degradation_UI", "params":{ "click" : "1" }

===Логирование режима энергосбережения (energy_saving)
Версия 18.3.1
Бандл energy_saving
1). Действия с элементами UI (отправляем с навигейтом после конкретного действия)
* show_icon - показ иконки
* show_baloon - показ балуна
* show_welcome_baloon - показ приветственного балуна
* good_button - клик в "Хорошо" на балуне
* baloon_on - включили энергосбережение в балуне
* baloon_off - выключили энергосбережение
* settings_on - включили энергосбережение в настройках
* settings_off - выключили энергосбережение в настройках
* help - переходы в хелп из балуна
2). Общие настройки и состояние режима (отправляем раз в три часа)
* settings_20 - выставлено автовключение по порогу 20% заряда батареи
* settings_50 - выставлено автовключение по порогу 50% заряда батареи
* settings_80 - выставлено автовключение по порогу 80% заряда батареи
* energy_saving_on - включено энергосбережение
* energy_saving_off - включено энергосбережение
====Примеры
{"client_id":"energy_saving", "params":{ "show_baloon" : "1" }
{"client_id":"energy_saving", "params":{ "baloon_off" : "1" }


===Порноинкогнито

bundle: %%porn_incognito%%

Параметры:
**a_SHOW**
- bubble - показался балун предложения из иконки Протекта


**a_CLICK**
- yes - в балуне предложения был клик на пункт "открывать"
- no - в балуне предложения был клик на пункт "не сейчас"
- nav - закрытие балуна при навигации на другой ресурс



===Единое избранное
%%client_id: favorites%% - точка входа в Яндекс.Коллекции
%%client_id: favorites_form%% - форма выбора коллекций/закладок;
%%client_id: settings%% - логируем использование настроек

* Вход пользователя в раздел "Мои коллекции" по кнопке рядом с "+"
* https://st.yandex-team.ru/BROWSER-89613
#|
||
Нажатие на кнопку показа коллекций
* %%client_id: favorites%%
* Параметр: %%a_my_collections%%
* Key/Value
  * %%click%%
    * %%1%% - по факту клика на иконку "Мои коллекции", рядом с +
  * %%o_type%%
    * %%0%% - при клике мы открыли новый таб;
    * %%1%% - при клике мы открыли уже открытый таб коллекций*
* Параметр: %%a_return_baloon%%
  * Значения
    * %%close%% - закрытие по крестику и миссклику
    * %%open%% - переход в коллекции
    * %%button_click%% - клик по кнопке "штанов" с синей точкой
* Параметр: %%a_feed_baloon%%
  * Значения
    * %%close%% - закрытие по крестику и миссклику
    * %%open%% - переход в коллекции
    * %%button_click%% - клик по кнопке "штанов" с синей точкой
||
|#

* Работа с новой формой по добавлению/изменению коллекций
https://st.yandex-team.ru/BROWSER-89614
#|
||
!! Логируем сессию работы с формой
* %%client_id: favorites_form%%
* Параметр: %%a_type%%
  * %%link%% - ссылка
  * %%image%% - изображение
  * %%video%% - видео
* Параметр: %%a_default%%
* Key/Value
  * %%collections%% - сохранили в коллекции
  * %%bookmarks%% - сохранили в закладки
  * %%show_promo%% - показали форму с промо
  * %%switch%% - изменили дефолт на коллекции
  * %%no_switch%% - не изменили дефолт на закладки по любой причине
* Параметр: %%a_public%%
* Key/Value
  * %%public%% - факт создания публичной коллекции
  * %%private_change%% - факт переключения с публичной на приватную коллекцию
  * %%public_change%% - факт переключения с приватной на публичную коллекцию
  * %%public_suggest%% - предложение создать публичную коллекцию при включенном параметре по умолчанию публичных коллекций
* Параметр: %%a_session%%
* Key/Value:
  * %%time_opened%%
    * Время в которое случилось открытие формы с точностью до ms;
  * %%time_closed%%
    * Время в которое случилось закрытие формы с точностью до ms;
  * %%src_type%%
    * %%l%% - линк на сайт;
    * %%i%% - картинка;
    * %%v%% - видео;
  * %%dst_open%% значения
    * %%c%% - если открыли форму для добавления сайта и последняя использованная папка была коллекция и мы ее знали;;
    * %%b%% - если открыли форму для добавления сайта и последняя использованная папака была папка закладок;
    * %%d%% - если открыли форму для добавления сайта и значение последней использованной папки коллекций было неизвестно;
    * %%0%% - прочий непонятный стейт.
  * %%dst_closed%% - для какого типа контента была закрыта форма
    * %%b%% - форма была закрыта и выбрана была папка закладок;
    * %%c%% - форма была закрыта и выбрана была папка коллекций;
    * %%0%% - прочий непонятный стейт.
  * %%close_m%% - метод закрытия
    * %%move_to_c%% - переход в коллекцию из формы добавления
    * %%btn_done%% - нажатие на кнопку "Готово";
    * %%btn_cross%% - закрытие по крестику;
    * %%btn_save%% - нажатие на "Сохранить"
    * %%outside_click%% - нажатие вне области
    * %%login%% - нажатие на смену логина/залогин;
    * %%btn_delete%% -  удаление;
    * %%other%% - неучтенный способ в коде (будем смотреть по проду, если появится значит, появился какой-то еще способ).
  * %%board_changed%% - выбор по факту закрытия формы, перевыборы внутри сессии не учитываем
    * %%to_c%% - изменялся текущий выбор в пользу папки коллекций;
    * %%to_b%% - изменялся текущий выбор в пользу папки букмарок;
  * %%title%%
    * %%1%% - (число изменений) тайтл изменился, нажали "готово" при редактировании;
  * %%fullview%% - пользователь в полный режим форму;
    * %%1%% - (Факт, что делалось за сессию) нажимался контрол разворачивания в полную форму;
  * %%view_expand%% - пользователь развернул коллекции;
    * %%1%% - (число действий)
  * %%other_b%% - пользователь нажал на "Выбрать другую папку";
    * %%1%% - (число действий)
  * %%new_c%% - пользователь нажал на кнопку создания новой коллекции;
    * %%1%% - (число действий)
  * %%change_login%%
    * %%1%% - пользователь нажал "Войти под другим пользователем";
  * Состояние флажка на момент открытия (красный или серый)
    * %%status_before_add%%
      * %%0%%-не добавлено в избранное,
      * %%1%%-было добавлено в избранное (редактирование),
  * Урл - %%u%%, значение url (логируем так же как принято логировать url везде, ну т.е. с обрезанием лишних данных)
  * Состояние формы: развернуто или свернуто на момент открытия
    * %%form_mode%%, значения:
      * %%0%%-краткая форма,
      * %%1%%-полня форма,
  ||
|#

%%client_id: settings%% - точка входа в Яндекс.Коллекции
* %%favorites%%
  * %%btn on%% - пользователь выключил кнопку коллекций рядом с "+"
  * %%btn off%% - пользователь выключил кнопку коллекций рядом с "-"
  * %%image btn on%% -  пользователь включил кнопку на картинках;
  * %%image btn off%% -  пользователь выключил кнопку на картинках;
* %%favorites bmk ex%%
  * %%on%% - пользователь включил экспорт закладок;
  * %%off%% - пользователь выключил экспорт закладок;
  * %%login%% -  пользователь нажал на "Войти";
  * %%clear dat%% - пользователь очистил переданные данные;


===Защита от плохих скриптов в расширениях

%%client_id: tpm_check%%

ID - id эктсеншна, скрипт которого отправляем в ручку

a_SCRIPT:
- upload - по факту отправки скрипта в ручку
- no_upload - по факту прохождения проверки "скрипт был проверен ранее и помечен в профиле как хороший"
- COUNT - количество данных, которые совпали с маской из json

a_VERDICT:
- good - по факту получения положительного вердикта от ручки
- bad - по факту получения отрицательного вердикта от ручки (в случае, если эксперимент %%tpm/2%%, то это фактически удаление эктсеншна)
- unknown - по факту получения UNKNOWN

a_DIALOG:
- show - по факту показа балуна из бутерброда
- close - по факту закрытия балуна
- yes - по факту включения расширения
- yes2 - по факту включения расширения и отправки информации


===HTTPS Everywhere
Бандл: %%https_ew%%

%%redirect: url%% - в момент, когда сайт открытый по http возвращает 302/301 на тот же сайт, но https, где %%url%% - адрес сайта
%%interstitial: url%% - в момент показа interstitial страницы с доменом, правилом, которое сработало и решением юзера, где %%url%% - адрес сайта
--%%history: url%% - в момент, когда браузер зашел на https сайт, а в хистори есть он же, но с http протоколом. Не более 1 раза на сайт в пределах сессии браузера, где %%url%% - адрес сайта в --
%%frame: url%%в момент, когда загружена http страница, а на ней есть ссылки, фреймы или формы с URL этого же сайта, но https, где %%url%% - адрес сайта, на котором есть фрейм
%%hsts: url%% - в момент получения HSTS-заголовка от сайта, которого нет в нашем конфиге, где %%url%% - адрес сайта

===Утилита лечения в браузере (client_id : rescuetool)
* show - показ балуна с приглашением полечится
* clk_start - 1, если нажали лечить в тихом режиме и 2, если с GUI
* clk_close - 1, если закрыли нажатием на [Не сейчас], 2 если закрыли нажатием на крестик
* clk_forcestart - клик по кнопке лечения из настроек
* clk_dreport - клик по ссылке с отчетом детекта
* clk_help - клик по хелпу с описанием угроз
* switch_silent - 1, если в настройках сменили режиме на тихий и 2, если в настройках сменили его на GUI

===Работа в фоновом режиме
BROWSER-88765
**client_id: backgroundmode**

**a_disable_from** - шлем при выключении настройки "разрешать приложениям работать в фоновом режиме после закрытия браузера"
* %%tray_menu%% - если отключили через настройку в меню, вызываемом из иконки браузера в трее
* %%settings%% - если отключили через настройку на странице %%browser://settings%%

**enable_backgroundmode**
* %%1%% - если фичу включили при отжатой галочке на странице %%browser://settings%%

Статусную статистику раз в 4 часа о состоянии этой настройки у пользователя:
**a_backgroundmode_status**
* %%on%% - если фича включена
* %%off%% - если фича выключена

**a_push_autostart**
* %%push%% - шлем при автозапуске браузера в фоне на старте ОС при наличии только пуш подписки
* %%ext%% - шлем при автозапуске браузера в фоне на старте ОС при наличии только фонового расширения
* %%pushext%% - шлем при автозапуске браузера в фоне на старте ОС при наличии пуш подписки и фонового расширения

===Эксперименты с автозапуском
https://st.yandex-team.ru/BROWSER-89088


**client_id: autolaunch**

**a_chng_setting** - шлем при выключении настройки "Запускать Браузер при включении компьютера"
* %%off%% - если отключили через настройку на странице %%browser://settings%%*
* %%on%% - если включили
* %%always%% - если переключили с "при завершении работы" на "всегда"
* %%restart%% - если переключили с "всегда" на "при завершении работы"

**baloon_show**
* %%1%% - показ балуна opt-out

**a_baloon_clck**
* %%ok%% - закрытие по ок
* %%missclck%% - закрытие балуна мискликом
* %%open_settings%% - переход в настройки в зависимости от варианта

Статусную статистику раз в 4 часа о состоянии этой настройки у пользователя:
**a_autolaunch_status**
* %%on_restart%% - если фича включена с настройкой "если он был открыт при завершении работы"
* %%on_always%% - если фича включена с настройкой "всегда"
* %%off%% - если фича выключена

При срабатывании автозапуска на старте шлем факт события
**a_autolaunch_started**
* %%restart%% - автозапуск при настройке "при завершении работы"
* %%always%% - автозапуск при настройке "всегда"



===Кнопка Найти на НТП
На С++ шапке размещаем кнопку Найти-Перейти в новом табе и в режиме дна.
Делаем для вин,мак, линукс.
https://st.yandex-team.ru/BROWSER-83756

Client id %%Searchbutton%%
* %%ShowSearchButton%% - Факт показа кнопки Найти
* %%ClickSearchButton%% - Факт клика в кнопку найти
* %%ShowGotoButton%% - Факт показа кнопки Перейти
* %%ClickGotoButton%% - Факт клика в кнопку Перейти

Clien id %%Searchness%%
* в нем %%SearchnessHint%%
* при показе полной отправляем %%showfull%%
* при показе сокращенной отправляем %%showsmall%%

===Проверка расширений с помощью install_verifier
https://st.yandex-team.ru/BROWSER-76230
%%client_id = ExtInstallVerifier%%

Собираем в статистику ответы от %%googleapis.com%%.

Поля:
* %%action=response%%
* %%mode%% - режим работы %%InstallVerifier%%, возможные значения:
  * %%bootstrap%% - запрашивать сигнатуры, но не реагировать
  * %%enforce%% - запрашивать сигнатуры и реагировать
  * %%enforce_strict%% - аналогично enforce, плюс запрещается разблокировать расширения, если у %%InstallVerifier%% ещё нет решения по нему (сигнатура не пришла || id неизвестен).
* %%success%% - успешным ли был запрос - 0 или 1.
* Для каждого разрешённого расширения (если %%success == 1%%):
%%ext_id_1=1%%
%%ext_id_2=1%%
%%ext_id_3=1%%
...
* Для каждого запрещённого расширения (если %%success == 1%%):
%%ext_id_1=0%%
%%ext_id_2=0%%
%%ext_id_3=0%%
...
* %%expire_date%% - дата, когда сигнатура протухнет в формате YYYY-MM-DD (если %%success == 1%%) - опциональное поле, может отсутствовать при %%success == 1%% из-за бага в хромиуме.


----
**UPD 1:**
удалил поле (%%timestamp%% - таймстэмп, когда сигнатура была обсчитана локально (если %%success == 1%%)) у %%action=response%%, т.к. тестировать его сложно, а полезной нагрузки оно не несёт.

**UPD 2:**
При тестировании откопали в хромиуме баг, что в режимах %%enforce%% && %%enforce_strict%% свежеустановленное расширение не включается после его проверки install-verifier-ом. Т.к. в этом случае мы корректно не можем отправлять статистику по блокировкам / разблокировкам, а чинить баг мы пока что не хотим (в ближайшее время будем включать только режим bootstrap), то удалил статистику по блокировкам / разблокировкам.

**UPD 3:** (от 21.06.2018)
Из-за хромиумного бага https://crbug.com/854951 поле %%expire_date%% придётся сделать необязательным.


===Запинивание популярных сайтов

**client_id: poppin**

BROWSER-89912


====Событийное

**Показ балуна**
Событие: %%bubble_show%%

Значение - json следующего формата
%%(json){
    url: строка - урл, на котором был показан балун. обрезать, если длинна урла больше 1000
    number: число - номер показа !!для данного сайта!!
    checkbox_state: 0 или 1 - проставлена галочка "закрепить на панели задач"
    !!weight: число - вес сайта, для которого показан балун!!
}%%

**Действие с балуном**
Событие: %%bubble_action%%

Значение - json следующего формата
%%(json){
    url: строка - урл, на котором был показан балун. обрезать если длинна урла больше 1000
    number: число - номер показа !!для данного сайта!!
    checkbox_state: 0 или 1 - проставлена галочка "закрепить на панели задач" при показе
    !!weight: число - вес сайта, для которого показан балун!!

    checkbox_last_state: 0 или 1 - проставленали галочки при действии с балуном
    title_change: 0 или 1 - изменение названия для ярлыка

    action: строка - действие с балуном
        - add - нажали "добавить"
        - cancel - нажали "не сейчас"
        - close - закрыли балун крестиком
        - miss_click - закрыли мисскликом
        - help - нажали на хелп
}%%


**Автоматическая отмена показа балуна**
При некоторых условиях балун перестается показываться, нужно залогировать этот факт.

//Отмена показа балуна на сайте://
Отсылается когда выполнено такое условие, что балун больше никогда не будет показан для этого урла.
**bubble_ban_for_url:**
* %url%  урл, для которого не балун никогда не будет показан

//Отмена показа балуна в принципе//
Отсылается когда выполнено такое условие, что балун больше никогда не будет показан для всех всех урлов.
**bubble_ban:**
* %%1%%

//Открытие урла с ярлыка//
Нужно для урлов, которые были открыты с помощью ярлыка добавить в новый параметр для csrc (https://wiki.yandex-team.ru/browser/stat/nav/)


Добавление через меню (логирование есть для факта показа диалога, но не действия с ним - {"client_id":  "settings", "params": { "IDC_CREATE_HOSTED_APP":  "1" }})


====Статусное
Урлы не которых балун больше не будет показан.
**bubble_ban_for_url_status:**
* список урлов, на которых балун больше не показывается

Факт того, что балун больше не будет показан
**a_bubble_ban_status:**
* %%1%% балун больше не будет показан на любом урле,
* %%0%% - иначе

Количество ярлыков добавленных с помощью фичи, накопительное.
Нужно статусно отправляться кол-во добавленный ярлыков. Начинает отправляться когда есть хотя бы 1 добавленный ярлык.
Если можно понять сколько ярлыков есть сейчас, то нужно отправлять это значение, если нет, то нужно отправлять накопленное кол-во добавленных ярлыков
**shortcut_added_cnt:**
* %n% - кол-во ярлыков


Фича включена/ выключена в настройках (если будет)
Сейчас не предусмотрено, но стоит учесть для будущего

===Добавление папки - обучение

**clientid: folder_edu**

**a_F:**
* %%si%% - в случае отработки фичи в тихом режиме (по факту добавления папки в табло и (опционально) добивки табло)
* %%ed%% - в случае отработки фичи в обычном режиме (по факту добавления папки)

**a_B:**
* %%1%% - по факту показа 1-го обучатора
* %%2%% - по факту показа 2-го обучатора

**a_C1:**
* %%1%% - по клику на согласие в первом одучаторе
* %%0%% - по клику на отказ в первом обучаторе
* %%2%% - по клику на крестик

**a_C2:**
* %%1%% - по клику на согласие во втором обучаторе
* %%0%% - по клику на отказ во втором обучаторе
* %%2%% - по клику на крестик

===Портальный виджет
**client_id: portal_widget**
Параметры:

#|
|| **Параметр**| **Значение**| **Описание**||
|| a_SHOW| | ||
|| | 1 | показ портального виджета||
|| a_CLICK| | ||
|| | y | при клике в портальный виджет "Зайти в Яндекс" ||
|| | m | при клике по ссылке "почта" ||
|| | w | при клике по ссылке "написать письмо" ||
|| | d | при клике по ссылке "диск" ||
|#

===Информеры на NTP
**client_id: NTP_widgets**
Параметры:

#|
|| **Параметр**| **Значение**| **Описание**||
|| a_SHOW| | показы виджетов||
|| | district | Район||
|| | weather | МЧС ||
|| | nowcast | Осадки рядом||
|| | route | Пробки||
|| | metro | Метро||
|| | traffic| Перекрытия дорог||
|| | fatal | Чрезвычайная ситуация||
|| | alert| Предупреждения о важных событиях||
|| | promo| Промо важных событий||
|| a_CLICK| | клик по виджету||
|| | district | Район||
|| | weather | МЧС ||
|| | nowcast | Осадки рядом||
|| | route | Пробки||
|| | metro | Метро||
|| | traffic| Перекрытия дорог||
|| | fatal | Чрезвычайная ситуация||
|| | alert| Предупреждения о важных событиях||
|| | promo| Промо важных событий||
|| a_close| | закрытие виджета||
|| | district | Район||
|| | weather | МЧС ||
|| | nowcast | Осадки рядом||
|| | route | Пробки||
|| | metro | Метро||
|| | traffic| Перекрытия дорог||
|| | fatal | Чрезвычайная ситуация||
|| | alert| Предупреждения о важных событиях||
|| | promo| Промо важных событий||
|#

===Sync2.0
Реализовано 2 clientid: **clientId=sync** и **client_id = signin**

====Sync 18.7.0
**clientId=sync**
 %%
 a_NoSyncWidget - Виджет без включенной синхры
    ShowMin Показ виджета в свернутом виде
    ShowMax Показ виджета в развернутом виде
    SaveClick Клик на Сохранить Данные
    ShowB Показ Закладок - единичка при показе + чиселка
    ShowP Показ Паролей - единичка при показе + чиселка
    ShowE Показ дополнений - единичка при показе + чиселка
    ClickMin Клик на свернуть виджет
    ClickMax Клик на развернуть виджет
    ClickB - клик по заголовку закладок,
    ClickP - клик по заголовку паролей,
    ClickE - клик по заголовку дополнений,
    ClickBСount - клик по каунтеру закладок,
    ClickPСount - клик по каунтеру паролей,
    ClickEСount - клик по каунтеру дополнений.
%%

%%
  a_SyncWidget - Виджет с включенной синхрой
    ShowMin Показ виджета в свернутом виде
    ShowMax Показ виджета в развернутом виде
    SetClick Клик на Настроить Синхронизацию
    ShowB Показ Закладок - единичка при показе + чиселка
    ShowP Показ Паролей - единичка при показе + чиселка
    ShowE Показ дополнений - единичка при показе + чиселка
    ClickMin Клик на свернуть виджет
    ClickMax Клик на развернуть виджет
    ClickB - клик по заголовку закладок,
    ClickP - клик по заголовку паролей,
    ClickE - клик по заголовку дополнений,
    ClickBСount - клик по каунтеру закладок,
    ClickPСount - клик по каунтеру паролей,
    ClickEСount - клик по каунтеру дополнений.

%%

%%
  a_SetWidget - Настройки виджета
    off Выключение через настройки
    on Включение через настройки
%%

Задача https://st.yandex-team.ru/BROWSER-87350
+ https://st.yandex-team.ru/BROWSER-91951 - кликабельность

%%
a_bbl_bkm - баббл с показом закладок и предложением включить синхру
      show - факт показа
      sync - нажатие включить синхру
      later - нажатие на Позже
      misclick - закрытие баббла мискликом
      cross - закрытие баббла крестиком
      esc - закрытие баббла ESC
%%

%%
a_bbl_psw - баббл с показом паролей и предложением включить синхру
      show - факт показа
      sync - нажатие включить синхру
      later - нажатие на Позже
      misclick - закрытие баббла мискликом
      cross - закрытие баббла крестиком
      esc - закрытие баббла ESC
%%

%%
a_bbl_ext - баббл с показом экстеншенов и предложением включить синхру
      show - факт показа
      sync - нажатие включить синхру
      later - нажатие на Позже
      misclick - закрытие баббла мискликом
      cross - закрытие баббла крестиком
      esc - закрытие баббла ESC
%%

%%
a_bbl_unv - баббл с показом паролей,закладок,экстеншенов и предложением включить синхру (сборный-универсальный)
      show - факт показа
      sync - нажатие включить синхру
      later - нажатие на Позже
      misclick - закрытие баббла мискликом
      cross - закрытие баббла крестиком
      esc - закрытие баббла ESC

%%

В источник включения надо добавить from и название баббла, с которого включать синхру пошли.
%%
bbl_bkm
bbl_psw
bbl_ext
bbl_tab
bbl_unv
%%
Задача https://st.yandex-team.ru/BROWSER-88361

====Статистика показа дзена/морды на НТП - 18.9.0
client_id:ntp_rich
params:
a_rich_type = (тут пишем урл который вставляется в страницу, например, brozen.yandex.ru или zen.yandex.ru/yabro3)
a_rich_settings = enable | disable - включен/выключен урл вставки (настройка всегда будет одна). Если a_rich_settings = disable, то другая статистика не отправляется.
a_way_(урл который вставлен в страницу) = immediate (дзен или другая страница показалась сразу) | delayed (дз.и.д.с. появилась на глазах пользователя) | never (д.и.д.с не появилась)
info_(урл который вставлен в страницу) - текстовое значение переданное д.и.д.с в ручку из п.2
timing = время через сколько показался д.и.д.с timestamp
error_info = ошибка, т.е. либо текстовое значение переданное д.и.д.с в ручку из п.1,
a_error_type = чего не хватило С++ для показа страницы
Валидация
Аудитория и число посылок a_close (client_id=ntp) должна быть равна и a_rich_settings и a_rich_type
Аудитория и число посылок a_rich_settings=*enable должна быть равна и a_way_(урл который вставлен в страницу) и info_(урл который вставлен в страницу)
Аудитория и число посылок a_way_(урл который вставлен в страницу)=never должна быть равна a_error_type

https://st.yandex-team.ru/BROWSER-89997

==== Статистика нагрузки на морду - 18.7.0
1. **ntp-ddos-default** - Отсылается каждые 10 минут

%%{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:03:37.333 UTC"}}
{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:13:37.348 UTC"}}
{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:23:37.360 UTC"}}
{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:33:37.372 UTC"}}
{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:43:37.386 UTC"}}
{"client_id":"morda","params":{"idle_num":"default","timestamp":"2018-08-08 09:53:37.398 UTC"}}
%%

2. **ntp-ddos-sys-idle** - Отсылается каждые 10 минут, вне зависимости взаимодействовали ли мы с системой или нет.
%%{"client_id":"morda","params":{"idle_num":"system_idle","timestamp":"2018-08-08 10:18:19.315 UTC"}}
{"client_id":"morda","params":{"idle_num":"system_idle","timestamp":"2018-08-08 10:28:19.327 UTC"}}
{"client_id":"morda","params":{"idle_num":"system_idle","timestamp":"2018-08-08 10:38:19.340 UTC"}}
%%

3. **ntp-ddos-user-input** - Отсылается только когда не взаимодействую с браузером
%%{"client_id":"morda","params":{"idle_num":"browser_input_idle","timestamp":"2018-08-08 10:55:56.296 UTC"}}%%

4. **ntp-ddos-inactive** - отсылается только в случае если я совсем не трогаю ничего)
Уходит статистика вида - %%{"client_id":"morda","params":{"idle_num":"browser_inactive","timestamp":"2018-08-08 13:03:39.612 UTC"}}%%

https://st.yandex-team.ru/BROWSER-88653

====Статистика виджета на НТП - 18.10.0

====Подробная воронка включения синхронизации 18.7.1
**Статистика отправляется с client_id = "signin"**
Статистика отправляется при переходе с одного этапа на другой.
Имя параметра - точка входа с которой пользователь попал на страницу входа.
Для того чтобы Statface сделано разбиение по значению параметра к имени параметра добавляется "a_".

%%
Основные точки входа:
a_bbl_prtl - балун с приглашением войти в синхронизацию по логину на портале,
a_bbl_unv - балун с приглашением войти в синхронизацию по накоплению данных,
a_menu_widget - виджет в меню бутерброда,
a_settings - страница настроек,
a_infobar - инфобар предлагающий войти в синхронизацию после логина на портале.
%%

Значение параметра - строка состоящая из имени предыдущего этапа и нового этапа.
%%
Этапы входа в синхронизацию.
none - начальное состояние,
begin - пользователь активировал точку входа,
confirm - отображается страница: включить синхронизацию с текущим аккаунтом,
login - отображается страница: введите пароль,
login_error - отображается страница: введите пароль с ошибкой входа,
registration - отображаются шаги регистрации нового пользователя,
password_restore - отображаются шаги восстановления пароля,
passport - отображаются другие страницы паспорта,
social - пользователь выбрал вход в синхронизацию через аккаунт социальной сети,
initialization - для пользователя успешно получен токен синхронизации и началась первичная инициализация бэкенда,
disk_install - отображается внутренняя страница disk-install (пока она отображается процесс вход в синхронизацию приостановлен),
configuration - получение первичных данных с сервера и объединение их с локальными данными,
restart - пользователь активировал другую точку входа до завершения входа в синхронизацию,
closed - пользователь закрыл окно включения синхронизации,
signed_out - пользователь вышел из синхронизации до завершение первичного слияния,
started - синхронизация была успешно включена.

%%
Шаги restart, closed, signed_out, started терминальные, то есть на них процесс входа в синхронизацию прекращается и переходит в состояние none.

%%При обычной последовательности входа получим такую цепочку:
none-begin
begin-login
login-initialization
initialization-disk_install
disk_install-configuration
configuration-started
%%

%%
При входе с регистрацией:
none-begin
begin-login
login-registration
registration-initialization
initialization-disk_install
disk_install-configuration
configuration-started
%%

%%
При выборе другой точки входа получим:
none-begin
begin-login
login-restart
%%

====Статусная статистика включения синхронизации и логина на портале 18.7.1
**Время отправки для каждого клиента:**
 Если не было отправки за последние 4 часа, то отправить статусное событие.
 **Авторизация в синхре client_id = "signin"**

%%
enabled - 1, если включена
a_enabled_source - отправляется, если включена синхра, говорит об источнике включения синхры:
main_widget - виджет в меню бутерброда
bbl_bkm - баббл закладочный
bbl_psw - баббл парольный
bbl_ext - баббл экстеншенов
bbl_unv - универсальный баббл (закладки, пароли, экстеншены)
settings - настройки бро
act - активация
%%

**Авторизация на портале client_id = "signin"**
enabled_portal - отправляется единичка, если залогинен на портале
с валидацией куки + паспортный uid
Задача - https://st.yandex-team.ru/BROWSER-89695

====yaPushes

client_id: yapushes

**recieved** - параметр, который показывает, что пуш был получен клиентом (sw)
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа)), который был получен клиентом
**displayed** - параметр, который показывает, что пуш был отображен клиентом
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа))
**ignored** - параметр, который показывает, что пуш был проигнорирован пользователем и скрыт автоматически
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа))
**clicked** - параметр, который показывает, что пуш был показан и пользователь кликнул в тело пуша
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа))
**menu_clicked** - параметр, который показывает, что пуш был показан и пользователь кликнул в меню
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа))
**closed** - параметр, который показывает, что пуш был показан и пользователь закрыл его крестиком
* %%%push_id%%% - значение ((https://st.yandex-team.ru/BROWSER-94351#1538508929000 push_id от СУПа))

===Алиссенджер
====Боковая панель и Алиса
**clientId=alice_flute_new**
 %%
 a_flute - статистика Флейты
    show - случай показа флейты при незапиненной флейте
    fix - факт, сообщающий о том, что флейта запинена
    pin_flute - факт запина флейты кликом в кнопку в табстрипе
    unpin_flute - факт распина флейты кликом в иконку в табстрипе
    settings_off - факт выключения флейты в настройках
    settings_ntponly - факт выбора запинить только на НТП в настройках
    settings_unpinall - факт выбора незапина флейты на всех страницах, включая НТП, в настройках
    settings_pinall - факт выбора запина флейты на всех страницах в настройках
    cmenu_off - факт выключения флейты в контекстном меню
    cmenu_ntponly - факт выбора запинить только на НТП в контекстном меню
    cmenu_unpinall - факт выбора незапина флейты на всех страницах, включая НТП, в контекстном меню
    cmenu_pinall - факт выбора запина флейты на всех страницах в контекстном меню
    status_off - статус: флейта отключена (статусные параметры можно отправлять раз в 5 часов)
    status_ntponly - статус: флейта запинена только на НТП
    status_unpinall - статус: флейта незапинена на всех страницах, включая НТП
    status_pinall - статус: флейта запинена на всех страницах
    bookmarks - клик в закладки
    history - клик в историю
    services - клик в сервисы
    bookmarks_choice - клик в закладку в вебвью закладок
    history_choice - клик в урл истории в вебвью истории
    services_choice - клик в сервис в вебвью сервисов
    voice_on - статус, ГА включена нами, по умолчанию
    voice_off - ГА выключена нами, по умолчанию
    voice_on_user - ГА включена руками пользователя
    voice_off_user - ГА выключена руками пользователя
    background - браузер работает в фоне
 a_alice - статистика Алисы
    click - клик в иконку Алисы
    s_click - клик в скилл
    voice_act - активация голосом
    text - отправка запроса текстом
    text_choice - выбор варианта продолжения диалога, предложенного Алисой в своем ответе
    voice - отправка голосового запроса
    store - клик в стор
 a_webview - статус поднятия вебью
    on_bro - вебвью поднят c внутренней страницей
    on_app - вебвью поднят с вебаппом
    off - вебвью погашен
 %%
====Рекомендации от Алисы
%%
 a_video - статистика видеорекомендаций
    show - случай показа рекомендации
    empty - рекомендации для видео нет
    should_show - условия для показа были выполнены, не важно, показали мы рекомендацию, или нет
    click - клик в любое видео из карточки с рекомендациями
    close - закрытие рекомендаций
    decline - пользователь воспользовался возможностью отложить рекомендации
 %%
====Мессенджер
Будем логировать со стороны мессенджера

===Параметры экрана (screen)

**client_id = screen**
Параметры:
display_count - количество мониторов;
display_height - высота экрана (расчетное значение с учетом display scale factor, выставленное у пользователя значение = display_height/display_scale-factor);
display_scale - соотношение сторон экрана (<ширина>:<высота>);
display_scale-factor - системное масштабирование (win);
display_width - ширина экрана (расчетное значение с учетом display scale factor, выставленное у пользователя значение = display_width/display_scale-factor);
is_maximized - браузер в режиме максимайза (truealse);
tab_height - высота шапки в пикселях
type - тип отправки статистики:
* ntp - при открытии ntp;
* time - раз в 4 часа или при запуске браузера;
window_height - ширина окна (для статусной статистики ("type":"time") - последнего активного окна);
window_left - координата верхнего левого угла по горизонтали;
window_top - координата верхнего левого угла по вертикали;
window_width - высота окна (для статусной статистики ("type":"time") - последнего активного окна);

===Сайты с манифестами для табла

**client_id = site_manifest**
Отправляется при первом переходе пользователя на страницу, которая содержит манифест для тумбы табла.
https://wiki.yandex-team.ru/browser/tz/tableau/customwidgets/
Параметры:
msft_emb_found - хост сайта на котором найден встроенный манифест;
msft_ext_found - хост сайта на котором найден внешний манифест;


===Морда

Каждые 4 часа должна отсылаться статистика о состоянии настроек.

**client_id**: %%browser_prefs%%

* %%a_zen_stat%%:
  * %%1%% - отсылается, если галочка "Показывать ленту рекомендаций в новой вкладке" (Дзен) **!!(Зел)вкл!!**ючена
  * %%0%% - если **!!выкл!!**ючена
* %%a_nwte_stat%%
  * %%1%% - отсылается, если галочка "Показывать в новой вкладке погоду, новости, пробки" **!!(Зел)вкл!!**ючена
  * %%0%% - если **!!выкл!!**ючена

===Рост залогинов в десктопном браузере
Добавляем новые параметры в **client_id**: %%yalogin%%

* %%a_soc_balloon%% - статистика балуна предложения синхры через соц логин. Значения:
  * %%show%% - факт показа балуна
  * %%cancel%% - отказ
  * %%accept%% - соглашение
  * %%soc_broker_cancel%% - появилось окно входа соц сети, но пользователь закрыл его и отказался
* %%a_add_b_1%%
  * %%show%% - факт показа балуна
  * %%cancel%% - отказ
  * %%accept%% - соглашение
  * %%login%% - факт успешного залогина
*  %%a_add_b_2%%
  * %%show%% - факт показа балуна
  * %%cancel%% - отказ
  * %%accept%% - соглашение
  * %%login%% - факт успешного залогина

===Передача управления закладок коллекциям. Залогиновые закладки.
Добавляем новые параметры в **client_id**: %%favorites_login%%

* %%a_balloon%% - статистика балуна предложения залогиниться для управления закладками. Значения:
  * %%show%% - факт показа балуна
  * %%cancel%% - отказ
  * %%accept%% - соглашение
  * %%zalogin%% - факт успешного залогина
* %%a_balloon_source%% - причина показа балуна. Значения:
  * %%bookmarks_bar%% - попытка редактировать закладки из панели закладок
  * %%menu%% - из главного меню
  * %%icon%% - клик по иконке в омнибоксе
  * %%manager%% - из диспетчера закладок

===Управление музыкой
===="client_id":"music_control"====
%%a_action%% - статистика балуна с плеером. Значения:
* %%next%% - клик на "Вперёд"
* %%prev%% - клик на "Назад"
* %%play%% - клик на "Играть"
* %%pause%% - клик на "Пауза"
* %%artist%% - клик на "Исполнитель"
* %%track%% - клик на "Название"
* %%cover%% - клик на "Обложку альбома"
* %%host_icon%% - клик на "Источник"
* %%sound_value%% - клик на "Громкость"
* %%mute%% - клик на "Выключить звук"

%%с_active_ac%% - кол-во активных вкладок в аудио контентом
%%domain%% - домен на котором включена музыка, отображающаяся в балуне
%%a_show_type%% - какой тип балуна был показан. Значения:
* %%promo%% - после нажатия пользователем в иконку на БП, ему был показан промо-балун
* %%active%% - после нажатия пользователем в иконку на БП, ему был показан балун с музыкой (активным источником)
* %%education%% - показ балуна обучения во время включения трека на одном из хостов с музыкой

===="client_id":"track_info"====
%%info_host%% - хост
%%info_artist%% - исполнитель
%%info_name%% - название трека


===Чтение вслух ("client_id":"alice_reader")
%%a_button%% - статистика кнопки в омнибоксе
* %%show_violet%% - показали развернутую фиолетовую кнопку
* %%show_grey%% - показали развернутую серую кнопку
* %%show_hf%% - показали обычную кнопку наушников
* %%click_violet%% - клик в развернутую фиолетовую кнопку
* %%click_grey%% - клик в развернутую серую кнопку
* %%click_hf%% - клик в обычную кнопку наушников
* %%click_pause%% - чтение остановлено кликом в иконку

%%a_promo%% - статистика промо
* %%show%% - показали промо
* %%click%% - клик в промо
* %%close%% - закрыли промо

%%a_reader%% - срабатывание чтения вслух
* %%voice%% - голосовой сценарий
* %%click%% - через клик в иконку в омнибоксе


===Портальный логин в боковой панели ("client_id":"panel_portal_menu")===
%%a_action%% - статистика балуна портального меню. Значения:
* %%login%% - клик в Войти
* %%loginlike%% - клик в "Войти как"
* %%loginanother%% - клик в "Войти с другим аккаунтом"
* %%createac%% - клик в Создать аккаунт
* %%social%% - клик в Соцсети
* %%avatar%% - клик в Аватарку или логин
* %%moreavat%% - клик в другие логины
* %%mail%% - клик в Почту
* %%disk%% - клик В Диск
* %%ugcpub%% - клик в Мои отзывы
* %%collections%% - клик в Коллекции
* %%notes%% - клик в Заметки
* %%pasport%% - клик в Паспорт
* %%synchronization%% - клик на Шестерёнку
* %%bookmarks%% - клик на Закладки
* %%passwords%% - клик на Пароли и карты
* %%tune%% - клик на Дополнения
* %%safedata%% - клик на Сохранить данные
* %%moreprof%% - клик в другие профили

%%a_type_show%% - статистика типа балуна портального меню. Статистику отправляем спустя 1 секунду бездействия после последнего обновления данных. Значения:
* %%logsync%% - Пользователь залогинен и засинхронизирован
* %%lognsync%% - Пользователь залогинен и не засинхронизирован
* %%nlogsync%% - Пользователь не залогинен и засинхронизирован
