# tap-tanker-helpers üåç

–ü–∞–∫–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—É—Ä–±–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ —Å–ª–µ–¥—É–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
```bash
npx lerna add @yandex-int/tap-tanker-helpers --scope=<package-name>
```
–≥–¥–µ `<package-name>` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞, –∫—É–¥–∞ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `tap-tanker-helpers`.

–í –ø—Ä–æ–µ–∫—Ç–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `tap-tanker-helpers`, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—É `tanker-kit`

```bash
npm i tanker-kit --save-dev --registry http://npm.yandex-team.ru
```

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ `tanker-kit` –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É –∏–º–µ–Ω–∏ tanker, –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç `tanker-cli`. –ü–∞–∫–µ—Ç `tanker-cli` - —ç—Ç–æ —Ö–µ–ª–ø–µ—Ä, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π `grunt-cli`, `bem-cli` –∏ –¥—Ä—É–≥–∏–º `cli`.

```bash
sudo npm i tanker-cli -g --registry http://npm.yandex-team.ru
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Readme tanker-kit](https://github.yandex-team.ru/search-interfaces/frontend/blob/master/packages/tanker-kit/README.md)

- [Wiki tanker-kit](https://wiki.yandex-team.ru/search-interfaces/tanker/tanker-kit/)

- [Wiki —Ç–∞–Ω–∫–µ—Ä–∞](https://wiki.yandex-team.ru/NikitaBrovikov/tanker/translator/)

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–∞–Ω–∫–µ—Ä–∞](https://doc.yandex-team.ru/~infrastructure/~tanker/)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–¢–∞–Ω–∫–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç oauth-—Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫ —Å–≤–æ–µ–º—É API. –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ https://nda.ya.ru/3SjQY7. –ó–∞—Ç–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–ª—é—á –≤ `$HOME/.profile` (–∏–ª–∏ `.bash_profile`, –µ—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ), –¥–æ–±–∞–≤–∏–≤
`export TANKER_API_TOKEN="OAuth —Ç–æ–∫–µ–Ω –¥–ª—è –¢–∞–Ω–∫–µ—Ä–∞"`.

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É `.tanker` –∏ —Å–æ–∑–¥–∞—Ç—å –≤ –Ω–µ–π —Ñ–∞–π–ª `config.js`. –ü—Ä–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç–∞–Ω–∫–µ—Ä–∞ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://github.yandex-team.ru/search-interfaces/frontend/blob/master/packages/tanker-kit/README.md).

–ü–∞–∫–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `getI18nKeys` –∏ `extractI18NKeysFromSourceFile`.

_–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `getI18nKeys`_
```ts
const tanker = require('tanker-kit');
const { getI18nKeys } = require('@yandex-int/tap-tanker-helpers');

module.exports = function dispatch(arg) {
    const config = arg.info.config;

    return tanker
        .find(config)
        .then(paths => tanker.parse(paths, config))
        .then(parsedKeys => getI18nKeys(parsedKeys, arg.data));
};
```

–§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤.

_–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `extractI18NKeysFromSourceFile`_
```ts
module.exports = function({ data: content, path: filePath }) {
    const keys = extractI18NKeysFromSourceCode(content, path.basename(filePath), ['i18n']);
    const keyset = path.dirname(filePath);

    return keys
        .map(key => {
            const { name, range, params, context, value } = key;
            const keyAdapter = {
                type: 'bem',
                hash: getHash(key, filePath),
                path: filePath,
                range,
                upload: null,
                single: (isString(keyset) && isString(name)) || null,
                keyset,
                key: isString(name) ? name : null,
                value: value,
                comment: '',
                context: context || '',
                plural: null,
                params: Array.isArray(params)
                    ? params.reduce(function(acc, param) {
                          return Object.assign({}, acc, param);
                      }, {})
                    : false,
            };

            return { key: keyAdapter };
        })
        .map(({ key }) => {
            if (key.context) {
                key.params = { context: key.context };
            }

            return key;
        });
};
```

–§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `i18n` –≤ –ø—Ä–æ–µ–∫—Ç–µ —Å —Ü–µ–ª—å—é –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∫–ª—é—á–µ–π –≤ —Ç–∞–Ω–∫–µ—Ä.

–ü–æ—Å–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `tanker pull`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Ç—è–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –∏–∑ —Ç–∞–Ω–∫–µ—Ä–∞ –∏ —Ä–∞–∑–ª–æ–∂–∏—Ç –ø–æ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ä—è–¥–æ–º —Å –º–µ—Å—Ç–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏.

_–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–∞–Ω–∫–µ—Ä–∞ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ tanker-kit](https://github.yandex-team.ru/search-interfaces/frontend/blob/master/packages/tanker-kit/README.md)._

## –ó–∞–∫–∞–∑ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

- –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥–∏ [TRANSLATE](https://st.yandex-team.ru/TRANSLATE)
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É
- –£–∫–∞–∑–∞—Ç—å –¥–µ–¥–ª–∞–π–Ω 2 –¥–Ω—è
- –î–æ–∂–¥–∞—Ç—å—Å—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∫–æ–º–∞–Ω–¥—É `tanker pull`, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Ç—è–Ω–µ—Ç –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã

## –¢–∞–Ω–∫–µ—Ä
–ö–ª—é—á–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [–¢–∞–Ω–∫–µ—Ä–µ](https://tanker.yandex-team.ru/).
