# Contribution Guide

Как передать свой код в библиотеку `tap-components`.

Библиотека открыта для:

- исправления ошибок;
- добавления новой функциональности существующим компонентам;
- добавления новых компонентов;
- внесения исправлений и дополнений в тесты и документацию.

Для передачи кода в библиотеку блоков `tap-components` рекомендуем
ознакомиться с [поддерживаемыми платформами](./README.md#поддерживаемые-браузеры).

## Вопросы и предложения

Для обсуждения вопросов - приходить в чат [в телеграмме](https://t.me/joinchat/B9JKrh10uhBanJDBoYywmA).


## Разработка

- Рекомендуем называть ветку разработки в формате `<username>[.<keywords>].<TICKET-1234>`.
  Например: `sapfear.products.TAP-1027`, `nodge.modals.TAP-1234`.
- Описания коммитов необходимо заполнять в соответствии c [Conventional commits](https://www.conventionalcommits.org/en/)


## Codestyle

Как мы пишем:

- новый код пишем на TypeScript
- все компоненты, в первую очередь, поддерживают Touch-платформу
- для CSS используем pure-css с неймингом по [BEM в стиле React](https://ru.bem.info/methodology/naming-convention/#стиль-react)
- модификаторы пишем с помощью [@bem-react/core](https://github.com/bem/bem-react/tree/master/packages/core#usage)
- react-компоненты - в functional стиле
- внутри компонентов используем хуки
- по необходимости дописываем свои [хуки](https://github.yandex-team.ru/search-interfaces/frontend/blob/master/packages/tap-components/src/hooks/)

На что ориентируемся:

- код не должен использовать никаких внутренних библиотек и сервисов, так как весь код библиотеки выкладываться на внешний Github
- весь код должен уметь выполняться на клиенте (без SSR)
- код должен приемлемо работать на медленном устройстве/медленном интернете
- если необходимо, пишем сразу скелетон компонента для отображения во время загрузки кода/данных
- желательно писать простой код, для возможности выложить наружу
- сторонние библиотеки должны быть легкими, помним о mobile-специфике. Лицензия - желательно MIT.

## Новый компонент

Добавление нового компонента можно разбить на 2 части - RFC-этап и написание кода.
На RFC-этапе описывается документация нового компонента в README.md ([пример PR](https://github.yandex-team.ru/search-interfaces/frontend/pull/8460)).
В него входит:

- Описание компонента и его задач
- Список CSS-переменных для кастомизации верстки
- Список props и принцип их работы
- Пример кода с использованием компонента

При добавлении кода нового компонента, необходимо

- Создать Storybook-файл
  - Свойства компонента необходимо сделать кастомизируемыми через [`@storybook/addon-knobs`](https://www.npmjs.com/package/@storybook/addon-knobs)
  - Обработчики компонента необходимо сделать логируемыми через [`@storybook/addon-actions`](https://www.npmjs.com/package/@storybook/addon-actions)
  - Необходимо дать возможность поменять CSS-свойства компонента (также через [`@storybook/addon-knobs`](https://www.npmjs.com/package/@storybook/addon-knobs), [пример](https://github.yandex-team.ru/search-interfaces/frontend/blob/master/packages/tap-components/src/components/CartProductItem/CartProductItem.examples.tsx#L39)
- Написать код и стили
  - Для интеграции CSS используется [@bem-react/classname](https://github.com/bem/bem-react/tree/master/packages/classname)
  - Нейминг классов по [BEM React](https://ru.bem.info/methodology/naming-convention/#стиль-react) className naming convention
- Актуализировать README.md
  - Пример компонента в виде Storybook
  - Пример скелетона (если есть) в виде Storybook

## Пулл-реквесты

Если вы что-то исправили или добавили в библиотеку `tap-components`, вы можете отправить пулл-реквест. Он будет рассмотрен мейнтейнерами и, либо принят, либо прокомментирован для дальнейшей доработки, либо отклонен.

- В случае принятия нового блока, к ревью могут привлекаться эксперты из сервисов
- Общение ведется в комментариях к задаче или на странице PR, если
  необходимо комментировать код
- Выполняется функциональное и регрессионное тестирование блоков, которых касаются
  вносимые в библиотеку изменения
- При возникновении замечаний или багов, обнаруженных при тестировании, задача
  возвращается на доработку
- Исправления добавляются коммитом, при необходимости снова сделайте `rebase` от
  соответствующей ветки
- О внесенных исправлениях сообщайте назначенным ревьюверам
- Результатом выполненного ревью является `merge` пулл-реквеста

## Контрольный список принятия PR

1. Отсутствуют отклонения от дизайнерского гайда.
2. Внесены соответствующие изменения в документацию.
3. Изменения покрыты тестами:
  - unit-тесты
  - тесты hermione
5. Имеются примеры для проверки новой функциональности.
5. Картинки (png, svg, jpg и т.п.) оптимизированы.
6. Изменения протестированы.

## Ошибки

Если вы нашли ошибку, недочет, опечатку, дефект в библиотеке - пожалуйста, сообщите об этом или создайте PR с исправлением.
И, да, чем подробнее вы опишите ошибку, тем быстрее её смогут воспроизвести и исправить, и тем больше ментейнеры будут вам признательны :)
К сожалению, неизбежны ситуации, когда ошибка будет воспроизводиться только на вашем проекте или в вашем окружении. В этом случае мейнтейнер не сможет вам помочь. В таких случаях, мы будем верить, вы сами сможете найти нужное исправление и со временем предложить ментейнеру фикс.