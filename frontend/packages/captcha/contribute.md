# Разработка

## CLI команды

**Установка зависимостей:**

```sh
npm ci
```

**Запуск storybook:**

```sh
npm start
```

**Сборка и запуск hermione:**

```sh
npm run hermione:build
npm run hermione:gui
```

**Сборка проекта:**

```sh
npm run build
```

## Переводы

Переводы хранятся в [Танкере капчи](https://tanker.yandex-team.ru/project/external-yacaptcha/keyset/Captcha), для их синхронизации необходимо получить персональный OAuth токен, это можно сделать по ссылке [nda.ya.ru/3SjQY7](https://nda.ya.ru/3SjQY7).

### Синхронизация переводов

**Внимание!** Локальные файлы с переводами, вроде `Captcha.i18n/en.tsx`, всегда перезаписываются теми значениями, которые присылает Танкер.

Если какой-то перевод есть в локальном файле, но отсутствует в Танкере, то он будет потерян.

\
**Для синхронизации используйте эту команду:**
```sh
TANKER_API_TOKEN=токен npx tanker sync
```

или эту, если вы добавили токен в переменные окружения:

```sh
npx tanker sync
```

**Что она делает:**
- находит в коде статические i18n-ключи, например `t('not-robot')`;
- определяет имя кейсета по имени папки, откуда импортируются переводы (если переводы хранятся в папке `Captcha.i18n`, то ключи отправятся в кейсет `Captcha`);
- добавляет найденные ключи в Танкер, если там их ещё нет (в качестве значения по умолчанию будет устновленно имя ключа);
- скачивает все кейсеты и раскладывает их по папкам, указанным в `.tanker/keysets.js`.

Если i18n-ключ динмический, например ``t(`status-${status}`)``, то его вариации (`status-pending`, `status-success` и&nbsp;т.&nbsp;д.) нужно будет добавить в Танкер вручную.

### Файл keysets.js

В файле `.tanker/keysets.js` хранятся пути до папок, куда будут загружаться кейсеты.

\
**Особенности:**
- Если Танкер прислал кейсет, которого нет в `keysets.js`, то он никуда не сохранится.
- В одну папку можно складывать только один кейсет.
- Важно, чтобы конечная папка для переводов имела название в формате `имя_кейсета.i18n`.

\
**Формат `keysets.js`:**
```js
module.exports = {
  keyset_name: 'path/to/folder/keyset_name.i18n'
}
```
