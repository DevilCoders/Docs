# Сущности данных

## `ID`

Используется для идентификации всех сущностей сервиса. Тип - строка.

### Примеры
```typescript
String(121313) // числовой идентификатор, преобразованный к строке

'421a52ae-704a-51e7-a387-10f0ac34ac78' // сгенерированный uuid

'odezhda' // человекочитаемый slug
```

## `Image`

Используется для обозначения всех изображений сервиса.

### Свойства

| Свойство | Тип      | Описание                                          |
| -------- | -------- | ------------------------------------------------- |
| src      | `string` | Ссылка на изображение                             |
| src2x?   | `string` | Ссылка на версию с повышенной плотностью пикселей |

### Примеры

```typescript
{
    src: "https://cdn.example.com/1/img"
}

{
    src: "https://cdn.example.com/1/img",
    sr2x: "https://cdn.example.com/1/img2x",
}
```

## `Brand`

Бренд товара.
Используется для получения списка товаров бренда.
Список всех брендов отображается на экране каталога и экране брендов.

### Свойства

| Свойство | Тип      | Описание                                                   |
| -------- | -------- | ---------------------------------------------------------- |
| id       | `ID`     | Идентификатор бренда                                       |
| name     | `string` | Название. Отображается в интерфейсе                        |
| image?   | `Image`  | Логотип. Рекомендуется использовать png с прозрачным фоном |

### Примеры

```typescript
{
    "id": "92cf23f8-4266-52bb-bfe5-26edaa40590d",
    "name": "T.taccardi",
    "image": {
        "src": "/images/brands/92cf23f8-4266-52bb-bfe5-26edaa40590d.png"
    }
}
```

## `Category`

Категория товара. Одна категория может включать в себя несколько подкатегорий.
Есть корневая системная категория без данных, которая содержит категории 1го уровня.

Категории 1го уровня отображаются на экране каталога 1го уровня, получаются запросом за
корневой категорией `fetchRootCategory`.

Нажатие на категорию 1го уровня ведет к экрану каталога с подкатегориями этой категории и т.д.

Также категории используются как кнопки в каруселях на главном экране
и на экране категории и бренда.

### Свойства

| Свойство     | Тип       | Описание                                                       |
| ------------ | --------- | -------------------------------------------------------------- |
| id           | `ID`      | Идентификатор категории                                        |
| name         | `string`  | Название. Отображается в интерфейсе                            |
| image?       | `Image`   | Изображение. Рекомендуется использовать png с прозрачным фоном |
| parentId?    | `ID`      | Идентификатор родительской категории. Используется для построения ссылки на предыдущий уровень каталога |
| hasChildren? | `boolean` | Есть ли подкатегории. Используется для построения ссылки в каталоге: если подкатегории есть, ссылка на следующий уровень каталога, если нет – ссылка сразу на экран категории |

### Примеры

```typescript
{
    "id": "0f481ad5-b014-5bb7-afc5-7e7df0461729",
    "name": "Кроссовки",
    "image": {
        "src": "/images/categories/0f481ad5-b014-5bb7-afc5-7e7df0461729.png"
    },
    "parentId": "561ab9cb-43e8-56b0-98d1-042f035a69e1",
    "hasChildren": false
}
```

## `Attribute`

Описание какого-либо свойства сущности (например, товара, корзины или заказа).
Для товара это может быть например, цвет, размер, материал или описание.

### Свойства

| Свойство | Тип      | Описание                                     |
| -------- | -------- | -------------------------------------------- |
| id       | `ID`     | Идентификатор свойства                       |
| name     | `string` | Название свойства. Отображается в интерфейсе |

### Примеры

```typescript
{
    "id": "color",
    "name": "Цвет"
}

{
    "id": "561ab9cb-43e8-56b0-98d1-042f035a69e1",
    "name": "Размер обуви"
}

{
    "id": "gender",
    "name": "Пол"
}

{
    "id": "isSale",
    "name": "Распродажа"
}

{
    "id": "description",
    "name": "Описание"
}
```

## `AttributeValue`

Конкретное значение свойства.

### Свойства

| Свойство | Тип      | Описание                                                             |
| -------- | -------- | -------------------------------------------------------------------- |
| id       | `ID`     | Идентификатор значения свойства. Если значений неограниченное количество, может быть пустой строкой |
| name     | `string` | Текстовое представление значения свойства. Отображается в интерфейсе |

### Примеры

```typescript
// Для свойства Цвет
{
    "id": "green",
    "name": "Зеленый"
}

// Для свойства Размер обуви
{
    "id": "7955d184-4dad-573f-a94b-5617f1fcba8f",
    "name": "35"
}

// Для свойства Пол
{
    "id": "gender",
    "name": "Пол"
}

// Для свойства Распродажа
{
  "id": "yes",
  "name": "Да"
}

// Для свойства Описание
{
    "id": "",
    "name": "Замша, кожа; Материал подкладки: ткань; Материал подошвы: полиуретан"
}
```

## `AttributeWithValue`

Свойство с конкретным значением.

Используется для отображения свойств товара на экране товара, а также для фильтрации
списка товаров по какому-либо свойству.
Также используется для отображения свойств корзины и заказа.

### Свойства

| Свойство | Тип              | Описание                                     |
| -------- | ---------------- | -------------------------------------------- |
| id       | `ID`             | Идентификатор свойства                       |
| name     | `string`         | Название свойства. Отображается в интерфейсе |
| value    | `AttributeValue` | Значение свойства                            |

### Примеры

```typescript
{
    "id": "color",
    "name": "Цвет",
    "value": {
        "id": "green",
        "name": "Зеленый"
    }
}

{
    "id": "561ab9cb-43e8-56b0-98d1-042f035a69e1",
    "name": "Размер обуви",
    "value": {
        "id": "7955d184-4dad-573f-a94b-5617f1fcba8f",
        "name": "35"
    }
}
```

## `ConfigurableAttribute`

Настраиваемое свойство. Состоит из описания свойства и
списка возможных его значений, а также значения по-умолчанию.

Используется для описания фильтров и их значений, а также для настройки товара: например,
выбора размера обуви или цвета футболки.

Для атрибутов такого типа важно, чтобы возможные значения имели непустые уникальные идентификаторы.

### Свойства

| Свойство        | Тип                     | Описание                                     |
| --------------- | ----------------------- | -------------------------------------------- |
| id              | `ID`                    | Идентификатор свойства                       |
| name            | `string`                | Название свойства. Отображается в интерфейсе |
| defaultValueId? | `ID`                    | Идентификатор свойства по-умолчанию. Может быть не указан, если не нужно выставлять значение по-умолчанию |
| values          | `Array<AttributeValue>` | Возможные значения свойства                  |

### Примеры

```typescript
{
    "id": "561ab9cb-43e8-56b0-98d1-042f035a69e1",
    "name": "Размер обуви",
    "values": [
        {
            "id": "7955d184-4dad-573f-a94b-5617f1fcba8f",
            "name": "35"
        },
        {
            "id": "bf77161d-9356-5527-aaa5-7438eddcaae3",
            "name": "36"
        }
    ]
}
```

## `AttributeWithValueRequestData`

Версия `AttributeWithValue` без данных, только с идентификаторами.
Используется в вызовах методов API, чтобы не дожидаться загрузки данных.

### Свойства

| Свойство | Тип   | Описание                         |
| ---------| ----- | -------------------------------- |
| id       | `ID`  | Идентификатор свойства           |
| valueId  | `ID`  | Идентификатор значения свойства  |

### Примеры

```typescript
{
    "id": "color",
    "valueId": "green"
}

{
    "id": "561ab9cb-43e8-56b0-98d1-042f035a69e1",
    "valueId": "7955d184-4dad-573f-a94b-5617f1fcba8f"
}
```

## `Product`

Данные товара. Используется на экране товара.

### Свойства

```typescript
export type PriceRange = {
    from: number;
    to: number;
};

export type Price = string | number | PriceRange;
// цену можно указать:
// - строкой, например, "договорная"
// - числом, тогда цена указывается в копейках
// - двумя числами, в формате "от" и "до"

export type CategoryLink = {
    text: string;
    brandId?: ID;
    categoryId?: ID;
};

export enum GalleryTypes {
    Image = 'image',
}

export type GalleryImage = {
    type: GalleryTypes.Image;
    image: Image;
};

export type GalleryItem = GalleryImage;

export type ProductComponentImages = {
    addToCart?: Image;          // Используется для превью в модалке после добавления товара в корзину
    orderInfo?: Image;          // Используется для превью в компоненте `OrderInfo`
    productCardSizeS?: Image;   // Используется в карточке товара размера `s`
    productCardSizeM?: Image;   // Используется в карточке товара размера `m`
    cartItem?: Image;           // Используется в карточке элемента корзины
};
```

| Свойство                | Тип                            | Описание                                                     |
| ----------------------- | ------------------------------ | ------------------------------------------------------------ |
| id                      | `ID`                           | Идентификатор товара                                         |
| name                    | `string`                       | Название. Отображается на карточке и экране товара           |
| description?            | `string`                       | Описание товара. Отображается на экране товара               |
| image                   | `Image`                        | Изображение товара по-умолчанию. Рекомендуется использовать png с прозрачным фоном |
| componentImages?        | `ProductComponentImages`       | Переопределения `image` для разных компонентов и их размеров. Рекомендуется использовать png с прозрачным фоном |
| gallery                 | `Array<GalleryItem>`           | Галерея товара. Отображается на экране товара. Для изображений рекомендуется использовать png с прозрачным фоном |
| price                   | `Price`                        | Цена товара                                                   |
| specialPrice?           | `Price`                        | Специальная цена товара. Используется для отображения скидки на товар. Выводится рядом с перечеркнутой `price`, а также добавляет лейбл с процентным изменением цены относительно `price` |
| categoryLinks?          | `Array<CategoryLink>`          | Список ссылок на категории, связанные с товаром               |
| brand?                  | `Brand`                        | Бренд товара. Используется для создания ссылок на все товары категории и родительских категорий этого бренда с экрана товара |
| attributes?             | `Array<AttributeWithValue>`    | Свойства товара со значениями. Отображаются на экране товара  |
| configurableAttributes? | `Array<ConfigurableAttribute>` | Настраиваемые свойства товара. Отображаются на экране товара с возможностью выбрать значение свойства. Товар в корзине будет идентифицироваться по `id` товара и `id` выбранных значений атрибутов. При оформлении заказа также будут переданы выбранные свойства помимо информации о товаре. Например, можно настроить размер обуви или цвет футболки |

Также тип бренда внутри товара можно переопределить с помощью дженерик-параметра `BrandType`, который по-умолчанию равен `Brand`.

### Примеры

```typescript
{
    "id": "1c464841-afb5-5965-8909-f1360ab43936",
    "name": "Мокасины детские для мальчиков SANIANO",
    "description": "Сдержанные мокасины для мальчиков. В качестве основного материала выбрана матовая кожа. На боковых частях и верху язычка есть декоративные бархатистые вставки. Модель отличается классическим дизайном с крупными объемными швами сверху. Плоская подошва имеет рельефную поверхность. Эти мокасины подойдут для сочетания с официальными прямыми брюками и белой рубашкой.",
    "image": {
        "src": "https://avatars.mds.yandex.net/get-bklk/2789303/311c2c4814da87c9527bbdf1b7677a9a/orig"
    },
    "componentImages": {
        "addToCart": {
            "src": "https://avatars.mds.yandex.net/get-bklk/2789303/311c2c4814da87c9527bbdf1b7677a9a/small"
        },
        "orderInfo": {
            "src": "https://avatars.mds.yandex.net/get-bklk/2789303/311c2c4814da87c9527bbdf1b7677a9a/small"
        }
    },
    "gallery": [
        {
            "type": "image",
            "image": {
                "src": "https://avatars.mds.yandex.net/get-bklk/2789303/311c2c4814da87c9527bbdf1b7677a9a/orig"
            }
        },
        {
            "type": "image",
            "image": {
                "src": "https://avatars.mds.yandex.net/get-bklk/2789303/5d14e1bd2776a37ffca66f0d93136b7a/orig"
            }
        },
        {
            "type": "image",
            "image": {
                "src": "https://avatars.mds.yandex.net/get-bklk/2789303/87fb0ec4e8a2a1413109391aef4f7c9b/orig"
            }
        }
    ],
    "price": 299900,
    "specialPrice": 199900,
    "categoryLinks": [
        {
            "text": "Все мокасины Saniano",
            "brandId": "b147b4cb-c7eb-526d-be3e-aa72b0120e43",
            "categoryId": "6f72bfdf-54c5-55b4-b129-4bcaa9c1bf1f"
        },
        {
            "text": "Вся обувь Saniano",
            "brandId": "b147b4cb-c7eb-526d-be3e-aa72b0120e43",
            "categoryId": "f0a4b41c-074e-5717-a5f4-26e5bf5f90bf"
        },
        {
            "text": "Вся обувь",
            "categoryId": "f0a4b41c-074e-5717-a5f4-26e5bf5f90bf"
        },
    ],
    "brand": {
        "id": "b147b4cb-c7eb-526d-be3e-aa72b0120e43",
        "name": "Saniano"
    },
    "attributes": [
        {
            "id": "age",
            "name": "Возраст",
            "value": {
                "id": "ea013db4-c1ac-5570-ac51-9890d0391ca3",
                "name": "Детский"
            }
        },
        {
            "id": "color",
            "name": "Цвет",
            "value": {
                "id": "2fa737db-b624-58f2-ade4-3f334cb61a45",
                "name": "Темно-синий"
            }
        },
        {
            "id": "gender",
            "name": "Пол",
            "value": {
                "id": "2df4ee60-877b-5797-b236-5c0612ff6b43",
                "name": "Мужской"
            }
        },
    ],
    "configurableAttributes": [
        {
            "id": "size",
            "name": "Размер",
            "values": [
                {
                    "id": "7955d184-4dad-573f-a94b-5617f1fcba8f",
                    "name": "35"
                },
                {
                    "id": "bf77161d-9356-5527-aaa5-7438eddcaae3",
                    "name": "36"
                },
            ]
        }
    ]
}
```

## ShortProduct

Сокращенная версия `Product`. Используется в списках и каруселях товаров.

```typescript
export type ShortProduct = Pick<Product,
    'id' |
    'name' |
    'image' |
    'componentImages' |
    'price' |
    'specialPrice' |
    'brand' |
    'configurableAttributes' |
    'isAvailable'
>;
```

Также тип бренда внутри сокращенной версии товара можно переопределить с помощью дженерик-параметра `BrandType`, который по-умолчанию равен `Brand`.

## Filters

Информация о фильтрах. Для описания используется тип `Array<Filter>`.

```typescript
export type Filter = RadioFilter | TumblerFilter | CheckboxFilter | ShopFilter | TabBarFilter;

export enum FilterWidget {
    Radio = 'radio',
    Tumbler = 'tumbler',
    Checkbox = 'checkbox',
    Shop = 'shop',
}

export type FilterValueOption = AttributeValue & {
    disabled?: boolean;
}

export type ShopFilterValueOption = FilterValueOption & {
    shop: Shop;
}

```

### Свойства

| Свойство     | Тип                        | Описание                                           |
| ------------ | -------------------------- | -------------------------------------------------- |
| id           | `ID`                       | Идентификатор фильтра                              |
| name         | `string`                   | Название. Отображается в интерфейсе                |
| widget       | `FilterWidget`             | Виджет, с помощью которого отобразится фильтр      |
| valueOptions | `Array<FilterValueOption>` | Набор доступных для фильтра опций. В качестве `valueOptions` при выборе `widget: FilterWidget.Shop` используется `Array<ShopFilterValueOption>` |
| allOption?   | `{ name: string }`         | Настройки опции выбора всех значений фильтра в фильтрах со множественным выбором. Если указано, то опция отобразится с текстом, указанным в `name` |


## FiltersValue

Выбранные значения фильтров. Для описания используется `Record<ID, Array<ID>>`, где ключ –– id фильтра, а значение –– массив id выбранных значений фильтра.

## City

Данные города. Используется на экране профиля и при выборе города пользователя.

### Свойства

| Свойство     | Тип           | Описание                                  |
| ------------ | ------------- | ----------------------------------------- |
| id           | `ID`          | Идентификатор города                      |
| name         | `string`      | Название. Отображается в интерфейсе       |
| area         | `string`      | Область, в которой находится город        |
| coordinates? | `Coordinates` | Координаты города для центрирования карты |


### Примеры

```typescript
{
    "id": "1",
    "name": "Москва",
    "area": "Москва и Московская область"
}
```

## Shop

Данные магазина. Используется при оформлении заказа, при фильтрации и при выборе магазина, где отложить товар. Магазин можно указать на карте.

### Свойства

```typescript
export type Coordinates = {
    latitude: number;
    longitude: number;
};
```

| Свойство     | Тип           | Описание                                                   |
| ------------ | ------------- | ---------------------------------------------------------- |
| id           | `ID`          | Идентификатор магазина                                     |
| name         | `string`      | Название. Отображается в интерфейсе                        |
| address      | `string`      | Адрес магазина. Отображается в интерфейсе                  |
| coordinates? | `Coordinates` | Координаты магазина, используются для отображения его на карте, а также чтобы определить расстояние до пользователя |

### Примеры

```typescript
{
    "id": "1",
    "name": "Магазин №1",
    "address": "ул. Ленина, 1"
}
```

## Cart

Данные корзины. Используется на экране корзины и оформления заказа.

### Свойства

```typescript
// Элемент корзины задается товаром и выбранными в нем настраиваемыми атрибутами
// Также важно, сколько таких элементов в корзине, и сколько из них есть в наличии
export type CartItem = {
    product: ShortProductType;
    attributes?: Array<AttributeWithValueRequestData>;
    shopId?: ID;
    count: number;
    availableCount?: number;
};
```

| Свойство    | Тип                         | Описание                                           |
| ------------| --------------------------- | -------------------------------------------------- |
| items       | `Array<CartItem>`           | Информация о товарах в корзине                     |
| attributes? | `Array<AttributeWithValue>` | Атрибуты корзины, отображаемые в "Итого". Например, цена, способ оплаты, способ получения заказа, количество начисленных бонусов |

Тип является дженериком от параметра `ShortProductType`, который по-умолчанию равен `ShortProduct`.

### Примеры

```typescript
{
    "items": [
        {
            "product": {
                "id": "1c464841-afb5-5965-8909-f1360ab43936",
                ...
            },
            "attributes": [
                {
                    "id": "size",
                    "name": "Размер",
                    "value": {
                        "id": "7955d184-4dad-573f-a94b-5617f1fcba8f",
                        "name": "35"
                    }
                }
            ],
            "count": 2,
            "availableCount": 100

        }
    ],
    "attributes": [
        {
            "id": "bonuses",
            "name": "Будет начислено бонусов",
            "value": {
                "id": "",
                "name": "256"
            }
        }
    ]
}
```

## Order

Данные заказа. Используется при оформлении заказа, на экране списка заказов и экране заказа.

### Свойства
```typescript
enum OrderStageType {
    Created = 'created',        // заказ создан, но не начата обработка
    InProgress = 'in-progress', // заказ готовится, обрабатывается
    Success = 'success',        // заказ успешно выполнен
    Error = 'error',            // произошла ошибка, заказ не выполнен
}

export type OrderStage = {
    name: string; // текстовое описание статуса заказа, будет выводиться на лейбле
    type: OrderStageType; // тип статуса заказа, влияет на отображения лейбла (цвет)
};

export type Contacts = {
    name?: string;
    phone?: string;
    email?: string;
};
```

| Свойство    | Тип                         | Описание                                          |
| ------------| --------------------------- | ------------------------------------------------- |
| id          | `ID`                        | Идентификатор заказа                              |
| name        | `string`                    | Название. Отображается в интерфейсе               |
| createdAt   | `number`                    | Временная метка в миллисекундах, когда заказ был оформлен. Используется для отображения даты заказа |
| cart        | `Cart`                      | Информация о корзине, по которой составлен заказ  |
| shop        | `ShopType`                  | Магазин, в котором оформлен заказ                 |
| stage?      | `OrderStage`                | Статус заказа, отображается лейблом               |
| contacts    | `Contacts`                  | Контакты пользователя                             |
| attributes? | `Array<AttributeWithValue>` | Атрибуты заказа, которые дополнительно надо отобразить на экране заказа |

Также типы товара и магазина внутри корзины можно переопределить с помощью дженерик-параметров `ShortProductType` и `ShopType`, которые по-умолчанию равны `ShortProduct` и `Shop` соответственно.

### Примеры

```typescript
{
    id: '1',
    name: 'Заказ №1',
    createdAt: 0,
    cart: {
        items: [],
    },
    shop: {
        id: '1',
        name: 'Магазин №1',
        address: 'Ленина, 1',
    },
    contacts: {
        name: '',
        phone: '',
        email: '',
    }
}
```
