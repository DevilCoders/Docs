## Описание

Блок `suggest`– поисковая подсказка. Появляется после первых введенных букв при формулировке поискового запроса. Состоит из [элементов поисковой подсказки (блок `suggest-item`)](../suggest-item/suggest-item.ru.md). Можно воспользоваться одной из них, и дальше вопрос не набирать. Используется для экономии времени на формулировку запроса.

Блок не имеет DOM-представления. При первой необходимости, то есть после ввода хотя бы одного символа или клика в поле ввода поискового запроса, создаётся блок [popup](../popup/popup.ru.md) (DOM-узлы) и вся работа с DOM идет через него.

Логирование: счетчики выбора подсказок саджеста в данном блоке отсутствуют.

### Объявление блока на странице

Блок создается и подключается следующим образом:

```javascript
BEM.create('suggest', {
    owner: <BEM.блок>, // блок-владелец (всегда блок `header` – шапка)
    input: <блок input>, // поле ввода для поискового запроса
    url: 'http://suggest.yandex.ru/...', // адрес сервера, который присылает данные для саджеста
    suggest: { // данные для сервера
        srv: 'serp_ru',
        wiz: 'TrWth',
        lr: 213
    },
    needUpdateTop: true
});
```

---
**NB**
- Поисковые подсказки не работают без JavaScript. Для создания блока `suggest` необходим включенный JavaScript на клиенте.
- Блок всегда растянут к краям страницы слева и справа (на данный момент отключить это невозможно).

---

```javascript
BEM.DOM.decl('example', {
    onSetMod: {
        js: function() {
            var input = this.findBlockInside('input');

            this._suggest = BEM.create('suggest', {
                owner: this,
                input: input,

                url: '//suggest.yandex.ru/suggest-ya.cgi',

                suggest: {
                    srv: 'morda_ru',
                    wiz: 'TrWth',
                    lr: 213
                }
            });

            this._suggest.on('select', function(e, data) {
                if(data.item.hasMod('type', 'nav')) {
                    return;
                }
                this.findBlockInside('search').domElem.submit();
            }, this);
        }
    }
});
```

#### Поля блока

##### Обязательные

  - `{BEM-блок} owner` – блок-владелец. Саджесту необходимо знать блок-владелец для позиционирования окошка с подсказками под ним. (Во всех случаях это шапка – блок  `header`)
  - `{BEM-блок} input` – поле ввода для поискового запроса. Блок `suggest` отслеживает изменения в поле ввода и сам перестраивает список подсказок. Данные с подсказками забираются из ручки (запрос), указанной в параметре `url`.
  - `{String} url` – адрес сервера, который присылает данные для саджеста, в виде URL, например, `http://suggest.yandex.ru/suggest-ya.cgi?version=4`.

##### Необязательные

- `{String} name` — название дата-провайдера.
  [Дата-провайдер](#about-provider) — это отдельный блок, который знает какие данные приходят с сервера, обрабатывает их и специальным образом передаёт саджесту в формате, который тот понимает. Пока существует только один дата-провайдер, называемый `provider`. По умолчанию значением `name` является `suggest__provider`.
- `{Object} suggest` — при помощи  параметра `suggest` можно переопределить данные, которые необходимо отправлять на сервер (suggest.yandex.ru) при каждом запросе. Список возможных значений данных и их описание можно посмотреть на wiki-странице [формата CGI-параметров](http://wiki.yandex-team.ru/IvanJanikov/SuggestFormat).
- `{Object} mods` — [модификаторы саджеста](#modifikatory), которые нужно  передать («пробросить») в блок `popup`, в котором строятся подсказки.
- `{String} label` — указатель на блок `service-label`. Метка сервиса находится рядом с поисковой строкой. Пример можно посмотреть у [Картинок](http://beta.yandex.ru/images/search?text=&stype=image). Подсказки саджеста сдвигаются таким образом, чтобы они были выровнены относительно метки сервиса.

<a name="modifikatory"></a>
### Модификаторы
Блок `suggest` создаёт `popup` (DOM-узлы) и добавляет его на страницу, при этом добавляя класс `suggest` на блок `popup`. Если необходимо на блок `popup` установить некий модификатор блока `suggest`, то можно воспользоваться следующей конструкцией:

```javascript
BEM.create('suggest', {
    ...
    mods: {
        fixed: 'yes'
    },
    ...
});
```

В таком случае на блоке `popup` появится микс с `suggest_fixed_yes`.

_**Внимание!** На winPhone 7.5 в IE9 не работает свойство `position: fixed`._


#### Автодополнение

Блок `suggest` уже умеет дополнять ввод пользователя, но чтобы включить эту возможность, необходимо в зависимостях указать модификатор  саджеста `complete` со значением `auto`.

```javascript
/* .deps.js */
({
    shouldDeps: [
        {block: 'suggest', mods: {complete: 'auto'}}
    ]
})
```

В этот момент подключатся файлы, необходимые для автодополнения.

Отображается только автодополнение, которое присылает сервер в поле `continue`.

---
**NB**  Обратите внимание, что автодополнение нельзя включить для каждого отдельного блока. Дополнение включается сразу для всех блоков на странице.

Установка более одного блока `suggest` на страницу не тестировалось.

---

<a name="about-provider"></a>
### Провайдер

Данные о подсказках предоставляет так называемый **провайдер**. Провайдер представляет собой блок, унаследованный от `i-request_type_ajax` (простые AJAX-запросы) блока [i-request](../i-request/i-request.ru.md).

По умолчанию используется блок `suggest__provider`, исходный код которого лежит в элементе `provider`, блока `suggest`. Данный блок является эталонным примером реализации для создания своих провайдеров.

### Значения по умолчанию

Параметр `name` — название провайдера данных, равен по умолчанию `suggest__provider`.


### Особенности реализации
*  Блок не имеет DOM-представления. При первой необходимости создаётся блок `popup`, и вся работа с DOM идёт через него.
* Дополнение не работает в IE8 из-за деградации `input`’а.
* Для перехода по элементам поисковой подсказки можно использовать клавиши вверх/вниз. Для выбора подходящего запроса – **Enter**.
* Для скрытия — **Esc**. Стрелка **[ → ]** и **Tab** активируют дополнение.
