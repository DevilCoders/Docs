# b-popupa
----
**NB** Блок устарел, рекомендуется перейти на использование новой версии блока — 
[popup2](../popup2/popup2.ru.md).

Попап — прямоугольная область, которая что-то перекрывает на странице.
Попап имеет полупрозрачную тень, хвостик и закрывающий крестик.

Хвостик и крестик — необязательные элементы.
Попап отображается по центру того элемента, который его вызывает.
Умеет открываться влево, вправо, вверх и вниз, а также по центру видимой области окна. По умолчанию попап белого цвета и открывается вниз.

Контекстный попап может быть вызван псевдоссылками, иконками. В каждом случае должно быть очевидно, с каким именно элементом на странице связан попап, поэтому контекстные попапы с хвостиками. Хвостик указывает на элемент, вызвавший попап.
Это же касается и блоков  `dropdown`.

По содержанию блоки `b-popupa` делятся на:

  * контентные (видеоролик, фотография, слайд-шоу, набор контролов) – белые;
  * пояснительные (просто текст со ссылками) – цветные.


### Модификаторы блока

Модификатор | Описание | Допустимые значения
--- | --- | ---
`direction` | Направление | `down`: Вниз<br>`fixed`: Фиксированное<br>`left`: Слева<br>`right`: Справа<br>`up`: Вверх.<br>
`has-close` | Наличие закрывающего крестика | `yes`: Закрывающий крестик есть
`theme`| Цветовая тема | `000000`: Черная<br>`black`: Темная тема<br>`feffd6`: Светло-желтая<br>`ffffff`: Белая.<br>

### Элементы блока

Элемент | Описание 
--- | ---  
`close` | Закрывающий крестик. 
`shadow` | Тень. 
`tail` | Хвостик. 
`under` | Позволяет передать параметры элементу `under` блока [i-popup](../i-popup/i-popup.ru.md). 


### Технические подробности
* `b-popupa` вкладывается в абстрактный попап ([i-popup](../i-popup/i-popup.ru.md)), который при вызове становится последним элементом `<body>`. Это сделано, для того чтобы решить проблему перекрытия элементов попапом.
  Частично это решило проблему, но к сожалению в некоторых браузерах попап все-таки не перекрывает флеш. **Без блока i-popup блок b-popupa не существует.**
  
* Через `b-popup` можно пробросить некоторые параметры в `i-popup`. А именно: `zIndex` и `underMods`.  Подробнее они описаны в документации [i-popup](../i-popup/i-popup.ru.md). В блок `b-popup` их нужно передавать в качестве JS-параметров.    

* Направление отображения попапа частично контролируется модификатором `direction`.
  **Важно:** попап сам высчитывает оптимальное направление открытия, не зависимо от того какое направление указано в `direction`.
  
  Например: в BEMJSON указано направление `direction` в значении `right`, но на странице места для отображения попапа справа слишком мало, поэтому попап сам выберет оптимальное направление отображения.
  
  Отображение хвостика зависит от направления отображения попапа. Стили находятся в `b-popupa__tail.css` и `b-popupa__tail.ie8.css`, так как они нужны всегда.

* За отображение попапа отвечает функция `show()`, параметром которой является DOM-элемент, относительно которого будет отображаться попап. Например:

```javascript
    $(function() {
        $('.view-popupa').click(function() {
            $('.b-popupa').bem('b-popupa').show($(this));
        })
    });
```

**Важно:** Попап с модификатором `direction` в значении `fixed` игнорирует параметры функции `show()`, так как открывается по центру видимость области окна, не зависимо от элемента, который его вызывает. Поэтому параметры в функции можно не писать.

* При наличии элемента крестик, попапу добавляется модификатор `has-close` со значением `yes`, поэтому в BEMJSON этот модификатор указывать не нужно.
* **На заметку**: Если первый элемент в `body` имеет не нулевой `margin-top`, то `body` с `position: relative` сдвигается на этот отступ. Соответственно попап открывается ниже. В большинстве своем сервисы Яндекса не будут иметь такой проблемы, так как у них нет элемента с не нулевым верхним отступом. Решение закомментировано в `b-popupa.css`: используя псевдоклассы, добавляем элемент с нулевым верхним отступом.
