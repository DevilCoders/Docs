## Описание

**Статус блока**: **deprecated**

Рекомендуется перейти на использование новой версии блока — [`popup2`](https://lego.yandex-team.ru/libs/islands/v5.x/desktop/popup2/).

Абстрактный `popup` – компонент, предназначенный для создания как выпадающего элемента (контекстный попап), так и модального окна. Блок отображается на первом плане и перекрывает остальные элементы на странице. Может служить основой для других блоков. Например, [Домик](../domik/domik.ru.md), [Саджест](../suggest/suggest.ru.md).

Элементы попапа (не обязательные):

* `tail` – хвост (указывает на вызывающий его элемент).
* `close` – кнопка закрытия попапа в виде крестика.

Попап может быть вызван различными элементами страницы, например, иконками, псевдо-ссылками. При использовании хвостика он всегда будет указывать на вызвавший его элемент, что делает очевидной их взаимосвязь.

В момент показа блок выносит себя в конец `<body>`.

---
**NB**. Из этого правила есть исключение: [вложенные фиксированные попапы](#fiksirovannyepopapy) (модификатор `position` со значением `fixed`).

---

Блок `popup` умеет:

* Перестраиваться по [направлениям раскрытия](#napravlenijaraskrytija) в указанном порядке.
* Автоматически закрываться при клике за пределами своей области и закрывать попапы, [открытые из "себя"](#vzaimosvjazimezhdupopupami).
* [Анимировать](#animacija) своё появление и скрытие.
* Убирать полосы прокрутки с `<body>` и использовать прокрутку для своего контента.
* Выбирать направление раскрытия по [фактору попадания в кастомный блок](#viewport).


<a name="sxemabloka"></a>
### Схема блока

Для внесения большей ясности была нарисована схема с изображением `popup` со следующими параметрами:

* Стороной раскрытия `to: 'bottom'`.
* Осью `axis: 'left'`.
* Отступом `offset: {top: XX}`.
* Хвостом:
  * С осью `axis: 'center'`.

<svg xmlns="http://www.w3.org/2000/svg" width="744.09" height="398"><defs><marker orient="auto" id="c" overflow="visible"><path d="M0 0l5-5-17.5 5 17.5 5-5-5z" transform="matrix(-.4 0 0 -.4 -4 0)" fill-rule="evenodd" stroke="#000" stroke-width="1pt"/></marker><marker orient="auto" overflow="visible"><path d="M0 0l5-5-17.5 5 17.5 5-5-5z" transform="matrix(.2 0 0 .2 1.2 0)" fill-rule="evenodd" stroke="#000" stroke-width="1pt"/></marker><marker orient="auto" id="b" overflow="visible"><path d="M0 0l5-5-17.5 5 17.5 5-5-5z" transform="matrix(.4 0 0 .4 4 0)" fill-rule="evenodd" stroke="#000" stroke-width="1pt"/></marker><marker orient="auto" id="a" overflow="visible"><path d="M0 0l5-5-17.5 5 17.5 5-5-5z" transform="matrix(.8 0 0 .8 10 0)" fill-rule="evenodd" stroke="#000" stroke-width="1pt"/></marker><marker orient="auto" overflow="visible"><path d="M0 0l5-5-17.5 5 17.5 5-5-5z" transform="matrix(.8 0 0 .8 10 0)" fill-rule="evenodd" stroke="#000" stroke-width="1pt"/></marker></defs><g transform="translate(0 -654.362)"><rect width="744.583" height="398.101" x="-.247" y="654.312" fill="#fff"/><rect width="418.571" height="175.714" x="66.979" y="845.245" fill="#fff" fill-rule="evenodd" stroke="#000"/><g transform="translate(-2.859 725.383)"><rect width="36.439" height="24.653" x="356.602" y="99.5" fill="#fff"/><path d="M356.305 119.765l18.6-16.693 18.6 16.996" stroke="#000" fill="none"/></g><rect width="610.132" height="78.792" x="66.979" y="734.907" fill="#f9f9f9" stroke="#7a7a7a" stroke-dasharray="3, 1"/><g style="line-height:125%" font-size="40" letter-spacing="0" word-spacing="0" font-family="Sans" text-anchor="middle"><path d="M322.642 768.135c-1.927 0-3.451.755-4.57 2.266-1.12 1.497-1.68 3.555-1.68 6.172 0 2.617.553 4.681 1.66 6.191 1.12 1.497 2.65 2.246 4.59 2.246 1.914 0 3.431-.755 4.551-2.266 1.12-1.51 1.68-3.568 1.68-6.172 0-2.591-.56-4.642-1.68-6.152-1.12-1.523-2.637-2.285-4.551-2.285m0-3.047c3.125 0 5.579 1.016 7.363 3.047 1.784 2.031 2.676 4.844 2.676 8.438 0 3.581-.892 6.393-2.676 8.438-1.784 2.031-4.238 3.047-7.363 3.047-3.138 0-5.599-1.016-7.383-3.047-1.771-2.044-2.656-4.857-2.656-8.438 0-3.594.885-6.406 2.656-8.438 1.784-2.031 4.245-3.047 7.383-3.047" style="text-align:center;line-height:167.99999475%"/><path d="M336.529 765.616h3.594l4.492 17.07 4.473-17.07h4.238l4.492 17.07 4.473-17.07h3.594l-5.723 21.875h-4.238l-4.707-17.93-4.727 17.93h-4.238l-5.723-21.875" style="text-align:center;line-height:167.99999475%"/><path d="M389.537 774.287v13.203h-3.594v-13.086c0-2.07-.404-3.62-1.211-4.648-.807-1.029-2.018-1.543-3.633-1.543-1.94 0-3.47.619-4.59 1.855-1.12 1.237-1.68 2.923-1.68 5.059v12.363h-3.613v-21.875h3.613v3.398c.859-1.315 1.868-2.298 3.027-2.949 1.172-.651 2.52-.977 4.043-.977 2.513 0 4.414.781 5.703 2.344 1.289 1.55 1.934 3.835 1.934 6.855" style="text-align:center;line-height:167.99999475%"/><path d="M415.455 775.655v1.758h-16.523c.156 2.474.898 4.362 2.227 5.664 1.341 1.289 3.203 1.934 5.586 1.934 1.38 0 2.715-.169 4.004-.508 1.302-.339 2.591-.846 3.867-1.523v3.398c-1.289.547-2.611.964-3.965 1.25-1.354.286-2.728.43-4.121.43-3.49 0-6.257-1.016-8.301-3.047-2.031-2.031-3.047-4.779-3.047-8.242 0-3.581.964-6.419 2.891-8.516 1.94-2.109 4.551-3.164 7.832-3.164 2.943 0 5.267.951 6.973 2.852 1.719 1.888 2.578 4.46 2.578 7.715m-3.594-1.055c-.026-1.966-.579-3.535-1.66-4.707-1.068-1.172-2.487-1.758-4.258-1.758-2.005 0-3.613.566-4.824 1.699-1.198 1.133-1.888 2.728-2.07 4.785l12.813-.019" style="text-align:center;line-height:167.99999475%"/><path d="M434.029 768.975c-.404-.234-.846-.404-1.328-.508-.469-.117-.99-.176-1.563-.176-2.031 0-3.594.664-4.688 1.992-1.081 1.315-1.621 3.21-1.621 5.684v11.523h-3.613v-21.875h3.613v3.398c.755-1.328 1.738-2.311 2.949-2.949 1.211-.651 2.682-.977 4.414-.977.247 0 .521.019.82.059.299.026.631.072.996.137l.019 3.691" style="text-align:center;line-height:167.99999475%"/></g><path d="M371.734 677.221v362.859" stroke="#9c9c9c" stroke-width=".887" stroke-dasharray="3.54631416, 3.54631416" fill="none"/><path d="M66.909 677.221v362.153" stroke="#9c9c9c" stroke-width=".886" stroke-dasharray="3.54286458, 3.54286458" fill="none"/><path d="M288.92 828.46h260.246" stroke="#afafaf" stroke-width=".606" fill="none"/><path d="M371.217 845.035h177.976" stroke="#afafaf" stroke-width=".531" fill="none"/><path d="M373.391 702.12l17.857-20h135.714" stroke="#000" marker-start="url(#a)" fill="none"/><path d="M528.926 826.271v-22.5h142.503" stroke="#000" marker-start="url(#b)" fill="none"/><path d="M528.813 847.287v15.152" stroke="#000" marker-start="url(#b)" fill="none"/><path d="M292.855 833.772v-3.031" stroke="#000" marker-end="url(#c)" fill="none"/><path d="M292.855 812.299v-8.482h-133.616" stroke="#000" marker-start="url(#b)" fill="none"/><path d="M68.669 701.945l17.857-20h135.714" stroke="#000" marker-start="url(#a)" fill="none"/><path d="M292.833 832.991v7.902" stroke="#000" fill="none"/><path d="M390.676 840.922v78.827" stroke="#afafaf" stroke-width=".334" fill="none"/><path d="M352.855 840.934v78.827" stroke="#afafaf" stroke-width=".334" fill="none"/><path d="M416.408 885.513h-23.929" stroke="#000" marker-end="url(#c)" fill="none"/><path d="M351.024 885.513h-108.036" stroke="#000" marker-start="url(#b)" fill="none"/><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M127.14 674.197c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.188 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.562 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M141.888 669.302l-3.56 4.79 3.744 5.054h-1.907l-2.865-3.867-2.865 3.867h-1.907l3.823-5.15-3.498-4.693h1.907l2.61 3.507 2.61-3.507h1.907"/><path d="M144.358 669.302h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M155.625 669.592v1.529c-.457-.234-.932-.41-1.424-.527-.492-.117-1.002-.176-1.529-.176-.803 0-1.406.123-1.811.369-.398.246-.598.615-.598 1.107 0 .375.144.671.431.888.287.211.864.413 1.731.606l.554.123c1.148.246 1.963.595 2.443 1.046.486.445.729 1.069.729 1.872 0 .914-.363 1.638-1.09 2.171-.721.533-1.714.8-2.979.8-.527 0-1.078-.053-1.652-.158-.568-.1-1.169-.252-1.802-.457v-1.67c.598.311 1.187.545 1.767.703.58.152 1.154.229 1.723.229.762 0 1.348-.129 1.758-.387.41-.264.615-.633.615-1.107 0-.439-.149-.776-.448-1.011-.293-.234-.94-.46-1.942-.677l-.563-.132c-1.002-.211-1.726-.533-2.171-.967-.445-.439-.668-1.04-.668-1.802 0-.926.328-1.641.984-2.145.656-.504 1.588-.756 2.795-.756.598 0 1.16.044 1.688.132.527.088 1.014.22 1.459.396"/></g><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M409.098 666.545v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/><path d="M419.039 674.235c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.187 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.562 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M425.604 669.339h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M430.596 665.507h1.617v13.676h-1.617v-13.676"/><path d="M445.793 674.235c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.188 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.562 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M460.541 669.339l-3.56 4.79 3.744 5.054h-1.907l-2.865-3.867-2.865 3.867h-1.907l3.823-5.15-3.498-4.693h1.907l2.61 3.507 2.61-3.507h1.907"/><path d="M463.01 669.339h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M474.278 669.629v1.529c-.457-.234-.932-.41-1.424-.527-.492-.117-1.002-.176-1.529-.176-.803 0-1.406.123-1.811.369-.398.246-.598.615-.598 1.107 0 .375.144.671.431.888.287.211.864.413 1.731.606l.554.123c1.148.246 1.963.595 2.443 1.046.486.445.729 1.069.73 1.872 0 .914-.363 1.638-1.09 2.171-.721.533-1.714.8-2.979.8-.527 0-1.078-.053-1.652-.158-.568-.1-1.169-.252-1.802-.457v-1.67c.598.311 1.187.545 1.767.703.58.152 1.154.229 1.723.229.762 0 1.348-.129 1.758-.387.41-.264.615-.633.615-1.107 0-.439-.149-.776-.448-1.011-.293-.234-.94-.46-1.942-.677l-.563-.132c-1.002-.211-1.726-.533-2.171-.967-.445-.439-.668-1.04-.668-1.802 0-.926.328-1.641.984-2.145.656-.504 1.588-.756 2.795-.756.598 0 1.16.044 1.688.132.527.088 1.014.22 1.459.396"/></g><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M173.293 799.399v5.221h-1.626v-13.588h1.626v1.494c.34-.586.768-1.02 1.283-1.301.521-.287 1.143-.431 1.863-.431 1.195 0 2.165.475 2.909 1.424.75.949 1.125 2.197 1.125 3.744 0 1.547-.375 2.795-1.125 3.744-.744.949-1.714 1.424-2.909 1.424-.721 0-1.342-.141-1.863-.422-.516-.287-.943-.724-1.283-1.31m5.502-3.437c0-1.189-.246-2.121-.738-2.795-.486-.68-1.157-1.02-2.013-1.02-.855 0-1.529.34-2.021 1.02-.486.674-.73 1.605-.729 2.795 0 1.189.243 2.124.729 2.804.492.674 1.166 1.011 2.021 1.011s1.526-.337 2.013-1.011c.492-.68.738-1.614.738-2.804"/><path d="M186.968 792.166c-.867 0-1.553.34-2.057 1.02-.504.674-.756 1.6-.756 2.777 0 1.178.249 2.106.747 2.786.504.674 1.192 1.011 2.065 1.011.861 0 1.544-.34 2.048-1.02.504-.68.756-1.605.756-2.777 0-1.166-.252-2.089-.756-2.769-.504-.686-1.187-1.028-2.048-1.028m0-1.371c1.406 0 2.511.457 3.313 1.371.803.914 1.204 2.18 1.204 3.797 0 1.611-.401 2.877-1.204 3.797-.803.914-1.907 1.371-3.313 1.371-1.412 0-2.52-.457-3.322-1.371-.797-.92-1.195-2.186-1.195-3.797 0-1.617.398-2.883 1.195-3.797.803-.914 1.91-1.371 3.322-1.371"/><path d="M195.722 799.399v5.221h-1.626v-13.588h1.626v1.494c.34-.586.768-1.02 1.283-1.301.521-.287 1.143-.431 1.863-.431 1.195 0 2.165.475 2.909 1.424.75.949 1.125 2.197 1.125 3.744 0 1.547-.375 2.795-1.125 3.744-.744.949-1.714 1.424-2.909 1.424-.721 0-1.342-.141-1.863-.422-.516-.287-.943-.724-1.283-1.31m5.502-3.437c0-1.189-.246-2.121-.738-2.795-.486-.68-1.157-1.02-2.013-1.02-.855 0-1.529.34-2.021 1.02-.486.674-.73 1.605-.73 2.795 0 1.189.243 2.124.73 2.804.492.674 1.166 1.011 2.021 1.011s1.526-.337 2.013-1.011c.492-.68.738-1.614.738-2.804"/><path d="M205.417 796.991v-5.959h1.617v5.897c0 .932.182 1.632.545 2.101.363.463.908.694 1.635.694.873 0 1.562-.278 2.065-.835.51-.557.765-1.315.765-2.276v-5.581h1.617v9.844h-1.617v-1.512c-.393.598-.85 1.043-1.371 1.336-.516.287-1.116.431-1.802.431-1.131 0-1.989-.352-2.575-1.055-.586-.703-.879-1.731-.879-3.085m4.069-6.196"/><path d="M218.574 799.399v5.221h-1.626v-13.588h1.626v1.494c.34-.586.768-1.02 1.283-1.301.521-.287 1.143-.431 1.863-.431 1.195 0 2.165.475 2.909 1.424.75.949 1.125 2.197 1.125 3.744 0 1.547-.375 2.795-1.125 3.744-.744.949-1.714 1.424-2.909 1.424-.721 0-1.342-.141-1.863-.422-.516-.287-.943-.724-1.283-1.31m5.502-3.437c0-1.189-.246-2.121-.738-2.795-.486-.68-1.157-1.02-2.013-1.02-.855 0-1.529.34-2.021 1.02-.486.674-.73 1.605-.729 2.795 0 1.189.243 2.124.729 2.804.492.674 1.166 1.011 2.021 1.011s1.526-.337 2.013-1.011c.492-.68.738-1.614.738-2.804"/><path d="M237.98 792.166c-.867 0-1.553.34-2.057 1.02-.504.674-.756 1.6-.756 2.777 0 1.178.249 2.106.747 2.786.504.674 1.192 1.011 2.065 1.011.861 0 1.544-.34 2.048-1.02.504-.68.756-1.605.756-2.777 0-1.166-.252-2.089-.756-2.769-.504-.686-1.187-1.028-2.048-1.028m0-1.371c1.406 0 2.511.457 3.313 1.371.803.914 1.204 2.18 1.204 3.797 0 1.611-.401 2.877-1.204 3.797-.803.914-1.907 1.371-3.313 1.371-1.412 0-2.52-.457-3.322-1.371-.797-.92-1.195-2.186-1.195-3.797 0-1.617.398-2.883 1.195-3.797.803-.914 1.91-1.371 3.322-1.371"/><path d="M256.217 787.2v1.345h-1.547c-.58 0-.984.117-1.213.352-.223.234-.334.656-.334 1.266v.87h2.663v1.257h-2.663v8.587h-1.626v-8.587h-4.438v8.587h-1.626v-8.587h-1.547v-1.257h1.547v-.686c0-1.096.255-1.893.765-2.391.51-.504 1.318-.756 2.426-.756h1.529v1.345h-1.547c-.58 0-.984.117-1.213.352-.223.234-.334.656-.334 1.266v.87h4.438v-.686c0-1.096.255-1.893.765-2.391.51-.504 1.318-.756 2.426-.756h1.529"/><path d="M263.855 791.322v1.529c-.457-.234-.932-.41-1.424-.527-.492-.117-1.002-.176-1.529-.176-.803 0-1.406.123-1.811.369-.398.246-.598.615-.598 1.107 0 .375.144.671.431.888.287.211.864.413 1.731.606l.554.123c1.148.246 1.963.595 2.443 1.046.486.445.729 1.069.729 1.872 0 .914-.363 1.638-1.09 2.171-.721.533-1.714.8-2.979.8-.527 0-1.078-.053-1.652-.158-.568-.1-1.169-.252-1.802-.457v-1.67c.598.311 1.187.545 1.767.703.58.152 1.154.229 1.723.229.762 0 1.348-.129 1.758-.387.41-.264.615-.633.615-1.107 0-.439-.149-.776-.448-1.011-.293-.234-.94-.46-1.942-.677l-.563-.132c-1.002-.211-1.726-.533-2.171-.967-.445-.439-.668-1.04-.668-1.802 0-.926.328-1.641.984-2.145.656-.504 1.588-.756 2.795-.756.598 0 1.16.044 1.688.132.527.088 1.014.22 1.459.396"/><path d="M275.386 795.549v.791h-7.436c.07 1.113.404 1.963 1.002 2.549.604.58 1.441.87 2.514.87.621 0 1.222-.076 1.802-.229.586-.152 1.166-.381 1.74-.686v1.529c-.58.246-1.175.434-1.784.563-.609.129-1.228.193-1.854.193-1.57 0-2.815-.457-3.735-1.371-.914-.914-1.371-2.15-1.371-3.709 0-1.611.434-2.889 1.301-3.832.873-.949 2.048-1.424 3.524-1.424 1.324 0 2.37.428 3.138 1.283.773.85 1.16 2.007 1.16 3.472m-1.617-.475c-.012-.885-.261-1.591-.747-2.118-.48-.527-1.119-.791-1.916-.791-.902 0-1.626.255-2.171.765-.539.51-.85 1.228-.932 2.153l5.766-.009"/><path d="M279.64 788.237v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/></g><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M537.715 788.232v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/><path d="M547.656 795.922c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.188 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.562 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M554.221 791.026h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M559.213 787.194h1.617v13.676h-1.617v-13.676"/><path d="M578.119 794.929v5.941h-1.617v-5.889c0-.932-.182-1.629-.545-2.092-.363-.463-.908-.694-1.635-.694-.873 0-1.562.278-2.065.835-.504.557-.756 1.315-.756 2.276v5.563h-1.626v-13.676h1.626v5.361c.387-.592.841-1.034 1.362-1.327.527-.293 1.134-.439 1.819-.439 1.131 0 1.986.352 2.566 1.055.58.697.87 1.726.87 3.085"/><path d="M589.782 795.544v.791h-7.436c.07 1.113.404 1.963 1.002 2.549.604.58 1.441.87 2.514.87.621 0 1.222-.076 1.802-.229.586-.152 1.166-.381 1.74-.686v1.529c-.58.246-1.175.434-1.784.563-.609.129-1.228.193-1.855.193-1.57 0-2.815-.457-3.735-1.371-.914-.914-1.371-2.15-1.371-3.709 0-1.611.434-2.889 1.301-3.832.873-.949 2.048-1.424 3.524-1.424 1.324 0 2.37.428 3.138 1.283.773.85 1.16 2.007 1.16 3.472m-1.617-.475c-.012-.885-.261-1.591-.747-2.118-.48-.527-1.119-.791-1.916-.791-.902 0-1.626.255-2.171.765-.539.51-.85 1.228-.932 2.153l5.766-.009"/><path d="M592.436 791.026h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M603.906 795.834c0-1.172-.243-2.08-.729-2.725-.48-.645-1.157-.967-2.03-.967-.867 0-1.544.322-2.03.967-.48.645-.721 1.553-.721 2.725 0 1.166.24 2.071.721 2.716.486.645 1.163.967 2.03.967.873 0 1.55-.322 2.03-.967.486-.645.729-1.55.729-2.716m1.617 3.814c0 1.676-.372 2.921-1.116 3.735-.744.82-1.884 1.23-3.419 1.23-.568 0-1.105-.044-1.608-.132-.504-.082-.993-.211-1.468-.387v-1.573c.475.258.943.448 1.406.571.463.123.935.185 1.415.185 1.061 0 1.854-.278 2.382-.835.527-.551.791-1.386.791-2.505v-.8c-.334.58-.762 1.014-1.283 1.301-.521.287-1.146.431-1.872.431-1.207 0-2.18-.46-2.918-1.38-.738-.92-1.107-2.139-1.107-3.656 0-1.523.369-2.745 1.107-3.665.738-.92 1.711-1.38 2.918-1.38.727 0 1.351.144 1.872.431.521.287.949.721 1.283 1.301v-1.494h1.617v8.622"/><path d="M617.037 794.929v5.941h-1.617v-5.889c0-.932-.182-1.629-.545-2.092-.363-.463-.908-.694-1.635-.694-.873 0-1.562.278-2.065.835-.504.557-.756 1.315-.756 2.276v5.563h-1.626v-13.676h1.626v5.361c.387-.592.841-1.034 1.362-1.327.527-.293 1.134-.439 1.819-.439 1.131 0 1.986.352 2.566 1.055.58.697.87 1.726.87 3.085"/><path d="M621.879 788.232v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/></g><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M253.064 870.004v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/><path d="M263.004 877.694c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.188 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.563 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M269.569 872.799h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M274.562 868.967h1.617v13.676h-1.617v-13.676"/><path d="M284.344 872.799h1.617l2.021 7.682 2.013-7.682h1.907l2.021 7.682 2.013-7.682h1.617l-2.575 9.844h-1.907l-2.118-8.068-2.127 8.068h-1.907l-2.575-9.844"/><path d="M300.015 872.799h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M311.484 874.293v-5.326h1.617v13.676h-1.617v-1.477c-.34.586-.771 1.022-1.292 1.31-.516.281-1.137.422-1.863.422-1.189 0-2.159-.475-2.909-1.424-.744-.949-1.116-2.197-1.116-3.744 0-1.547.372-2.795 1.116-3.744.75-.949 1.72-1.424 2.909-1.424.727 0 1.348.144 1.863.431.521.281.952.715 1.292 1.301m-5.511 3.437c0 1.189.243 2.124.729 2.804.492.674 1.166 1.011 2.021 1.011s1.529-.337 2.021-1.011c.492-.68.738-1.614.738-2.804 0-1.189-.246-2.121-.738-2.795-.492-.68-1.166-1.02-2.021-1.02s-1.529.34-2.021 1.02c-.486.674-.73 1.605-.729 2.795"/><path d="M318.032 870.004v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/><path d="M331.682 876.701v5.941h-1.617v-5.889c0-.932-.182-1.629-.545-2.092-.363-.463-.908-.694-1.635-.694-.873 0-1.562.278-2.065.835-.504.557-.756 1.315-.756 2.276v5.563h-1.626v-13.676h1.626v5.361c.387-.592.841-1.034 1.362-1.327.527-.293 1.134-.439 1.819-.439 1.131 0 1.986.352 2.566 1.055.58.697.87 1.726.87 3.085"/></g><g transform="translate(6)"><rect width="36.439" height="24.653" x="79.986" y="825.075" fill="#fff"/><path d="M79.688 845.34l18.6-16.693 18.6 16.996" stroke="#c4c4c4" stroke-dasharray="4, 2" fill="none"/></g><path d="M85.633 828.01v78.827" stroke="#afafaf" stroke-width=".334" fill="none"/><path d="M193.018 885.362h-105.381" stroke="#000" marker-end="url(#c)" fill="none"/><path d="M64.645 885.362h-29.831" stroke="#000" marker-start="url(#b)" fill="none"/><g style="line-height:125%" font-size="18" letter-spacing="0" word-spacing="0" font-family="Sans"><path d="M103.608 869.974v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/><path d="M113.549 877.664c-1.307 0-2.212.149-2.716.448-.504.299-.756.809-.756 1.529 0 .574.188 1.031.563 1.371.381.334.896.501 1.547.501.896 0 1.614-.316 2.153-.949.545-.639.817-1.485.817-2.54v-.36h-1.608m3.226-.668v5.616h-1.617v-1.494c-.369.598-.829 1.04-1.38 1.327-.551.281-1.225.422-2.021.422-1.008 0-1.811-.281-2.408-.844-.592-.568-.888-1.327-.888-2.276 0-1.107.369-1.942 1.107-2.505.744-.563 1.852-.844 3.322-.844h2.268v-.158c0-.744-.246-1.318-.738-1.723-.486-.41-1.172-.615-2.057-.615-.563 0-1.11.067-1.644.202-.533.135-1.046.337-1.538.606v-1.494c.592-.229 1.166-.398 1.723-.51.557-.117 1.099-.176 1.626-.176 1.424 0 2.487.369 3.19 1.107.703.738 1.055 1.857 1.055 3.357"/><path d="M120.114 872.769h1.617v9.844h-1.617v-9.844m0-3.832h1.617v2.048h-1.617v-2.048"/><path d="M125.106 868.937h1.617v13.676h-1.617v-13.676"/><path d="M139.644 873.902c-.867 0-1.553.34-2.057 1.02-.504.674-.756 1.6-.756 2.777 0 1.178.249 2.106.747 2.786.504.674 1.192 1.011 2.065 1.011.861 0 1.544-.34 2.048-1.02.504-.68.756-1.605.756-2.777 0-1.166-.252-2.089-.756-2.769-.504-.686-1.187-1.028-2.048-1.028m0-1.371c1.406 0 2.511.457 3.313 1.371.803.914 1.204 2.18 1.204 3.797 0 1.611-.401 2.877-1.204 3.797-.803.914-1.907 1.371-3.313 1.371-1.412 0-2.52-.457-3.322-1.371-.797-.92-1.195-2.186-1.195-3.797 0-1.617.398-2.883 1.195-3.797.803-.914 1.91-1.371 3.322-1.371"/><path d="M157.881 868.937v1.345h-1.547c-.58 0-.984.117-1.213.352-.223.234-.334.656-.334 1.266v.87h2.663v1.257h-2.663v8.587h-1.626v-8.587h-4.438v8.587h-1.626v-8.587h-1.547v-1.257h1.547v-.686c0-1.096.255-1.893.765-2.391.51-.504 1.318-.756 2.426-.756h1.529v1.345h-1.547c-.58 0-.984.117-1.213.352-.223.234-.334.656-.334 1.266v.87h4.438v-.686c0-1.096.255-1.893.765-2.391.51-.504 1.318-.756 2.426-.756h1.529"/><path d="M165.519 873.059v1.529c-.457-.234-.932-.41-1.424-.527-.492-.117-1.002-.176-1.529-.176-.803 0-1.406.123-1.811.369-.398.246-.598.615-.598 1.107 0 .375.144.671.431.888.287.211.864.413 1.731.606l.554.123c1.148.246 1.963.595 2.443 1.046.486.445.729 1.069.729 1.872 0 .914-.363 1.638-1.09 2.171-.721.533-1.714.8-2.979.8-.527 0-1.078-.053-1.652-.158-.568-.1-1.169-.252-1.802-.457v-1.67c.598.311 1.187.545 1.767.703.58.152 1.154.229 1.723.229.762 0 1.348-.129 1.758-.387.41-.264.615-.633.615-1.107 0-.439-.149-.776-.448-1.011-.293-.234-.94-.46-1.942-.677l-.563-.132c-1.002-.211-1.726-.533-2.171-.967-.445-.439-.668-1.04-.668-1.802 0-.926.328-1.641.984-2.145.656-.504 1.588-.756 2.795-.756.598 0 1.16.044 1.688.132.527.088 1.014.22 1.459.396"/><path d="M177.05 877.286v.791h-7.436c.07 1.113.404 1.963 1.002 2.549.604.58 1.441.87 2.514.87.621 0 1.222-.076 1.802-.229.586-.152 1.166-.381 1.74-.686v1.529c-.58.246-1.175.434-1.784.563-.609.129-1.228.193-1.855.193-1.57 0-2.815-.457-3.735-1.371-.914-.914-1.371-2.15-1.371-3.709 0-1.611.434-2.889 1.301-3.832.873-.949 2.048-1.424 3.524-1.424 1.324 0 2.37.428 3.138 1.283.773.85 1.16 2.007 1.16 3.472m-1.617-.475c-.012-.885-.261-1.591-.747-2.118-.48-.527-1.119-.791-1.916-.791-.902 0-1.626.255-2.171.765-.539.51-.85 1.228-.932 2.153l5.766-.009"/><path d="M181.304 869.974v2.795h3.331v1.257h-3.331v5.344c0 .803.108 1.318.325 1.547.223.229.671.343 1.345.343h1.661v1.354h-1.661c-1.248 0-2.109-.231-2.584-.694-.475-.469-.712-1.318-.712-2.549v-5.344h-1.187v-1.257h1.187v-2.795h1.626"/></g></g></svg>

### Объявление блока на странице

BEMJSON для использования блока:

```javascript
{ // элемент интерфейса, вызывающий `popup`
	block: 'button',
    mods: {size: 'm', theme: 'normal'},
    mix: [{block: 'owner'}],
    content: 'Я.Owner'
},
{ // блок `popup`
    block: 'popup', // имя блока
    attrs: {style: 'width: 200px'}, // атрибуты блока
    mods: {adaptive: 'yes'}, // модификаторы блока
    /*
     * Можно обойтись без указания направлений
     * Раскрытие вниз производится по умолчанию
     * см islands-popups/common.blocks/popup/popup.js:30
    */
    js: { //  JS-параметры
        directions: 'bottom' // направление раскрытия
    },
    content: [
        {elem: 'tail'}, // хвост. Не обязательный элемент
        {
            elem: 'content',
            content: 'Содержимое попапа'
        }
    ]
}
```

### Хвост
* `tail` -  хвост, элемент попапа.

---
**NB** у блока нет зависимости от элемента `tail`.

---

Если вы хотите его использовать, то его нужно добавить самостоятельно в `content` блока следующим образом:

```js
{
    block: 'popup',
    js: true,
    content: [
    	{elem: 'tail'},
        {elem: 'content', content: 'example'}
    ]
}
```

### Содержимое попапа

Содержимое попапа произвольное. Добавляется аналогично `tail` – в  поле `content` элемента блока `content`.


### JS-параметры

Поведение блока `popup` можно изменить, передав ему следующие необязательные JS-параметры во входных данных:

* `{Object} directions` — [направления раскрытия](#napravlenijaraskrytija). Для модального окна (модификатор `type` со значением `modal`) не учитываются.
* `{Object} tail` — [параметры хвоста](#parametryxvostavkontekstenapravlenijaraskrytija).
* `{Object} position` — [зафиксировать позицию по оси](#zafiksirovatpolozheniepoodnojjizkoordinatnyxosejj) (координатная ось (left, top)).


<a name="napravlenijaraskrytija"></a>
#### Направления раскрытия

Указываются в JS-параметре блока `directions`.

---
**NB** Направления раскрытия игнорируются для модального окна (модификатор `type` со значением `modal`).

---

Ключи:

* `{String} to` — [сторона раскрытия](#storonaraskrytija). Обязательный.
* `{String} axis` — [ось](#os).
* `{Object} offset` — [смещение попапа](#smeshhenie).
* `{Object} tail` — [параметры хвоста для направления раскрытия](#parametryxvostavkontekstenapravlenijaraskrytija).

Направление раскрытия характеризуется двумя параметрами:

* `to` – [сторона раскрытия](#storonaraskrytija).
* `axis` – [ось](#os).

Для внесения большей ясности была нарисована [схема](#sxemabloka).

Есть короткий и длинный типы записей параметров для направления раскрытия.

Например, если нужно расположить попап внизу, отцентрирован относительно `owner`, то можно написать так:


```javascript
{directions: 'bottom-center'} // длинный тип записи (здесь to: bottom, axis: center)
```

Тоже самое можно записать короче (так как для направления раскрытия вниз предусмотрено значение `axis`, а также другие параметры [по умолчанию](popup.js#L30-L51):

```javascript
{directions: 'bottom'} // короткий тип записи
```

Короткую запись можно комбинировать с длинной.
Например, при таких настройках в первом случае блок отобразится сверху, во втором – снизу. Хвост и сам попап всегда будут справа:

```javascript
{
    directions: [
        'top-right-right',
        {
            to: 'bottom',
            axis: 'right',
            tail: {
                axis: 'right'
            }
        }
    ]
}
```

Можно пропускать декларацию ключей (за исключением `to`), в таком случае им будет выставлено значение по умолчанию.

По умолчанию направления выстроены в [таком порядке](popup.js#L30-L51):

* `bottom-center-center`;
* `top-center-center`;
* `right-middle-middle`;
* `left-middle-middle`.

---
**NB** Блок раскрывается только в указанных ему направлениях с соблюдением порядка.

В версии Островов 2.0 список направлений раскрытия по умолчанию будет изменен. Если направления не указаны, то они будут сгенерированы и помещены в глобальный для всех попапов кэш методом `_generateDirections`. Сейчас это поведение можно включить, указав `generate: true `в JS параметрах блока.

---

<a name="storonaraskrytija"></a>
#### Сторона раскрытия

* `{String} to` — сторона `owner`, с которой будет открыт блок `popup`.

  Допустимые значения: `top`, `bottom`, `left`, `right`.

```js
[{
    block: 'button',
    mods: {size: 'm', theme: 'normal'},
    mix: [{block: 'owner'}],
    content: 'Я.Owner'
},
{
    block: 'popup',
    attrs: {style: 'width:200px'},
    mods: {adaptive: 'yes'},
    js: {directions: 'top'},
    content: [
        {elem: 'tail'},
        {
            elem: 'content',
            content: [
                'Душа моя озарена неземной радостью, как эти чудесные весенние утра, ',
                'которыми я наслаждаюсь от всего сердца. Я совсем один и блаженствую в здешнем краю, ',
                'словно созданном для таких, как я. Я так счастлив, мой друг, ',
                'так упоен ощущением покоя, что искусство мое страдает от этого.'
            ].join('')
        }
    ]
}]
```

<a name="os"></a>
#### Ось

  - `{String} axis` — ось. Может быть задана как для направления раскрытия, так и для хвоста. Значения при этом совпадают.

    Допустимые значения: `left`, `right`, `center`, `middle`, `bottom`, `top`.

<a name="parametryxvostavkontekstenapravlenijaraskrytija"></a>
#### Параметры хвоста в контексте направления раскрытия
Контекстом является направление, заданное в JS-параметрах блока.

```javascript
directions: [
    ...
    {
        to: 'left',
        axis: 'middle',
        tail: {axis: 'middle'} // контекст
    }
]
```

  - `{Object} tail` — параметры хвоста
    - `{String} axis` — [ось](#os)
    - `{Object} offset` — [смещение хвоста](#smeshheniexvosta)

#### Глобальные параметры хвоста

Глобальные настройки хвоста, которые можно передать в JS-параметрах блока `popup`:

  - `{Number} width` — ширина хвоста
  - `{Number} height` — высота хвоста
  - `{Object|Number} offset` — [смещение хвоста](#smeshheniexvosta)

При кастомизации и самостоятельном расчете размеров хвоста стоит учитывать тот факт, что он поворачивается на 45° с помощью CSS. Для кода, занимающегося расчетом положения блока, размер хвоста является лишь количеством пикселов, на которое нужно сместиться. Размеры хвоста меняются местами при открытии блока на стороны `left`, `right` (width → height, height → width)

<a name="smeshheniexvosta"></a>
#### Смещение хвоста
  - `{Object|Number} offset` — [смещение](#smeshhenie) хвоста. В зависимости от направления раскрытия имеют силу лишь два значения из указанных.
 Например, при раскрытии вниз будет иметь силу только отступ слева или справа.

<a name="smeshhenie"></a>
#### Смещение
  - `{Object|Number} offset` — смещение (как положительное, так и отрицательное).

    Объект с ключами:

    - `{Number} top`
    - `{Number} right`
    - `{Number} bottom`
    - `{Number} left`

При указании в качестве значения параметра `offset` числа (`{Number}`) это значение будет использовано для
задания отступа только в направлении раскрытия.

Например:

```javascript
js: {
    offset: 5
}
```

задаст отступ в 5px вверх, если направление раскрытия попапа будет вверх.

<a name="zafiksirovatpolozheniepoodnojjizkoordinatnyxosejj"></a>
#### Зафиксировать положение по одной из координатных осей

Иногда нужно, чтобы блок не пересчитывал свою позицию по одной из координатных осей (здесь под термином "координатные оси" имеются ввиду значения `top`, `left`). Для этого был сделан JS-параметр `position`.
Пример:

```javascript
js: {
    position: {
        top: 5,
        left: 5
    }
}
```

### Модификаторы блока

#### Тема оформления
Для попапа реализована одна тема – белая, модификатор `theme` со значением `ffffff`. Визуально попап представлен белым прямоугольником с полупрозрачной тенью. Используется по умолчанию.
У модального окна появляется темная полупрозрачная подложка (элемент `under`).

Крестик-кнопка закрытия попапа (элемент `close`) – векторное изображение в формате svg.
Добавить закрывающий крестик можно с помощью модификатор `has-close` со значением `yes`. По умолчанию он добавляет блоку на уровне шаблонизатора элемент `close`.

#### Модальное окно

Модификатор блока `type` со значением `modal` отобразит `popup` в виде модального окна. Для модальных окон выставляется элемент `under` (подложка) с модификатором `type` со значением `paranja`.
По умолчанию элемент `under` всегда добавляется в шаблоне блока для всех `popup`.

Возможна модификация следующих полей во входных данных:

`{Object} underMods` – модификаторы для элемента `under`.

`{Number|String} zIndex` – значение поля изменит значение CSS-свойства `z-index`, заданное по умолчанию для блока `popup`.

```js
{
    block: 'popup',
    attrs: {style: 'width: 400px'},
    mods: {
    	type: 'modal', // устанавливает тип для попапа – модальное окно
    	position: 'fixed',
    	'has-close': 'yes' // опционально, добавляет элемент `close` (закрывающий крестик)
    },
    underMods: {type: 'paranja'}, // модификаторы подложки (элемент `under`)
	content: [
        {elem: 'tail'},
        {elem: 'content', content: 'Модальное окно'}
    ]
}
```

При указании модификаторов элемента подложки (`under`), их необходимо добавить в зависимости:

```javascript
{
    shouldDeps: [
        {
            block: 'popup',
            elem: 'under',
            mods: {type: 'paranja', color: 'white'}
        }
    ]
}
```

<a name="fiksirovannyepopapy"></a>
#### Фиксированные попапы

Есть одна особенность обработки потомков попапа, который имеет модификатор `position` в значении `fixed`.
Например, если есть два блока `popup`, вложенных друг в друга, и родительский блок имеет модификатор `position` в значении `fixed`, то вложенный `popup` не будет выносить себя в конец `<body>`. В момент показа дочерний попап вынесет себя за пределы элемента `content` родительского `popup`.
Такое решение призвано улучшить поведение блока при прокрутке и исправить некоторые ошибки на планшетах.

---
**NB** В Островах v2 планируются изменения. В библиотеке «Ромочка» фиксированным попапом называлось модальное окно. Сейчас этот модификатор практически ничего общего с ним не имеет, только добавляет стиль "position: fixed" для попап.

На winPhone 7.5 в IE9 не работает свойство `position: fixed`.

---

<a name="animacija"></a>
#### Анимация скрытия/появления

Анимация вызывается только при наличии модификатора `animate` со значением `yes`.
Обеспечивается методами `afterShow`, `beforeHide`. Важно то, что `beforeHide` обязательно должен вызвать callback, который получает первым аргументом при вызове.

Есть возможность отключить анимацию скрытия/появления, установив дополнительно модификаторы:

- `fade-in` со значением `no` — не использовать анимацию появления.
- `fade-out` со значением `no` — не использовать анимацию скрытия.

Запретить анимацию можно, выставив модификатору `animate` значение `no`.

```js
[{
    block: 'button',
    mods: {size: 'm', theme: 'normal'},
    mix: [{block: 'owner'}],
    content: 'Я.Owner'
},
{
    block: 'popup',
    attrs: {style: 'width:200px'},
    mods: {'fade-out': 'no', adaptive: 'yes'},
    js: {directions: 'bottom'},
    content: [
        {elem: 'tail'},
        {
            elem: 'content',
            content: 'Анимация скрытия/появления'
        }
    ]
}]
```

<a name="skrolldljasvoegokontenta"></a>
#### Прокрутка для своего контента

Блок умеет убирать полосы прокрутки с `<body>`и создавать прокрутку для своего контента. Это обеспечивается модификатором `behaviour` со значением `scrollable`.

```js
{
    block: 'popup',
    mods: {
        type: 'modal',
        'has-close': 'yes',
         behaviour: 'scrollable'
    },
    underMods: {type: 'paranja'},
    content: [
        {elem: 'tail'},
        {
            elem: 'content',
            content: 'Прокрутка содержимого'
        }
    ]
}
```

<a name="vzaimosvjazimezhdupopupami"></a>
#### Взаимосвязи между блоками popup

Так как попап выносит себя в конец `<body>`, чтобы перекрывать другие элементы страницы, возникает необходимость в построении взаимосвязей. Блок умеет выстраивать связи Parent→[ Child, Child, ... ]. Для этого он выполняет проверку, вложен ли его `owner` (блок, вызывающий попап)  в другой `popup`. Потомки знают о наличии родителя. Например, Домик. Если бы этих взаимосвязей не было, то родительский попап (при наличии модификатора `autoclosable` со значением `yes`) закрылся при клике внутри дочернего.

Другими словами, модификатор `autoclosable` со значением `yes` означает, что попап закроется сам и закроет свои дочерние блоки при клике за пределами самого себя и дочерних попапов.
Дочерние блоки `popup` можно рассматривать в виде цепочки 1→2→3→4. При клике на 2-ом попапе – закрываются 3, 4. При клике в 1 – закрываются 2, 3, 4. При клике за пределами любого попапа из цепочки – закроются все.

<a name="viewport"></a>
#### Выбор направления раскрытия по фактору попадания в произвольный блок

По умолчанию выбор происходит по фактору попадания в окно. Если требуется поменять это поведение, то нужно использовать метод `setViewport`, который принимает единственный параметр — jQuery элемент. Он позволяет указать произвольный DOM-узел, по которому нужно выбирать направление раскрытия.
Не вызывает перерисовки.

#### Видимость

Модификатор `visibility` определяет видимость блока. Допустимые значения:
* `visible` – блок видим;
* `hidden` – спрятан;
* `outside` – показан за пределами области просмотра браузера.

#### Адаптивность (направление раскрытия)

Модификатор `adaptive` со значением `yes` определяет направление раскрытия попапа.
Выбирается первое направление со 100% видимостью попапа. При отсутствии направления,
в котором попап виден полностью, будет выбрано направление с максимальной видимостью.

Порядок перебора направлений может задаваться в BEMJSON. По умолчанию - `bottom`, `top`, `right`, `left`.

#### Авторазмер

Модификатор `autosize` со значением `yes` включает режим подстройки под доступное свободное место. При выборе
направления раскрытия попапа, если попап не умещается полностью по рассчитываемому направлению,
то его размер ограничивается оставшимся свободным местом.
Доступное свободное место определяется c учетом размеров хвостика (при его наличии) и заданных
в BEMJSON отступов (offset).

```js
{
    block: 'popup',
    mods: {
        adaptive: 'yes',
        autosize: 'yes'
    },
    js: {
        directions: [
            {to:'right',offset:{right:-20}},
            {to:'bottom',offset:{bottom:-20}},
            {to:'top',offset:{top:-20}}
        ]
    },
    content: [
        {elem: 'tail'},
        {
            elem: 'content',
            content: 'Авторазмер'
        }
    ]
}
```
