## Описание

Блок `radio-button` – кнопочная «радиогруппа». Применяется для создания набора зависимых кнопочных переключателей (элементы блока `radio` в виде кнопок). Используется для выбора единственного варианта из предложенного списка.

`radio-button` базируется на блоке [radiobox](../radiobox/radiobox.ru.md). В версиях браузера MSIE ниже 8 элементы кнопочной радиогруппы – радиокнопки, деградируют до нативных переключателей <input name="имя" type="radio" атрибуты>.

Блок позволяет использовать [отложенную инициализацию](#live).

### Объявление блока на странице

BEMJSON для использования блока `radio-button`:

```javascript
{
    block: 'radio-button', // имя блока
    mods: {size: 'm', theme: 'normal'}, // модификаторы блока. Модификатор размера - обязательный
    name: 'show_to',     // имя радиогруппы. Одинаковое для всех радиокнопок группы. Обязательное поле
    value: 'friends',    // значение для предварительного выделения радиокнопки
    content: [ // массив радиокнопок
        {
            elem: 'radio', // радиокнопка
            controlAttrs: {value: 'all'}, // атрибуты радиокнопки. Атрибут `value` – обязательный
            elemMods: {disabled: 'yes'},   // модификаторы радиокнопки
            content: 'виден всем'           // текст радиокнопки
        },
       {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        }
    ]
}
```

В результате BEMHTML-преобразований блок `radio-button` на странице заменяется HTML-тегом `<span>` – контейнер, содержащий группу радиокнопок.

На уровне шаблона каждый элемент `radio` преобразуется  в HTML-тег `<label for="значение_id">` (метка), реализующий пользовательскую радиокнопку,
внутри которой находится нативный переключатель `<input type="radio" name="имя" атрибуты>` (элемент `control`).

Метка связывается с переключателем  `<input type="radio" id="значение_id">` через свой атрибут `for` и аналогичным значением `id` у `input`.

```js
{
    block: 'radio-button',
    mods: {size: 'm', theme: 'normal'},
    name: 'show_to',     
    value: 'friends',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'all'},
            elemMods: {disabled: 'yes'},  
            content: 'виден всем'           
        },
       {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            elemMods: {disabled: 'yes'},
            content: 'только мне'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'other'},
            content: 'только не мне'
        }
    ]
}
```

### Атрибуты кнопочной радиогруппы

Задаются в одноименных полях входного BEMJSON блока.

* `{String} name` – имя кнопочной радиогруппы. **Обязательное поле.** По умолчанию присваивается всем радиокнопкам. BEMHTML-шаблоном трансформируется в атрибут `name` с заданным значением для каждого нативного переключателя группы.

* `{String} value` – служит для предварительного выделения радиокнопки.
 Устанавливает состояние **выбрана** (модификатор `checked` со значением `yes`) радиокнопке
со значением `value` из поля `controlAttrs`, совпадающее с заданным значением `value` блока.

### JS-параметры

* `{Object} js` – JS-параметры блока
  * `{String} id` – идентификатор радиогруппы. Значением параметра может выступать произвольная строка.

Несколько блоков `radio-button` могут функционировать как единая радиогруппа.
Состояние их будет согласовано: возможно выбрать только один элемент из общей совокупности элементов радиогрупп.

Для этого нужно для каждой из объединяемых радиогрупп:

* в JS-параметрах указать одинаковое значение параметра `id`;
* указать одинаковое значение в поле `name`.
В результате при инициализации блоков создается один JS-объект, поле `{jQuery} domElem` которого содержит ссылки на DOM-узлы радиогрупп.

Идентификатор  `id` используется только в момент инициализации экземпляра блока. Значение `id` должно быть уникальным в пределах экземпляров одного блока.
[Подробнее о распределенных блоках](https://github.com/bem/bem-core/blob/v1/common.docs/i-bem-js/i-bem-js.ru.md#%D0%9E%D0%B4%D0%B8%D0%BD-js-%D0%B1%D0%BB%D0%BE%D0%BA-%D0%BD%D0%B0-%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%B8%D1%85-html-%D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%85).
Радио-группы могут располагаться в произвольном месте страницы.

```js
({
    block: 'radio-button',
    js: {id: 'show_to'},
    mods: {size: 'm', theme: 'normal'},
    name: 'show_to',     
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'all'},
            elemMods: {disabled: 'yes'},  
            content: 'виден всем'           
        }
    ]
},
'&nbsp;&nbsp;',
{
    block: 'radio-button',
    js: {id: 'show_to'},
    mods: {size: 'm', theme: 'normal'},
    name: 'show_to',     
    value: 'me',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            content: 'только мне'
        }    
    ]
})
```

### Содержимое кнопочной радиогруппы
* `{Array} content` – содержит набор радиокнопок.

### Атрибуты радиокнопок

* `{Object} controlAttrs` – атрибуты радиокнопки (элемента `radio`), совпадают с  атрибутами нативного переключателя.
В результате BEMHTML-преобразований трансформируются в соответствующие атрибуты с заданными значениям нативного переключателя.
Допустимые атрибуты:
  * `{String} value` – значение, отправляемое на сервер, уникальное для каждого `radio`. Обязательный атрибут.
  * `{String} id` – уникальный идентификатор радиокнопки. Если явно не задан, генерируется автоматически.
  * `{Number} tabindex` – определяет последовательность перехода между элементами при нажатии на кнопку `Tab`.

### Содержимое радиокнопки

* `{String} content` – в поле задается текст, присутствующий на радиокнопке.
 Для отображения текста используется элемент блока `text`, который добавляется
 в BEMHTML-шаблоне по моде `content` и трансформируется в HTML-тег `span`.

У радиокнопки без содержимого (т.е. отсутствуют текст и иконка) кнопка отобразится пустой с размером, указанным в модификаторе `size`.

Кнопки радиогруппы, помимо текста, могут содержать текст с иконкой или только иконку.
Для отображения иконки в BEMJSON элемента `radio` нужно:

* добавить модификатор `only-icon` со значением `yes` (только для иконки без текста);
* выполнить микс элемента блока `icon` с блоком иконки [image](../image/image.ru.md). Иконка задается с помощью нового модификатора блока `image` (произвольная пара «ключ:значение»), для которого в CSS хранится путь к изображению.

```js
{
    block: 'radio-button',
    mods: {size: 'm', theme: 'normal'},
    name: 'show_to',
    content: [
        {
             elem: 'radio',
             controlAttrs: {value: 'photo'},
             elemMods: {'only-icon': 'yes'}, // только для кнопок с одной иконкой
             content: [
                 {
                     block: 'image',
                     // mods: {'16': 'view'} задаст иконку view (фотоаппарат) размером 16px
                     mix: [{block: 'radio-button', elem: 'icon', elemMods: {'16': 'photo'}}]
                  },
                  'Фото'
             ]
        }
    ]
}
```

<a name="live"></a>
## Отложенная инициализация
По умолчанию радио-группы инициализируется автоматически при загрузке страницы (то есть при наступлении события `domReady`).
При большом количестве радио-групп это создает большую нагрузку на браузер, причем не все радио-группы могут потребоваться
пользователю. Для оптимизации производительности рекомендуется инициализировать блок отложено.

### Включение отложенной инициализации
Есть несколько способов включить отложенную инициализацию:

* **Локально** – для конкретного экземпляра блока `radio-button`.
Достаточно в BEMJSON-декларации блока указать JS-параметр `live` со значением `true`
(значение по умолчание `live: false` – автоматическая инициализация).

 ```javascript
 {
     block: 'radio-button',
     js: { live: true }
     ...
 }
 ```

* **Глобально** – для всех блоков `radio-button` проекта.
В этом случае, на уровне своего проекта нужно доопределить `BEMHTML`-шаблон блока
`radio-button/radio-button.bemhtml.js` следующим образом:

```javascript
block('radio-button').js()(function() {
    return this.extend({live: true}, this.ctx.js);
});
```
для `BH`-шаблона `radio-button/radio-button.bh.js` доопределение будет таким:

```javascript
module.exports = function(bh) {
    bh.match('radio-button', function(ctx) {
        ctx.js(ctx.extend({live: true}, ctx.js()));
    });
};
```

Все блоки `radio-button` проекта станут инициализироваться отложено, кроме блоков с явно отключенной live-инициализацией в BEMJSON через JS-параметр `live: false`:

 ```javascript
 {
     block: 'radio-button',
     js: { live: false }
     ...
 }
 ```

В этих случаях радио-группа инициализируется сразу.

### Модификаторы блока

#### Модификатор `side`

Отвечает за скругление углов радиокнопок блока.

* Крайние левая и правая радиокнопки в группе отображаются с закругленными сторонами.
По умолчанию на уровне шаблонизатора элемента `radio` крайним кнопкам добавляется модификатор `side` со значением `left` или `right` соответственно.
* По умолчанию для радиогруппы, состоящей из одной радиокнопки, устанавливается модификатор `side` со значением `both`.
Выполняет визуальное скругление углов радиокнопки с двух сторон.
* Оформление и размеры радиокнопки совпадают с обычной кнопкой ([button](../button/button.ru.md), модификатор `theme` со значением `normal`).

#### Модификатор `theme`

**Обязательный**. Отвечает за стилевое оформление блока. По умолчанию не выставляется. При использовании модификатора необходимо самостоятельно добавить его в зависимости блока. 

Способ установки: BEMJSON.<br>
Допустимое значение: `normal`.

#### Модификатора `size`

**Обязательный**. Отвечает за размер радиокнопок радиогруппы. По умолчанию не определен.
Без указания размера радиокнопки группы не отобразятся на странице.

Способ установки: BEMJSON. <br>
Допустимые значения: `хs`, `s`,`m`, `l`, `head` (экспериментальный, доступен на уровне `desktop`; используется в шапке).

**xs**
```js
{
    block: 'radio-button',
    mods: {size: 'xs', theme: 'normal'},
    name: 'show_to',     
    value: 'me',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            content: 'только мне'
        }    
    ]
}
```

**s**
```js
{
    block: 'radio-button',
    mods: {size: 's', theme: 'normal'},
    name: 'show_to',     
    value: 'me',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            content: 'только мне'
        }    
    ]
}
```

**m**
```js
{
    block: 'radio-button',
    mods: {size: 'm', theme: 'normal'},
    name: 'show_to',     
    value: 'me',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            content: 'только мне'
        }    
    ]
}
```

**l**
```js
{
    block: 'radio-button',
    js: {id: 'show_to'},
    mods: {size: 'l', theme: 'normal'},
    name: 'show_to',     
    value: 'me',    
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            content: 'только мне'
        }    
    ]
}
```

#### Состояния радиокнопок

* **Не активна**, модификатор `disabled` – радиокнопка недоступна для действий пользователя.
* **В фокусе**, модификатор `focused`.
* **Нажата**, модификатор `pressed` (но не выбрана, модификатор для обозначения активности кнопки).
* **Выбрана**, модификатор `checked`.
 Одна из кнопок радиогруппы может постоянно находиться в состоянии «выбрана» (визуально - кнопка выделена оранжевым цветом).

 Модификаторы состояния радиокнопки задаются в поле `{Object} elemMods` элемента `radio`. Устанавливаются со значением: `yes`.

 ---
 **NB** кнопка различает состояния **нажата** и **выбрана**.
 Нажимается кнопка по событию `mousedown` (по аналогии с `button`), но выбор текущего значения (`check`) происходит при `mouseup`. Это обусловлено нативным поведением `<input type="radio"/>`.

---

Радиокнопка может одновременно находиться в нескольких состояниях. Например: **в фокусе** и **выбрана**.

Нажатие по кнопке может выполняться клавишей **Space** или **Enter**, если она находится в фокусе.
Переход по элементам радиогруппы осуществляется клавишами **[ ←, ↑, →, ↓ ]**.

```js
{
    block: 'radio-button',
    mods: {size: 's', theme: 'normal'},
    name: 'show_to',     
    content: [
        {
            elem: 'radio',
            controlAttrs: {value: 'friends'},
            elemMods: {disabled: 'yes'},
            content: 'только друзьям'
        },
        {
            elem: 'radio',
            controlAttrs: {value: 'me'},
            elemMods: {checked: 'yes'},
            content: 'только мне'
        },
        {    
            elem: 'radio',
            controlAttrs: {value: 'val-4'},
            content: 'только не мне'
        }    
    ]
}
```
