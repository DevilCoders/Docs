## Описание

**Статус блока**: **deprecated**

Блок `alert-controller` – медиатор, обеспечивающий взаимосвязь между блоком источником сообщения и блоком отображающим сообщение ([`alert`](../alert/alert.ru.md)). Сообщения могут быть трех типов: информационное, об ошибке и блокирующее.

Связь осуществляется с помощью абстрактного блока не имеющего визуального представления `alert-message`, который является вспомогательным для вызова сообщений.

`alert-controller` ищет все блоки `alert-message` внутри себя расположенные на странице (блок [b-page](../b-page/b-page.ru.md)) и слушает(подписывается на события) кастомные БЭМ-события на всех найденных экземплярах.

Блок-источник – это любой блок, из кода которого может вызываться `alert`.

Вызов выполняется следующим образом:

* К каждому блоку-источнику примиксовывается блок `alert-message` (для удобства использования).
* Затем на блоке `alert-message` вызывается соответствующее событие, для показа нужного сообщения.

На странице всегда отображается только одно сообщение. Поскольку перед каждым показом нового сообщения все существующие удаляются.


### Объявление блока на странице

BEMJSON для подключения блока:

```javascript
({
    block: 'b-page',
    mix: [{
        block: 'alert-controller', // блок-контроллер
        js: { // задания текста по умолчанию для каждого типа сообщения
            message: {
                error: 'Упс, что-то пошло не так&hellip; <br/> Попробуйте поискать снова',
                block: 'Все сломалось!',
                info: 'Все суперпупер круто, <br/> продолжайте в том же духе'
            },
            buttonTxt: 'Обновить'
        }
    }],
    title: 'заголовок',
    head: [...],
    content: [
        {
            block: 'button', // блок-источник сообщения
            js: true,
            mods: {
                type: 'simple',
                message: 'error' // тип сообщения.
            },
            mix: [{block: 'alert-message'}],// подмешивание блока `alert-message`
            content: 'Показать сообщение об ошибке'
        },
        ...
    ]
});
```

### JS-параметры блока

* `{Object} message` – предназначен для задания текста сообщения по умолчанию каждому типу сообщения:

  * `info` - информационное;
  * `error` - об ошибке;
  * `block` – блокирующее.

* `{String} buttonTxt` – текст кнопки для блокирующего сообщения.

На уровне проекта можно переопределить текст сообщения по умолчанию  при генерации одного из БЭМ-событий блока `alert-message`. Для этого ему передается в качестве данных объект с параметрами `message` и `buttonTxt`(только для блокирующего сообщения).

[пример переопределения текста для блокирующего сообщения](../alert/alert.examples/10-simple.blocks/button/_message/button_message_block.js).

```javascript
BEM.DOM.decl({name: 'button', modName: 'message', modVal: 'block'}, {
    onSetMod: {
        js: function() {
            // переопределяем дефолтный текст для блокирующего типа
            this.bindTo('tap', function() {
                this.findBlockOn('alert-message').trigger('alertBlock',
                    {
                        message: 'Что-то пошло не так. <br/> Попробуйте обновить страницу.',
                        buttonTxt: 'Обновить'
                    }
                );
            });
        }
    }
});
```

### Положение и время показа сообщения

Для показа сообщения блок `alert-controller` генерирует блок `popup` c вложенным блоком `alert`, в котором отображается сообщение.

Перед показом скрывается саджест, положение попапа и время его показа зависит от типа сообщения.

Блокирующее сообщение отображается в модальном окне, содержит кнопку  и располагается строго по центру страницы. Скрывается только по тапу на кнопку или выполняет кастомное действие по нажатию на кнопку, если такое было задано.

Окно сообщения об ошибке и информационное отображаются под шапкой страницы, если она в области видимости, иначе – сверху экрана и скрываются через 5 секунд после показа.
