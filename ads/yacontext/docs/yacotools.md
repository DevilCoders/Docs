# Yacotools: вспомогательные инструменты

## В разделе приведена информация о различных функциях, реализуемых компонентом Yacotools {#about}

Компонент Yacotools представляет собой набор инструментов, выполняющих различные задачи для поддержания работы других компонентов Фокусировщика. На схеме ниже отражены взаимосвязи между логическими блоками в составе Yacotools, компонентами Фокусировщика и внешними сервисами.

![](images/yacotools.png)

(1) Основной функцией, реализуемой компонентом Yacotools, является сборка словаря ключевых фраз и категорий на основе данных о ключевых фразах и категориях баннеров, полученых от компонента Yacoads. Подробно о ключевых фразах и категориях рассказывается в подразделе [Привязки, ключевые фразы и категории](bindings.md), о работе Yacoads — в подразделе [Yacoads: классификация баннеров](yacoads.md). Сборка словаря осуществляется в следующей последовательности:

* формируется список уникальных фраз баннеров из всех ключевых фраз всех баннеров;
* фразам из списка приписываются все категории, которые были назначены хотя бы одному баннеру, у которого конкретная уникальная фраза была ключевой;
* если фразе приписано более 3 категорий, то остается 3 наиболее популярных категории с точки зрения оценки количества различных рекламодателей.

(2) Модули CustomBinder и CatServer предназначены для классификации различных объектов (URL-адресов, фраз, документов) с помощью BSClassify и классификатора «Каталогия». Для данных инструментов реализовано API, обрабатывающее запросы от Яндекс.Директа и Broadmatch. В запросе содержится набор данных для классификации и тип задания, определяющий какой из классификаторов будет использоваться: 

* `catserver` — классификация по категориям Яндекс.Каталога (входные данные — список URL-адресов);
* `catserver_BM` — классификация по категориям "Каталогии" (входные данные — список URL-адресов);
* `custom_binder` — классификация документов в соответствии с приложенным словарем (входные данные — словарь категорий, документы).

(3) Блок классификаторов предоставляет внешним сервисам возможность доступа к любому из классификаторов Фокусировщика:

* FILTER_TRIE, FILTER_OBJ — классификация по каталогу аналогично CatFilter (описан в разделе [Yacoads: классификация баннеров](yacoads.md));
* SUBQUERY — колдунщик Subquery (подробное описание на [Wiki](http://wiki.yandex-team.ru/EvgenijjKroxalev/subquery));
* AD, PHRASE — классификация баннера или набора фраз аналогично AdClassifier (описан в разделе [Yacoads: классификация баннеров](yacoads.md)); PHRASE классифицирует фразы, AD использует PHRASE, для того чтобы классифицировать баннер или набор фраз;
* TRAGIC — определение степени трагичности контента документа ([Трагический фильтр](tragic-context.md)).

В набор скриптов экспорта-импорта данных входят следующие скрипты:

(4) Скрипты, предоставляющие различную статистическую информацию о документах, привязках, категориях:

* YACOBOT_EXPORT_QUEUE — экспорт привязок (Yacotools хранит все привязки, сформированные Yacobot-серверами за последнюю неделю; ограничение очереди — 10&nbsp;000 файлов);
* YACOBOT_EXPORT — экспорт статистических срезов по категориям для доменов РСЯ (относительное количество документов по категориям);
* YACOBOT_EXPORT_PAGES — экспорт статистических срезов для рекламных площадок РСЯ:
    * абсолютное количество документов по категориям;
    * количество URL-адресов по статусам;
    * количество URL-адресов по кодировкам.

(5) Скрипт UPDATE_MARKET обновляет словари ключевых фраз queries.log, data.dat, prices.dat, используемые Market Binder в создания привязок для баннеров Яндекс&nbsp;Маркета. Скрипты MCB_PAGES и MCB_PHRASES загружают на Yacobot-серверы словари ключевых фраз для медийно-контекстных баннеров, используемые MCB Binder. Функциональность Direct Binder, Market Binder и MCB Binder подробно описана в разделе [Формирование привязок](yacobot-binders.md).

(6) Скрипт MIRRORS_DB_MASTER обновляет базу зеркал рекламных площадок РСЯ, используя данные Яндекс&nbsp;Поиска и Master Server.

