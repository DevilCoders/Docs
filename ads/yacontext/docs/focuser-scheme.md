# Общее описание

В состав Фокусировщика входит несколько внутренних компонентов, каждый из которых реализует отдельную функциональность и связан с другими компонентами и внешними сервисами.

Упрощенная схема внутренного устройства Фокусировщика представлена на рисунке ниже.

![](images/focuser-genscheme.png)

(1) Каждый раз, когда посетитель сайта, входящего в РСЯ, попадает на страницу, где размещен код вызова рекламного блока, адрес этой страницы сохраняется Баннерокрутилкой. Все сохраненные адреса, а также дополнительная информация о посещении страниц хранятся в файлах формата RefLog, которые забирает Master Server.

(2) Master Server обрабатывает поток URL-адресов, полученный от Баннерокуртилки, распределяет URL-адреса по Yacobot-серверам для последущего скачивания и привязки (подробнее см. в разделе [Master Server: распределение URL-адресов](master-server.md)), оптимизируя нагрузку на отдельные компоненты Фокусировщика.

Также на Master Server реализован специальный компонент, который обрабатывает параметры URL-адресов (query_args) и определяет их значимость (подробнее см. в разделе [Qargfilter: обработка параметров URL-адресов](queryargs.md)), что также позволяет упростить обработку потока URL-адресов и не скачивать страницы с одинаковым содержимым.

(3) Классификация баннеров Яндекс.Директа производится с помощью компонента Yacoads (подробнее о классификации баннеров см. в разделе [Yacoads: классификация баннеров](yacoads.md)).

(4) Компонент Yacotools представляет собой набор инструментов, выполняющих различные задачи для поддержания работы других компонентов Фокусировщика, таких как, например, составление словаря ключевых фраз и категорий, который необходим для формирования привязок, обновление классификаторов, предоставление данных для экспорта другим сервисам Яндекса (подробнее см. в разделе [Yacotools: вспомогательные инструменты](yacotools.md)).

(5) Основная функциональность Фокусировщика реализована на кластере Yacobot-серверов. Каждый Yacobot-сервер (или Yacobot) в составе кластера выполняет следующие задачи для определенной части доменов сайтов РСЯ:

* скачивание содержимого (веб-страниц) по полученному с Master Server списку URL-адресов;
* классификация страниц — присвоение им категорий с помощью специального классификатора сайтов;
* формирование привязок и заглушек для страниц сайтов РСЯ по словарю ключевых фраз и категорий в соответствии с содержимым скачанных страниц и присвоенной категорией;
* передача данных (привязок, заглушек, а также query_args) в Баннерокрутилку.

Подробно архитектура yacobot-серверов описана в разделе [Yacobots: скачивание, классификация и привязка](yacobots.md).

(6) Под компонентом Yacofast на данной схеме подразумевается группа компонентов Фокусировщика (Yacofast, Yacortbinder, Yacotitles), которые позволяет в режиме реального времени определить и передать в Баннерокрутилку быстрые привязки для страницы сайта партнера без скачивания ее содержимого (подробнее см. в разделе [Yacofast: быстрый Фокусировщик](yacofast.md)).

