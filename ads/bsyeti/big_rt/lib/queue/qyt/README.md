# QYT

QYT (queue over YT, очередь на YT, кыть) - упорядоченная динтаблица + обвязка нод рядом, добавляющая сущности потребителей.

Здесь лежит объект для всех операций с QYT:
* Записи в QYT
* Чтения из QYT и коммита оффсетов от имени потребителя (читателя, consumer'а) очереди
* Тримминга - удаления закоммиченных всеми важными потребителями данных

Примерная иерархия очереди на YT:
   * `<queue_path>/queue` — сама очередь, тут всего две колонки: value (строка) и codec (как ее расшифровывать)
   * `<queue_path>/consumers/<consumer_name>/offsets` — сортированная динтаблица всех прочитанных оффсетов потребителя
   * `<queue_path>/consumers/<consumer_name>/options` - опции читателя, например нужно ли учитывать этого читателя при тримминге 
   (тестовых читателей обычно не нужно).

## Требования для пользователя очередей
При создании консьюмера необходимо выдать на робота консьюмера:
1. Права чтения динамической таблицы очереди `queue`.
2. Права записи на папку данного консьюмера, поскольку туда пишутся роботом оффсеты по нему.

При использовании коммунального Queue Daemon необходимо получить права на запись в таблицу регистрации,
более подробно как это сделать указано в [документации демона](https://a.yandex-team.ru/arc/trunk/arcadia/ads/bsyeti/big_rt/queue_daemon#konfiguraciya-prav).  
Документация по инструменту управления очередями big_rt_cli находится [здесь](https://a.yandex-team.ru/arc/trunk/arcadia/ads/bsyeti/big_rt/cli).
