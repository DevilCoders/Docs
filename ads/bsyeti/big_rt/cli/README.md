
### Bigb RT command line interface

(autogenerated with gen_readme subcommand)

```text
usage: big_rt_cli [-h] [-v] [--proxy PROXY]
                  {queue,offsets_table,consumer,consuming_system,gen_readme}
                  ...

Docs:
Rights configuration for consumers - https://a.yandex-team.ru/arc/trunk/arcadia/ads/bsyeti/big_rt/lib/queue/qyt#trebovaniya-dlya-pol—åzovatelya-ocheredej
Rights configuration for Queue Daemon - https://a.yandex-team.ru/arc/trunk/arcadia/ads/bsyeti/big_rt/queue_daemon#konfiguraciya-prav
Bigb RT command line interface

Required environment variables:
    YT_PROXY
    YT_TOKEN
Examples:
    YT_PROXY=pythia ./big_rt_cli queue trim //home/bigb_resharder_test/ShardedTest --ignore-consumers  # clear queue

positional arguments:
  {queue,offsets_table,consumer,consuming_system,gen_readme}
    queue                               All operations with queue itself: create/remove/read/write/update options
    offsets_table                       Create/remove offsets table (legacy?)
    consumer                            Consumers of queue. Create/remove/list all. Consumer's offsets operations. Consumer's options operations
    consuming_system                    Diagnostic of CS: find host processing shard, find slow shards and hosts.
    gen_readme

options:
  -h, --help                            show this help message and exit
  -v, --verbose                         Verbose level: INFO if verbose else ERROR
  --proxy PROXY                         Alternative for YT_PROXY env type=str

Command scheme:
    -v, --verbose  Verbose level: INFO if verbose else ERROR
    --proxy PROXY  Alternative for YT_PROXY env type=str
    queue:
        #  All operations with queue itself: create/remove/read/write/update options
        create:
            #  Creates queue over yt
            queue_path              type=str
            --shards SHARDS         Count of shards (or tablets in terms of YT) type=int default=3072
            --medium {default,ssd_blobs}
                                    type=str default=default
            --max-ttl MAX_TTL       how long keep data in queue e.g. (3600 - seconds, 4d - (d)ays, 2h - (h)ours, 30m - (m)inutes) type=ttl
            --commit-ordering {weak,strong}
                                    type=str default=weak
            --swift                 Create SwiftQueue
            --add-timestamp         Add $timestamp field to queue scheme
            --queue-options QUEUE_OPTIONS
                                    Options for a queue, e.g. '{"RetainedMessagesPerShard": 500}'. Overwrite if exist type=parse_queue_options default={}
        update:
            #  Updates attributes of existing queue over yt.
            #  New queue options fully overwrite attribute queue_options in yt queue.
            queue_path              type=str
            --medium {default,ssd_blobs}
                                    type=str
            --max-ttl MAX_TTL       how long keep data in queue e.g. (3600 - seconds, 4d - (d)ays, 2h - (h)ours, 30m - (m)inutes) type=ttl
            --queue-options QUEUE_OPTIONS
                                    Options for a queue, e.g. '{"RetainedMessagesPerShard": 500}'. Overwrite if exist type=parse_queue_options default=None
        get_options:
            #  Get queue_options of a queue.
            #  Example: YT_PROXY=pythia ./big_rt_cli queue get_options //home/bigb_resharded_queues/BigbSwiftEventsQueue
            queue_path  type=str
        sync_schema:
            #  Synchronize queue table schema (makes alter if need)
            queue_path  type=str
        remove:
            #  Removes queue over yt
            queue_path  type=str
            --force
        trim:
            #  Print command to run to trim queue
            queue_path              type=str
            --retained-messages-per-shard RETAINED_MESSAGES_PER_SHARD
                                    type=int default=0
            --ignore-consumers
        register:
            #  Command to register queue for public queue daemon
            queue_path              type=str
            --registry-path REGISTRY_PATH
                                    type=str
        unregister:
            #  Command to unregister queue for public queue daemon
            queue_path              type=str
            --registry-path REGISTRY_PATH
                                    type=str
        write:
            #  Write data to queue. Example of data_json: '{"1": ["record1", "record2"], "2": ["record3"]}'. "1", "2" in this context are shard numbers
            queue_path     type=str
            data_json      type=str
            --codec CODEC  codec from library/cpp/blockcodecs, by default will use default queue codec type=str default=None
        read:
            #  Read data from queue. If start_offset is negative, (TotalRowCount + start_offset) will be used. TotalRowCount - total row count in specified shard or (maximal offset + 1)
            queue_path              type=str
            --shard SHARD           type=int default=0
            --start-offset START_OFFSET
                                    type=int default=-1
            --output-format {json,yson}
                                    type=str default=yson
            --pretty
            --raw
            --limit LIMIT           type=int default=1
    offsets_table:
        #  Create/remove offsets table (legacy?)
        create:
            #  Creates and mounts Offsets table for using by ConsumingSystem
            table_path  type=str
        remove:
            #  Unmounts and removes Offsets table for using by ConsumingSystem
            table_path  type=str
    consumer:
        #  Consumers of queue. Create/remove/list all. Consumer's offsets operations. Consumer's options operations
        list:
            queue_path  type=str
            --json
        create:
            #  Create consumer of queue
            queue_path              type=str
            consumer                type=str
            --ignore-in-trimming {0,1}
                                    sets IgnoreInTrimming consumer's option (usually 0 for production connsumers and 1 for test ones) type=int
        remove:
            queue_path  type=str
            consumer    type=str
        get_offsets:
            #  Get consumers offsets for specified shards. shards is python-evaluated expression. shards=="" means all shards
            #  Example: YT_PROXY=pythia ./big_rt_cli consumer get_offsets //home/bigb_resharder_test/ShardedTest demo_stateful_processor --shards "range(2)"
            queue_path       type=str
            consumer         type=str
            --shards SHARDS  type=str
        update_offsets:
            #  Update consumers offsets for specified shards. shards is same as in get_offsets.
            #  Value is python-evaluated expression that can use variables: 'shard', 'old' - old value of offset,
            #      'unreachable' - to exclude this shard from shard lag calculation.
            #      negative value means offset = (egde - value), 0 means trimmed edge.
            #  Example: ./big_rt_cli consumer update_offsets //home/bigb_resharder_test/ShardedTest demo_stateful_processor --shards "range(10)" --value "0"
            queue_path       type=str
            consumer         type=str
            --shards SHARDS  type=str
            --value VALUE    type=str
        get_options:
            #  Get consumer options (it is user attribute '_options' of consumer's path)
            queue_path  type=str
            consumer    type=str
        set_options:
            #  Set consumer options (it is user attribute '_options' of consumer's path) with json `options`
            #  Options schema is provided with TYtQueueConsumerOptions proto (but with snakecasing names of fields)
            queue_path  type=str
            consumer    type=str
            options     type=str
        update_options:
            #  Update consumer options: `old_options.update(json.loads(options))`
            #  Example:
            #      # Make queue_daemon ignore this consumer in trimming
            #      ./big_rt_cli consumer update_options //home/bigb_resharded_queues/ReshardedBtQueue buzzard_prestable '{"IgnoreInTrimming": true}'
            queue_path  type=str
            consumer    type=str
            options     type=str
    consuming_system:
        #  Diagnostic of CS: find host processing shard, find slow shards and hosts.
        host_by_shard:
            #  Get host that processes the shard.
            #  If cs_path doesn't exist, then tries to interpret its basename as regexp.
            #  Example:
            #      ./big_rt_cli consuming_system host_by_shard //home/bigb_resharded_queues/ReshardingConsumingSystem/iva.*adv.*banners.* 3
            cs_path  Consuming system path in YT type=str
            shard    type=int
        shards_info:
            #  Gets shards info for consuming system. For every shard finds corresponding processing host and message lag.
            #  Requires env variables: TVM_ID=<lb_client_tvm_id> TVM_SECRET=<lb_client_tvm_secret>
            #     or you can use presets: presets/with_bigb_resharder_test_tvm ./big_rt_cli consuming_system ...
            #     it load secrets from yav, substitute them to env variables and launch command given in args
            #  Example:
            #      ./big_rt_cli consuming_system shards_info //home/bigb_resharder_test/man_metrika__visit_v2_log --group_by_host --sort_message_lag --limit 10
            cs_path                Consuming system path in YT type=str
            --shards [SHARDS ...]  Consider only these shards type=int
            --group_by_host
            --sort_message_lag
            --preserve_unknown
            --limit LIMIT          Limit output rows type=int default=10000
        offsets:
            #  Operation with CS offset
            list_supplier_aliases:
                #  List supplier aliases of consuming system. Returns united set of aliases over all shards of system
                cs_path  Consuming system path in YT type=str
            drop_supplier_aliases:
                #  Drop supplier aliases from all shards of system
                cs_path                 Consuming system path in YT type=str
                --aliases ALIASES [ALIASES ...]
                                        Supplier aliases to drop type=str
            copy:
                #  Copy supplier offsets
                --src-path SRC_PATH  Source CS path type=str
                --dst-path DST_PATH  Destination CS path type=str
            rename_alias:
                #  Rename alias in offsets
                cs_path                 CS path type=str
                --alias-from ALIAS_FROM
                                        Old alias type=str
                --alias-to ALIAS_TO     New alias type=str
            list_swift_source_ids:
                #  List united set of swift queue source ids from given supplier offset from all shards of system
                cs_path                 Consuming system path in YT type=str
                --alias ALIAS           Supplier alias with swift offset type=str
                --source-id-regexp SOURCE_ID_REGEXP
                                        List only matching regexp source ids type=str
            drop_swift_source_ids:
                #  Drop swift queue source ids from given supplier offset from all shards of system
                #  Example:
                #      ./big_rt_cli consuming_system offsets drop_swift_source_ids
                #          //home/bigb/caesar/prestable/BannersSystem
                #          --alias 'markov://home/some_account/SomeTable'
                #          --source-ids $(python3 -c "s = 'some_prefix-%d'; print(' '.join(s % d for d in range(1000)))")
                #      ./big_rt_cli consuming_system offsets drop_swift_source_ids
                #          //home/bigb/caesar/prestable/AdGroupsSystem
                #          --alias 'markov://home/some_account/SomeTable'
                #          --source-id-regexp "some_prefix-\d+"
                #  TODO(https://st.yandex-team.ru/BIGRT-150): alias supplier from public config on YT
                cs_path                 Consuming system path in YT type=str
                --alias ALIAS           Supplier alias with swift offset type=str
                --source-ids SOURCE_IDS [SOURCE_IDS ...]
                                        Source ids to drop type=str
                --source-id-regexp SOURCE_ID_REGEXP
                                        Regexp for source ids to drop. It adds up to --source-ids type=str
                -y, --yes               Skip confirmation before dropping
            list_swift_seq_nos:
                #  List all source ids with seqnos from given supplier offset from given shard
                cs_path        Consuming system path in YT type=str
                --shard SHARD  Shard of CS type=int
                --alias ALIAS  Supplier alias with swift offset type=str
    gen_readme:
        --output OUTPUT  type=str default=README.md

```
