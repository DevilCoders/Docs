# Архитектура

Основная идея: отделить конфигурацию пайплайна от исполнения. То есть, пайплайн должен описываться не в терминах, скажем, "кубиков на Нирване", а с помощью абстрактных операций. В tenfifty такие операции называются действиями (actions). Действие описывается интерфейсом: какие данные ожидаются на входе и какие на выходе. Данные в tenfifty представлены артефактами (artifacts).

Пользователи могут создавать свои действия с помощью системы [плагинов](plugins/overview.md). Действие может (но не обязано) иметь реализацию на бэкенде. Граф может быть исполнен на бэкенде, если все его действия имеют реализацию на этом бэкенде.

Трансляция конфигурации в исполнение выглядит примерно так:

![Архитектура](pic/architecture.png)

Разделение конфигурации и исполнения достигается за счёт промежуточного представления пайплайна в виде графа.

При необходимости предложенная архитектура позволяет расширять множество бекэндов и способы конфигурирования, например, добавить бэкенд на open-source решениях (sklearn, hadoop, luigi, catboost, ...) или конфигурирование на основе protobuf.

## Действия     {#actions}

Основная единица в графе. Каждое действие может иметь или не иметь входные артефакты, созданные другими действиями, и выходные артефакты, которые в свою очередь породит данное действие.

## Артефакты    {#artifacts}

Все артефакты порождаются определенным действием.

Каждый артефакт имеет определенный тип. Сами по себе типы не имеют большой смысл в отрыве от бэкенда.

Сейчас основных типа два:
* `Dataset` &ndash; таблица на YT. К данному типу можно применять стандартные MapReduce-операции: map, join, reduce, sort и тд. Порождается действием `GetDatasetFromYt`. В нирване датасет представляется типом `MRTable`.
* `Model` &ndash; либо Catboost, либо Matrixnet, либо линейная модель (TLM). Порождается действиями типа `Train*`. Также модели можно применять к определенному датасету посредством операций типа `Apply*`. В нирване обычно представляется типом `Binary Data`.

Также существует композитный тип `Log`, на самом деле представляющий собой список артефактов типа `Dataset`. Порождается действием `GetLog`. К данному типу также можно применять стандартные MapReduce-операции (те же map, reduce, sort, join), при этом на самом деле все эти операции будут применяться по отдельности к каждому датасету из списка, так что на выходе мы тоже получим артефакт типа `Log`.
