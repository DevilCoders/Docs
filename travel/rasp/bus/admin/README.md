# Админка Автобусов

Flask приложение автобусной админки.

Запуск:

```
ya make && ./admin gunicorn -b "unix:/tmp/bus_admin.sock"
```

Для вывода всех опций:

```
./admin --help
```

### Все миграции на чистую базу
```
./admin db upgrade
```


### Создание миграции

Для быстрого создания миграции (например импорта базы) можно использовать команду
`./admin db migrate -m "revision-name"`
которая сгенерирует миграцию до текущей структуры базы, сравнивая ее состояние с моделями в `models`.

Автоматическая миграция создаётся командой `./admin db revision --autogenerate -m "revision-name"`. Если при этом
ничего не происходит, то скорее всего достаточно выполнить `./admin db upgrade`, чтобы база оказалась в актуальном
состоянии и alembic увидел изменения в моделях.

После создания файла с миграцией его __необходимо__ добавить в `ya.make` (в секцию `RESOURCE_FILES`)
Иначе при выкатке приложение не увидит вашу миграцию.


### deploy

Собирает Testenv тут:

`https://testenv.yandex-team.ru/?screen=manage&database=rasp_bus_admin`

в qloud в прод катим руками
