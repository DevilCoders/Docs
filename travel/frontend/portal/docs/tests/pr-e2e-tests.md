## Запуск автотестов на PR

Запуск автотестов встроен в CI `farm-flow`.

В проверках на merge называется `travel/frontend/portal: Deploy stand and e2e-tests` в блоке CI.

Можно перейти внутрь по клику и увидеть flow запущенное для вашего PR:

![img.png](img/flow.png)

Кубик `Generate Farm instance` запускает сборку фермы для PR,
ждет окончания сборки и передает url полученного стенда дальше.

Кубик `Hermione e2e-tests` прогоняет все тесты на вашем стенде
и всегда завершается успехом в независимости от количества упавших тестов.
Передает в следующий кубик список упавших тестов.

HTML отчет о выполнении тестов можно увидеть нажав на третий бейдж sandbox:

![img.png](img/sandbox-html-report.png)

Кубик `Hermione e2e-tests (only fallen)` запускает только те тесты, которые
упали в предыдущем кубике. Если все тесты на предыдущем шаге прошли успешно,
то этот кубик пропускается.

Если все тесты прошли сразу в `Hermione e2e-tests` или если были упавшие
и прошли в `Hermione e2e-tests (only fallen)`, то активируется последний кубик `Completed`.
Значит проверка e2e тестами завершена успешно.

Кубик `Hermione e2e-tests (only fallen)` подходит для ситуаций, когда были проблемы
с тестовым окружением, например не работал бек или траст.
После восстановления работоспособности тестового окружения, можно перезапустить только упавшие тесты - это быстрее.

Для перезапуска используйте стрелочку в правом нижнем углу
и подтвердите перезапуск в открывшемся модальном окне.

![img.png](img/retry.png)
